---
title: "aaaOnline biztonsági mentése és visszaállítása az Azure Cosmos DB |} Microsoft Docs"
description: "Megtudhatja, hogyan tooperform automatikus biztonsági mentése és visszaállítása egy Azure Cosmos DB adatbázisban."
keywords: "biztonsági mentés és visszaállítás, az online biztonsági mentés"
services: cosmos-db
documentationcenter: 
author: RahulPrasad16
manager: jhubbard
editor: monicar
ms.assetid: 98eade4a-7ef4-4667-b167-6603ecd80b79
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/11/2017
ms.author: raprasa
ms.openlocfilehash: a0b464c95681dfc7b5462b02bf04c2c43d6bc16f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="automatic-online-backup-and-restore-with-azure-cosmos-db"></a><span data-ttu-id="1698b-104">Automatikus online biztonsági mentés és helyreállítás Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="1698b-104">Automatic online backup and restore with Azure Cosmos DB</span></span>
<span data-ttu-id="1698b-105">Azure Cosmos-adatbázis rendszeres időközönként automatikusan az adatok biztonsági másolatainak vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="1698b-105">Azure Cosmos DB automatically takes backups of all your data at regular intervals.</span></span> <span data-ttu-id="1698b-106">hello automatikus biztonsági mentésekhez készít a nem befolyásolja a hello teljesítmény vagy a rendelkezésre álló a Helyadatbázis-műveletekhez.</span><span class="sxs-lookup"><span data-stu-id="1698b-106">hello automatic backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="1698b-107">A biztonsági mentések külön-külön tárolják egy másik tárhelyre, és azokat a biztonsági mentések globálisan replikálva vannak a rugalmasságot regionális vészhelyzetek ellen.</span><span class="sxs-lookup"><span data-stu-id="1698b-107">All your backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="1698b-108">Ha véletlenül törli a a Comos DB tárolót, és később a adat-helyreállítás vagy egy vész-helyreállítási megoldást igényelnek szánt forgatókönyvek hello automatikus biztonsági mentésekhez.</span><span class="sxs-lookup"><span data-stu-id="1698b-108">hello automatic backups are intended for scenarios when you accidentally delete your Comos DB container and later require data recovery or a disaster recovery solution.</span></span>  

<span data-ttu-id="1698b-109">Ez a cikk egy rövid összefoglaló hello adatok redundancia és rendelkezésre állás érdekében Cosmos DB kezdődik, és majd a biztonsági mentések ismerteti.</span><span class="sxs-lookup"><span data-stu-id="1698b-109">This article starts with a quick recap of hello data redundancy and availability in Cosmos DB, and then discusses backups.</span></span> 

## <a name="high-availability-with-cosmos-db---a-recap"></a><span data-ttu-id="1698b-110">Magas rendelkezésre állás az Cosmos DB - egy összefoglalása</span><span class="sxs-lookup"><span data-stu-id="1698b-110">High availability with Cosmos DB - a recap</span></span>
<span data-ttu-id="1698b-111">Cosmos DB tervezett toobe [globálisan elosztott](distribute-data-globally.md) – lehetővé teszi tooscale átviteli együtt feladatátvevő és transzparens többhelyű API-alapú házirend több Azure-régiók között.</span><span class="sxs-lookup"><span data-stu-id="1698b-111">Cosmos DB is designed toobe [globally distributed](distribute-data-globally.md) – it allows you tooscale throughput across multiple Azure regions along with policy driven failover and transparent multi-homing APIs.</span></span> <span data-ttu-id="1698b-112">Egy adatbázis rendszer ajánlat mint [rendelkezésre állás 99,99 % SLA-k](https://azure.microsoft.com/support/legal/sla/cosmos-db), minden hello írás az Adatbázisba az Cosmos véglegesítésére toolocal a lemezek helyi adatközpontban lévő replikák másodlagosak toohello ügyfél igazolása előtt.</span><span class="sxs-lookup"><span data-stu-id="1698b-112">As a database system offering [99.99% availability SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db), all hello writes in Cosmos DB are durably committed toolocal disks by a quorum of replicas within a local data center before acknowledging toohello client.</span></span> <span data-ttu-id="1698b-113">Ne feledje, hogy hello Cosmos-adatbázis magas rendelkezésre állású támaszkodik a helyi tároló nem függ semmilyen külső tárolási technológiákat.</span><span class="sxs-lookup"><span data-stu-id="1698b-113">Note that hello high availability of Cosmos DB relies on local storage and does not depend on any external storage technologies.</span></span> <span data-ttu-id="1698b-114">Továbbá ha az adatbázis-fiók egynél több Azure-régió tartozik, az írási műveletek replikálódnak más régiókból is.</span><span class="sxs-lookup"><span data-stu-id="1698b-114">Additionally, if your database account is associated with more than one Azure region, your writes are replicated across other regions as well.</span></span> <span data-ttu-id="1698b-115">tooscale alacsony késleltetésű, az átviteli sebesség és a hozzáférési adatok is különböző régiókban-adatbázis fiókjához tartozó tetszés szerinti olvasás.</span><span class="sxs-lookup"><span data-stu-id="1698b-115">tooscale your throughput and access data at low latencies, you can have as many read regions associated with your database account as you like.</span></span> <span data-ttu-id="1698b-116">Minden olvasási régióban (replikált) hello adatok tartósan állandó között a replikakészlethez.</span><span class="sxs-lookup"><span data-stu-id="1698b-116">In each read region, hello (replicated) data is durably persisted across a replica set.</span></span>  

<span data-ttu-id="1698b-117">A következő diagram hello módon van-e egyetlen Cosmos DB tárolót [vízszintesen particionált](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="1698b-117">As illustrated in hello following diagram, a single Cosmos DB container is [horizontally partitioned](partition-data.md).</span></span> <span data-ttu-id="1698b-118">A következő diagram hello kör megjelölt "Partíció", és mindegyik partíció keresztül egy magas rendelkezésre állású legyen.</span><span class="sxs-lookup"><span data-stu-id="1698b-118">A “partition” is denoted by a circle in hello following diagram, and each partition is made highly available via a replica set.</span></span> <span data-ttu-id="1698b-119">Ez a helyi terjesztési hello (hello X tengely jelölik) egyetlen Azure régión belül.</span><span class="sxs-lookup"><span data-stu-id="1698b-119">This is hello local distribution within a single Azure region (denoted by hello X axis).</span></span> <span data-ttu-id="1698b-120">Továbbá minden egyes partícióra (a megfelelő replikakészlethez) van majd globálisan elosztott-(például régiókban az ábra hello három – USA keleti régiója, USA nyugati régiója és közép-Indiában) adatbázis fiókjához tartozó különféle régiókban.</span><span class="sxs-lookup"><span data-stu-id="1698b-120">Further, each partition (with its corresponding replica set) is then globally distributed across multiple regions associated with your database account (for example, in this illustration hello three regions – East US, West US and Central India).</span></span> <span data-ttu-id="1698b-121">hello "partíció set" globálisan elosztott az entitás minden régióban (hello Y tengely jelölik) az adatok több példányt tartalmazó.</span><span class="sxs-lookup"><span data-stu-id="1698b-121">hello “partition set” is a globally distributed entity comprising of multiple copies of your data in each region (denoted by hello Y axis).</span></span> <span data-ttu-id="1698b-122">Rendelhet prioritást-adatbázis fiókjához tartozó toohello régiók és Cosmos DB fog transzparens feladatátvétel toohello következő terület katasztrófa esetén.</span><span class="sxs-lookup"><span data-stu-id="1698b-122">You can assign priority toohello regions associated with your database account and Cosmos DB will transparently failover toohello next region in case of disaster.</span></span> <span data-ttu-id="1698b-123">Feladatátvételi tootest hello végpont alkalmazás rendelkezésre állásának a szimulálhatja manuálisan is.</span><span class="sxs-lookup"><span data-stu-id="1698b-123">You can also manually simulate failover tootest hello end-to-end availability of your application.</span></span>  

<span data-ttu-id="1698b-124">hello alábbi kép ábrázolja a Cosmos DB redundancia magas fokú hello.</span><span class="sxs-lookup"><span data-stu-id="1698b-124">hello following image illustrates hello high degree of redundancy with Cosmos DB.</span></span>

![A Cosmos DB redundancia magas fokú](./media/online-backup-and-restore/redundancy.png)

![A Cosmos DB redundancia magas fokú](./media/online-backup-and-restore/global-distribution.png)

## <a name="full-automatic-online-backups"></a><span data-ttu-id="1698b-127">Teljes, automatikus, online biztonsági mentések</span><span class="sxs-lookup"><span data-stu-id="1698b-127">Full, automatic, online backups</span></span>
<span data-ttu-id="1698b-128">Sajnos a törölt a tároló, vagy az adatbázis!</span><span class="sxs-lookup"><span data-stu-id="1698b-128">Oops, I deleted my container or database!</span></span> <span data-ttu-id="1698b-129">A Cosmos DB nem csak az adatokat, de hello biztonsági másolatokat is magas redundáns és rugalmas tooregional vészhelyzetek esetére.</span><span class="sxs-lookup"><span data-stu-id="1698b-129">With Cosmos DB, not only your data, but hello backups of your data are also made highly redundant and resilient tooregional disasters.</span></span> <span data-ttu-id="1698b-130">Automatikus biztonsági mentéseket jelenleg körülbelül négy óránként készít, és a legújabb 2 biztonsági másolatai mindig.</span><span class="sxs-lookup"><span data-stu-id="1698b-130">These automated backups are currently taken approximately every four hours and latest 2 backups are stored at all times.</span></span> <span data-ttu-id="1698b-131">Ha véletlenül hello adatok eldobása, vagy sérült, adjon [kérje az Azure támogatási](https://azure.microsoft.com/support/options/) 8 órán belül.</span><span class="sxs-lookup"><span data-stu-id="1698b-131">If hello data is accidently dropped or corrupted, please [contact Azure support](https://azure.microsoft.com/support/options/) within 8 hours.</span></span> 

<span data-ttu-id="1698b-132">hello biztonsági mentést készít a nem befolyásolja a hello teljesítmény vagy a rendelkezésre álló a Helyadatbázis-műveletekhez.</span><span class="sxs-lookup"><span data-stu-id="1698b-132">hello backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="1698b-133">A kiépített RUs fel vagy hello teljesítményét és nélkül hello az adatbázis elérhetőségét érintő cosmos DB hello biztonsági mentés hello háttérben vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="1698b-133">Cosmos DB takes hello backup in hello background without consuming your provisioned RUs or affecting hello performance and without affecting hello availability of your database.</span></span> 

<span data-ttu-id="1698b-134">A Cosmos DB belül tárolt adatokat, eltérően hello automatikus biztonsági másolatai Azure Blob Storage szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="1698b-134">Unlike your data that is stored inside Cosmos DB, hello automatic backups are stored in Azure Blob Storage service.</span></span> <span data-ttu-id="1698b-135">tooguarantee hello alacsony késleltetésű/hatékony, a biztonsági mentési pillanatképet hello feltöltése feltöltött tooan példányát az Azure Blob storage hello hello aktuális írási terület Cosmos-adatbázis adatbázis-fiókja és ugyanabban a régióban.</span><span class="sxs-lookup"><span data-stu-id="1698b-135">tooguarantee hello low latency/efficient upload, hello snapshot of your backup is uploaded tooan instance of Azure Blob storage in hello same region as hello current write region of your Cosmos DB database account.</span></span> <span data-ttu-id="1698b-136">A regionális katasztrófa szembeni hibatűrést minden pillanatképet a biztonsági mentési adatok az Azure Blob Storage újra replikálja a rendszer georedundáns tárolás (GRS) tooanother régió keresztül.</span><span class="sxs-lookup"><span data-stu-id="1698b-136">For resiliency against regional disaster, each snapshot of your backup data in Azure Blob Storage is again replicated via geo-redundant storage (GRS) tooanother region.</span></span> <span data-ttu-id="1698b-137">hello következő ábrán az látható, hogy hello teljes Cosmos DB tárolóhoz (az összes három elsődleges partíció USA nyugati régiója, az ebben a példában) készül biztonsági másolat egy távoli Azure Blob Storage-fiókban az USA nyugati régiója és Georedundáns replikálja tooEast VELÜNK.</span><span class="sxs-lookup"><span data-stu-id="1698b-137">hello following diagram shows that hello entire Cosmos DB container (with all three primary partitions in West US, in this example) is backed up in a remote Azure Blob Storage account in West US and then GRS replicated tooEast US.</span></span> 

<span data-ttu-id="1698b-138">hello alábbi kép ábrázolja Georedundáns Azure Storage összes Cosmos DB entitásának rendszeres teljes biztonsági mentést.</span><span class="sxs-lookup"><span data-stu-id="1698b-138">hello following image illustrates periodic full backups of all Cosmos DB entities in GRS Azure Storage.</span></span>

![Az összes Cosmos DB entitások Georedundáns Azure Storage rendszeres teljes biztonsági mentés](./media/online-backup-and-restore/automatic-backup.png)

## <a name="backup-retention-period"></a><span data-ttu-id="1698b-140">Biztonsági mentés megőrzési időtartam</span><span class="sxs-lookup"><span data-stu-id="1698b-140">Backup retention period</span></span>
<span data-ttu-id="1698b-141">A fent leírtaknak megfelelően Azure Cosmos DB időt vesz igénybe az adatok pillanatfelvételének négy óránként, és 30 napig őrzi meg hello utolsó két pillanatképek minden partíció.</span><span class="sxs-lookup"><span data-stu-id="1698b-141">As described above, Azure Cosmos DB takes snapshots of your data every four hours and retains hello last two snapshots of every partition for 30 days.</span></span> <span data-ttu-id="1698b-142">A megfelelőségi szabályzat / pillanatképek kiürítésekor 90 nap után.</span><span class="sxs-lookup"><span data-stu-id="1698b-142">Per our compliance regulations, snapshots are purged after 90 days.</span></span>

<span data-ttu-id="1698b-143">Ha toomaintain saját pillanatképeket, használhatja a hello Azure Cosmos DB hello exportálási tooJSON beállítás [adatáttelepítési eszközét](import-data.md#export-to-json-file) tooschedule további biztonsági másolatoknak.</span><span class="sxs-lookup"><span data-stu-id="1698b-143">If you want toomaintain your own snapshots, you can use hello export tooJSON option in hello Azure Cosmos DB [Data Migration tool](import-data.md#export-to-json-file) tooschedule additional backups.</span></span> 

## <a name="restoring-a-database-from-an-online-backup"></a><span data-ttu-id="1698b-144">Adatbázis visszaállítása az online biztonsági mentés</span><span class="sxs-lookup"><span data-stu-id="1698b-144">Restoring a database from an online backup</span></span>
<span data-ttu-id="1698b-145">Ha véletlenül törli az adatbázis vagy a gyűjtemény, akkor [fájlt egy támogatási jegy](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) vagy [Azure az ügyfélszolgálat](https://azure.microsoft.com/support/options/) hello utolsó automatikus biztonsági mentés toorestore hello adatait.</span><span class="sxs-lookup"><span data-stu-id="1698b-145">If you accidentally delete your database or collection, you can [file a support ticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) or [call Azure support](https://azure.microsoft.com/support/options/) toorestore hello data from hello last automatic backup.</span></span> <span data-ttu-id="1698b-146">Ha szüksége toorestore az adatbázis adatsérülés következett be miatt, tekintse meg [adatsérülés kezelése](#handling-data-corruption) szükség szerint további tootake tooprevent hello sérült adatok lépések áthatoló hello biztonsági másolatból.</span><span class="sxs-lookup"><span data-stu-id="1698b-146">If you need toorestore your database because of data corruption issue, see [Handling data corruption](#handling-data-corruption) as you need tootake additional steps tooprevent hello corrupted data from penetrating hello backups.</span></span> <span data-ttu-id="1698b-147">A biztonsági másolat visszaállítása toobe adott pillanatképet Cosmos DB szükséges hello adatok volt elérhető a hello hello biztonsági mentési ciklust, hogy a pillanatkép idejére.</span><span class="sxs-lookup"><span data-stu-id="1698b-147">For a specific snapshot of your backup toobe restored, Cosmos DB requires that hello data was available for hello duration of hello backup cycle for that snapshot.</span></span>

## <a name="handling-data-corruption"></a><span data-ttu-id="1698b-148">Adatsérülés kezelése</span><span class="sxs-lookup"><span data-stu-id="1698b-148">Handling data corruption</span></span>
<span data-ttu-id="1698b-149">Azure Cosmos DB hello minden partíció utolsó két biztonsági mentést hello rendszer megőrzi.</span><span class="sxs-lookup"><span data-stu-id="1698b-149">Azure Cosmos DB retains hello last two backups of every partition in hello system.</span></span> <span data-ttu-id="1698b-150">Ez a modell jól működik, ha óta hello utolsó verziók egyike állítható vissza véletlenül törli a tároló (gyűjtemény dokumentumok, a graph, a táblázat), vagy az adatbázis.</span><span class="sxs-lookup"><span data-stu-id="1698b-150">This model works very well when a container (collection of documents, graph, table) or a database is accidentally deleted since one of hello last versions can be restored.</span></span> <span data-ttu-id="1698b-151">Azonban a hello eset, amikor a felhasználók vezethetnek adatsérülés következett be, amikor Azure Cosmos DB előfordulhat, hogy ne tudjanak a hello program sérült adatokat, és előfordulhat, hogy a sérülés hello előfordulhat, hogy rendelkezik követhessék hello biztonsági mentéseket.</span><span class="sxs-lookup"><span data-stu-id="1698b-151">However, in hello case when when users may introduce a data corruption issue, Azure Cosmos DB may be unaware of hello data corruption, and it is possible that hello corruption may have penetrated hello backups.</span></span> <span data-ttu-id="1698b-152">Amint sérülést észlel, törölnie kell sérült hello tároló (gyűjtemény vagy graph vagy tábla), hogy a biztonsági mentések védi a felülírás sérült adatokkal.</span><span class="sxs-lookup"><span data-stu-id="1698b-152">As soon as corruption is detected, you should delete hello corrupted container (collection/graph/table) so that backups are protected from being overwritten with corrupted data.</span></span> <span data-ttu-id="1698b-153">Hello utolsó biztonsági mentés régi négy óra lehet, mert hello felhasználói is alkalmaz [adatcsatorna módosítása](change-feed.md) toocapture és a tároló hello utolsó négy óra érdemes adatok hello tároló törlése előtt.</span><span class="sxs-lookup"><span data-stu-id="1698b-153">Since hello last backup could be four hours old, hello user can employ [change feed](change-feed.md) toocapture and store hello last four hours worth of data before deleting hello container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1698b-154">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="1698b-154">Next steps</span></span>

<span data-ttu-id="1698b-155">tooreplicate az adatbázis több adatközpontokban, lásd: [terjesztése az adatok globálisan Cosmos DB](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="1698b-155">tooreplicate your database in multiple data centers, see [distribute your data globally with Cosmos DB](distribute-data-globally.md).</span></span> 

<span data-ttu-id="1698b-156">toofile Forduljon Azure támogatási [hello Azure-portálon az igénylést](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span><span class="sxs-lookup"><span data-stu-id="1698b-156">toofile contact Azure Support, [file a ticket from hello Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span></span>

