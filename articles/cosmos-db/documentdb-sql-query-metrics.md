---
title: "Azure Cosmos DB DocumentDB API aaaSQL lekérdezés metrikáját |} Microsoft Docs"
description: "További információk a hogyan tooinstrument és hibakeresési hello Azure Cosmos DB kérelmek SQL-lekérdezések teljesítményét."
keywords: "SQL-szintaxis, sql-lekérdezést, az sql-lekérdezések, json lekérdezési nyelv, adatbázis fogalmait és az sql-lekérdezések, összesítő függvények"
services: cosmos-db
documentationcenter: 
author: arramac
manager: jhubbard
editor: monicar
ms.assetid: b2fa8e8f-7291-45a3-9bd1-7284ed9077f8
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/15/2017
ms.author: arramac
ms.openlocfilehash: 2fee3786b7d48d254162699471943e316764b003
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="tuning-query-performance-with-azure-cosmos-db"></a><span data-ttu-id="8911f-104">Az Azure Cosmos DB lekérdezési teljesítmény hangolása</span><span class="sxs-lookup"><span data-stu-id="8911f-104">Tuning query performance with Azure Cosmos DB</span></span>
<span data-ttu-id="8911f-105">Az Azure Cosmos DB biztosít egy [SQL API-t a lekérdezésre adatok](documentdb-sql-query.md), anélkül, hogy a séma vagy másodlagos kulcsot.</span><span class="sxs-lookup"><span data-stu-id="8911f-105">Azure Cosmos DB provides a [SQL API for querying data](documentdb-sql-query.md), without requiring schema or secondary indexes.</span></span> <span data-ttu-id="8911f-106">Ez a cikk ismerteti a következő információk fejlesztőknek hello:</span><span class="sxs-lookup"><span data-stu-id="8911f-106">This article provides hello following information for developers:</span></span>

* <span data-ttu-id="8911f-107">Nagy részletességű Azure Cosmos adatbázis SQL-lekérdezés végrehajtása működéséről</span><span class="sxs-lookup"><span data-stu-id="8911f-107">High-level details on how Azure Cosmos DB's SQL query execution works</span></span>
* <span data-ttu-id="8911f-108">A lekérdezés kérés- és válaszfejlécekről, és az ügyfél SDK-beállítások részletei</span><span class="sxs-lookup"><span data-stu-id="8911f-108">Details on query request and response headers, and client SDK options</span></span>
* <span data-ttu-id="8911f-109">Tippek és ajánlott eljárások a lekérdezési teljesítmény</span><span class="sxs-lookup"><span data-stu-id="8911f-109">Tips and best practices for query performance</span></span>
* <span data-ttu-id="8911f-110">Példák hogyan tooutilize SQL végrehajtási statisztika toodebug lekérdezési teljesítmény</span><span class="sxs-lookup"><span data-stu-id="8911f-110">Examples of how tooutilize SQL execution statistics toodebug query performance</span></span>

## <a name="about-sql-query-execution"></a><span data-ttu-id="8911f-111">Tudnivalók az SQL-lekérdezés végrehajtása</span><span class="sxs-lookup"><span data-stu-id="8911f-111">About SQL query execution</span></span>

<span data-ttu-id="8911f-112">Az Azure Cosmos Adatbázisba, adattárolásra-tárolókban, amely milyen mértékben növelhető a tooany [tárolási méretét, vagy kérjen teljesítmény](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="8911f-112">In Azure Cosmos DB, you store data in containers, which can grow tooany [storage size or request throughput](partition-data.md).</span></span> <span data-ttu-id="8911f-113">Azure Cosmos-adatbázis zökkenőmentesen arányosan adatok különböző fizikai partíciók hello magában foglalja az toohandle adatmennyiség-növekedés vagy a kiosztott átviteli sebesség növekedését.</span><span class="sxs-lookup"><span data-stu-id="8911f-113">Azure Cosmos DB seamlessly scales data across physical partitions under hello covers toohandle data growth or increase in provisioned throughput.</span></span> <span data-ttu-id="8911f-114">SQL-lekérdezések tooany tároló hello REST API vagy hello támogatott egyikének használatával adhat ki [DocumentDB SDK-k](documentdb-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="8911f-114">You can issue SQL queries tooany container using hello REST API or one of hello supported [DocumentDB SDKs](documentdb-sdk-dotnet.md).</span></span>

<span data-ttu-id="8911f-115">Particionálás rövid áttekintést: megadhatja a partíciós kulcs, például a "város", amely megadja, hogy milyen adatok fizikai partíciók osztani.</span><span class="sxs-lookup"><span data-stu-id="8911f-115">A brief overview of partitioning: you define a partition key like "city", which determines how data is split across physical partitions.</span></span> <span data-ttu-id="8911f-116">Adatok tartozó tooa egyetlen partíciós kulcs (például "város" == "Seattle") a fizikai partíción belül található, de általában egyetlen fizikai partícióján több partíciós kulcsok.</span><span class="sxs-lookup"><span data-stu-id="8911f-116">Data belonging tooa single partition key (for example, "city" == "Seattle") is stored within a physical partition, but typically a single physical partition has multiple partition keys.</span></span> <span data-ttu-id="8911f-117">Amikor egy partíció mérete eléri, hello szolgáltatás zökkenőmentesen hello partíció felosztja a két új partíció és hello partíciókulcs egyenlően osztja ezek a partíciók közötti.</span><span class="sxs-lookup"><span data-stu-id="8911f-117">When a partition reaches its storage size, hello service seamlessly splits hello partition into two new partitions, and divides hello partition key evenly across these partitions.</span></span> <span data-ttu-id="8911f-118">Mivel partíció átmeneti, hello API-k használata egy "partíció kulcs tartományt", amely azt jelzi, a partíciós kulcs kivonatok hello tartományok absztrakciós.</span><span class="sxs-lookup"><span data-stu-id="8911f-118">Since partitions are transient, hello APIs use an abstraction of a "partition key range", which denotes hello ranges of partition key hashes.</span></span> 

<span data-ttu-id="8911f-119">A lekérdezés tooAzure Cosmos DB elküldésekor hello SDK logikai lépéseket hajtja végre:</span><span class="sxs-lookup"><span data-stu-id="8911f-119">When you issue a query tooAzure Cosmos DB, hello SDK performs these logical steps:</span></span>

* <span data-ttu-id="8911f-120">Hello SQL lekérdezés toodetermine hello lekérdezés végrehajtási terv elemezni.</span><span class="sxs-lookup"><span data-stu-id="8911f-120">Parse hello SQL query toodetermine hello query execution plan.</span></span> 
* <span data-ttu-id="8911f-121">Ha hello lekérdezés szűrője hello partíciókulcs ellen, például `SELECT * FROM c WHERE c.city = "Seattle"`, irányított tooa egy partíció.</span><span class="sxs-lookup"><span data-stu-id="8911f-121">If hello query includes a filter against hello partition key, like `SELECT * FROM c WHERE c.city = "Seattle"`, it is routed tooa single partition.</span></span> <span data-ttu-id="8911f-122">Ha hello lekérdezés nem rendelkezik egy szűrőt a partíciós kulcs, majd az összes partíció végrehajtása, eredmények egyesítve lesznek az ügyféloldali.</span><span class="sxs-lookup"><span data-stu-id="8911f-122">If hello query does not have a filter on partition key, then it is executed in all partitions, and results are merged client side.</span></span>
* <span data-ttu-id="8911f-123">hello lekérdezés minden partíció sorozat futtatásuk vagy párhuzamosan, alapuló ügyfél-konfigurációt.</span><span class="sxs-lookup"><span data-stu-id="8911f-123">hello query is executed within each partition in series or parallel, based on client configuration.</span></span> <span data-ttu-id="8911f-124">Minden partíción belül hello lekérdezés tehetik az egyik vagy hello lekérdezés összetettségét, attól függően, hogy további kiszolgálókkal való adatváltások számát konfigurálva az ajánlott méretet, és a kiosztott átviteli sebesség hello gyűjtemény.</span><span class="sxs-lookup"><span data-stu-id="8911f-124">Within each partition, hello query might make one or more round trips depending on hello query complexity, configured page size, and provisioned throughput of hello collection.</span></span> <span data-ttu-id="8911f-125">Minden egyes végrehajtása hello számát adja vissza [egységek kérelem](request-units.md) felhasznált lekérdezés-végrehajtáshoz, és szükség esetén lekérdezés végrehajtási statisztika.</span><span class="sxs-lookup"><span data-stu-id="8911f-125">Each execution returns hello number of [request units](request-units.md) consumed by query execution, and optionally, query execution statistics.</span></span> 
* <span data-ttu-id="8911f-126">hello SDK egy összegzési hello lekérdezési eredmények között partíciók hajt végre.</span><span class="sxs-lookup"><span data-stu-id="8911f-126">hello SDK performs a summarization of hello query results across partitions.</span></span> <span data-ttu-id="8911f-127">Például ha hello lekérdezés szerint egy ORDER BY partíciók között, majd az egyes partíciók eredményei egyesítési rendezve tooreturn eredmények globálisan rendezett sorrendben.</span><span class="sxs-lookup"><span data-stu-id="8911f-127">For example, if hello query involves an ORDER BY across partitions, then results from individual partitions are merge-sorted tooreturn results in globally sorted order.</span></span> <span data-ttu-id="8911f-128">Ha hello lekérdezés például összesítést `COUNT`, az egyes partíciók hello számok pedig összegzett tooproduce hello teljes száma.</span><span class="sxs-lookup"><span data-stu-id="8911f-128">If hello query is an aggregation like `COUNT`, hello counts from individual partitions are summed tooproduce hello overall count.</span></span>

<span data-ttu-id="8911f-129">hello SDK-k a lekérdezés-végrehajtáshoz különböző lehetőségeket kínál.</span><span class="sxs-lookup"><span data-stu-id="8911f-129">hello SDKs provide various options for query execution.</span></span> <span data-ttu-id="8911f-130">Például a .NET ezek a lehetőségek állnak rendelkezésre hello `FeedOptions` osztály.</span><span class="sxs-lookup"><span data-stu-id="8911f-130">For example, in .NET these options are available in hello `FeedOptions` class.</span></span> <span data-ttu-id="8911f-131">hello következő táblázat ismerteti ezeket a beállításokat, és milyen hatással lesznek a lekérdezés-végrehajtási idő.</span><span class="sxs-lookup"><span data-stu-id="8911f-131">hello following table describes these options and how they impact query execution time.</span></span> 

| <span data-ttu-id="8911f-132">Beállítás</span><span class="sxs-lookup"><span data-stu-id="8911f-132">Option</span></span> | <span data-ttu-id="8911f-133">Leírás</span><span class="sxs-lookup"><span data-stu-id="8911f-133">Description</span></span> |
| ------ | ----------- |
| `EnableCrossPartitionQuery` | <span data-ttu-id="8911f-134">Az összes lekérdezés, amely több partíciót keresztül végrehajtott toobe tootrue kell beállítani.</span><span class="sxs-lookup"><span data-stu-id="8911f-134">Must be set tootrue for any query that requires toobe executed across more than one partition.</span></span> <span data-ttu-id="8911f-135">Ez az egy explicit jelző tooenable meg toomake tudatos teljesítmény mellékhatásokkal fejlesztési idő alatt.</span><span class="sxs-lookup"><span data-stu-id="8911f-135">This is an explicit flag tooenable you toomake conscious performance tradeoffs during development time.</span></span> |
| `EnableScanInQuery` | <span data-ttu-id="8911f-136">Meg kell tootrue Ha visszavonta igényét a indexelő, de ennek ellenére is szeretné toorun hello lekérdezés segítségével a vizsgálat.</span><span class="sxs-lookup"><span data-stu-id="8911f-136">Must be set tootrue if you have opted out of indexing, but want toorun hello query via a scan anyway.</span></span> <span data-ttu-id="8911f-137">Csak végezhető el, ha a hello indexelő kért szűrő elérési útja le van tiltva.</span><span class="sxs-lookup"><span data-stu-id="8911f-137">Only applicable if indexing for hello requested filter path is disabled.</span></span> | 
| `MaxItemCount` | <span data-ttu-id="8911f-138">az elemek tooreturn oda-vissza toohello kiszolgálónként hello maximális számát.</span><span class="sxs-lookup"><span data-stu-id="8911f-138">hello maximum number of items tooreturn per round trip toohello server.</span></span> <span data-ttu-id="8911f-139">Túl-1 értékre állításával, hogy hello kiszolgáló kezelése hello elemek száma.</span><span class="sxs-lookup"><span data-stu-id="8911f-139">By setting too-1, you can let hello server manage hello number of items.</span></span> <span data-ttu-id="8911f-140">Vagy csökkenthető a érték tooretrieve csak kevés elemek száma oda-vissza.</span><span class="sxs-lookup"><span data-stu-id="8911f-140">Or, you can lower this value tooretrieve only a small number of items per round trip.</span></span> 
| `MaxBufferedItemCount` | <span data-ttu-id="8911f-141">Ez egy ügyféloldali beállítást, és toolimit hello memória-felhasználás használt kereszt-partíció ORDER BY végrehajtása során.</span><span class="sxs-lookup"><span data-stu-id="8911f-141">This is a client-side option, and used toolimit hello memory consumption when performing cross-partition ORDER BY.</span></span> <span data-ttu-id="8911f-142">A nagyobb érték csökkentheti a kereszt-partíció rendezés hello késését.</span><span class="sxs-lookup"><span data-stu-id="8911f-142">A higher value helps reduce hello latency of cross-partition sorting.</span></span> |
| `MaxDegreeOfParallelism` | <span data-ttu-id="8911f-143">Lekérdezi vagy beállítja a hello száma párhuzamos műveletek hello Azure DocumentDB adatbázis-szolgáltatás a párhuzamos lekérdezés-végrehajtás során az ügyféloldali futtatni.</span><span class="sxs-lookup"><span data-stu-id="8911f-143">Gets or sets hello number of concurrent operations run client side during parallel query execution in hello Azure DocumentDB database service.</span></span> <span data-ttu-id="8911f-144">Egy pozitív tulajdonság értéke korlátozza hello száma párhuzamos műveletek toohello érték beállítása.</span><span class="sxs-lookup"><span data-stu-id="8911f-144">A positive property value limits hello number of concurrent operations toohello set value.</span></span> <span data-ttu-id="8911f-145">Ha az érték 0-nál tooless, hello rendszer automatikusan eldönti hello száma párhuzamos műveletek toorun.</span><span class="sxs-lookup"><span data-stu-id="8911f-145">If it is set tooless than 0, hello system automatically decides hello number of concurrent operations toorun.</span></span> |
| `PopulateQueryMetrics` | <span data-ttu-id="8911f-146">Lehetővé teszi, hogy a lekérdezés-végrehajtás, mint a fordítás során, a index hurok idő és a dokumentum különböző fázisait töltött idő statisztika részletes naplózás betöltési ideje.</span><span class="sxs-lookup"><span data-stu-id="8911f-146">Enables detailed logging of statistics of time spent in various phases of query execution like compilation time, index loop time, and document load time.</span></span> <span data-ttu-id="8911f-147">Azure-támogatás toodiagnose lekérdezés teljesítményproblémák megoszthatja zónalekérdezési statisztika kimenetét.</span><span class="sxs-lookup"><span data-stu-id="8911f-147">You can share output from query statistics with Azure Support toodiagnose query performance issues.</span></span> |
| `RequestContinuation` | <span data-ttu-id="8911f-148">A lekérdezés által visszaadott hello nem átlátszó folytatási kód történő lekérdezés-végrehajtás folytathatja.</span><span class="sxs-lookup"><span data-stu-id="8911f-148">You can resume query execution by passing in hello opaque continuation token returned by any query.</span></span> <span data-ttu-id="8911f-149">hello folytatási kód magában foglalja a lekérdezés-végrehajtáshoz szükséges összes állapotát.</span><span class="sxs-lookup"><span data-stu-id="8911f-149">hello continuation token encapsulates all state required for query execution.</span></span> |
| `ResponseContinuationTokenLimitInKb` | <span data-ttu-id="8911f-150">Korlátozhatja hello kiszolgáló által visszaadott folytatási hello hello maximális méretét.</span><span class="sxs-lookup"><span data-stu-id="8911f-150">You can limit hello maximum size of hello continuation token returned by hello server.</span></span> <span data-ttu-id="8911f-151">Előfordulhat, hogy tooset ez szükséges-e az alkalmazás-állomás korlátok a válasz fejléc mérete.</span><span class="sxs-lookup"><span data-stu-id="8911f-151">You might need tooset this if your application host has limits on response header size.</span></span> <span data-ttu-id="8911f-152">Beállítás megnőhet hello teljes időtartamát és hello lekérdezés felhasznált RUs.</span><span class="sxs-lookup"><span data-stu-id="8911f-152">Setting this may increase hello overall duration and RUs consumed for hello query.</span></span>  |

<span data-ttu-id="8911f-153">Például vessen példalekérdezést a partíciós kulcs egy gyűjtemény kért `/city` kulcs és 100 000 RU/s átviteli kiosztott hello partíció.</span><span class="sxs-lookup"><span data-stu-id="8911f-153">For example, let's take an example query on partition key requested on a collection with `/city` as hello partition key and provisioned with 100,000 RU/s of throughput.</span></span> <span data-ttu-id="8911f-154">A lekérdezés segítségével kér le `CreateDocumentQuery<T>` a .NET hasonló hello:</span><span class="sxs-lookup"><span data-stu-id="8911f-154">You request this query using `CreateDocumentQuery<T>` in .NET like hello following:</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
        MaxItemCount = -1, 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();
```

<span data-ttu-id="8911f-155">hello SDK kódrészletben bemutatott, megfelel-e toohello REST API-kérelem a következő:</span><span class="sxs-lookup"><span data-stu-id="8911f-155">hello SDK snippet shown above, corresponds toohello following REST API request:</span></span>

```
POST https://arramacquerymetrics-westus.documents.azure.com/dbs/db/colls/sample/docs HTTP/1.1
x-ms-continuation: 
x-ms-documentdb-isquery: True
x-ms-max-item-count: -1
x-ms-documentdb-query-enablecrosspartition: True
x-ms-documentdb-query-parallelizecrosspartitionquery: True
x-ms-documentdb-query-iscontinuationexpected: True
x-ms-documentdb-populatequerymetrics: True
x-ms-date: Tue, 27 Jun 2017 21:52:18 GMT
authorization: type%3dmaster%26ver%3d1.0%26sig%3drp1Hi83Y8aVV5V6LzZ6xhtQVXRAMz0WNMnUuvriUv%2b4%3d
x-ms-session-token: 7:8,6:2008,5:8,4:2008,3:8,2:2008,1:8,0:8,9:8,8:4008
Cache-Control: no-cache
x-ms-consistency-level: Session
User-Agent: documentdb-dotnet-sdk/1.14.1 Host/32-bit MicrosoftWindowsNT/6.2.9200.0
x-ms-version: 2017-02-22
Accept: application/json
Content-Type: application/query+json
Host: arramacquerymetrics-westus.documents.azure.com
Content-Length: 52
Expect: 100-continue

{"query":"SELECT * FROM c WHERE c.city = 'Seattle'"}
```

<span data-ttu-id="8911f-156">Minden egyes lekérdezés végrehajtása lap megfelel tooa REST API `POST` a hello `Accept: application/query+json` fejléc, és SQL-lekérdezés hello hello törzsében.</span><span class="sxs-lookup"><span data-stu-id="8911f-156">Each query execution page corresponds tooa REST API `POST` with hello `Accept: application/query+json` header, and hello SQL query in hello body.</span></span> <span data-ttu-id="8911f-157">Minden egyes lekérdezés esetén egy vagy több kerekíteni hello kiszolgálóval való adatváltások számát toohello `x-ms-continuation` token annál hello ügyfél és kiszolgáló tooresume végrehajtási között.</span><span class="sxs-lookup"><span data-stu-id="8911f-157">Each query makes one or more round trips toohello server with hello `x-ms-continuation` token echoed between hello client and server tooresume execution.</span></span> <span data-ttu-id="8911f-158">hello konfigurációs beállítások FeedOptions átadott toohello server kérelemfejléc hello formájában.</span><span class="sxs-lookup"><span data-stu-id="8911f-158">hello configuration options in FeedOptions are passed toohello server in hello form of request headers.</span></span> <span data-ttu-id="8911f-159">Például `MaxItemCount` megfelel-e túl`x-ms-max-item-count`.</span><span class="sxs-lookup"><span data-stu-id="8911f-159">For example, `MaxItemCount` corresponds too`x-ms-max-item-count`.</span></span> 

<span data-ttu-id="8911f-160">hello kérelem adja vissza (az olvashatóság csonkolt) hello következő választ:</span><span class="sxs-lookup"><span data-stu-id="8911f-160">hello request returns hello following (truncated for readability) response:</span></span>

```
HTTP/1.1 200 Ok
Cache-Control: no-store, no-cache
Pragma: no-cache
Transfer-Encoding: chunked
Content-Type: application/json
Server: Microsoft-HTTPAPI/2.0
Strict-Transport-Security: max-age=31536000
x-ms-last-state-change-utc: Tue, 27 Jun 2017 21:01:57.561 GMT
x-ms-resource-quota: documentSize=10240;documentsSize=10485760;documentsCount=-1;collectionSize=10485760;
x-ms-resource-usage: documentSize=1;documentsSize=884;documentsCount=2000;collectionSize=1408;
x-ms-item-count: 2000
x-ms-schemaversion: 1.3
x-ms-alt-content-path: dbs/db/colls/sample
x-ms-content-path: +9kEANVq0wA=
x-ms-xp-role: 1
x-ms-documentdb-query-metrics: totalExecutionTimeInMs=33.67;queryCompileTimeInMs=0.06;queryLogicalPlanBuildTimeInMs=0.02;queryPhysicalPlanBuildTimeInMs=0.10;queryOptimizationTimeInMs=0.00;VMExecutionTimeInMs=32.56;indexLookupTimeInMs=0.36;documentLoadTimeInMs=9.58;systemFunctionExecuteTimeInMs=0.00;userFunctionExecuteTimeInMs=0.00;retrievedDocumentCount=2000;retrievedDocumentSize=1125600;outputDocumentCount=2000;writeOutputTimeInMs=18.10;indexUtilizationRatio=1.00
x-ms-request-charge: 604.42
x-ms-serviceversion: version=1.14.34.4
x-ms-activity-id: 0df8b5f6-83b9-4493-abda-cce6d0f91486
x-ms-session-token: 2:2008
x-ms-gatewayversion: version=1.14.33.2
Date: Tue, 27 Jun 2017 21:59:49 GMT
```

<span data-ttu-id="8911f-161">hello kulcs válaszfejlécek hello lekérdezés által visszaadott hello alábbiakat foglalja magába:</span><span class="sxs-lookup"><span data-stu-id="8911f-161">hello key response headers returned from hello query include hello following:</span></span>

| <span data-ttu-id="8911f-162">Beállítás</span><span class="sxs-lookup"><span data-stu-id="8911f-162">Option</span></span> | <span data-ttu-id="8911f-163">Leírás</span><span class="sxs-lookup"><span data-stu-id="8911f-163">Description</span></span> |
| ------ | ----------- |
| `x-ms-item-count` | <span data-ttu-id="8911f-164">hello válaszként visszaküldött elemek hello száma.</span><span class="sxs-lookup"><span data-stu-id="8911f-164">hello number of items returned in hello response.</span></span> <span data-ttu-id="8911f-165">Ez az függ a megadott hello `x-ms-max-item-count`, hello hello válasz maximális terhelés méretének, a hello kiosztott átviteli sebesség és a lekérdezés-végrehajtási idő illeszkedő elemek száma.</span><span class="sxs-lookup"><span data-stu-id="8911f-165">This is dependent on hello supplied `x-ms-max-item-count`, hello number of items that can be fit within hello maximum response payload size, hello provisioned throughput, and query execution time.</span></span> |  
| `x-ms-continuation:` | <span data-ttu-id="8911f-166">hello folytatási token tooresume hello lekérdezés futtatása, ha további eredmények érhetők el.</span><span class="sxs-lookup"><span data-stu-id="8911f-166">hello continuation token tooresume execution of hello query, if additional results are available.</span></span> | 
| `x-ms-documentdb-query-metrics` | <span data-ttu-id="8911f-167">hello zónalekérdezési statisztika hello végrehajtásra.</span><span class="sxs-lookup"><span data-stu-id="8911f-167">hello query statistics for hello execution.</span></span> <span data-ttu-id="8911f-168">Ez a lekérdezés-végrehajtás különböző fázisait hello töltött időt a statisztikai adatait tartalmazó tagolt karakterláncot.</span><span class="sxs-lookup"><span data-stu-id="8911f-168">This is a delimited string containing statistics of time spent in hello various phases of query execution.</span></span> <span data-ttu-id="8911f-169">Visszaadott if `x-ms-documentdb-populatequerymetrics` értéke túl`True`.</span><span class="sxs-lookup"><span data-stu-id="8911f-169">Returned if `x-ms-documentdb-populatequerymetrics` is set too`True`.</span></span> | 
| `x-ms-request-charge` | <span data-ttu-id="8911f-170">hello száma [egységek kérelem](request-units.md) hello lekérdezés használni.</span><span class="sxs-lookup"><span data-stu-id="8911f-170">hello number of [request units](request-units.md) consumed by hello query.</span></span> | 

<span data-ttu-id="8911f-171">További részletek a hello REST API kérelemfejléc és beállítások: [hello DocumentDB REST API-t használó erőforrásokat](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span><span class="sxs-lookup"><span data-stu-id="8911f-171">For details on hello REST API request headers and options, see [Querying resources using hello DocumentDB REST API](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span></span>

## <a name="best-practices-for-query-performance"></a><span data-ttu-id="8911f-172">Gyakorlati tanácsok a lekérdezési teljesítmény</span><span class="sxs-lookup"><span data-stu-id="8911f-172">Best practices for query performance</span></span>
<span data-ttu-id="8911f-173">Az alábbiakban hello Azure Cosmos DB lekérdezési teljesítményt befolyásoló leggyakoribb tényezők hello.</span><span class="sxs-lookup"><span data-stu-id="8911f-173">hello following are hello most common factors that impact Azure Cosmos DB query performance.</span></span> <span data-ttu-id="8911f-174">A Microsoft feltárva minden, az alábbi témakörökben találja ebben a cikkben.</span><span class="sxs-lookup"><span data-stu-id="8911f-174">We dig deeper into each of these topics in this article.</span></span>

| <span data-ttu-id="8911f-175">Tényező</span><span class="sxs-lookup"><span data-stu-id="8911f-175">Factor</span></span> | <span data-ttu-id="8911f-176">Tipp</span><span class="sxs-lookup"><span data-stu-id="8911f-176">Tip</span></span> | 
| ------ | -----| 
| <span data-ttu-id="8911f-177">Kiosztott átviteli kapacitás</span><span class="sxs-lookup"><span data-stu-id="8911f-177">Provisioned throughput</span></span> | <span data-ttu-id="8911f-178">RU mérjük lekérdezésenként, és győződjön meg arról, hogy rendelkezik-e hello szükséges kiosztott átviteli sebesség a lekérdezések.</span><span class="sxs-lookup"><span data-stu-id="8911f-178">Measure RU per query, and ensure that you have hello required provisioned throughput for your queries.</span></span> | 
| <span data-ttu-id="8911f-179">Particionálás és partíciós kulcsok</span><span class="sxs-lookup"><span data-stu-id="8911f-179">Partitioning and partition keys</span></span> | <span data-ttu-id="8911f-180">Lekérdezések alkalmazást a hello a partíciós kulcs értéke az alacsony késleltetés hello szűrőfeltételben.</span><span class="sxs-lookup"><span data-stu-id="8911f-180">Favor queries with hello partition key value in hello filter clause for low latency.</span></span> |
| <span data-ttu-id="8911f-181">SDK-t és a lekérdezés beállításai</span><span class="sxs-lookup"><span data-stu-id="8911f-181">SDK and query options</span></span> | <span data-ttu-id="8911f-182">Kövesse a bevált gyakorlatokat SDK például közvetlen kapcsolatot, és az ügyféloldali lekérdezés végrehajtási beállítások hangolását.</span><span class="sxs-lookup"><span data-stu-id="8911f-182">Follow SDK best practices like direct connectivity, and tune client-side query execution options.</span></span> |
| <span data-ttu-id="8911f-183">Hálózati késés</span><span class="sxs-lookup"><span data-stu-id="8911f-183">Network latency</span></span> | <span data-ttu-id="8911f-184">Hálózati terhelés a mérési fiókot, és használja a hello többhelyű API-k tooread legközelebbi régiót.</span><span class="sxs-lookup"><span data-stu-id="8911f-184">Account for network overhead in measurement, and use multi-homing APIs tooread from hello nearest region.</span></span> |
| <span data-ttu-id="8911f-185">Indexelési házirendet</span><span class="sxs-lookup"><span data-stu-id="8911f-185">Indexing Policy</span></span> | <span data-ttu-id="8911f-186">Győződjön meg arról, hogy rendelkezik-e szükséges hello indexelési elérési utak/házirendet hello lekérdezéshez.</span><span class="sxs-lookup"><span data-stu-id="8911f-186">Ensure that you have hello required indexing paths/policy for hello query.</span></span> |
| <span data-ttu-id="8911f-187">Lekérdezés-végrehajtási metrikák</span><span class="sxs-lookup"><span data-stu-id="8911f-187">Query execution metrics</span></span> | <span data-ttu-id="8911f-188">Hello lekérdezés végrehajtási metrikák tooidentify lehetséges újraírások lekérdezés- és alakzatok elemzése.</span><span class="sxs-lookup"><span data-stu-id="8911f-188">Analyze hello query execution metrics tooidentify potential rewrites of query and data shapes.</span></span>  |

### <a name="provisioned-throughput"></a><span data-ttu-id="8911f-189">Kiosztott átviteli kapacitás</span><span class="sxs-lookup"><span data-stu-id="8911f-189">Provisioned throughput</span></span>
<span data-ttu-id="8911f-190">Cosmos DB az adatokat, minden egyes kérelem egységek (RU) másodpercenként kifejezett fenntartott átviteli tárolók hoz létre.</span><span class="sxs-lookup"><span data-stu-id="8911f-190">In Cosmos DB, you create containers of data, each with reserved throughput expressed in request units (RU) per-second.</span></span> <span data-ttu-id="8911f-191">Egy 1 KB-os dokumentum olvasási 1 RU, és minden művelet (beleértve a lekérdezések) összetettsége alapján RUs száma rögzített normalizált tooa.</span><span class="sxs-lookup"><span data-stu-id="8911f-191">A read of a 1-KB document is 1 RU, and every operation (including queries) is normalized tooa fixed number of RUs based on its complexity.</span></span> <span data-ttu-id="8911f-192">Például ha 1000 RU/mp a tároló üzembe, és rendelkezik a lekérdezés például `SELECT * FROM c WHERE c.city = 'Seattle'` , amely feldolgozó 5 RUs, majd végezhet (1000 RU/mp) / (5 RU/lekérdezés) = 200 lekérdezés/s ilyen lekérdezések száma másodpercenként.</span><span class="sxs-lookup"><span data-stu-id="8911f-192">For example, if you have 1000 RU/s provisioned for your container, and you have a query like `SELECT * FROM c WHERE c.city = 'Seattle'` that consumes 5 RUs, then you can perform (1000 RU/s) / (5 RU/query) = 200 query/s such queries per second.</span></span> 

<span data-ttu-id="8911f-193">Ha több mint 200 állapotlekérdezés/mp, hello szolgáltatás elindul, bejövő kérelmek Sebességhatároló 200/mp feletti.</span><span class="sxs-lookup"><span data-stu-id="8911f-193">If you submit more than 200 queries/sec, hello service starts rate-limiting incoming requests above 200/s.</span></span> <span data-ttu-id="8911f-194">SDK-k hello automatikusan kezelik az ebben az esetben egy leállítási újra elvégzésével, ezért bizonyára észrevette, hogy a lekérdezések egy nagyobb késleltetéssel járhat.</span><span class="sxs-lookup"><span data-stu-id="8911f-194">hello SDKs automatically handle this case by performing a backoff/retry, therefore you might notice a higher latency for these queries.</span></span> <span data-ttu-id="8911f-195">Hello kiosztott átviteli sebesség toohello növelése szükséges érték javítja a lekérdezés-késleltetés és a teljesítményt.</span><span class="sxs-lookup"><span data-stu-id="8911f-195">Increasing hello provisioned throughput toohello required value improves your query latency and throughput.</span></span> 

<span data-ttu-id="8911f-196">További információ a kérelemegység, toolearn lásd: [egységek kérelem](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="8911f-196">toolearn more about request units, see [Request units](request-units.md).</span></span>

### <a name="partitioning-and-partition-keys"></a><span data-ttu-id="8911f-197">Particionálás és partíciós kulcsok</span><span class="sxs-lookup"><span data-stu-id="8911f-197">Partitioning and partition keys</span></span>
<span data-ttu-id="8911f-198">Az Azure Cosmos DB általában lekérdezések hajtsa végre a következő sorrendbe leggyorsabb/legtöbb hatékony tooslower/kevésbé hatékony hello.</span><span class="sxs-lookup"><span data-stu-id="8911f-198">With Azure Cosmos DB, typically queries perform in hello following order from fastest/most efficient tooslower/less efficient.</span></span> 

* <span data-ttu-id="8911f-199">Egy olyan partíciót és elem kulcsot az beszerzése</span><span class="sxs-lookup"><span data-stu-id="8911f-199">GET on a single partition key and item key</span></span>
* <span data-ttu-id="8911f-200">Egy szűrési záradékot a egypartíciós kulcs lekérdezése</span><span class="sxs-lookup"><span data-stu-id="8911f-200">Query with a filter clause on a single partition key</span></span>
* <span data-ttu-id="8911f-201">Az egyik tulajdonságnak sem egyenlőség vagy tartomány szűrő záradék nélkül lekérdezése</span><span class="sxs-lookup"><span data-stu-id="8911f-201">Query without an equality or range filter clause on any property</span></span>
* <span data-ttu-id="8911f-202">Lekérdezése nélkül szűrők</span><span class="sxs-lookup"><span data-stu-id="8911f-202">Query without filters</span></span>

<span data-ttu-id="8911f-203">Lekérdezi, hogy szükség tooconsult összes partíció szükséges nagyobb késleltetéssel járhat, és magasabb RUs felhasználhat.</span><span class="sxs-lookup"><span data-stu-id="8911f-203">Queries that need tooconsult all partitions need higher latency, and can consume higher RUs.</span></span> <span data-ttu-id="8911f-204">Mindegyik partíció rendelkezik, az automatikus indexeléshez szemben az összes tulajdonság, mert hello lekérdezés szolgáltatható hatékonyan hello indexből ebben az esetben.</span><span class="sxs-lookup"><span data-stu-id="8911f-204">Since each partition has automatic indexing against all properties, hello query can be served efficiently from hello index in this case.</span></span> <span data-ttu-id="8911f-205">Lekérdezések, amelyek több partíciót gyorsabb hello párhuzamossági beállítások használatával végezheti el.</span><span class="sxs-lookup"><span data-stu-id="8911f-205">You can make queries that span partitions faster by using hello parallelism options.</span></span>

<span data-ttu-id="8911f-206">További információ a particionálás és partíciós kulcsok toolearn lásd [Azure Cosmos DB a particionálás](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="8911f-206">toolearn more about partitioning and partition keys, see [Partitioning in Azure Cosmos DB](partition-data.md).</span></span>

### <a name="sdk-and-query-options"></a><span data-ttu-id="8911f-207">SDK-t és a lekérdezés beállításai</span><span class="sxs-lookup"><span data-stu-id="8911f-207">SDK and query options</span></span>
<span data-ttu-id="8911f-208">Lásd: [teljesítmény tippek](performance-tips.md) és [Teljesítménytesztelés](performance-testing.md) a hogyan tooget hello Azure Cosmos DB legjobb ügyféloldali teljesítményét.</span><span class="sxs-lookup"><span data-stu-id="8911f-208">See [Performance Tips](performance-tips.md) and [Performance testing](performance-testing.md) for how tooget hello best client-side performance from Azure Cosmos DB.</span></span> <span data-ttu-id="8911f-209">Ez magában foglalja, használja legújabb SDK, alapértelmezett kapcsolatok száma, gyakoriságát szemétgyűjtés, például a platform-specifikus konfigurációk konfigurálásával és használatával egyszerűsített kapcsolati lehetőségek például közvetlen/TCP hello.</span><span class="sxs-lookup"><span data-stu-id="8911f-209">This includes using hello latest SDKs, configuring platform-specific configurations like default number of connections, frequency of garbage collection, and using lightweight connectivity options like Direct/TCP.</span></span> 


#### <a name="max-item-count"></a><span data-ttu-id="8911f-210">Elemek maximális száma</span><span class="sxs-lookup"><span data-stu-id="8911f-210">Max Item Count</span></span>
<span data-ttu-id="8911f-211">A lekérdezések, hello értékének `MaxItemCount` jelentős hatással lehet a végpont lekérdezés idejét.</span><span class="sxs-lookup"><span data-stu-id="8911f-211">For queries, hello value of `MaxItemCount` can have a significant impact on end-to-end query time.</span></span> <span data-ttu-id="8911f-212">Minden egyes üzenetváltási toohello server hello elemszáma nagyobb visszaadható `MaxItemCount` (100 elemek alapértelmezett).</span><span class="sxs-lookup"><span data-stu-id="8911f-212">Each round trip toohello server will return no more than hello number of items in `MaxItemCount` (Default of 100 items).</span></span> <span data-ttu-id="8911f-213">Tooa magasabb érték (-1 érték legnagyobb, és az ajánlott) javítja a lekérdezés teljes időtartam korlátozásával hello kiszolgáló és az ügyfél, különösen a lekérdezések nagy eredményhalmazt közötti adatváltások számát.</span><span class="sxs-lookup"><span data-stu-id="8911f-213">Setting this tooa higher value (-1 is maximum, and recommended) will improve your query duration overall by limiting hello number of round trips between server and client, especially for queries with large result sets.</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxItemCount = -1, 
    }).AsDocumentQuery();
```

#### <a name="max-degree-of-parallelism"></a><span data-ttu-id="8911f-214">Párhuzamossági maximális fok</span><span class="sxs-lookup"><span data-stu-id="8911f-214">Max Degree of Parallelism</span></span>
<span data-ttu-id="8911f-215">A lekérdezések, hangolja hello `MaxDegreeOfParallelism` tooidentify hello bevált konfigurációkat az alkalmazáshoz, különösen akkor, ha Ön lekérdezésére kereszt-partíció (nélkül egy szűrőt a hello partíciókulcs érték).</span><span class="sxs-lookup"><span data-stu-id="8911f-215">For queries, tune hello `MaxDegreeOfParallelism` tooidentify hello best configurations for your application, especially if you perform cross-partition queries (without a filter on hello partition-key value).</span></span> <span data-ttu-id="8911f-216">`MaxDegreeOfParallelism`hello feladatok maximális száma párhuzamos, azaz hello legfeljebb párhuzamosan meglátogatott partíciók toobe szabályozza.</span><span class="sxs-lookup"><span data-stu-id="8911f-216">`MaxDegreeOfParallelism`  controls hello maximum number of parallel tasks, i.e., hello maximum of partitions toobe visited in parallel.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();
```

<span data-ttu-id="8911f-217">Tegyük fel, amelyek</span><span class="sxs-lookup"><span data-stu-id="8911f-217">Let’s assume that</span></span>
* <span data-ttu-id="8911f-218">D = alapértelmezett maximális száma párhuzamos tevékenységek (= hello ügyfélszámítógépen. a processzor teljes száma)</span><span class="sxs-lookup"><span data-stu-id="8911f-218">D = Default Maximum number of parallel tasks (= total number of processor in hello client machine)</span></span>
* <span data-ttu-id="8911f-219">P = párhuzamos tevékenységek maximális száma a felhasználó által megadott</span><span class="sxs-lookup"><span data-stu-id="8911f-219">P = User-specified maximum number of parallel tasks</span></span>
* <span data-ttu-id="8911f-220">N =, amelyet a meglátogatott toobe lekérdezést a partíciók száma</span><span class="sxs-lookup"><span data-stu-id="8911f-220">N = Number of partitions that needs  toobe visited for answering a query</span></span>

<span data-ttu-id="8911f-221">Az alábbiakban hogyan hello párhuzamos lekérdezések viselkednek a p különböző értékeket következményei</span><span class="sxs-lookup"><span data-stu-id="8911f-221">Following are implications of how hello parallel queries would behave for different values of P.</span></span>
* <span data-ttu-id="8911f-222">(P == 0) = > soros üzemmód</span><span class="sxs-lookup"><span data-stu-id="8911f-222">(P == 0) => Serial Mode</span></span>
* <span data-ttu-id="8911f-223">(P == 1) = > maximális egy feladat</span><span class="sxs-lookup"><span data-stu-id="8911f-223">(P == 1) => Maximum of one task</span></span>
* <span data-ttu-id="8911f-224">(P > 1) = > Min (P, N) párhuzamos tevékenységek</span><span class="sxs-lookup"><span data-stu-id="8911f-224">(P > 1) => Min (P, N) parallel tasks</span></span> 
* <span data-ttu-id="8911f-225">(P < 1) = > Min (N, D) párhuzamos tevékenységek</span><span class="sxs-lookup"><span data-stu-id="8911f-225">(P < 1) => Min (N, D) parallel tasks</span></span>

<span data-ttu-id="8911f-226">Az SDK kibocsátási megjegyzéseket, és a részletek megvalósított osztályokat és metódusokat: [DocumentDB SDK-k](documentdb-sdk-dotnet.md)</span><span class="sxs-lookup"><span data-stu-id="8911f-226">For SDK release notes, and details on implemented classes and methods see [DocumentDB SDKs](documentdb-sdk-dotnet.md)</span></span>

### <a name="network-latency"></a><span data-ttu-id="8911f-227">Hálózati késés</span><span class="sxs-lookup"><span data-stu-id="8911f-227">Network latency</span></span>
<span data-ttu-id="8911f-228">Lásd: [Azure Cosmos DB globális terjesztési](tutorial-global-distribution-documentdb.md) hogyan tooset akár globális terjesztési, és csatlakozzon toohello legközelebbi régiót.</span><span class="sxs-lookup"><span data-stu-id="8911f-228">See [Azure Cosmos DB global distribution](tutorial-global-distribution-documentdb.md) for how tooset up global distribution, and connect toohello closest region.</span></span> <span data-ttu-id="8911f-229">Hálózati késés jelentős hatással van a lekérdezési teljesítmény kell toomake kiszolgálóval végzett több adatváltásra vagy egy nagy eredményhalmazt hello lekérdezésből beolvasása.</span><span class="sxs-lookup"><span data-stu-id="8911f-229">Network latency has a significant impact on query performance when you need toomake multiple round-trips or retrieve a large result set from hello query.</span></span> 

<span data-ttu-id="8911f-230">hello lekérdezés végrehajtási mérőszámokat szakasz azt ismerteti, hogyan tooretrieve hello lekérdezések server végrehajtási idő ( `totalExecutionTimeInMs`), így meg tudja különböztetni a lekérdezés-végrehajtás töltött időt és az idő a hálózati átvitel során.</span><span class="sxs-lookup"><span data-stu-id="8911f-230">hello section on query execution metrics explains how tooretrieve hello server execution time of queries ( `totalExecutionTimeInMs`), so that you can differentiate between time spent in query execution and time spent in network transit.</span></span>

### <a name="indexing-policy"></a><span data-ttu-id="8911f-231">Indexelési házirendet</span><span class="sxs-lookup"><span data-stu-id="8911f-231">Indexing policy</span></span>
<span data-ttu-id="8911f-232">Lásd: [konfigurálása az indexelési házirendet](indexing-policies.md) indexeléshez elérési utak, különböző, és módok és milyen hatással lesznek a lekérdezés végrehajtása.</span><span class="sxs-lookup"><span data-stu-id="8911f-232">See [Configuring indexing policy](indexing-policies.md) for indexing paths, kinds, and modes, and how they impact query execution.</span></span> <span data-ttu-id="8911f-233">Alapértelmezés szerint házirend indexelő hello használja kivonatoló indexelő karakterláncok, amelyek a következő időponttól érvényes egyenlőség lekérdezések, de nem lekérdezések tartomány rendelés lekérdezések.</span><span class="sxs-lookup"><span data-stu-id="8911f-233">By default, hello indexing policy uses Hash indexing for strings, which is effective for equality queries, but not for range queries/order by queries.</span></span> <span data-ttu-id="8911f-234">Ha lekérdezések karakterláncok, ajánlott hello index Tartománytípus az összes karakterlánc megadása.</span><span class="sxs-lookup"><span data-stu-id="8911f-234">If you need range queries for strings, we recommend specifying hello Range index type for all strings.</span></span> 

## <a name="query-execution-metrics"></a><span data-ttu-id="8911f-235">Lekérdezés-végrehajtási metrikák</span><span class="sxs-lookup"><span data-stu-id="8911f-235">Query execution metrics</span></span>
<span data-ttu-id="8911f-236">A lekérdezés-végrehajtás részletes metrikák szerezheti be a választható hello sikeres `x-ms-documentdb-populatequerymetrics` fejléc (`FeedOptions.PopulateQueryMetrics` a hello .NET SDK-val).</span><span class="sxs-lookup"><span data-stu-id="8911f-236">You can obtain detailed metrics on query execution by passing in hello optional `x-ms-documentdb-populatequerymetrics` header (`FeedOptions.PopulateQueryMetrics` in hello .NET SDK).</span></span> <span data-ttu-id="8911f-237">a visszaadott érték hello `x-ms-documentdb-query-metrics` kulcs-érték párok azt jelentette, hogy a speciális lekérdezés-végrehajtás hibaelhárításához a következő hello rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="8911f-237">hello value returned in `x-ms-documentdb-query-metrics` has hello following key-value pairs meant for advanced troubleshooting of query execution.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();

// Returns metrics by partition key range Id
IReadOnlyDictionary<string, QueryMetrics> metrics = result.QueryMetrics;

```

| <span data-ttu-id="8911f-238">Metrika</span><span class="sxs-lookup"><span data-stu-id="8911f-238">Metric</span></span> | <span data-ttu-id="8911f-239">Unit (Egység)</span><span class="sxs-lookup"><span data-stu-id="8911f-239">Unit</span></span> | <span data-ttu-id="8911f-240">Leírás</span><span class="sxs-lookup"><span data-stu-id="8911f-240">Description</span></span> | 
| ------ | -----| ----------- |
| `totalExecutionTimeInMs` | <span data-ttu-id="8911f-241">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-241">milliseconds</span></span> | <span data-ttu-id="8911f-242">Lekérdezés-végrehajtási idő</span><span class="sxs-lookup"><span data-stu-id="8911f-242">Query execution time</span></span> | 
| `queryCompileTimeInMs` | <span data-ttu-id="8911f-243">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-243">milliseconds</span></span> | <span data-ttu-id="8911f-244">Lekérdezés fordítás során</span><span class="sxs-lookup"><span data-stu-id="8911f-244">Query compile time</span></span>  | 
| `queryLogicalPlanBuildTimeInMs` | <span data-ttu-id="8911f-245">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-245">milliseconds</span></span> | <span data-ttu-id="8911f-246">Idő toobuild logikai lekérdezésterv</span><span class="sxs-lookup"><span data-stu-id="8911f-246">Time toobuild logical query plan</span></span> | 
| `queryPhysicalPlanBuildTimeInMs` | <span data-ttu-id="8911f-247">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-247">milliseconds</span></span> | <span data-ttu-id="8911f-248">Idő toobuild fizikai lekérdezésterv</span><span class="sxs-lookup"><span data-stu-id="8911f-248">Time toobuild physical query plan</span></span> | 
| `queryOptimizationTimeInMs` | <span data-ttu-id="8911f-249">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-249">milliseconds</span></span> | <span data-ttu-id="8911f-250">A lekérdezés optimalizálása töltött idő</span><span class="sxs-lookup"><span data-stu-id="8911f-250">Time spent in optimizing query</span></span> | 
| `VMExecutionTimeInMs` | <span data-ttu-id="8911f-251">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-251">milliseconds</span></span> | <span data-ttu-id="8911f-252">Idő a lekérdezés futásidejű</span><span class="sxs-lookup"><span data-stu-id="8911f-252">Time spent in query runtime</span></span> | 
| `indexLookupTimeInMs` | <span data-ttu-id="8911f-253">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-253">milliseconds</span></span> | <span data-ttu-id="8911f-254">Idő a fizikai index réteg</span><span class="sxs-lookup"><span data-stu-id="8911f-254">Time spent in physical index layer</span></span> | 
| `documentLoadTimeInMs` | <span data-ttu-id="8911f-255">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-255">milliseconds</span></span> | <span data-ttu-id="8911f-256">Idő a dokumentum betöltése</span><span class="sxs-lookup"><span data-stu-id="8911f-256">Time spent in loading documents</span></span>  | 
| `systemFunctionExecuteTimeInMs` | <span data-ttu-id="8911f-257">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-257">milliseconds</span></span> | <span data-ttu-id="8911f-258">A fordított teljes idő végrehajtás alatt álló rendszer (beépített) funkciók ezredmásodpercben</span><span class="sxs-lookup"><span data-stu-id="8911f-258">Total time spent executing system (built-in) functions in milliseconds</span></span>  | 
| `userFunctionExecuteTimeInMs` | <span data-ttu-id="8911f-259">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-259">milliseconds</span></span> | <span data-ttu-id="8911f-260">Töltött teljes idő, ezredmásodpercben végrehajtó felhasználó által definiált függvények</span><span class="sxs-lookup"><span data-stu-id="8911f-260">Total time spent executing user-defined functions in milliseconds</span></span> | 
| `retrievedDocumentCount` | <span data-ttu-id="8911f-261">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-261">milliseconds</span></span> | <span data-ttu-id="8911f-262">Lekért dokumentumok száma összesen</span><span class="sxs-lookup"><span data-stu-id="8911f-262">Total number of retrieved documents</span></span>  | 
| `retrievedDocumentSize` | <span data-ttu-id="8911f-263">Bájtok</span><span class="sxs-lookup"><span data-stu-id="8911f-263">bytes</span></span> | <span data-ttu-id="8911f-264">A beolvasott dokumentumokat a bájtok teljes mérete</span><span class="sxs-lookup"><span data-stu-id="8911f-264">Total size of retrieved documents in bytes</span></span>  | 
| `outputDocumentCount` | <span data-ttu-id="8911f-265">Száma</span><span class="sxs-lookup"><span data-stu-id="8911f-265">count</span></span> | <span data-ttu-id="8911f-266">Kimeneti dokumentumok száma</span><span class="sxs-lookup"><span data-stu-id="8911f-266">Number of output documents</span></span> | 
| `writeOutputTimeInMs` | <span data-ttu-id="8911f-267">ezredmásodperc</span><span class="sxs-lookup"><span data-stu-id="8911f-267">milliseconds</span></span> | <span data-ttu-id="8911f-268">Lekérdezés-végrehajtási idő ezredmásodpercben</span><span class="sxs-lookup"><span data-stu-id="8911f-268">Query execution time in milliseconds</span></span> | 
| `indexUtilizationRatio` | <span data-ttu-id="8911f-269">arány (< = 1)</span><span class="sxs-lookup"><span data-stu-id="8911f-269">ratio (<=1)</span></span> | <span data-ttu-id="8911f-270">Hello szűrő toohello betöltött dokumentumok száma egyező dokumentumok száma aránya</span><span class="sxs-lookup"><span data-stu-id="8911f-270">Ratio of number of documents matched by hello filter toohello number of documents loaded</span></span>  | 

<span data-ttu-id="8911f-271">hello ügyfél SDK-k belső tehet több lekérdezés műveletek tooserve hello lekérdezés minden partíción belül.</span><span class="sxs-lookup"><span data-stu-id="8911f-271">hello client SDKs may internally make multiple query operations tooserve hello query within each partition.</span></span> <span data-ttu-id="8911f-272">hello ügyfél hívást egynél több partíciónkénti Ha hello teljes eredmények ennél nagyobb `x-ms-max-item-count`, ha hello lekérdezés meghaladja hello kiosztott átviteli sebesség hello partíció, vagy ha hello lekérdezés hasznos eléri-e a hello maximális mérete egy oldalon, vagy ha hello lekérdezés eléri-e a hello a rendszer lefoglalt időkorlátja.</span><span class="sxs-lookup"><span data-stu-id="8911f-272">hello client makes more than one call per-partition if hello total results exceed `x-ms-max-item-count`, if hello query exceeds hello provisioned throughput for hello partition, or if hello query payload reaches hello maximum size per page, or if hello query reaches hello system allocated timeout limit.</span></span> <span data-ttu-id="8911f-273">Minden egyes részleges lekérdezés-végrehajtás adja vissza egy `x-ms-documentdb-query-metrics` lap.</span><span class="sxs-lookup"><span data-stu-id="8911f-273">Each partial query execution returns a `x-ms-documentdb-query-metrics` for that page.</span></span> 

<span data-ttu-id="8911f-274">Az alábbiakban néhány mintalekérdezések, és hogyan toointerpret néhány hello metrikák adott vissza a lekérdezés-végrehajtás:</span><span class="sxs-lookup"><span data-stu-id="8911f-274">Here are some sample queries, and how toointerpret some of hello metrics returned from query execution:</span></span> 

| <span data-ttu-id="8911f-275">Lekérdezés</span><span class="sxs-lookup"><span data-stu-id="8911f-275">Query</span></span> | <span data-ttu-id="8911f-276">A minta-metrika</span><span class="sxs-lookup"><span data-stu-id="8911f-276">Sample Metric</span></span> | <span data-ttu-id="8911f-277">Leírás</span><span class="sxs-lookup"><span data-stu-id="8911f-277">Description</span></span> | 
| ------ | -----| ----------- |
| `SELECT TOP 100 * FROM c` | `"RetrievedDocumentCount": 101` | <span data-ttu-id="8911f-278">hello száma beolvasott dokumentumokat: 100 + 1 toomatch hello TOP záradék.</span><span class="sxs-lookup"><span data-stu-id="8911f-278">hello number of documents retrieved is 100+1 toomatch hello TOP clause.</span></span> <span data-ttu-id="8911f-279">Lekérdezési idő többnyire töltött `WriteOutputTime` és `DocumentLoadTime` mivel ez a vizsgálat.</span><span class="sxs-lookup"><span data-stu-id="8911f-279">Query time is mostly spent in `WriteOutputTime` and `DocumentLoadTime` since it is a scan.</span></span> | 
| `SELECT TOP 500 * FROM c` | `"RetrievedDocumentCount": 501` | <span data-ttu-id="8911f-280">RetrievedDocumentCount már nagyobb (500 + 1 toomatch hello TOP záradék).</span><span class="sxs-lookup"><span data-stu-id="8911f-280">RetrievedDocumentCount is now higher (500+1 toomatch hello TOP clause).</span></span> | 
| `SELECT * FROM c WHERE c.N = 55` | `"IndexLookupTime": "00:00:00.0009500"` | <span data-ttu-id="8911f-281">Hamarosan 0.9 ms van töltött IndexLookupTime kulcs kereséshez, mert az index keresési `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="8911f-281">About 0.9 ms is spent in IndexLookupTime for a key lookup, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT * FROM c WHERE c.N > 55` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="8911f-282">Valamivel több (1.7 ms) töltött idő IndexLookupTime keresztül tartomány vizsgálatot, mivel az index keresési `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="8911f-282">Slightly more time (1.7 ms) spent in IndexLookupTime over a range scan, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT TOP 500 c.N FROM c` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="8911f-283">A fordított egyszerre `DocumentLoadTime` előző lekérdezésekhez, de kisebb `WriteOutputTime` , mert azt még kivetítéséről csak egy tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="8911f-283">Same time spent on `DocumentLoadTime` as previous queries, but lower `WriteOutputTime` because we're projecting only one property.</span></span> | 
| `SELECT TOP 500 udf.toPercent(c.N) FROM c` | `"UserDefinedFunctionExecutionTime": "00:00:00.2136500"` | <span data-ttu-id="8911f-284">Hamarosan 213 ms töltött `UserDefinedFunctionExecutionTime` UDF végrehajtása hello minden értékének a `c.N`.</span><span class="sxs-lookup"><span data-stu-id="8911f-284">About 213 ms is spent in `UserDefinedFunctionExecutionTime` executing hello UDF on each value of `c.N`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(c.Name, 'Den')` | `"IndexLookupTime": "00:00:00.0006400", "SystemFunctionExecutionTime": "00:00:00.0074100"` | <span data-ttu-id="8911f-285">Hamarosan 0,6 ms töltött `IndexLookupTime` a `/Name/?`.</span><span class="sxs-lookup"><span data-stu-id="8911f-285">About 0.6 ms is spent in `IndexLookupTime` on `/Name/?`.</span></span> <span data-ttu-id="8911f-286">A legtöbb hello lekérdezés végrehajtási idő (ms ~ 7) a `SystemFunctionExecutionTime`.</span><span class="sxs-lookup"><span data-stu-id="8911f-286">Most of hello query execution time (~7 ms) in `SystemFunctionExecutionTime`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(LOWER(c.Name), 'den')` | `"IndexLookupTime": "00:00:00", "RetrievedDocumentCount": 2491,  "OutputDocumentCount": 500` | <span data-ttu-id="8911f-287">Lekérdezést végrehajtja a rendszer egy vizsgálatot, mivel a program `LOWER`, és 500 2491 lekérdezése dokumentumból ad vissza.</span><span class="sxs-lookup"><span data-stu-id="8911f-287">Query is performed as a scan because it uses `LOWER`, and 500 out of 2491 retrieved documents are returned.</span></span> |


## <a name="next-steps"></a><span data-ttu-id="8911f-288">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="8911f-288">Next steps</span></span>
* <span data-ttu-id="8911f-289">toolearn hello támogatott SQL lekérdezési operátorok és a kulcsszavakat, lásd: [SQL-lekérdezés](documentdb-sql-query.md).</span><span class="sxs-lookup"><span data-stu-id="8911f-289">toolearn about hello supported SQL query operators and keywords, see [SQL query](documentdb-sql-query.md).</span></span> 
* <span data-ttu-id="8911f-290">toolearn kapcsolatos, lásd: [egységek kérelem](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="8911f-290">toolearn about request units, see [request units](request-units.md).</span></span>
* <span data-ttu-id="8911f-291">toolearn indexelési házirendet kapcsolatban lásd: [indexelő házirend](indexing-policies.md)</span><span class="sxs-lookup"><span data-stu-id="8911f-291">toolearn about indexing policy, see [indexing policy](indexing-policies.md)</span></span> 


