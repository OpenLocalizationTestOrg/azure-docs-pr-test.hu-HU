---
title: "Az Azure Cosmos DB tűzfaltámogatás & IP hozzáférés-vezérlés |} Microsoft Docs"
description: "Megtudhatja, hogyan IP hozzáférés-vezérlési házirendeket tűzfal támogatásához az Azure Cosmos DB adatbázis fiókot használjon."
keywords: "IP-hozzáférés-vezérlés, tűzfaltámogatás"
services: cosmos-db
author: shahankur11
manager: jhubbard
editor: 
tags: azure-resource-manager
documentationcenter: 
ms.assetid: c1b9ede0-ed93-411a-ac9a-62c113a8e887
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/22/2017
ms.author: ankshah
ms.openlocfilehash: e08c0ba9c1fc0bab72ae8c1158aafaad4f66920e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="azure-cosmos-db-firewall-support"></a><span data-ttu-id="9b768-104">Az Azure Cosmos DB-tűzfaltámogatás</span><span class="sxs-lookup"><span data-stu-id="9b768-104">Azure Cosmos DB firewall support</span></span>
<span data-ttu-id="9b768-105">Egy Azure Cosmos-adatbázis adatbázis-fiókban tárolt adatok védelme érdekében Azure Cosmos DB nyújtott támogatás a titkos kulcs alapú [engedélyezési modellt](https://msdn.microsoft.com/library/azure/dn783368.aspx) , amely erős kivonat-alapú üzenethitelesítő kódot (HMAC) használja.</span><span class="sxs-lookup"><span data-stu-id="9b768-105">To secure data stored in an Azure Cosmos DB database account, Azure Cosmos DB has provided support for a secret based [authorization model](https://msdn.microsoft.com/library/azure/dn783368.aspx) that utilizes a strong Hash-based message authentication code (HMAC).</span></span> <span data-ttu-id="9b768-106">Most a titkos alapú engedélyezési modell mellett Azure Cosmos DB bejövő tűzfaltámogatás IP-alapú hozzáférés-vezérléssel vezérelt házirend támogatja.</span><span class="sxs-lookup"><span data-stu-id="9b768-106">Now, in addition to the secret based authorization model, Azure Cosmos DB supports policy driven IP-based access controls for inbound firewall support.</span></span> <span data-ttu-id="9b768-107">Ez a modell nagyon hasonlít a tűzfalszabályokat az adatbázisok hagyományos rendszert, és egy további Azure Cosmos DB adatbázis fiókhoz biztonsági szintet.</span><span class="sxs-lookup"><span data-stu-id="9b768-107">This model is very similar to the firewall rules of a traditional database system and provides an additional level of security to the Azure Cosmos DB database account.</span></span> <span data-ttu-id="9b768-108">Ez a modell segítségével mostantól beállíthatja egy Azure Cosmos DB adatbázisfiók csak egy jóváhagyott gépek halmazát jelenti érhetők el, illetve a felhőalapú szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="9b768-108">With this model, you can now configure an Azure Cosmos DB database account to be accessible only from an approved set of machines and/or cloud services.</span></span> <span data-ttu-id="9b768-109">A jóváhagyott halmazok gépek és szolgáltatások Azure Cosmos DB erőforrásokhoz való hozzáférés továbbra is szükség van egy érvényes hitelesítési jogkivonatot a hívó.</span><span class="sxs-lookup"><span data-stu-id="9b768-109">Access to Azure Cosmos DB resources from these approved sets of machines and services still require the caller to present a valid authorization token.</span></span>

## <a name="ip-access-control-overview"></a><span data-ttu-id="9b768-110">IP hozzáférés-vezérlés áttekintése</span><span class="sxs-lookup"><span data-stu-id="9b768-110">IP access control overview</span></span>
<span data-ttu-id="9b768-111">Alapértelmezés szerint egy Azure Cosmos DB adatbázisfiók érhető el nyilvános internetről mindaddig, amíg a kérelem egy érvényes engedélyezési jogkivonat együtt.</span><span class="sxs-lookup"><span data-stu-id="9b768-111">By default, an Azure Cosmos DB database account is accessible from public internet as long as the request is accompanied by a valid authorization token.</span></span> <span data-ttu-id="9b768-112">IP-csoportházirend-alapú hozzáférés-vezérlés konfigurálása, a felhasználónak meg kell adnia az IP-címek vagy IP-címtartományt a CIDR formátumban része, mint az engedélyezett bővítmények listájához ügyfél IP-címek egy adott adatbázis fiókjához tartozó készletét.</span><span class="sxs-lookup"><span data-stu-id="9b768-112">To configure IP policy-based access control, the user must provide the set of IP addresses or IP address ranges in CIDR form to be included as the allowed list of client IPs for a given database account.</span></span> <span data-ttu-id="9b768-113">Ha ez a konfiguráció van érvényben, kívül az engedélyezett bővítmények listájához készülékekről származó összes kérelem le lesz tiltva a kiszolgáló.</span><span class="sxs-lookup"><span data-stu-id="9b768-113">Once this configuration is applied, all requests originating from machines outside this allowed list will be blocked by the server.</span></span>  <span data-ttu-id="9b768-114">A kapcsolat feldolgozása a IP-alapú hozzáférés-vezérlés folyamata a következő ábra ismerteti.</span><span class="sxs-lookup"><span data-stu-id="9b768-114">The connection processing flow for the IP-based access control is described in the following diagram.</span></span>

![IP-alapú hozzáférés-vezérlés folyamata bemutató ábra](./media/firewall-support/firewall-support-flow.png)

## <a name="connections-from-cloud-services"></a><span data-ttu-id="9b768-116">Felhőszolgáltatások közötti kapcsolatok</span><span class="sxs-lookup"><span data-stu-id="9b768-116">Connections from cloud services</span></span>
<span data-ttu-id="9b768-117">Az Azure felhőszolgáltatások, amelyek egy nagyon gyakori középső réteg szolgáltatás logika Azure Cosmos DB használatával üzemeltetéséhez.</span><span class="sxs-lookup"><span data-stu-id="9b768-117">In Azure, cloud services are a very common way for hosting middle tier service logic using Azure Cosmos DB.</span></span> <span data-ttu-id="9b768-118">Hozzáférés engedélyezése egy Azure Cosmos-adatbázis adatbázis-fiókhoz az egy felhőszolgáltatás, a felhőalapú szolgáltatás nyilvános IP-címe hozzá kell adni az engedélyezettek listájához, az IP-címek az Azure Cosmos DB adatbázisfiók által társított [az IP-hozzáférés konfigurálása Szabályozza a házirend](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="9b768-118">To enable access to an Azure Cosmos DB database account from a cloud service, the public IP address of the cloud service must be added to the allowed list of IP addresses associated with your Azure Cosmos DB database account by [configuring the IP access control policy](#configure-ip-policy).</span></span>  <span data-ttu-id="9b768-119">Ez biztosítja, hogy a felhőalapú szolgáltatások minden szerepkör példányát az Azure Cosmos DB adatbázisfiók hozzáféréssel rendelkeznek.</span><span class="sxs-lookup"><span data-stu-id="9b768-119">This ensures that all role instances of cloud services have access to your Azure Cosmos DB database account.</span></span> <span data-ttu-id="9b768-120">IP-címek kérheti le az Azure-portálon a felhőszolgáltatások, az alábbi képernyőfelvételen látható módon.</span><span class="sxs-lookup"><span data-stu-id="9b768-120">You can retrieve IP addresses for your cloud services in the Azure portal, as shown in the following screenshot.</span></span>

![Képernyőfelvétel: a nyilvános IP-cím egy felhőalapú szolgáltatás, az Azure-portálon jelenik meg](./media/firewall-support/public-ip-addresses.png)

<span data-ttu-id="9b768-122">A horizontális a felhőszolgáltatás további szerepkör-példányokat, hozzáadásával, ha új logikailemez automatikusan hozzáférhetnek az Azure Cosmos DB adatbázisfiók óta az ugyanazon a felhőalapú szolgáltatás részét képezik.</span><span class="sxs-lookup"><span data-stu-id="9b768-122">When you scale out your cloud service by adding additional role instance(s), those new instances will automatically have access to the Azure Cosmos DB database account since they are part of the same cloud service.</span></span>

## <a name="connections-from-virtual-machines"></a><span data-ttu-id="9b768-123">Virtuális gépek közötti kapcsolatok</span><span class="sxs-lookup"><span data-stu-id="9b768-123">Connections from virtual machines</span></span>
<span data-ttu-id="9b768-124">[Virtuális gépek](https://azure.microsoft.com/services/virtual-machines/) vagy [virtuálisgép-méretezési csoportok](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) is használható Azure Cosmos DB használatával középső réteg szolgáltatások futtatásához.</span><span class="sxs-lookup"><span data-stu-id="9b768-124">[Virtual machines](https://azure.microsoft.com/services/virtual-machines/) or [virtual machine scale sets](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) can also be used to host middle tier services using Azure Cosmos DB.</span></span>  <span data-ttu-id="9b768-125">Az Azure Cosmos DB adatbázis fiókot, hogy a hozzáférést a virtuális gépek, a virtuális gép és/vagy a virtuális gép nyilvános IP-címek konfigurálása méretezési be kell állítani az engedélyezett IP-címek az Azure Cosmos DB adatbázis fiókjához tartozó egyik által[IP hozzáférés-vezérlési házirend beállítása](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="9b768-125">To configure the Azure Cosmos DB database account to allow access from virtual machines, public IP addresses of virtual machine and/or virtual machine scale set must be configured as one of the allowed IP addresses for your Azure Cosmos DB database account by [configuring the IP access control policy](#configure-ip-policy).</span></span> <span data-ttu-id="9b768-126">Az Azure portálon, a virtuális gépek IP-címet az alábbi képernyőfelvételen látható módon kérheti le.</span><span class="sxs-lookup"><span data-stu-id="9b768-126">You can retrieve IP addresses for virtual machines in the Azure portal, as shown in the following screenshot.</span></span>

![Képernyőfelvétel egy nyilvános IP-címet a virtuális gép az Azure-portálon jelenik meg](./media/firewall-support/public-ip-addresses-dns.png)

<span data-ttu-id="9b768-128">Ha további virtuálisgép-példányok felvétele a csoportba, azok automatikusan kapnak hozzáférést az Azure Cosmos DB adatbázisfiók.</span><span class="sxs-lookup"><span data-stu-id="9b768-128">When you add additional virtual machine instances to the group, they are automatically provided access to your Azure Cosmos DB database account.</span></span>

## <a name="connections-from-the-internet"></a><span data-ttu-id="9b768-129">Az internetről érkező kapcsolatokat</span><span class="sxs-lookup"><span data-stu-id="9b768-129">Connections from the internet</span></span>
<span data-ttu-id="9b768-130">Amikor egy Azure Cosmos DB adatbázisfiók fér hozzá egy számítógépről az interneten, az ügyfél IP-cím vagy IP-címtartomány a gép hozzá kell adni az Azure Cosmos DB adatbázis fiókjához tartozó IP-cím az engedélyezett bővítmények listájához.</span><span class="sxs-lookup"><span data-stu-id="9b768-130">When you access an Azure Cosmos DB database account from a computer on the internet, the client IP address or IP address range of the machine must be added to the allowed list of IP address for the Azure Cosmos DB database account.</span></span> 

## <span data-ttu-id="9b768-131"><a id="configure-ip-policy"></a>Az IP-hozzáférés-vezérlési házirend beállítása</span><span class="sxs-lookup"><span data-stu-id="9b768-131"><a id="configure-ip-policy"></a> Configuring the IP access control policy</span></span>
<span data-ttu-id="9b768-132">Az IP-hozzáférés-vezérlési szabályzat állítható be az Azure portálon vagy programozottan a [Azure CLI](cli-samples.md), [Azure Powershell](powershell-samples.md), vagy a [REST API](/rest/api/documentdb/) a frissítésével`ipRangeFilter`tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="9b768-132">The IP access control policy can be set in the Azure portal, or programmatically through [Azure CLI](cli-samples.md), [Azure Powershell](powershell-samples.md), or the [REST API](/rest/api/documentdb/) by updating the `ipRangeFilter` property.</span></span> <span data-ttu-id="9b768-133">IP-címeken/tartományokon vesszővel elválasztott, és nem tartalmazhat szóközt kell lennie.</span><span class="sxs-lookup"><span data-stu-id="9b768-133">IP addresses/ranges must be comma separated and must not contain any spaces.</span></span> <span data-ttu-id="9b768-134">Példa: "13.91.6.132,13.91.6.1/24".</span><span class="sxs-lookup"><span data-stu-id="9b768-134">Example: "13.91.6.132,13.91.6.1/24".</span></span> <span data-ttu-id="9b768-135">Amikor ezek a módszerek használatával az adatbázisfiók frissítése, ügyeljen arra, hogy a tulajdonságokat, hogy megakadályozza a rendszer visszaállítja az alapértelmezett beállításokat az feltöltéséhez.</span><span class="sxs-lookup"><span data-stu-id="9b768-135">When updating your database account through these methods, be sure to populate all of the properties to prevent resetting to default settings.</span></span>

> [!NOTE]
> <span data-ttu-id="9b768-136">Azáltal, hogy IP hozzáférés-vezérlési szabályzatok Azure Cosmos DB adatbázis fiókjához, minden Azure Cosmos DB adatbázis fiókja gépekről kívül a beállított elérését az IP-címtartományok listájának le vannak tiltva.</span><span class="sxs-lookup"><span data-stu-id="9b768-136">By enabling an IP access control policy for your Azure Cosmos DB database account, all access to your Azure Cosmos DB database account from machines outside the configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="9b768-137">Ez a modell alapján keresse meg az vezérlősík művelet a portálról is blokkolja a hozzáférés-vezérlés sértetlenségének biztosítása érdekében.</span><span class="sxs-lookup"><span data-stu-id="9b768-137">By virtue of this model, browsing the data plane operation from the portal will also be blocked to ensure the integrity of access control.</span></span>

<span data-ttu-id="9b768-138">Egyszerűbbé teheti a fejlesztési, az Azure-portálon segítségével azonosítsa és adja meg az IP-címe az ügyfélszámítógép az engedélyezettek listájához, hogy a gépen futó alkalmazások hozzáférhessenek az Azure Cosmos DB fiók.</span><span class="sxs-lookup"><span data-stu-id="9b768-138">To simplify development, the Azure portal helps you identify and add the IP of your client machine to the allowed list, so that apps running your machine can access the Azure Cosmos DB account.</span></span> <span data-ttu-id="9b768-139">Ügyeljen arra, hogy az ügyfél IP-cím szerinti a portál észleli-e.</span><span class="sxs-lookup"><span data-stu-id="9b768-139">Note that the client IP address here is detected as seen by the portal.</span></span> <span data-ttu-id="9b768-140">Elképzelhető, hogy az ügyfél IP-cím a gép, de az is lehet a hálózati átjáró IP-címét.</span><span class="sxs-lookup"><span data-stu-id="9b768-140">It may be the client IP address of your machine, but it could also be the IP address of your network gateway.</span></span> <span data-ttu-id="9b768-141">Ne feledje éles előtt távolítsa el.</span><span class="sxs-lookup"><span data-stu-id="9b768-141">Do not forget to remove it before going to production.</span></span>

<span data-ttu-id="9b768-142">Az IP-hozzáférés-vezérlési házirend beállítása az Azure portálon, keresse meg a Azure Cosmos DB-fiók panelen, kattintson a **tűzfal** a navigációs menü, majd kattintson a **ON**</span><span class="sxs-lookup"><span data-stu-id="9b768-142">To set the IP access control policy in the Azure portal, navigate to the Azure Cosmos DB account blade, click **Firewall** in the navigation menu, then click **ON**</span></span> 

![Képernyőfelvétel: a tűzfal panel megnyitása a az Azure-portálon](./media/firewall-support/azure-portal-firewall.png)

<span data-ttu-id="9b768-144">Az új panelen adja meg, hogy az Azure-portálon is fér hozzá a fiókjához, és adja hozzá a más címek és tartományok, mint a megfelelő, majd kattintson az **mentése**.</span><span class="sxs-lookup"><span data-stu-id="9b768-144">In the new pane, specify whether the Azure portal can access the account, and add other addresses and ranges as appropriate, then click **Save**.</span></span>  

> [!NOTE]
> <span data-ttu-id="9b768-145">Amikor egy IP-hozzáférés-vezérlési szabályzatok engedélyezéséhez kell az IP-címek az Azure-portálon fér hozzá.</span><span class="sxs-lookup"><span data-stu-id="9b768-145">When you enable an IP access control policy, you need to add the IP address for the Azure portal to maintain access.</span></span> <span data-ttu-id="9b768-146">A portál IP-címek a következők:</span><span class="sxs-lookup"><span data-stu-id="9b768-146">The portal IP addresses are:</span></span>
> |<span data-ttu-id="9b768-147">Régió</span><span class="sxs-lookup"><span data-stu-id="9b768-147">Region</span></span>|<span data-ttu-id="9b768-148">IP-cím</span><span class="sxs-lookup"><span data-stu-id="9b768-148">IP address</span></span>|
> |------|----------|
> |<span data-ttu-id="9b768-149">Minden egyes megadott kivéve alatt</span><span class="sxs-lookup"><span data-stu-id="9b768-149">All regions except those specified below</span></span>| <span data-ttu-id="9b768-150">104.42.195.92</span><span class="sxs-lookup"><span data-stu-id="9b768-150">104.42.195.92</span></span>|
> |<span data-ttu-id="9b768-151">Németország</span><span class="sxs-lookup"><span data-stu-id="9b768-151">Germany</span></span>|<span data-ttu-id="9b768-152">51.4.229.218</span><span class="sxs-lookup"><span data-stu-id="9b768-152">51.4.229.218</span></span>|
> |<span data-ttu-id="9b768-153">Kína</span><span class="sxs-lookup"><span data-stu-id="9b768-153">China</span></span>|<span data-ttu-id="9b768-154">139.217.8.252</span><span class="sxs-lookup"><span data-stu-id="9b768-154">139.217.8.252</span></span>|
> |<span data-ttu-id="9b768-155">USA-beli államigazgatás – Arizona</span><span class="sxs-lookup"><span data-stu-id="9b768-155">US Gov Arizona</span></span>|<span data-ttu-id="9b768-156">52.244.48.71</span><span class="sxs-lookup"><span data-stu-id="9b768-156">52.244.48.71</span></span>|
>

![Képernyőfelvétel egy hogyan tűzfal beállításainak konfigurálása az Azure-portálon](./media/firewall-support/azure-portal-firewall-configure.png)

## <a name="troubleshooting-the-ip-access-control-policy"></a><span data-ttu-id="9b768-158">Hibaelhárítás az IP-hozzáférés-vezérlési házirend</span><span class="sxs-lookup"><span data-stu-id="9b768-158">Troubleshooting the IP access control policy</span></span>
### <a name="portal-operations"></a><span data-ttu-id="9b768-159">Portál műveletek</span><span class="sxs-lookup"><span data-stu-id="9b768-159">Portal operations</span></span>
<span data-ttu-id="9b768-160">Azáltal, hogy IP hozzáférés-vezérlési szabályzatok Azure Cosmos DB adatbázis fiókjához, minden Azure Cosmos DB adatbázis fiókja gépekről kívül a beállított elérését az IP-címtartományok listájának le vannak tiltva.</span><span class="sxs-lookup"><span data-stu-id="9b768-160">By enabling an IP access control policy for your Azure Cosmos DB database account, all access to your Azure Cosmos DB database account from machines outside the configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="9b768-161">Ezért ha portál adatok vezérlősík műveletek tartoznak, mint a gyűjtemények és dokumentumok lekérdezés tallózása engedélyezni szeretné, akkor kell explicit módon az Azure portál hozzáférés engedélyezése a **tűzfal** a portálon.</span><span class="sxs-lookup"><span data-stu-id="9b768-161">Therefore if you want to enable portal data plane operations like browsing collections and query documents, you need to explicitly allow Azure portal access using the **Firewall** blade in the portal.</span></span> 

![A bemutató Képernyőkép az Azure-portálon való hozzáférés engedélyezése](./media/firewall-support/azure-portal-access-firewall.png)

### <a name="sdk--rest-api"></a><span data-ttu-id="9b768-163">SDK & Rest API</span><span class="sxs-lookup"><span data-stu-id="9b768-163">SDK & Rest API</span></span>
<span data-ttu-id="9b768-164">A biztonsági okokból nem található az engedélyezési listához gépek SDK vagy a REST API-n keresztül hozzáférést egy általános 404-es nem található response további részletek nem ad vissza.</span><span class="sxs-lookup"><span data-stu-id="9b768-164">For security reasons, access via SDK or REST API from machines not on the allowed list will return a generic 404 Not Found response with no additional details.</span></span> <span data-ttu-id="9b768-165">Ellenőrizze, hogy a megfelelő házirend-konfiguráció alkalmazásának Azure Cosmos DB adatbázis fiókjába engedélyezettek listájához, a Azure Cosmos DB adatbázis fiókjához beállított IP.</span><span class="sxs-lookup"><span data-stu-id="9b768-165">Please verify the IP allowed list configured for your Azure Cosmos DB database account to ensure the correct policy configuration is applied to your Azure Cosmos DB database account.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9b768-166">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="9b768-166">Next steps</span></span>
<span data-ttu-id="9b768-167">További információ a hálózati kapcsolatos teljesítményadatokat tippek: [teljesítmény tippek](performance-tips.md).</span><span class="sxs-lookup"><span data-stu-id="9b768-167">For information about network related performance tips, see [Performance tips](performance-tips.md).</span></span>

