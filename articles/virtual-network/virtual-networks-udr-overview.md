---
title: "aaaUser által definiált útvonalak és IP-továbbítást az Azure-ban |} Microsoft Docs"
description: "Ismerje meg, hogyan tooconfigure felhasználó által definiált útvonalak (UDR) és az IP-továbbítás tooforward forgalom virtuális készülékek toonetwork az Azure-ban."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: c39076c4-11b7-4b46-a904-817503c4b486
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/15/2016
ms.author: jdial
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f1f1d46166d5a7c776f472b7ade1354d943ece10
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="user-defined-routes-and-ip-forwarding"></a><span data-ttu-id="fa9c0-103">Felhasználó által megadott útvonalak és IP-továbbítás</span><span class="sxs-lookup"><span data-stu-id="fa9c0-103">User-defined routes and IP forwarding</span></span>

<span data-ttu-id="fa9c0-104">Amikor az Azure virtuális gépek (VM) tooa virtuális hálózathoz (VNet), megfigyelheti, hogy hello virtuális gépek automatikusan legyenek-e egymással képes toocommunicate hello hálózaton keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-104">When you add virtual machines (VMs) tooa virtual network (VNet) in Azure, you will notice that hello VMs are able toocommunicate with each other over hello network, automatically.</span></span> <span data-ttu-id="fa9c0-105">Az átjáró toospecify nem kell annak ellenére, hogy a virtuális gépek hello külön alhálózatokon vannak.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-105">You do not need toospecify a gateway, even though hello VMs are in different subnets.</span></span> <span data-ttu-id="fa9c0-106">hello is igaz hello virtuális gépek toohello közti kommunikációhoz nyilvános interneten, és még akkor is, tooyour a helyszíni hálózatra is, ha egy hibrid kapcsolat az Azure tooyour saját datacenter jelen.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-106">hello same is true for communication from hello VMs toohello public Internet, and even tooyour on-premises network when a hybrid connection from Azure tooyour own datacenter is present.</span></span>

<span data-ttu-id="fa9c0-107">Kommunikáció ilyen típusú áramlása azért lehetséges, mert az Azure rendszer útvonalak toodefine hogyan IP a forgalom sorát használja.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-107">This flow of communication is possible because Azure uses a series of system routes toodefine how IP traffic flows.</span></span> <span data-ttu-id="fa9c0-108">Rendszerútvonalak vezérlő a következő forgatókönyvek hello kommunikáció hello áramlását:</span><span class="sxs-lookup"><span data-stu-id="fa9c0-108">System routes control hello flow of communication in hello following scenarios:</span></span>

* <span data-ttu-id="fa9c0-109">Belül hello ugyanazon az alhálózaton.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-109">From within hello same subnet.</span></span>
* <span data-ttu-id="fa9c0-110">Az alhálózati tooanother, egy Vneten belül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-110">From a subnet tooanother within a VNet.</span></span>
* <span data-ttu-id="fa9c0-111">A virtuális gépek toohello Internet.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-111">From VMs toohello Internet.</span></span>
* <span data-ttu-id="fa9c0-112">Az egy VNet tooanother VNet egy VPN-átjárón keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-112">From a VNet tooanother VNet through a VPN gateway.</span></span>
* <span data-ttu-id="fa9c0-113">A virtuális hálózat tooanother VNet Vnetben társviszony-létesítés (szolgáltatás láncolás) keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-113">From a VNet tooanother VNet through VNet Peering (Service Chaining).</span></span>
* <span data-ttu-id="fa9c0-114">Virtuális hálózat tooyour a helyi hálózaton keresztül egy VPN-átjárón keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-114">From a VNet tooyour on-premises network through a VPN gateway.</span></span>

<span data-ttu-id="fa9c0-115">hello az alábbi ábra egy egyszerű beállítás egy Vnetet két alhálózattal és néhány virtuális géppel, valamint hello rendszerútvonalak, amelyek lehetővé teszik az IP-forgalom tooflow.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-115">hello figure below shows a simple setup with a VNet, two subnets, and a few VMs, along with hello system routes that allow IP traffic tooflow.</span></span>

![Rendszerútvonalak az Azure-ban](./media/virtual-networks-udr-overview/Figure1.png)

<span data-ttu-id="fa9c0-117">Bár a rendszerútvonalak hello használata elősegíti a forgalom automatikusan az üzembe helyezéshez, vannak esetek használni kívánt toocontrol hello a csomagok útválasztását egy virtuális készüléken keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-117">Although hello use of system routes facilitates traffic automatically for your deployment, there are cases in which you want toocontrol hello routing of packets through a virtual appliance.</span></span> <span data-ttu-id="fa9c0-118">Úgy, hogy felhasználó által megadott útvonalak létrehozásával megadhatja hello következő ugrás tooa alhálózatot toogo tooyour virtuális készülék helyette áramló csomagok számára, és a továbbítási hello IP-engedélyezése a virtuális gép futtatásához használt hello virtuális készülék.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-118">You can do so by creating user defined routes that specify hello next hop for packets flowing tooa specific subnet toogo tooyour virtual appliance instead, and enabling IP forwarding for hello VM running as hello virtual appliance.</span></span>

<span data-ttu-id="fa9c0-119">hello az alábbi ábra szemlélteti, felhasználó által definiált útvonalak és IP-továbbítás tooforce csomagok tooone alhálózati küldött egy másik toogo a harmadik alhálózat egy virtuális készüléken keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-119">hello figure below shows an example of user defined routes and IP forwarding tooforce packets sent tooone subnet from another toogo through a virtual appliance on a third subnet.</span></span>

![Rendszerútvonalak az Azure-ban](./media/virtual-networks-udr-overview/Figure2.png)

> [!IMPORTANT]
> <span data-ttu-id="fa9c0-121">Felhasználó által definiált útvonalak alkalmazott tootraffic alhálózatot elhagyó bármely erőforrás (például a hálózati adapterek csatolt tooVMs) hello alhálózatban.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-121">User-defined routes are applied tootraffic leaving a subnet from any resource (such as network interfaces attached tooVMs) in hello subnet.</span></span> <span data-ttu-id="fa9c0-122">Nem hozhat létre útvonalakat toospecify hogyan forgalom ad meg egy alhálózatot a hello Internet, például.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-122">You cannot create routes toospecify how traffic enters a subnet from hello Internet, for instance.</span></span> <span data-ttu-id="fa9c0-123">hello készülék, forgalom toocannot hello lennie ugyanazon az alhálózaton Ha hello forgalom származik.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-123">hello appliance you are forwarding traffic toocannot be in hello same subnet where hello traffic originates.</span></span> <span data-ttu-id="fa9c0-124">Mindig hozzon létre egy külön alhálózatot a készülékeinek.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-124">Always create a separate subnet for your appliances.</span></span> 
> 
> 

## <a name="route-resource"></a><span data-ttu-id="fa9c0-125">Útvonal-erőforrás</span><span class="sxs-lookup"><span data-stu-id="fa9c0-125">Route resource</span></span>
<span data-ttu-id="fa9c0-126">Történik a csomagok irányítása alapján egy útválasztási táblázatot hello fizikai hálózat minden csomópontján definiált TCP/IP-hálózaton keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-126">Packets are routed over a TCP/IP network based on a route table defined at each node on hello physical network.</span></span> <span data-ttu-id="fa9c0-127">Egy útválasztási táblázatot a külön útvonalak gyűjteménye használt toodecide ahol tooforward csomagok alapján hello cél IP-címet.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-127">A route table is a collection of individual routes used toodecide where tooforward packets based on hello destination IP address.</span></span> <span data-ttu-id="fa9c0-128">Egy olyan útvonalat hello következő tevődik össze:</span><span class="sxs-lookup"><span data-stu-id="fa9c0-128">A route consists of hello following:</span></span>

| <span data-ttu-id="fa9c0-129">Tulajdonság</span><span class="sxs-lookup"><span data-stu-id="fa9c0-129">Property</span></span> | <span data-ttu-id="fa9c0-130">Leírás</span><span class="sxs-lookup"><span data-stu-id="fa9c0-130">Description</span></span> | <span data-ttu-id="fa9c0-131">Korlátozások</span><span class="sxs-lookup"><span data-stu-id="fa9c0-131">Constraints</span></span> | <span data-ttu-id="fa9c0-132">Megfontolások</span><span class="sxs-lookup"><span data-stu-id="fa9c0-132">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="fa9c0-133">Címelőtag</span><span class="sxs-lookup"><span data-stu-id="fa9c0-133">Address Prefix</span></span> |<span data-ttu-id="fa9c0-134">hello cél CIDR toowhich hello vonatkozik, például 10.1.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-134">hello destination CIDR toowhich hello route applies, such as 10.1.0.0/16.</span></span> |<span data-ttu-id="fa9c0-135">Hello címek képviselő érvényes CIDR tartománynak kell lennie nyilvános interneten, Azure-beli virtuális hálózat vagy a helyszíni adatközpontban.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-135">Must be a valid CIDR range representing addresses on hello public Internet, Azure virtual network, or on-premises datacenter.</span></span> |<span data-ttu-id="fa9c0-136">Győződjön meg arról, hogy hello **címelőtag** nem tartalmaz hello hello címet **következő ugrási cím**, ellenkező esetben a csomagok bekerülnek egy hurokba, anélkül, hogy valaha is elérnék hello forrás toohello következő ugrás át hello cél.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-136">Make sure hello **Address prefix** does not contain hello address for hello **Next hop address**, otherwise your packets will enter in a loop going from hello source toohello next hop without ever reaching hello destination.</span></span> |
| <span data-ttu-id="fa9c0-137">A következő ugrás típusa</span><span class="sxs-lookup"><span data-stu-id="fa9c0-137">Next hop type</span></span> |<span data-ttu-id="fa9c0-138">hello típusú Azure Ugrás hello csomagot kell küldeni.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-138">hello type of Azure hop hello packet should be sent to.</span></span> |<span data-ttu-id="fa9c0-139">Hello a következő értékek egyike lehet:</span><span class="sxs-lookup"><span data-stu-id="fa9c0-139">Must be one of hello following values:</span></span> <br/> <span data-ttu-id="fa9c0-140">**Virtuális hálózat**.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-140">**Virtual Network**.</span></span> <span data-ttu-id="fa9c0-141">Hello helyi virtuális hálózatot jelenti.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-141">Represents hello local virtual network.</span></span> <span data-ttu-id="fa9c0-142">Például, ha két alhálózat, 10.1.0.0/16 és 10.2.0.0/16 található ugyanabban a virtuális hálózatban hello, hello útvonal minden hello útválasztási táblázatot az alhálózathoz kell egy következő ugrás értéke *virtuális hálózati*.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-142">For instance, if you have two subnets, 10.1.0.0/16 and 10.2.0.0/16 in hello same virtual network, hello route for each subnet in hello route table will have a next hop value of *Virtual Network*.</span></span> <br/> <span data-ttu-id="fa9c0-143">**Virtuális hálózati átjáró**.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-143">**Virtual Network Gateway**.</span></span> <span data-ttu-id="fa9c0-144">Egy Azure S2S VPN Gateway átjárót jelöl.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-144">Represents an Azure S2S VPN Gateway.</span></span> <br/> <span data-ttu-id="fa9c0-145">**Internet**.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-145">**Internet**.</span></span> <span data-ttu-id="fa9c0-146">Hello hello Azure infrastruktúrája által biztosított alapértelmezett internetes átjárót jelöli.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-146">Represents hello default Internet gateway provided by hello Azure Infrastructure.</span></span> <br/> <span data-ttu-id="fa9c0-147">**Virtuális készülék**.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-147">**Virtual Appliance**.</span></span> <span data-ttu-id="fa9c0-148">Azure-beli virtuális hálózat tooyour hozzáadott virtuális készüléket jelöli.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-148">Represents a virtual appliance you added tooyour Azure virtual network.</span></span> <br/> <span data-ttu-id="fa9c0-149">**Nincs**.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-149">**None**.</span></span> <span data-ttu-id="fa9c0-150">Egy fekete lyukat jelöl.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-150">Represents a black hole.</span></span> <span data-ttu-id="fa9c0-151">Tooa fekete lyuk továbbított csomagok egyáltalán nem lesznek továbbítva.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-151">Packets forwarded tooa black hole will not be forwarded at all.</span></span> |<span data-ttu-id="fa9c0-152">Érdemes lehet **virtuális készülék** toodirect forgalom tooa virtuális gép vagy az Azure Load Balancer belső IP-címet.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-152">Consider using **Virtual Appliance** toodirect traffic tooa VM or Azure Load Balancer internal IP address.</span></span>  <span data-ttu-id="fa9c0-153">Ez a típus lehetővé teszi, hogy egy IP-címet az alább ismertetett hello megadását.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-153">This type allows hello specification of an IP address as described below.</span></span> <span data-ttu-id="fa9c0-154">Érdemes lehet egy **nincs** írja be a megadott cél szereplő tooa toostop-csomagokat.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-154">Consider using a **None** type toostop packets from flowing tooa given destination.</span></span> |
| <span data-ttu-id="fa9c0-155">A következő ugrás címe</span><span class="sxs-lookup"><span data-stu-id="fa9c0-155">Next hop address</span></span> |<span data-ttu-id="fa9c0-156">hello következő ugrási cím csomagokat továbbítani kell hello IP-címet tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-156">hello next hop address contains hello IP address packets should be forwarded to.</span></span> <span data-ttu-id="fa9c0-157">Következő ugrás értékei csak engedélyezettek hol található a következő ugrás típusa hello útvonalak *virtuális készülék*.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-157">Next hop values are only allowed in routes where hello next hop type is *Virtual Appliance*.</span></span> |<span data-ttu-id="fa9c0-158">Virtuális hálózat, amikor a felhasználó által definiált útvonal hello érvényben, áthaladás nélkül hello belül elérhető IP-címnek kell lennie egy **virtuális hálózati átjáró**.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-158">Must be an IP address that is reachable within hello Virtual Network where hello User Defined Route is applied, without going through a **Virtual Network Gateway**.</span></span> <span data-ttu-id="fa9c0-159">hello IP-cím toobe van, ugyanazon virtuális hálózat az alkalmazása hello, vagy peered virtuális hálózaton.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-159">hello IP address has toobe on hello same Virtual Network where it is applied, or on a peered Virtual Network.</span></span> |<span data-ttu-id="fa9c0-160">Ha hello IP-cím egy virtuális Gépet jelöl, ellenőrizze, hogy engedélyezi [IP-továbbítás](#IP-forwarding) hello virtuális gép az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-160">If hello IP address represents a VM, make sure you enable [IP forwarding](#IP-forwarding) in Azure for hello VM.</span></span> <span data-ttu-id="fa9c0-161">Ha hello IP cím jelöli hello belső IP-cím az Azure terheléselosztó, ellenőrizze, hogy a megfelelő terheléselosztási szabály minden port tooload egyenleg kívánja.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-161">If hello IP address represents hello internal IP address of Azure Load Balancer, make sure you have a matching load balancing rule for each port you wish tooload balance.</span></span>|

<span data-ttu-id="fa9c0-162">Az Azure PowerShell hello "NextHopType" értékek némelyike neve nem lehet ugyanaz:</span><span class="sxs-lookup"><span data-stu-id="fa9c0-162">In Azure PowerShell some of hello "NextHopType" values have different names:</span></span>

* <span data-ttu-id="fa9c0-163">A virtuális hálózat a VnetLocal</span><span class="sxs-lookup"><span data-stu-id="fa9c0-163">Virtual Network is VnetLocal</span></span>
* <span data-ttu-id="fa9c0-164">A virtuális hálózati átjáró a VirtualNetworkGateway</span><span class="sxs-lookup"><span data-stu-id="fa9c0-164">Virtual Network Gateway is VirtualNetworkGateway</span></span>
* <span data-ttu-id="fa9c0-165">A virtuális készülék a VirtualAppliance</span><span class="sxs-lookup"><span data-stu-id="fa9c0-165">Virtual Appliance is VirtualAppliance</span></span>
* <span data-ttu-id="fa9c0-166">Az internet az Internet</span><span class="sxs-lookup"><span data-stu-id="fa9c0-166">Internet is Internet</span></span>
* <span data-ttu-id="fa9c0-167">A nincs a Nincs</span><span class="sxs-lookup"><span data-stu-id="fa9c0-167">None is None</span></span>

### <a name="system-routes"></a><span data-ttu-id="fa9c0-168">Rendszerútvonalak</span><span class="sxs-lookup"><span data-stu-id="fa9c0-168">System routes</span></span>
<span data-ttu-id="fa9c0-169">A virtuális hálózatban létrehozott összes alhálózatot automatikusan hozzárendeli egy útválasztási táblázatot, amely tartalmazza a következő útvonal rendszerszabályok hello:</span><span class="sxs-lookup"><span data-stu-id="fa9c0-169">Every subnet created in a virtual network is automatically associated with a route table that contains hello following system route rules:</span></span>

* <span data-ttu-id="fa9c0-170">**Helyi Vnet szabály**: Ez a szabály a virtuális hálózat miden alhálózatában automatikusan létrejön.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-170">**Local Vnet Rule**: This rule is automatically created for every subnet in a virtual network.</span></span> <span data-ttu-id="fa9c0-171">Meghatározza, hogy hello hello virtuális hálózat virtuális gépek között közvetlen kapcsolat van, és nincs köztes Ugrás.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-171">It specifies that there is a direct link between hello VMs in hello VNet and there is no intermediate next hop.</span></span>
* <span data-ttu-id="fa9c0-172">**Helyszíni szabály**: Ez a szabály vonatkozik tooall adatforgalmat toohello helyszíni címtartomány és VPN-átjárót használ hello következő ugrási célként.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-172">**On-premises Rule**: This rule applies tooall traffic destined toohello on-premises address range and uses VPN gateway as hello next hop destination.</span></span>
* <span data-ttu-id="fa9c0-173">**Internet szabály**: Ez a szabály kezeli az összes adatforgalmat toohello nyilvános Internet (cím előtag 0.0.0.0/0) és a használt hello infrastruktúra internetes átjáróját hello, a következő az összes adatforgalmat toohello Internet az Ugrás.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-173">**Internet Rule**: This rule handles all traffic destined toohello public Internet (address prefix 0.0.0.0/0) and uses hello infrastructure internet gateway as hello next hop for all traffic destined toohello Internet.</span></span>

### <a name="user-defined-routes"></a><span data-ttu-id="fa9c0-174">Felhasználó által megadott útvonalak</span><span class="sxs-lookup"><span data-stu-id="fa9c0-174">User-defined routes</span></span>
<span data-ttu-id="fa9c0-175">A legtöbb környezetben csak akkor hello Azure által meghatározott rendszerútvonalakra.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-175">For most environments you will only need hello system routes already defined by Azure.</span></span> <span data-ttu-id="fa9c0-176">Azonban előfordulhat, hogy toocreate egy útválasztási táblázatot kell, és adjon hozzá egy vagy több útvonal például az adott esetben:</span><span class="sxs-lookup"><span data-stu-id="fa9c0-176">However, you may need toocreate a route table and add one or more routes in specific cases, such as:</span></span>

* <span data-ttu-id="fa9c0-177">A kényszerített bújtatás toohello Internet a helyi hálózaton keresztül.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-177">Force tunneling toohello Internet via your on-premises network.</span></span>
* <span data-ttu-id="fa9c0-178">Virtuális készülékek használata Azure környezetben.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-178">Use of virtual appliances in your Azure environment.</span></span>

<span data-ttu-id="fa9c0-179">Hello a fenti helyzetekben toocreate rendelkezik egy útválasztási táblázatot, és adja hozzá a felhasználó által definiált útvonalak tooit.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-179">In hello scenarios above, you will have toocreate a route table and add user defined routes tooit.</span></span> <span data-ttu-id="fa9c0-180">Több útválasztási táblázattal is rendelkezhet, és hello ugyanazt az útválasztási táblázatot lehet társított tooone vagy további alhálózatokat.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-180">You can have multiple route tables, and hello same route table can be associated tooone or more subnets.</span></span> <span data-ttu-id="fa9c0-181">És minden alhálózathoz csak társított tooa egy útválasztási táblázatot.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-181">And each subnet can only be associated tooa single route table.</span></span> <span data-ttu-id="fa9c0-182">Minden virtuális gépe és felhőszolgáltatása ugyanazt az alhálózat hello útvonal kapcsolódó tábla toothat alhálózati használata</span><span class="sxs-lookup"><span data-stu-id="fa9c0-182">All VMs and cloud services in a subnet use hello route table associated toothat subnet.</span></span>

<span data-ttu-id="fa9c0-183">Alhálózatok rendszerútvonalakra támaszkodnak, amíg egy útválasztási táblázatot társított toohello alhálózat.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-183">Subnets rely on system routes until a route table is associated toohello subnet.</span></span> <span data-ttu-id="fa9c0-184">Miután egy hozzárendelés létrejött, az útválasztás a felhasználó által megadott útvonalaknál és a rendszerútvonalaknál is a leghosszabb előtag-megfeleltetés (LPM) alapján történik.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-184">Once an association exists, routing is done based on Longest Prefix Match (LPM) among both user defined routes and system routes.</span></span> <span data-ttu-id="fa9c0-185">Ha egynél több útvonal rendelkezik hello azonos LPM egyezik egy útvonal van kiválasztva, majd a sorrend hello Kiindulás alapján:</span><span class="sxs-lookup"><span data-stu-id="fa9c0-185">If there is more than one route with hello same LPM match then a route is selected based on its origin in hello following order:</span></span>

1. <span data-ttu-id="fa9c0-186">Felhasználó által megadott útvonal</span><span class="sxs-lookup"><span data-stu-id="fa9c0-186">User defined route</span></span>
2. <span data-ttu-id="fa9c0-187">BGP-útvonal (ExpressRoute használatánál)</span><span class="sxs-lookup"><span data-stu-id="fa9c0-187">BGP route (when ExpressRoute is used)</span></span>
3. <span data-ttu-id="fa9c0-188">Rendszerútvonal</span><span class="sxs-lookup"><span data-stu-id="fa9c0-188">System route</span></span>

<span data-ttu-id="fa9c0-189">toolearn hogyan toocreate felhasználó által megadott útvonalak, lásd: [hogyan tooCreate útvonalak és IP-továbbítás az Azure-ban engedélyezése](virtual-network-create-udr-arm-template.md).</span><span class="sxs-lookup"><span data-stu-id="fa9c0-189">toolearn how toocreate user defined routes, see [How tooCreate Routes and Enable IP Forwarding in Azure](virtual-network-create-udr-arm-template.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="fa9c0-190">Felhasználó által megadott útvonalakat csak alkalmazott tooAzure virtuális gépek és a felhőalapú szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-190">User defined routes are only applied tooAzure VMs and cloud services.</span></span> <span data-ttu-id="fa9c0-191">Például ha azt szeretné, hogy tooadd virtuális készülékként egy tűzfalat a helyszíni hálózat és az Azure között, akkor toocreate az Azure útválasztási táblázatban egy felhasználó által megadott útvonalat, amely továbbítja a teljes forgalmat toohello a helyi cím terület toohello virtuális készüléket.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-191">For instance, if you want tooadd a firewall virtual appliance between your on-premises network and Azure, you will have toocreate a user defined route for your Azure route tables that forwards all traffic going toohello on-premises address space toohello virtual appliance.</span></span> <span data-ttu-id="fa9c0-192">A felhasználó által definiált útvonal (UDR) toohello GatewaySubnet tooforward helyszíni tooAzure származó összes forgalmat hello virtuális készülék keresztül is hozzáadhat.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-192">You can also add a user defined route (UDR) toohello GatewaySubnet tooforward all traffic from on-premises tooAzure through hello virtual appliance.</span></span> <span data-ttu-id="fa9c0-193">Ez a lehetőség a közelmúltban lett hozzáadva.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-193">This is a recent addition.</span></span>
> 
> 

### <a name="bgp-routes"></a><span data-ttu-id="fa9c0-194">BGP-útvonalak</span><span class="sxs-lookup"><span data-stu-id="fa9c0-194">BGP routes</span></span>
<span data-ttu-id="fa9c0-195">Ha a helyszíni hálózat és az Azure között ExpressRoute kapcsolat van, a helyszíni hálózati tooAzure a engedélyezheti toopropagate BGP-útvonalakat.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-195">If you have an ExpressRoute connection between your on-premises network and Azure, you can enable BGP toopropagate routes from your on-premises network tooAzure.</span></span> <span data-ttu-id="fa9c0-196">Hello használatosak, a BGP-útvonalakat minden Azure alhálózatban ugyanúgy, mint a rendszerútvonalakat és a felhasználó által megadott útvonalak.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-196">These BGP routes are used in hello same way as system routes and user defined routes in each Azure subnet.</span></span> <span data-ttu-id="fa9c0-197">További információ: [ExpressRoute Introduction](../expressroute/expressroute-introduction.md) (Az ExpressRoute bemutatása).</span><span class="sxs-lookup"><span data-stu-id="fa9c0-197">For more information see [ExpressRoute Introduction](../expressroute/expressroute-introduction.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="fa9c0-198">Konfigurálhatja az Azure-alapú környezetben toouse kényszerített a helyszíni hálózaton hozzon létre egy felhasználó által megadott útvonalat a 0.0.0.0/0 alhálózat számára, amely a következő ugrás hello hello VPN-átjárót használ.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-198">You can configure your Azure environment toouse force tunneling through your on-premises network by creating a user defined route for subnet 0.0.0.0/0 that uses hello VPN gateway as hello next hop.</span></span> <span data-ttu-id="fa9c0-199">Ez azonban csak akkor működik, ha VPN-átjárót használ, nem ExpressRoute-ot.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-199">However, this only works if you are using a VPN gateway, not ExpressRoute.</span></span> <span data-ttu-id="fa9c0-200">Az ExpressRoute-nál a kényszerített bújtatás konfigurálása a BGP-n keresztül történik.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-200">For ExpressRoute, forced tunneling is configured through BGP.</span></span>
> 
> 

## <a name="ip-forwarding"></a><span data-ttu-id="fa9c0-201">IP-továbbítás</span><span class="sxs-lookup"><span data-stu-id="fa9c0-201">IP forwarding</span></span>
<span data-ttu-id="fa9c0-202">A fent említett egyik fő oka annak toocreate hello egy felhasználó által megadott útvonalat tooforward forgalom tooa virtuális készülék.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-202">As described above, one of hello main reasons toocreate a user defined route is tooforward traffic tooa virtual appliance.</span></span> <span data-ttu-id="fa9c0-203">A virtuális készülék értéke "Nothing" több mint egy virtuális Gépet, amelyen az alkalmazás toohandle hálózati forgalom valamilyen módon, például egy tűzfal vagy NAT-eszköz.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-203">A virtual appliance is nothing more than a VM that runs an application used toohandle network traffic in some way, such as a firewall or a NAT device.</span></span>

<span data-ttu-id="fa9c0-204">A virtuális gép kell lennie, amely képes tooreceive bejövő forgalom virtuális készüléknek tooitself nem foglalkozik.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-204">This virtual appliance VM must be able tooreceive incoming traffic that is not addressed tooitself.</span></span> <span data-ttu-id="fa9c0-205">a virtuális gépek tooreceive forgalma tooallow címzett tooother a célok, engedélyeznie kell az IP-továbbítás az hello VM.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-205">tooallow a VM tooreceive traffic addressed tooother destinations, you must enable IP Forwarding for hello VM.</span></span> <span data-ttu-id="fa9c0-206">Ez az egy Azure beállítás, nem a megfelelő értéket hello vendég operációs rendszer.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-206">This is an Azure setting, not a setting in hello guest operating system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fa9c0-207">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="fa9c0-207">Next steps</span></span>
* <span data-ttu-id="fa9c0-208">Ismerje meg, hogyan túl[hozhat létre útvonalakat hello Resource Manager üzembe helyezési modellel](virtual-network-create-udr-arm-template.md) és toosubnets rendelje hozzá őket.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-208">Learn how too[create routes in hello Resource Manager deployment model](virtual-network-create-udr-arm-template.md) and associate them toosubnets.</span></span> 
* <span data-ttu-id="fa9c0-209">Ismerje meg, hogyan túl[hozhat létre útvonalakat a klasszikus üzembe helyezési modellel hello](virtual-network-create-udr-classic-ps.md) és toosubnets rendelje hozzá őket.</span><span class="sxs-lookup"><span data-stu-id="fa9c0-209">Learn how too[create routes in hello classic deployment model](virtual-network-create-udr-classic-ps.md) and associate them toosubnets.</span></span>

