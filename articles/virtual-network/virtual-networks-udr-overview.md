---
title: "Felhasználói útvonalak és IP-továbbítás az Azure-ban | Microsoft Docs"
description: "Megtudhatja, hogyan konfigurálhat a felhasználói útvonalakat (UDR) és az IP-továbbítást a forgalom hálózati virtuális készülékekre történő irányításához az Azure-ban."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: c39076c4-11b7-4b46-a904-817503c4b486
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/15/2016
ms.author: jdial
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 6274e0101f6fb0864c8d1efaef7fcde78b8760c3
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="user-defined-routes-and-ip-forwarding"></a><span data-ttu-id="33280-103">Felhasználó által megadott útvonalak és IP-továbbítás</span><span class="sxs-lookup"><span data-stu-id="33280-103">User-defined routes and IP forwarding</span></span>

<span data-ttu-id="33280-104">Amikor az Azure-ban virtuális gépeket (VM-ek) ad hozzá egy virtuális hálózathoz (VNet), észre fogja venni, hogy a virtuális gépek automatikusan tudnak egymással kommunikálni a hálózaton keresztül.</span><span class="sxs-lookup"><span data-stu-id="33280-104">When you add virtual machines (VMs) to a virtual network (VNet) in Azure, you will notice that the VMs are able to communicate with each other over the network, automatically.</span></span> <span data-ttu-id="33280-105">Nem kell megadni átjárót, akkor sem, ha a virtuális gépek külön alhálózatokon vannak.</span><span class="sxs-lookup"><span data-stu-id="33280-105">You do not need to specify a gateway, even though the VMs are in different subnets.</span></span> <span data-ttu-id="33280-106">Ugyanez vonatkozik a virtuális gépek és a nyilvános internet közötti kommunikációra, és akár a helyszíni hálózatra is, ha jelen van egy hibrid kapcsolat az Azure és a saját adatközpont között.</span><span class="sxs-lookup"><span data-stu-id="33280-106">The same is true for communication from the VMs to the public Internet, and even to your on-premises network when a hybrid connection from Azure to your own datacenter is present.</span></span>

<span data-ttu-id="33280-107">A kommunikáció ilyen típusú áramlása azért lehetséges, mert az Azure rendszerútvonalak sorát használja az IP-cím adatforgalmának meghatározására.</span><span class="sxs-lookup"><span data-stu-id="33280-107">This flow of communication is possible because Azure uses a series of system routes to define how IP traffic flows.</span></span> <span data-ttu-id="33280-108">A rendszerútvonalak az alábbi helyzetekben irányítják a kommunikáció áramlását:</span><span class="sxs-lookup"><span data-stu-id="33280-108">System routes control the flow of communication in the following scenarios:</span></span>

* <span data-ttu-id="33280-109">Ha ugyanazon az alhálózaton belül történik.</span><span class="sxs-lookup"><span data-stu-id="33280-109">From within the same subnet.</span></span>
* <span data-ttu-id="33280-110">Két alhálózat között történik egy virtuális hálózaton belül.</span><span class="sxs-lookup"><span data-stu-id="33280-110">From a subnet to another within a VNet.</span></span>
* <span data-ttu-id="33280-111">Virtuális gépek és az internet között történik.</span><span class="sxs-lookup"><span data-stu-id="33280-111">From VMs to the Internet.</span></span>
* <span data-ttu-id="33280-112">Két VNet között történik egy VPN-átjárón keresztül.</span><span class="sxs-lookup"><span data-stu-id="33280-112">From a VNet to another VNet through a VPN gateway.</span></span>
* <span data-ttu-id="33280-113">Két VNet között történik Virtuális hálózatok közötti társviszony révén (Szolgáltatásláncolás).</span><span class="sxs-lookup"><span data-stu-id="33280-113">From a VNet to another VNet through VNet Peering (Service Chaining).</span></span>
* <span data-ttu-id="33280-114">Egy VNet és a helyszíni hálózat között történik egy VPN-átjárón keresztül.</span><span class="sxs-lookup"><span data-stu-id="33280-114">From a VNet to your on-premises network through a VPN gateway.</span></span>

<span data-ttu-id="33280-115">Az alábbi ábrán egy egyszerű beállítás látható egy virtuális hálózattal, két alhálózattal és néhány virtuális géppel, valamint azokkal a rendszerútvonalakkal, amelyek engedélyezik az IP-cím forgalmának áramlását.</span><span class="sxs-lookup"><span data-stu-id="33280-115">The figure below shows a simple setup with a VNet, two subnets, and a few VMs, along with the system routes that allow IP traffic to flow.</span></span>

![Rendszerútvonalak az Azure-ban](./media/virtual-networks-udr-overview/Figure1.png)

<span data-ttu-id="33280-117">Bár a rendszerútvonalak használata automatikusan segíti az üzemelő példány forgalmát, vannak esetek, amikor a csomagok útválasztását érdemesebb egy virtuális készüléken keresztül irányítani.</span><span class="sxs-lookup"><span data-stu-id="33280-117">Although the use of system routes facilitates traffic automatically for your deployment, there are cases in which you want to control the routing of packets through a virtual appliance.</span></span> <span data-ttu-id="33280-118">Ezt úgy teheti meg, hogy felhasználó által megadott útvonalakat hoz létre, amelyek úgy határozzák meg a következő ugrást az adott alhálózatra áramló csomagok számára, hogy azok a virtuális készülékre érkezzenek, valamint engedélyezi az IP-továbbítást a virtuális készülékként futó virtuális gép számára.</span><span class="sxs-lookup"><span data-stu-id="33280-118">You can do so by creating user defined routes that specify the next hop for packets flowing to a specific subnet to go to your virtual appliance instead, and enabling IP forwarding for the VM running as the virtual appliance.</span></span>

<span data-ttu-id="33280-119">Az alábbi ábra a felhasználó által megadott útvonalakra és az IP-továbbításra mutat egy példát, amelyben az egyik alhálózatról a másikra küldött csomagokat arra kényszerítik, hogy áthaladjanak a harmadik alhálózat virtuális készülékén.</span><span class="sxs-lookup"><span data-stu-id="33280-119">The figure below shows an example of user defined routes and IP forwarding to force packets sent to one subnet from another to go through a virtual appliance on a third subnet.</span></span>

![Rendszerútvonalak az Azure-ban](./media/virtual-networks-udr-overview/Figure2.png)

> [!IMPORTANT]
> <span data-ttu-id="33280-121">A rendszer a felhasználó által megadott útvonalakat az alhálózatot elhagyó, az alhálózatban lévő bármely erőforrásról (például a virtuális gépekhez csatolt hálózati adapterekről) származó forgalomra alkalmazza.</span><span class="sxs-lookup"><span data-stu-id="33280-121">User-defined routes are applied to traffic leaving a subnet from any resource (such as network interfaces attached to VMs) in the subnet.</span></span> <span data-ttu-id="33280-122">Nem hozhat létre útvonalakat például azért, hogy meghatározza, milyen úton érkezik a forgalom az internetről egy alhálózatba.</span><span class="sxs-lookup"><span data-stu-id="33280-122">You cannot create routes to specify how traffic enters a subnet from the Internet, for instance.</span></span> <span data-ttu-id="33280-123">Az a készülék, amelyre a forgalmat továbbítja, nem lehet ugyanabban az alhálózatban, ahonnan a forgalom származik.</span><span class="sxs-lookup"><span data-stu-id="33280-123">The appliance you are forwarding traffic to cannot be in the same subnet where the traffic originates.</span></span> <span data-ttu-id="33280-124">Mindig hozzon létre egy külön alhálózatot a készülékeinek.</span><span class="sxs-lookup"><span data-stu-id="33280-124">Always create a separate subnet for your appliances.</span></span> 
> 
> 

## <a name="route-resource"></a><span data-ttu-id="33280-125">Útvonal-erőforrás</span><span class="sxs-lookup"><span data-stu-id="33280-125">Route resource</span></span>
<span data-ttu-id="33280-126">A csomagok útválasztása a TCP/IP-hálózatban egy útválasztási táblázaton alapul, ami a fizikai hálózat minden csomópontján meg van határozva.</span><span class="sxs-lookup"><span data-stu-id="33280-126">Packets are routed over a TCP/IP network based on a route table defined at each node on the physical network.</span></span> <span data-ttu-id="33280-127">Az útválasztási táblázat külön útvonalak gyűjteménye, amelyet arra használnak, hogy az IP-célcím alapján eldöntsék, a rendszer hova továbbítsa a csomagokat.</span><span class="sxs-lookup"><span data-stu-id="33280-127">A route table is a collection of individual routes used to decide where to forward packets based on the destination IP address.</span></span> <span data-ttu-id="33280-128">Az útvonalak a következőket tartalmazzák:</span><span class="sxs-lookup"><span data-stu-id="33280-128">A route consists of the following:</span></span>

| <span data-ttu-id="33280-129">Tulajdonság</span><span class="sxs-lookup"><span data-stu-id="33280-129">Property</span></span> | <span data-ttu-id="33280-130">Leírás</span><span class="sxs-lookup"><span data-stu-id="33280-130">Description</span></span> | <span data-ttu-id="33280-131">Korlátozások</span><span class="sxs-lookup"><span data-stu-id="33280-131">Constraints</span></span> | <span data-ttu-id="33280-132">Megfontolások</span><span class="sxs-lookup"><span data-stu-id="33280-132">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="33280-133">Címelőtag</span><span class="sxs-lookup"><span data-stu-id="33280-133">Address Prefix</span></span> |<span data-ttu-id="33280-134">A cél CIDR, amelyre az útvonal vonatkozik, például 10.1.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="33280-134">The destination CIDR to which the route applies, such as 10.1.0.0/16.</span></span> |<span data-ttu-id="33280-135">Érvényes CIDR tartománynak kell lennie, ami a nyilvános interneten, az Azure virtuális hálózatban vagy a helyszíni adatközpontban található címeket jelöli.</span><span class="sxs-lookup"><span data-stu-id="33280-135">Must be a valid CIDR range representing addresses on the public Internet, Azure virtual network, or on-premises datacenter.</span></span> |<span data-ttu-id="33280-136">Győződjön meg arról, hogy a **címelőtag** nem **a következő ugrás címét** tartalmazza, különben a csomagok bekerülnek egy hurokba, és a forrásuktól a következő ugráshoz kerülnek anélkül, hogy valaha is elérnék a céljukat.</span><span class="sxs-lookup"><span data-stu-id="33280-136">Make sure the **Address prefix** does not contain the address for the **Next hop address**, otherwise your packets will enter in a loop going from the source to the next hop without ever reaching the destination.</span></span> |
| <span data-ttu-id="33280-137">A következő ugrás típusa</span><span class="sxs-lookup"><span data-stu-id="33280-137">Next hop type</span></span> |<span data-ttu-id="33280-138">Az Azure ugrás típusa, amellyel a csomagot küldeni kell.</span><span class="sxs-lookup"><span data-stu-id="33280-138">The type of Azure hop the packet should be sent to.</span></span> |<span data-ttu-id="33280-139">A következő értékek egyikének kell lennie:</span><span class="sxs-lookup"><span data-stu-id="33280-139">Must be one of the following values:</span></span> <br/> <span data-ttu-id="33280-140">**Virtuális hálózat**.</span><span class="sxs-lookup"><span data-stu-id="33280-140">**Virtual Network**.</span></span> <span data-ttu-id="33280-141">A helyi virtuális hálózatot jelöli.</span><span class="sxs-lookup"><span data-stu-id="33280-141">Represents the local virtual network.</span></span> <span data-ttu-id="33280-142">Ha például ugyanabban a virtuális hálózatban két alhálózat van, (10.1.0.0/16 és 10.2.0.0/16) az útválasztási táblázatban az alhálózatok útvonalának következő ugrás értéke *Virtuális hálózat* lesz.</span><span class="sxs-lookup"><span data-stu-id="33280-142">For instance, if you have two subnets, 10.1.0.0/16 and 10.2.0.0/16 in the same virtual network, the route for each subnet in the route table will have a next hop value of *Virtual Network*.</span></span> <br/> <span data-ttu-id="33280-143">**Virtuális hálózati átjáró**.</span><span class="sxs-lookup"><span data-stu-id="33280-143">**Virtual Network Gateway**.</span></span> <span data-ttu-id="33280-144">Egy Azure S2S VPN Gateway átjárót jelöl.</span><span class="sxs-lookup"><span data-stu-id="33280-144">Represents an Azure S2S VPN Gateway.</span></span> <br/> <span data-ttu-id="33280-145">**Internet**.</span><span class="sxs-lookup"><span data-stu-id="33280-145">**Internet**.</span></span> <span data-ttu-id="33280-146">Az Azure infrastruktúra által biztosított alapértelmezett internetes átjárót jelöli.</span><span class="sxs-lookup"><span data-stu-id="33280-146">Represents the default Internet gateway provided by the Azure Infrastructure.</span></span> <br/> <span data-ttu-id="33280-147">**Virtuális készülék**.</span><span class="sxs-lookup"><span data-stu-id="33280-147">**Virtual Appliance**.</span></span> <span data-ttu-id="33280-148">Az Azure Virtual Networkhöz hozzáadott virtuális készüléket jelöli.</span><span class="sxs-lookup"><span data-stu-id="33280-148">Represents a virtual appliance you added to your Azure virtual network.</span></span> <br/> <span data-ttu-id="33280-149">**Nincs**.</span><span class="sxs-lookup"><span data-stu-id="33280-149">**None**.</span></span> <span data-ttu-id="33280-150">Egy fekete lyukat jelöl.</span><span class="sxs-lookup"><span data-stu-id="33280-150">Represents a black hole.</span></span> <span data-ttu-id="33280-151">A fekete lyukakba továbbított csomagok nem lesznek továbbítva.</span><span class="sxs-lookup"><span data-stu-id="33280-151">Packets forwarded to a black hole will not be forwarded at all.</span></span> |<span data-ttu-id="33280-152">Fontolja meg **Virtuális készülék** használatát az adatforgalom átirányításához egy virtuális gépre vagy az Azure Load Balancer belső IP-címére.</span><span class="sxs-lookup"><span data-stu-id="33280-152">Consider using **Virtual Appliance** to direct traffic to a VM or Azure Load Balancer internal IP address.</span></span>  <span data-ttu-id="33280-153">Ezzel a típussal megadható egy IP-cím, az alábbiakban ismertetettek szerint.</span><span class="sxs-lookup"><span data-stu-id="33280-153">This type allows the specification of an IP address as described below.</span></span> <span data-ttu-id="33280-154">Érdemes a **Nincs** típust használni, ha nem szeretné, hogy a csomagok elérjék a megadott céljukat.</span><span class="sxs-lookup"><span data-stu-id="33280-154">Consider using a **None** type to stop packets from flowing to a given destination.</span></span> |
| <span data-ttu-id="33280-155">A következő ugrás címe</span><span class="sxs-lookup"><span data-stu-id="33280-155">Next hop address</span></span> |<span data-ttu-id="33280-156">A következő ugrás címe azt az IP-címet tartalmazza, ahová a csomagokat továbbítani kell.</span><span class="sxs-lookup"><span data-stu-id="33280-156">The next hop address contains the IP address packets should be forwarded to.</span></span> <span data-ttu-id="33280-157">A következő ugrás értékei csak az olyan útvonalaknál engedélyezettek, ahol a következő ugrás típusa *Virtuális készülék*.</span><span class="sxs-lookup"><span data-stu-id="33280-157">Next hop values are only allowed in routes where the next hop type is *Virtual Appliance*.</span></span> |<span data-ttu-id="33280-158">Egy olyan IP-címnek kell lennie, ami elérhető azon virtuális hálózaton belül, ahol a felhasználó által megadott útvonal van alkalmazva anélkül, hogy áthaladna a **virtuális hálózati átjárón**.</span><span class="sxs-lookup"><span data-stu-id="33280-158">Must be an IP address that is reachable within the Virtual Network where the User Defined Route is applied, without going through a **Virtual Network Gateway**.</span></span> <span data-ttu-id="33280-159">Az IP-címnek egy társított virtuális hálózaton, vagy ugyanazon a virtuális hálózaton kell lennie, ahol alkalmazva van.</span><span class="sxs-lookup"><span data-stu-id="33280-159">The IP address has to be on the same Virtual Network where it is applied, or on a peered Virtual Network.</span></span> |<span data-ttu-id="33280-160">Ha az IP-cím egy virtuális gépet jelöl, győződjön meg arról, hogy engedélyezi az [IP-továbbítást](#IP-forwarding) a virtuális gép számára az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="33280-160">If the IP address represents a VM, make sure you enable [IP forwarding](#IP-forwarding) in Azure for the VM.</span></span> <span data-ttu-id="33280-161">Ha az IP-cím az Azure Load Balancer belső IP-címét jelöli, győződjön meg arról, hogy minden egyes porthoz, amelyen terheléselosztást kíván végrehajtani, hozzá van rendelve egy terheléselosztási szabály.</span><span class="sxs-lookup"><span data-stu-id="33280-161">If the IP address represents the internal IP address of Azure Load Balancer, make sure you have a matching load balancing rule for each port you wish to load balance.</span></span>|

<span data-ttu-id="33280-162">Az Azure PowerShellben néhány „NextHopType” értéknek különböző neve van:</span><span class="sxs-lookup"><span data-stu-id="33280-162">In Azure PowerShell some of the "NextHopType" values have different names:</span></span>

* <span data-ttu-id="33280-163">A virtuális hálózat a VnetLocal</span><span class="sxs-lookup"><span data-stu-id="33280-163">Virtual Network is VnetLocal</span></span>
* <span data-ttu-id="33280-164">A virtuális hálózati átjáró a VirtualNetworkGateway</span><span class="sxs-lookup"><span data-stu-id="33280-164">Virtual Network Gateway is VirtualNetworkGateway</span></span>
* <span data-ttu-id="33280-165">A virtuális készülék a VirtualAppliance</span><span class="sxs-lookup"><span data-stu-id="33280-165">Virtual Appliance is VirtualAppliance</span></span>
* <span data-ttu-id="33280-166">Az internet az Internet</span><span class="sxs-lookup"><span data-stu-id="33280-166">Internet is Internet</span></span>
* <span data-ttu-id="33280-167">A nincs a Nincs</span><span class="sxs-lookup"><span data-stu-id="33280-167">None is None</span></span>

### <a name="system-routes"></a><span data-ttu-id="33280-168">Rendszerútvonalak</span><span class="sxs-lookup"><span data-stu-id="33280-168">System routes</span></span>
<span data-ttu-id="33280-169">A rendszer a virtuális hálózatban létrehozott összes alhálózatot automatikusan hozzárendeli egy útválasztási táblázathoz, ami az alábbi útválasztási szabályokat tartalmazza:</span><span class="sxs-lookup"><span data-stu-id="33280-169">Every subnet created in a virtual network is automatically associated with a route table that contains the following system route rules:</span></span>

* <span data-ttu-id="33280-170">**Helyi Vnet szabály**: Ez a szabály a virtuális hálózat miden alhálózatában automatikusan létrejön.</span><span class="sxs-lookup"><span data-stu-id="33280-170">**Local Vnet Rule**: This rule is automatically created for every subnet in a virtual network.</span></span> <span data-ttu-id="33280-171">Meghatározza, hogy a virtuális hálózatban a virtuális gépek között közvetlen kapcsolat van, és nincs köztes ugrás.</span><span class="sxs-lookup"><span data-stu-id="33280-171">It specifies that there is a direct link between the VMs in the VNet and there is no intermediate next hop.</span></span>
* <span data-ttu-id="33280-172">**Helyszíni szabály**: Ez a szabály a helyszíni címtartományba irányuló teljes forgalomra érvényes, és VPN-átjárót használ a következő ugrási célként.</span><span class="sxs-lookup"><span data-stu-id="33280-172">**On-premises Rule**: This rule applies to all traffic destined to the on-premises address range and uses VPN gateway as the next hop destination.</span></span>
* <span data-ttu-id="33280-173">**Internet szabály**: Ez a szabály kezeli a nyilvános internet felé irányuló teljes forgalmat (címelőtag 0.0.0.0/0) , és az internetre irányuló forgalomnál az infrastruktúra internetes átjáróját használja következő ugrásként.</span><span class="sxs-lookup"><span data-stu-id="33280-173">**Internet Rule**: This rule handles all traffic destined to the public Internet (address prefix 0.0.0.0/0) and uses the infrastructure internet gateway as the next hop for all traffic destined to the Internet.</span></span>

### <a name="user-defined-routes"></a><span data-ttu-id="33280-174">Felhasználó által megadott útvonalak</span><span class="sxs-lookup"><span data-stu-id="33280-174">User-defined routes</span></span>
<span data-ttu-id="33280-175">A legtöbb környezetben csak az Azure által meghatározott rendszerútvonalakra van szükség.</span><span class="sxs-lookup"><span data-stu-id="33280-175">For most environments you will only need the system routes already defined by Azure.</span></span> <span data-ttu-id="33280-176">Lehetséges azonban, hogy létre kell hoznia egy útválasztási táblázatot, amelyhez bizonyos esetekben hozzá kell adnia egy vagy több útvonalat, ilyenek például:</span><span class="sxs-lookup"><span data-stu-id="33280-176">However, you may need to create a route table and add one or more routes in specific cases, such as:</span></span>

* <span data-ttu-id="33280-177">Kényszerített bújtatás az internetre a helyszíni hálózaton keresztül.</span><span class="sxs-lookup"><span data-stu-id="33280-177">Force tunneling to the Internet via your on-premises network.</span></span>
* <span data-ttu-id="33280-178">Virtuális készülékek használata Azure környezetben.</span><span class="sxs-lookup"><span data-stu-id="33280-178">Use of virtual appliances in your Azure environment.</span></span>

<span data-ttu-id="33280-179">A fenti helyzetekben létre kell hoznia egy útválasztási táblázatot, és hozzá kell adnia felhasználó által meghatározott útvonalakat.</span><span class="sxs-lookup"><span data-stu-id="33280-179">In the scenarios above, you will have to create a route table and add user defined routes to it.</span></span> <span data-ttu-id="33280-180">Egyszerre több útválasztási táblázattal is rendelkezhet, és ugyanazt az útválasztási táblázatot egy vagy több alhálózathoz is hozzá lehet rendelni.</span><span class="sxs-lookup"><span data-stu-id="33280-180">You can have multiple route tables, and the same route table can be associated to one or more subnets.</span></span> <span data-ttu-id="33280-181">És minden alhálózathoz csak egy útválasztási táblázatot lehet hozzárendelni.</span><span class="sxs-lookup"><span data-stu-id="33280-181">And each subnet can only be associated to a single route table.</span></span> <span data-ttu-id="33280-182">Az alhálózat minden virtuális gépe és felhőszolgáltatása ugyanazt az alhálózathoz hozzárendelt útválasztási táblázatot használja.</span><span class="sxs-lookup"><span data-stu-id="33280-182">All VMs and cloud services in a subnet use the route table associated to that subnet.</span></span>

<span data-ttu-id="33280-183">Az alhálózatok egészen addig rendszerútvonalakra támaszkodnak, amíg hozzá nem rendelnek egy útválasztási táblázatot az alhálózathoz.</span><span class="sxs-lookup"><span data-stu-id="33280-183">Subnets rely on system routes until a route table is associated to the subnet.</span></span> <span data-ttu-id="33280-184">Miután egy hozzárendelés létrejött, az útválasztás a felhasználó által megadott útvonalaknál és a rendszerútvonalaknál is a leghosszabb előtag-megfeleltetés (LPM) alapján történik.</span><span class="sxs-lookup"><span data-stu-id="33280-184">Once an association exists, routing is done based on Longest Prefix Match (LPM) among both user defined routes and system routes.</span></span> <span data-ttu-id="33280-185">Ha egynél több útvonal rendelkezik ugyanazzal az LPM megfeleltetéssel, akkor a rendszer az útvonalat a kiindulás alapján választja ki, az alábbi sorrendben:</span><span class="sxs-lookup"><span data-stu-id="33280-185">If there is more than one route with the same LPM match then a route is selected based on its origin in the following order:</span></span>

1. <span data-ttu-id="33280-186">Felhasználó által megadott útvonal</span><span class="sxs-lookup"><span data-stu-id="33280-186">User defined route</span></span>
2. <span data-ttu-id="33280-187">BGP-útvonal (ExpressRoute használatánál)</span><span class="sxs-lookup"><span data-stu-id="33280-187">BGP route (when ExpressRoute is used)</span></span>
3. <span data-ttu-id="33280-188">Rendszerútvonal</span><span class="sxs-lookup"><span data-stu-id="33280-188">System route</span></span>

<span data-ttu-id="33280-189">A felhasználó által megadott útvonalak létrehozásával kapcsolatban tekintse meg a [How to Create Routes and Enable IP Forwarding in Azure](virtual-network-create-udr-arm-template.md) (Hogyan hozhat létre útvonalakat, és engedélyezheti az IP-továbbítást az Azure-ban) című cikket.</span><span class="sxs-lookup"><span data-stu-id="33280-189">To learn how to create user defined routes, see [How to Create Routes and Enable IP Forwarding in Azure](virtual-network-create-udr-arm-template.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="33280-190">A rendszer a felhasználó által megadott útvonalakat csak az Azure virtuális gépekre és felhőszolgáltatásokra alkalmazza.</span><span class="sxs-lookup"><span data-stu-id="33280-190">User defined routes are only applied to Azure VMs and cloud services.</span></span> <span data-ttu-id="33280-191">Ha például virtuális készülékként egy tűzfalat szeretne beiktatni a helyszíni hálózat és az Azure közé, létre kell hoznia egy felhasználó által megadott útvonalat az Azure útválasztási táblázatban, amely a helyszíni címtérre irányuló teljes forgalmat a virtuális készülékre továbbítja.</span><span class="sxs-lookup"><span data-stu-id="33280-191">For instance, if you want to add a firewall virtual appliance between your on-premises network and Azure, you will have to create a user defined route for your Azure route tables that forwards all traffic going to the on-premises address space to the virtual appliance.</span></span> <span data-ttu-id="33280-192">Hozzáadhat egy felhasználó által megadott útvonalat a GatewaySubnet alhálózathoz, így az összes helyszíni forgalmat továbbíthatja az Azure-ba a virtuális készüléken keresztül.</span><span class="sxs-lookup"><span data-stu-id="33280-192">You can also add a user defined route (UDR) to the GatewaySubnet to forward all traffic from on-premises to Azure through the virtual appliance.</span></span> <span data-ttu-id="33280-193">Ez a lehetőség a közelmúltban lett hozzáadva.</span><span class="sxs-lookup"><span data-stu-id="33280-193">This is a recent addition.</span></span>
> 
> 

### <a name="bgp-routes"></a><span data-ttu-id="33280-194">BGP-útvonalak</span><span class="sxs-lookup"><span data-stu-id="33280-194">BGP routes</span></span>
<span data-ttu-id="33280-195">Ha a helyszíni hálózat és az Azure között ExpressRoute kapcsolat van, akkor engedélyezni lehet a BGP-t, hogy az útvonalakat a helyszíni hálózatból az Azure-ba terjessze.</span><span class="sxs-lookup"><span data-stu-id="33280-195">If you have an ExpressRoute connection between your on-premises network and Azure, you can enable BGP to propagate routes from your on-premises network to Azure.</span></span> <span data-ttu-id="33280-196">A BGP-útvonalakat minden Azure alhálózatban ugyanúgy kell használni, mint a rendszerútvonalakat és a felhasználó által megadott útvonalakat.</span><span class="sxs-lookup"><span data-stu-id="33280-196">These BGP routes are used in the same way as system routes and user defined routes in each Azure subnet.</span></span> <span data-ttu-id="33280-197">További információ: [ExpressRoute Introduction](../expressroute/expressroute-introduction.md) (Az ExpressRoute bemutatása).</span><span class="sxs-lookup"><span data-stu-id="33280-197">For more information see [ExpressRoute Introduction](../expressroute/expressroute-introduction.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="33280-198">Az Azure környezetet a helyszíni hálózaton keresztül lehet úgy konfigurálni, hogy kényszerített bújtatást használjon. Ehhez létre kell hozni egy felhasználó által megadott útvonalat a 0.0.0.0/0 alhálózat számára, amely a VPN-átjárót használja következő ugrásként.</span><span class="sxs-lookup"><span data-stu-id="33280-198">You can configure your Azure environment to use force tunneling through your on-premises network by creating a user defined route for subnet 0.0.0.0/0 that uses the VPN gateway as the next hop.</span></span> <span data-ttu-id="33280-199">Ez azonban csak akkor működik, ha VPN-átjárót használ, nem ExpressRoute-ot.</span><span class="sxs-lookup"><span data-stu-id="33280-199">However, this only works if you are using a VPN gateway, not ExpressRoute.</span></span> <span data-ttu-id="33280-200">Az ExpressRoute-nál a kényszerített bújtatás konfigurálása a BGP-n keresztül történik.</span><span class="sxs-lookup"><span data-stu-id="33280-200">For ExpressRoute, forced tunneling is configured through BGP.</span></span>
> 
> 

## <a name="ip-forwarding"></a><span data-ttu-id="33280-201">IP-továbbítás</span><span class="sxs-lookup"><span data-stu-id="33280-201">IP forwarding</span></span>
<span data-ttu-id="33280-202">A fent leírtak szerint a felhasználó által megadott útvonal létrehozásának egyik fő oka a forgalom virtuális készülékre történő továbbítása.</span><span class="sxs-lookup"><span data-stu-id="33280-202">As described above, one of the main reasons to create a user defined route is to forward traffic to a virtual appliance.</span></span> <span data-ttu-id="33280-203">A virtuális készülék nem más, mint egy virtuális gép, amelyen egy olyan alkalmazás fut, ami a hálózati forgalmat kezeli valamilyen módon, például tűzfallal vagy NAT-eszközzel.</span><span class="sxs-lookup"><span data-stu-id="33280-203">A virtual appliance is nothing more than a VM that runs an application used to handle network traffic in some way, such as a firewall or a NAT device.</span></span>

<span data-ttu-id="33280-204">A virtuális készüléknek képesnek kell lennie fogadni a nem neki címzett bejövő forgalmat.</span><span class="sxs-lookup"><span data-stu-id="33280-204">This virtual appliance VM must be able to receive incoming traffic that is not addressed to itself.</span></span> <span data-ttu-id="33280-205">Ahhoz, hogy egy virtuális gép számára engedélyezze a más célhelyre irányított forgalom fogadását, először engedélyeznie kell a virtuális gép számára az IP-továbbítást.</span><span class="sxs-lookup"><span data-stu-id="33280-205">To allow a VM to receive traffic addressed to other destinations, you must enable IP Forwarding for the VM.</span></span> <span data-ttu-id="33280-206">Ez egy Azure beállítás, nem a vendég operációs rendszer beállítása.</span><span class="sxs-lookup"><span data-stu-id="33280-206">This is an Azure setting, not a setting in the guest operating system.</span></span>

## <a name="next-steps"></a><span data-ttu-id="33280-207">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="33280-207">Next steps</span></span>
* <span data-ttu-id="33280-208">Ismerje meg, hogyan [hozhat létre útvonalakat a Resource Manager üzembe helyezési modellben](virtual-network-create-udr-arm-template.md), és hogyan rendelheti őket hozzá az alhálózatokhoz.</span><span class="sxs-lookup"><span data-stu-id="33280-208">Learn how to [create routes in the Resource Manager deployment model](virtual-network-create-udr-arm-template.md) and associate them to subnets.</span></span> 
* <span data-ttu-id="33280-209">Ismerje meg, hogyan [hozhat létre útvonalakat a klasszikus üzembe helyezési modellben](virtual-network-create-udr-classic-ps.md), és hogyan rendelheti őket hozzá az alhálózatokhoz.</span><span class="sxs-lookup"><span data-stu-id="33280-209">Learn how to [create routes in the classic deployment model](virtual-network-create-udr-classic-ps.md) and associate them to subnets.</span></span>

