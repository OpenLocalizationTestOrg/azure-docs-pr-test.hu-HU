---
title: "Egy felhőalapú szolgáltatás frissítése |} Microsoft Docs"
description: "Útmutató az Azure felhőszolgáltatások frissítése. Ismerje meg, hogyan egy frissítés egy felhőalapú szolgáltatás rendelkezésre állásának biztosításához folytatódik."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 2ba9676ed2afce7f18446642527971f5001b5ca7
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-update-a-cloud-service"></a><span data-ttu-id="6df60-104">Egy felhőalapú szolgáltatás frissítése</span><span class="sxs-lookup"><span data-stu-id="6df60-104">How to update a cloud service</span></span>

<span data-ttu-id="6df60-105">Frissítés egy felhőalapú szolgáltatás, beleértve a szerepkörök és a vendég operációs rendszer, akkor a három lépésben.</span><span class="sxs-lookup"><span data-stu-id="6df60-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="6df60-106">Először a bináris fájljait és a konfigurációs fájlokat az új felhőalapú szolgáltatás vagy az operációs rendszer verziója fel kell tölteni.</span><span class="sxs-lookup"><span data-stu-id="6df60-106">First, the binaries and configuration files for the new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="6df60-107">A következő Azure számítási és hálózati erőforrásokat a felhőalapú szolgáltatás, az új felhőalapú szolgáltatás verzió követelményei alapján foglalja le.</span><span class="sxs-lookup"><span data-stu-id="6df60-107">Next, Azure reserves compute and network resources for the cloud service based on the requirements of the new cloud service version.</span></span> <span data-ttu-id="6df60-108">Végül az Azure-ban a működés közbeni frissítés Növekményesen frissíteni a bérlő az új verzióra, vagy a vendég operációs rendszer, a rendelkezésre állás megőrzése mellett.</span><span class="sxs-lookup"><span data-stu-id="6df60-108">Finally, Azure performs a rolling upgrade to incrementally update the tenant to the new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="6df60-109">Ez a cikk ismerteti, amelyek ezen utolsó lépésében – a működés közbeni frissítés részletes adatait.</span><span class="sxs-lookup"><span data-stu-id="6df60-109">This article discusses the details of this last step – the rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="6df60-110">Frissítés az Azure-szolgáltatások</span><span class="sxs-lookup"><span data-stu-id="6df60-110">Update an Azure Service</span></span>
<span data-ttu-id="6df60-111">Azure rendezi a szerepkörpéldányok frissítési tartományok (UD) nevű logikai csoportosítással.</span><span class="sxs-lookup"><span data-stu-id="6df60-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="6df60-112">Frissítési tartományok (UD), amelyeket logikai szerepkörpéldányt beállítani, hogy a csoport frissítése.</span><span class="sxs-lookup"><span data-stu-id="6df60-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="6df60-113">Az Azure töröl egy felhőalapú szolgáltatás egy UD egyszerre, így példányok más UDs szolgál a forgalom a folytatáshoz.</span><span class="sxs-lookup"><span data-stu-id="6df60-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs to continue serving traffic.</span></span>

<span data-ttu-id="6df60-114">Az alapértelmezett frissítési tartományok száma érték az 5.</span><span class="sxs-lookup"><span data-stu-id="6df60-114">The default number of upgrade domains is 5.</span></span> <span data-ttu-id="6df60-115">A szolgáltatás definíciós fájl (.csdef) belefoglalja a upgradeDomainCount attribútum különböző hány frissítési tartományt is megadhat.</span><span class="sxs-lookup"><span data-stu-id="6df60-115">You can specify a different number of upgrade domains by including the upgradeDomainCount attribute in the service’s definition file (.csdef).</span></span> <span data-ttu-id="6df60-116">A upgradeDomainCount attribútum kapcsolatos további információkért lásd: [webrole típusról séma](https://msdn.microsoft.com/library/azure/gg557553.aspx) vagy [WorkerRole séma](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span><span class="sxs-lookup"><span data-stu-id="6df60-116">For more information about the upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="6df60-117">A szolgáltatás egy vagy több szerepkör helybeni frissítést hajt végre, amikor Azure frissítések beállítása szerint a frissítési tartomány, amelyhez tartoznak szerepkörpéldányt beállítani.</span><span class="sxs-lookup"><span data-stu-id="6df60-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according to the upgrade domain to which they belong.</span></span> <span data-ttu-id="6df60-118">Azure-példánya a megadott frissítési tartomány – leállítása, frissítése, állapotba hozza őket az összes online – biztonsági frissítések, a következő tartomány helyezi.</span><span class="sxs-lookup"><span data-stu-id="6df60-118">Azure updates all of the instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto the next domain.</span></span> <span data-ttu-id="6df60-119">Csak a jelenlegi frissítési tartománya futó példányok leállításával Azure gondoskodik arról, hogy egy frissítés során fordul elő a lehető legkisebb hatással legyen a futó szolgáltatásokra.</span><span class="sxs-lookup"><span data-stu-id="6df60-119">By stopping only the instances running in the current upgrade domain, Azure makes sure that an update occurs with the least possible impact to the running service.</span></span> <span data-ttu-id="6df60-120">További információkért lásd: [hogyan eltérő lehet a frissítés](#howanupgradeproceeds) című cikkben.</span><span class="sxs-lookup"><span data-stu-id="6df60-120">For more information, see [How the update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="6df60-121">A feltételek során **frissítése** és **frissítése** némileg eltérő jelentéssel bírnak az Azure környezetben, akkor felcserélhetők a folyamatok és a jelen dokumentum a szolgáltatások leírása.</span><span class="sxs-lookup"><span data-stu-id="6df60-121">While the terms **update** and **upgrade** have slightly different meaning in the context Azure, they can be used interchangeably for the processes and descriptions of the features in this document.</span></span>
>
>

<span data-ttu-id="6df60-122">A szolgáltatás meg kell adnia legalább két példánya egy adott szerepkör frissítenie kell a helyszíni állásidő nélkül.</span><span class="sxs-lookup"><span data-stu-id="6df60-122">Your service must define at least two instances of a role for that role to be updated in-place without downtime.</span></span> <span data-ttu-id="6df60-123">Ha a szolgáltatás egy szerepkörnek csak egy példánya, a szolgáltatás nem lehet a helyben frissítés befejeződött.</span><span class="sxs-lookup"><span data-stu-id="6df60-123">If the service consists of only one instance of one role, your service will be unavailable until the in-place update has finished.</span></span>

<span data-ttu-id="6df60-124">Ez a témakör ismerteti az Azure-hírt kapcsolatos alábbi információkat:</span><span class="sxs-lookup"><span data-stu-id="6df60-124">This topic covers the following information about Azure updates:</span></span>

* [<span data-ttu-id="6df60-125">A szolgáltatás módosítása engedélyezett frissítése közben</span><span class="sxs-lookup"><span data-stu-id="6df60-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="6df60-126">Hogyan egy frissítés előrehalad az</span><span class="sxs-lookup"><span data-stu-id="6df60-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="6df60-127">Frissítés visszaállítása</span><span class="sxs-lookup"><span data-stu-id="6df60-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="6df60-128">Az egy folyamatban lévő telepítés több mutating művelet kezdeményezése</span><span class="sxs-lookup"><span data-stu-id="6df60-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="6df60-129">Kapcsolódó szerepkörök frissítési tartományok között</span><span class="sxs-lookup"><span data-stu-id="6df60-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="6df60-130">A szolgáltatás módosítása engedélyezett frissítése közben</span><span class="sxs-lookup"><span data-stu-id="6df60-130">Allowed service changes during an update</span></span>
<span data-ttu-id="6df60-131">Az alábbi táblázat az engedélyezett végrehajtott módosításokat a frissítés közben:</span><span class="sxs-lookup"><span data-stu-id="6df60-131">The following table shows the allowed changes to a service during an update:</span></span>

| <span data-ttu-id="6df60-132">Üzemeltetési, szolgáltatások és szerepkörök engedélyezi a módosításokat</span><span class="sxs-lookup"><span data-stu-id="6df60-132">Changes permitted to hosting, services, and roles</span></span> | <span data-ttu-id="6df60-133">Frissítés helyben</span><span class="sxs-lookup"><span data-stu-id="6df60-133">In-place update</span></span> | <span data-ttu-id="6df60-134">Előkészített (virtuális IP-címcsere)</span><span class="sxs-lookup"><span data-stu-id="6df60-134">Staged (VIP swap)</span></span> | <span data-ttu-id="6df60-135">Törölje és hozza létre</span><span class="sxs-lookup"><span data-stu-id="6df60-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="6df60-136">Operációs rendszer verziója</span><span class="sxs-lookup"><span data-stu-id="6df60-136">Operating system version</span></span> |<span data-ttu-id="6df60-137">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-137">Yes</span></span> |<span data-ttu-id="6df60-138">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-138">Yes</span></span> |<span data-ttu-id="6df60-139">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-139">Yes</span></span> |
| <span data-ttu-id="6df60-140">.NET megbízhatósági szintjét.</span><span class="sxs-lookup"><span data-stu-id="6df60-140">.NET trust level</span></span> |<span data-ttu-id="6df60-141">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-141">Yes</span></span> |<span data-ttu-id="6df60-142">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-142">Yes</span></span> |<span data-ttu-id="6df60-143">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-143">Yes</span></span> |
| <span data-ttu-id="6df60-144">Virtuálisgép-méret<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="6df60-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="6df60-145">Igen<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="6df60-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="6df60-146">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-146">Yes</span></span> |<span data-ttu-id="6df60-147">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-147">Yes</span></span> |
| <span data-ttu-id="6df60-148">Helyi tárolási beállításai</span><span class="sxs-lookup"><span data-stu-id="6df60-148">Local storage settings</span></span> |<span data-ttu-id="6df60-149">Csak növelése<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="6df60-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="6df60-150">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-150">Yes</span></span> |<span data-ttu-id="6df60-151">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-151">Yes</span></span> |
| <span data-ttu-id="6df60-152">Hozzáadása vagy eltávolítása a szerepkörök szolgáltatás</span><span class="sxs-lookup"><span data-stu-id="6df60-152">Add or remove roles in a service</span></span> |<span data-ttu-id="6df60-153">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-153">Yes</span></span> |<span data-ttu-id="6df60-154">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-154">Yes</span></span> |<span data-ttu-id="6df60-155">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-155">Yes</span></span> |
| <span data-ttu-id="6df60-156">Egy adott szerepkör példányainak száma</span><span class="sxs-lookup"><span data-stu-id="6df60-156">Number of instances of a particular role</span></span> |<span data-ttu-id="6df60-157">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-157">Yes</span></span> |<span data-ttu-id="6df60-158">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-158">Yes</span></span> |<span data-ttu-id="6df60-159">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-159">Yes</span></span> |
| <span data-ttu-id="6df60-160">Vagy a szolgáltatás végpontjainak típus</span><span class="sxs-lookup"><span data-stu-id="6df60-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="6df60-161">Igen<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="6df60-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="6df60-162">Nem</span><span class="sxs-lookup"><span data-stu-id="6df60-162">No</span></span> |<span data-ttu-id="6df60-163">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-163">Yes</span></span> |
| <span data-ttu-id="6df60-164">Neveit és értékeit a konfigurációs beállítások</span><span class="sxs-lookup"><span data-stu-id="6df60-164">Names and values of configuration settings</span></span> |<span data-ttu-id="6df60-165">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-165">Yes</span></span> |<span data-ttu-id="6df60-166">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-166">Yes</span></span> |<span data-ttu-id="6df60-167">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-167">Yes</span></span> |
| <span data-ttu-id="6df60-168">Értékek (de nem nevek) a konfigurációs beállítások</span><span class="sxs-lookup"><span data-stu-id="6df60-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="6df60-169">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-169">Yes</span></span> |<span data-ttu-id="6df60-170">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-170">Yes</span></span> |<span data-ttu-id="6df60-171">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-171">Yes</span></span> |
| <span data-ttu-id="6df60-172">Hozzáadhat új tanúsítványokat</span><span class="sxs-lookup"><span data-stu-id="6df60-172">Add new certificates</span></span> |<span data-ttu-id="6df60-173">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-173">Yes</span></span> |<span data-ttu-id="6df60-174">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-174">Yes</span></span> |<span data-ttu-id="6df60-175">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-175">Yes</span></span> |
| <span data-ttu-id="6df60-176">Meglévő tanúsítványok módosítása</span><span class="sxs-lookup"><span data-stu-id="6df60-176">Change existing certificates</span></span> |<span data-ttu-id="6df60-177">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-177">Yes</span></span> |<span data-ttu-id="6df60-178">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-178">Yes</span></span> |<span data-ttu-id="6df60-179">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-179">Yes</span></span> |
| <span data-ttu-id="6df60-180">Új kód telepítése</span><span class="sxs-lookup"><span data-stu-id="6df60-180">Deploy new code</span></span> |<span data-ttu-id="6df60-181">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-181">Yes</span></span> |<span data-ttu-id="6df60-182">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-182">Yes</span></span> |<span data-ttu-id="6df60-183">Igen</span><span class="sxs-lookup"><span data-stu-id="6df60-183">Yes</span></span> |

<span data-ttu-id="6df60-184"><sup>1</sup> méretének módosítása a felhőalapú szolgáltatáshoz elérhető méretek részhalmazát korlátozódik.</span><span class="sxs-lookup"><span data-stu-id="6df60-184"><sup>1</sup> Size change limited to the subset of sizes available for the cloud service.</span></span>

<span data-ttu-id="6df60-185"><sup>2</sup> szükséges Azure SDK 1.5 vagy újabb verzió.</span><span class="sxs-lookup"><span data-stu-id="6df60-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="6df60-186">A virtuális gép méretének módosítása törlődnek a helyi adatokat.</span><span class="sxs-lookup"><span data-stu-id="6df60-186">Changing the virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="6df60-187">A következő elemek nem támogatottak a frissítés közben:</span><span class="sxs-lookup"><span data-stu-id="6df60-187">The following items are not supported during an update:</span></span>

* <span data-ttu-id="6df60-188">A szerepkör nevének módosítása.</span><span class="sxs-lookup"><span data-stu-id="6df60-188">Changing the name of a role.</span></span> <span data-ttu-id="6df60-189">Távolítsa el, és adja hozzá a szerepkört az új nevet.</span><span class="sxs-lookup"><span data-stu-id="6df60-189">Remove and then add the role with the new name.</span></span>
* <span data-ttu-id="6df60-190">A frissítési tartományok számának módosításához.</span><span class="sxs-lookup"><span data-stu-id="6df60-190">Changing of the Upgrade Domain count.</span></span>
* <span data-ttu-id="6df60-191">A helyi erőforrások méretének csökkentésével.</span><span class="sxs-lookup"><span data-stu-id="6df60-191">Decreasing the size of the local resources.</span></span>

<span data-ttu-id="6df60-192">Ha a szolgáltatás-definíció, például a helyi erőforrás méretének csökkentésével kapcsolatos egyéb frissítésekről a VIP-csere frissítése helyette kell elvégeznie.</span><span class="sxs-lookup"><span data-stu-id="6df60-192">If you are making other updates to your service's definition, such as decreasing the size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="6df60-193">További információkért lásd: [felcserélése telepítési](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span><span class="sxs-lookup"><span data-stu-id="6df60-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="6df60-194">Hogyan egy frissítés előrehalad az</span><span class="sxs-lookup"><span data-stu-id="6df60-194">How an upgrade proceeds</span></span>
<span data-ttu-id="6df60-195">Eldöntheti, hogy szeretné-e frissíti az összes, a szerepkörök, a szolgáltatás vagy a szolgáltatás egyetlen szerepkör.</span><span class="sxs-lookup"><span data-stu-id="6df60-195">You can decide whether you want to update all of the roles in your service or a single role in the service.</span></span> <span data-ttu-id="6df60-196">Mindkét esetben minden frissítés alatt áll, és ugyanahhoz az első frissítési tartomány szerepkör példányainak leállt, frissítése, és automatikusan visszaáll online állapotba.</span><span class="sxs-lookup"><span data-stu-id="6df60-196">In either case, all instances of each role that is being upgraded and belong to the first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="6df60-197">Miután ismét online állapotban, a második frissítési tartomány a példányok leállt, frissítése, és automatikusan visszaáll online állapotba.</span><span class="sxs-lookup"><span data-stu-id="6df60-197">Once they are back online, the instances in the second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="6df60-198">Egy felhőalapú szolgáltatás lehet aktív egyszerre legfeljebb egy frissítés.</span><span class="sxs-lookup"><span data-stu-id="6df60-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="6df60-199">Mindig megtörténik a frissítés a legújabb verzióra a felhőalapú szolgáltatás ellen.</span><span class="sxs-lookup"><span data-stu-id="6df60-199">The upgrade is always performed against the latest version of the cloud service.</span></span>

<span data-ttu-id="6df60-200">A következő diagram azt ábrázolja, hogyan a frissítés előrehalad az összes szolgáltatási szerepkör frissítése esetén:</span><span class="sxs-lookup"><span data-stu-id="6df60-200">The following diagram illustrates how the upgrade proceeds if you are upgrading all of the roles in the service:</span></span>

<span data-ttu-id="6df60-201">![Service frissítése](media/cloud-services-update-azure-service/IC345879.png "service frissítése")</span><span class="sxs-lookup"><span data-stu-id="6df60-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="6df60-202">A következő diagram azt ábrázolja, hogyan lehet a frissítés, hogy csak egy szerepkör frissíti:</span><span class="sxs-lookup"><span data-stu-id="6df60-202">This next diagram illustrates how the update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="6df60-203">![Frissítési szerepkör](media/cloud-services-update-azure-service/IC345880.png "frissítési szerepkör")</span><span class="sxs-lookup"><span data-stu-id="6df60-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="6df60-204">Az automatikus frissítése közben a Azure Fabric Controller rendszeresen kiértékeli a felhőszolgáltatással az határozható meg, hogy biztonságosan ismerteti a következő UD állapotát.</span><span class="sxs-lookup"><span data-stu-id="6df60-204">During an automatic update, the Azure Fabric Controller periodically evaluates the health of the cloud service to determine when it’s safe to walk the next UD.</span></span> <span data-ttu-id="6df60-205">Az állapot kiértékelésekor szerepkör alapon történik, és úgy ítéli meg, csak a legújabb verzió (azaz példányok, amely már telefonon UDs) példányokat.</span><span class="sxs-lookup"><span data-stu-id="6df60-205">This health evaluation is performed on a per-role basis and considers only instances in the latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="6df60-206">Ellenőrzi, hogy a szerepkörpéldányok, az egyes szerepkörökhöz minimális száma elérte a kielégítő terminál állapotba.</span><span class="sxs-lookup"><span data-stu-id="6df60-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="6df60-207">Szerepkör példány Start időtúllépés</span><span class="sxs-lookup"><span data-stu-id="6df60-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="6df60-208">A Fabric Controller Várjon 30 perc minden szerepkörpéldányhoz állapotot elérni a elindítva.</span><span class="sxs-lookup"><span data-stu-id="6df60-208">The Fabric Controller will wait 30 minutes for each role instance to reach a Started state.</span></span> <span data-ttu-id="6df60-209">Ha az időkorlát tartama eltelte után a Fabric Controller továbbra is a következő szerepkör-példányra érdekében.</span><span class="sxs-lookup"><span data-stu-id="6df60-209">If the timeout duration elapses, the Fabric Controller will continue walking to the next role instance.</span></span>

### <a name="impact-to-drive-data-during-cloud-service-upgrades"></a><span data-ttu-id="6df60-210">Frissíti a meghajtó adatainak során a felhőalapú szolgáltatás gyakorolt hatás</span><span class="sxs-lookup"><span data-stu-id="6df60-210">Impact to drive data during Cloud Service upgrades</span></span>

<span data-ttu-id="6df60-211">A szolgáltatás a egyetlen példányából származó több példány való frissítéskor a szolgáltatás kerül a szolgáltatásokat milyen módon Azure frissítések miatt megtörténik a frissítés során.</span><span class="sxs-lookup"><span data-stu-id="6df60-211">When upgrading a service from a single instance to multiple instances your service will be brought down while the upgrade is performed due to the way Azure upgrades services.</span></span> <span data-ttu-id="6df60-212">A szolgáltatás szolgáltatásiszint-szerződés garanciavállaló szolgáltatás rendelkezésre állása csak érvényes, ha egynél több példánya telepített szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="6df60-212">The service level agreement guaranteeing service availability only applies to services that are deployed with more than one instance.</span></span> <span data-ttu-id="6df60-213">Az alábbi lista ismerteti, hogyan befolyásolják az egyes Azure-szolgáltatások frissítési forgatókönyv minden meghajtón található adatokat:</span><span class="sxs-lookup"><span data-stu-id="6df60-213">The following list describes how the data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="6df60-214">Forgatókönyv</span><span class="sxs-lookup"><span data-stu-id="6df60-214">Scenario</span></span>|<span data-ttu-id="6df60-215">C meghajtó</span><span class="sxs-lookup"><span data-stu-id="6df60-215">C Drive</span></span>|<span data-ttu-id="6df60-216">D meghajtó</span><span class="sxs-lookup"><span data-stu-id="6df60-216">D Drive</span></span>|<span data-ttu-id="6df60-217">E meghajtó</span><span class="sxs-lookup"><span data-stu-id="6df60-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="6df60-218">Virtuális gép újraindítása</span><span class="sxs-lookup"><span data-stu-id="6df60-218">VM reboot</span></span>|<span data-ttu-id="6df60-219">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-219">Preserved</span></span>|<span data-ttu-id="6df60-220">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-220">Preserved</span></span>|<span data-ttu-id="6df60-221">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-221">Preserved</span></span>|
|<span data-ttu-id="6df60-222">Portál újraindítás</span><span class="sxs-lookup"><span data-stu-id="6df60-222">Portal reboot</span></span>|<span data-ttu-id="6df60-223">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-223">Preserved</span></span>|<span data-ttu-id="6df60-224">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-224">Preserved</span></span>|<span data-ttu-id="6df60-225">Megsemmisül</span><span class="sxs-lookup"><span data-stu-id="6df60-225">Destroyed</span></span>|
|<span data-ttu-id="6df60-226">Lemezkép-visszaállítási portál</span><span class="sxs-lookup"><span data-stu-id="6df60-226">Portal reimage</span></span>|<span data-ttu-id="6df60-227">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-227">Preserved</span></span>|<span data-ttu-id="6df60-228">Megsemmisül</span><span class="sxs-lookup"><span data-stu-id="6df60-228">Destroyed</span></span>|<span data-ttu-id="6df60-229">Megsemmisül</span><span class="sxs-lookup"><span data-stu-id="6df60-229">Destroyed</span></span>|
|<span data-ttu-id="6df60-230">Frissítés helyben</span><span class="sxs-lookup"><span data-stu-id="6df60-230">In-Place Upgrade</span></span>|<span data-ttu-id="6df60-231">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-231">Preserved</span></span>|<span data-ttu-id="6df60-232">Megőrzi</span><span class="sxs-lookup"><span data-stu-id="6df60-232">Preserved</span></span>|<span data-ttu-id="6df60-233">Megsemmisül</span><span class="sxs-lookup"><span data-stu-id="6df60-233">Destroyed</span></span>|
|<span data-ttu-id="6df60-234">Csomópont áttelepítése</span><span class="sxs-lookup"><span data-stu-id="6df60-234">Node migration</span></span>|<span data-ttu-id="6df60-235">Megsemmisül</span><span class="sxs-lookup"><span data-stu-id="6df60-235">Destroyed</span></span>|<span data-ttu-id="6df60-236">Megsemmisül</span><span class="sxs-lookup"><span data-stu-id="6df60-236">Destroyed</span></span>|<span data-ttu-id="6df60-237">Megsemmisül</span><span class="sxs-lookup"><span data-stu-id="6df60-237">Destroyed</span></span>|

<span data-ttu-id="6df60-238">Vegye figyelembe, hogy a fenti listában, a E: meghajtót jelenti. a szerepkör gyökérmeghajtóján, és nem lehet változtatható.</span><span class="sxs-lookup"><span data-stu-id="6df60-238">Note that, in the above list, the E: drive represents the role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="6df60-239">Ehelyett használja a **RoleRoot %** környezeti változót határoz meg a meghajtót.</span><span class="sxs-lookup"><span data-stu-id="6df60-239">Instead, use the **%RoleRoot%** environment variable to represent the drive.</span></span>

<span data-ttu-id="6df60-240">Az állásidő minimálisra csökkentése érdekében, egy egypéldányos szolgáltatás frissítésekor, új többpéldányos szolgáltatás központi telepítése az átmeneti kiszolgálón, és végezze el a virtuális IP-címcsere.</span><span class="sxs-lookup"><span data-stu-id="6df60-240">To minimize the downtime when upgrading a single-instance service, deploy a new multi-instance service to the staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="6df60-241">Frissítés visszaállítása</span><span class="sxs-lookup"><span data-stu-id="6df60-241">Rollback of an update</span></span>
<span data-ttu-id="6df60-242">Azure frissítés közben szolgáltatások kezelése azáltal, hogy kezdeményezni egy szolgáltatás, további műveleteket, miután a kezdeti frissítési kérelem elfogadta a Azure Fabric Controller rugalmasságot biztosít.</span><span class="sxs-lookup"><span data-stu-id="6df60-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after the initial update request is accepted by the Azure Fabric Controller.</span></span> <span data-ttu-id="6df60-243">Csak akkor hajtható végre a visszaállítást, ha egy frissítés (konfigurációváltozás) vagy a frissítés megtalálható a **folyamatban** állapot az üzemelő példányon.</span><span class="sxs-lookup"><span data-stu-id="6df60-243">A rollback can only be performed when an update (configuration change) or upgrade is in the **in progress** state on the deployment.</span></span> <span data-ttu-id="6df60-244">Egy frissítést, illetve tekinthető folyamatban mindaddig, amíg a szolgáltatás, amely még nincs frissítve az új verzióra legalább egy példánya.</span><span class="sxs-lookup"><span data-stu-id="6df60-244">An update or upgrade is considered to be in-progress as long as there is at least one instance of the service which has not yet been updated to the new version.</span></span> <span data-ttu-id="6df60-245">Annak megállapítására, hogy a visszaállítás engedélyezett, ellenőrizze a RollbackAllowed jelző által visszaadott értékének [első központi telepítési](https://msdn.microsoft.com/library/azure/ee460804.aspx) és [felhőalapú szolgáltatás tulajdonságainak beolvasása](https://msdn.microsoft.com/library/azure/ee460806.aspx) műveletek, értéke TRUE.</span><span class="sxs-lookup"><span data-stu-id="6df60-245">To test whether a rollback is allowed, check the value of the RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set to true.</span></span>

> [!NOTE]
> <span data-ttu-id="6df60-246">Csak az így visszaállítási hívni egy **helyben** frissítési vagy verziófrissítési, mert a VIP-csere frissítéseket tartalmaz, amely a szolgáltatás egy teljes futó példányát cseréje egy másik.</span><span class="sxs-lookup"><span data-stu-id="6df60-246">It only makes sense to call Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="6df60-247">A folyamatban lévő frissítés visszaállítása a következő hatásai vannak az üzemelő példányon rendelkezik:</span><span class="sxs-lookup"><span data-stu-id="6df60-247">Rollback of an in-progress update has the following effects on the deployment:</span></span>

* <span data-ttu-id="6df60-248">Bármely szerepkörpéldányok, amelyen korábban még nem frissített vagy új verzióra frissíteni nem frissítése vagy frissítés, mert azokat a példányokat már fut a szolgáltatás a cél verzióját.</span><span class="sxs-lookup"><span data-stu-id="6df60-248">Any role instances which had not yet been updated or upgraded to the new version are not updated or upgraded, because those instances are already running the target version of the service.</span></span>
* <span data-ttu-id="6df60-249">A szerepkör-példányok rendelkezett már frissítése vagy a service-csomag új verzióra frissíteni (\*.cspkg) fájl vagy a szolgáltatás konfigurációs (\*.cscfg) fájl (vagy mindkét fájl) ezeket a fájlokat a frissítés előtti verzióját állnak vissza.</span><span class="sxs-lookup"><span data-stu-id="6df60-249">Any role instances which had already been updated or upgraded to the new version of the service package (\*.cspkg) file or the service configuration (\*.cscfg) file (or both files) are reverted to the pre-upgrade version of these files.</span></span>

<span data-ttu-id="6df60-250">Ez gyakorlatilag biztosítja a következő szolgáltatásokat:</span><span class="sxs-lookup"><span data-stu-id="6df60-250">This functionally is provided by the following features:</span></span>

* <span data-ttu-id="6df60-251">A [visszaállítási módosítása vagy frissítése](https://msdn.microsoft.com/library/azure/hh403977.aspx) művelet, amely nem hívható meg a konfiguráció frissítése a (meghívásával indított [telepítési konfiguráció módosítása](https://msdn.microsoft.com/library/azure/ee460809.aspx)) vagy a verziófrissítésre (meghívásával indított [ Frissítés telepítési](https://msdn.microsoft.com/library/azure/ee460793.aspx)), amíg a szolgáltatás, amely még nincs frissítve az új verzióra van legalább egy példányát.</span><span class="sxs-lookup"><span data-stu-id="6df60-251">The [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in the service which has not yet been updated to the new version.</span></span>
* <span data-ttu-id="6df60-252">A zárolt elemet, és a RollbackAllowed elem válasz törzsében részeként visszaküldött a [első központi telepítési](https://msdn.microsoft.com/library/azure/ee460804.aspx) és [felhőalapú szolgáltatás tulajdonságainak beolvasása](https://msdn.microsoft.com/library/azure/ee460806.aspx) műveletek:</span><span class="sxs-lookup"><span data-stu-id="6df60-252">The Locked element and the RollbackAllowed element, which are returned as part of the response body of the [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="6df60-253">A zárolt elem észlelés, ha egy mutating művelet a megadott központi telepítés is elindítható teszi lehetővé.</span><span class="sxs-lookup"><span data-stu-id="6df60-253">The Locked element allows you to detect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="6df60-254">A RollbackAllowed elem lehetővé teszi, hogy mikor a [visszaállítás frissítés vagy frissítési](https://msdn.microsoft.com/library/azure/hh403977.aspx) művelet nem hívható meg egy adott központi telepítés a.</span><span class="sxs-lookup"><span data-stu-id="6df60-254">The RollbackAllowed element allows you to detect when the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="6df60-255">A visszaállítás végrehajtásához nincs a zárolt, mind a RollbackAllowed elemek kereséséhez.</span><span class="sxs-lookup"><span data-stu-id="6df60-255">In order to perform a rollback, you do not have to check both the Locked and the RollbackAllowed elements.</span></span> <span data-ttu-id="6df60-256">Elegendő, ha a győződjön meg arról, hogy RollbackAllowed értéke TRUE.</span><span class="sxs-lookup"><span data-stu-id="6df60-256">It suffices to confirm that RollbackAllowed is set to true.</span></span> <span data-ttu-id="6df60-257">Ezek az elemek csak adott vissza, ha ezek a módszerek hívják használata a kérelem fejléc értéke "x-ms-version: 2011-10-01" vagy egy újabb verziója.</span><span class="sxs-lookup"><span data-stu-id="6df60-257">These elements are only returned if these methods are invoked by using the request header set to “x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="6df60-258">Versioning fejlécek kapcsolatos további információkért lásd: [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="6df60-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="6df60-259">Vannak olyan helyzetek, ahol egy frissítést a visszaállítás vagy a frissítés nem támogatott, ezek a következők:</span><span class="sxs-lookup"><span data-stu-id="6df60-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="6df60-260">Helyi erőforrások – Ha a frissítés növeli a helyi erőforrások az Azure platformon szerepkör csökkentése nem engedélyezi a visszaállítása.</span><span class="sxs-lookup"><span data-stu-id="6df60-260">Reduction in local resources - If the update increases the local resources for a role the Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="6df60-261">Sablonkérelem -, ha a frissítési művelet már nem lehet egy vertikális rendelkezik-e elegendő számítási kvótával a visszaállítási művelet befejezéséhez.</span><span class="sxs-lookup"><span data-stu-id="6df60-261">Quota limitations - If the update was a scale down operation you may no longer have sufficient compute quota to complete the rollback operation.</span></span> <span data-ttu-id="6df60-262">Minden Azure-előfizetéssel rendelkezik kvóta társítva, amely meghatározza a maximális számát mag, amely szerint az adott előfizetéshez tartozó összes üzemeltetett szolgáltatás képes használni.</span><span class="sxs-lookup"><span data-stu-id="6df60-262">Each Azure subscription has a quota associated with it that specifies the maximum number of cores which can be consumed by all hosted services that belong to that subscription.</span></span> <span data-ttu-id="6df60-263">A visszaállítás egy adott frissítés végrehajtása után kerülne az előfizetés keresztül kvóta, majd a visszaállítás nem engedélyezhető.</span><span class="sxs-lookup"><span data-stu-id="6df60-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="6df60-264">Versenyhelyzet - Ha a kezdeti frissítése befejeződött, a visszaállítás nincs lehetőség.</span><span class="sxs-lookup"><span data-stu-id="6df60-264">Race condition - If the initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="6df60-265">Ha egy frissítés visszaállításának hasznosak lehetnek példa: Ha az a [frissítés telepítési](https://msdn.microsoft.com/library/azure/ee460793.aspx) művelet átviteli sebességét, ahol a fő helybeni frissítést Azure üzemeltetett szolgáltatás manuális üzemmódban lesz állítva.</span><span class="sxs-lookup"><span data-stu-id="6df60-265">An example of when the rollback of an update might be useful is if you are using the [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode to control the rate at which a major in-place upgrade to your Azure hosted service is rolled out.</span></span>

<span data-ttu-id="6df60-266">A frissítés a bevezetés alatt hívható [frissítés telepítési](https://msdn.microsoft.com/library/azure/ee460793.aspx) manuális üzemmódban és veszik át a frissítési tartományok ismerteti.</span><span class="sxs-lookup"><span data-stu-id="6df60-266">During the rollout of the upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin to walk upgrade domains.</span></span> <span data-ttu-id="6df60-267">Ha bármikor, ahogy figyeli a frissítést, vegye figyelembe az első frissítési tartományok, amely megvizsgálja az egyes szerepkörpéldányokat válaszol, akkor meghívhatja a [visszaállítás frissítés vagy frissítési](https://msdn.microsoft.com/library/azure/hh403977.aspx) marad központi telepítési művelet a példányok kellett még nincsenek frissítve és visszaállítási példányok volt frissítve az előző service-csomag és a konfigurációs érintetlenül.</span><span class="sxs-lookup"><span data-stu-id="6df60-267">If at some point, as you monitor the upgrade, you note some role instances in the first upgrade domains that you examine have become unresponsive, you can call the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on the deployment, which will leave untouched the instances which had not yet been upgraded and rollback instances which had been upgraded to the previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="6df60-268">Az egy folyamatban lévő telepítés több mutating művelet kezdeményezése</span><span class="sxs-lookup"><span data-stu-id="6df60-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="6df60-269">Bizonyos esetekben érdemes lehet egy folyamatban lévő telepítés több egyidejű mutating műveletek kezdeményezésére.</span><span class="sxs-lookup"><span data-stu-id="6df60-269">In some cases you may want to initiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="6df60-270">Például szolgáltatásfrissítés hajthat végre és, amíg a szolgáltatásban, ez a frissítés van megkezdődött, szeretne módosítást bizonyos, például állíthatja vissza a frissítést, egy másik frissítés, vagy akkor törölje a központi telepítést.</span><span class="sxs-lookup"><span data-stu-id="6df60-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want to make some change, e.g. to roll the update back, apply a different update, or even delete the deployment.</span></span> <span data-ttu-id="6df60-271">Egy esetet, ahol erre akkor lehet szükség, ha a szolgáltatás frissítése egy frissített szerepkörpéldányon ismételten összeomlás okozó buggy kódját tartalmazza-e.</span><span class="sxs-lookup"><span data-stu-id="6df60-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance to repeatedly crash.</span></span> <span data-ttu-id="6df60-272">Ebben az esetben az Azure Fabric Controller nem tudnak halad, az alkalmazásában, amelyet frissíteni, mivel a példányok a frissített tartományban elegendő számú kifogástalan.</span><span class="sxs-lookup"><span data-stu-id="6df60-272">In this case, the Azure Fabric Controller will not be able to make progress in applying that upgrade because an insufficient number of instances in the upgraded domain are healthy.</span></span> <span data-ttu-id="6df60-273">Ebben az állapotban nevezzük egy *elakadt a központi telepítési*.</span><span class="sxs-lookup"><span data-stu-id="6df60-273">This state is referred to as a *stuck deployment*.</span></span> <span data-ttu-id="6df60-274">A frissítés visszaállítása vagy egy friss frissítés alkalmazása a sikertelen első keresztül is követően a a központi telepítés egy.</span><span class="sxs-lookup"><span data-stu-id="6df60-274">You can unstick the deployment by rolling back the update or applying a fresh update over top of the failing one.</span></span>

<span data-ttu-id="6df60-275">Miután az Azure Fabric Controller frissítéséhez, vagy frissítse a szolgáltatást az eredeti kérelem érkezett, elindíthatja a későbbi szótárból elemeinek módosítása műveletek.</span><span class="sxs-lookup"><span data-stu-id="6df60-275">Once the initial request to update or upgrade the service has been received by the Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="6df60-276">Ez azt jelenti, hogy nem rendelkezik a kezdeti művelet elvégzéséhez, egy másik mutating művelet megkezdése előtt várjon.</span><span class="sxs-lookup"><span data-stu-id="6df60-276">That is, you do not have to wait for the initial operation to complete before you can start another mutating operation.</span></span>

<span data-ttu-id="6df60-277">A második-frissítési művelet kezdeményezése, amíg az első frissítés folyamatban lévő hasonló a visszaállítási műveletet hajt végre.</span><span class="sxs-lookup"><span data-stu-id="6df60-277">Initiating a second update operation while the first update is ongoing will perform similar to the rollback operation.</span></span> <span data-ttu-id="6df60-278">Ha a második frissítés automatikus üzemmódban van, az első frissítési tartomány lesz frissítve azonnal, valószínűleg vezető példányok nem kapcsolódott ugyanabban az idő több frissítési tartományt.</span><span class="sxs-lookup"><span data-stu-id="6df60-278">If the second update is in automatic mode, the first upgrade domain will be upgraded immediately, possibly leading to instances from multiple upgrade domains being offline at the same point in time.</span></span>

<span data-ttu-id="6df60-279">A mutating műveletek a következők: [telepítési konfiguráció módosítása](https://msdn.microsoft.com/library/azure/ee460809.aspx), [frissítés telepítési](https://msdn.microsoft.com/library/azure/ee460793.aspx), [központi telepítésének állapota](https://msdn.microsoft.com/library/azure/ee460808.aspx), [telepítési törlése ](https://msdn.microsoft.com/library/azure/ee460815.aspx), és [visszaállítási vagy Verziófrissítésekor](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span><span class="sxs-lookup"><span data-stu-id="6df60-279">The mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="6df60-280">Két műveletek [első központi telepítési](https://msdn.microsoft.com/library/azure/ee460804.aspx) és [felhőalapú szolgáltatás tulajdonságainak beolvasása](https://msdn.microsoft.com/library/azure/ee460806.aspx), térjen vissza a zárolt jelzőt, amely képes vizsgálja meg, hogy mutating művelet a megadott központi telepítés is elindítható.</span><span class="sxs-lookup"><span data-stu-id="6df60-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return the Locked flag which can be examined to determine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="6df60-281">Ahhoz, hogy ezek a módszerek a verziója, ami visszaadja a zárolt jelző hívja, be kell kérelemfejléc "x-ms-version: 2011-10-01" vagy egy újabb verziója.</span><span class="sxs-lookup"><span data-stu-id="6df60-281">In order to call the version of these methods which returns the Locked flag, you must set request header to “x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="6df60-282">Versioning fejlécek kapcsolatos további információkért lásd: [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="6df60-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="6df60-283">Kapcsolódó szerepkörök frissítési tartományok között</span><span class="sxs-lookup"><span data-stu-id="6df60-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="6df60-284">Azure példánya egy egyenletesen elosztja a készlet hány frissítési tartományt, a szolgáltatás definíciós (.csdef) fájl részeként állítható be.</span><span class="sxs-lookup"><span data-stu-id="6df60-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of the service definition (.csdef) file.</span></span> <span data-ttu-id="6df60-285">A frissítési tartományok maximális száma: 20, és az alapértelmezett érték 5.</span><span class="sxs-lookup"><span data-stu-id="6df60-285">The max number of upgrade domains is 20 and the default is 5.</span></span> <span data-ttu-id="6df60-286">A szolgáltatásdefiníciós fájl módosításával kapcsolatos további információkért lásd: [Azure szolgáltatás definíciós séma (.csdef fájl)](cloud-services-model-and-package.md#csdef).</span><span class="sxs-lookup"><span data-stu-id="6df60-286">For more information about how to modify the service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="6df60-287">Például ha a szerepkör tíz példánnyal rendelkezik, alapértelmezés szerint minden frissítési tartomány két példányait tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="6df60-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="6df60-288">Ha a szerepkör 14 példánnyal rendelkezik, majd négy a frissítési tartományok három példányokat tartalmazhatják, és ötödik tartomány két tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="6df60-288">If your role has 14 instances, then four of the upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="6df60-289">Frissítési tartományok azonosítják a nulla alapú indexét: az első frissítési tartomány 0 Azonosítót tartalmaz, és a második frissítési tartomány 1 és így tovább Azonosítót.</span><span class="sxs-lookup"><span data-stu-id="6df60-289">Upgrade domains are identified with a zero-based index: the first upgrade domain has an ID of 0, and the second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="6df60-290">A következő ábra bemutatja, hogyan két szerepköröket tartalmazza, mint szolgáltatás terjessze a szolgáltatás két frissítési tartományt határoz meg.</span><span class="sxs-lookup"><span data-stu-id="6df60-290">The following diagram illustrates how a service than contains two roles are distributed when the service defines two upgrade domains.</span></span> <span data-ttu-id="6df60-291">A szolgáltatás fut a webes szerepkör nyolc példányai és a feldolgozói szerepkör kilenc példányai.</span><span class="sxs-lookup"><span data-stu-id="6df60-291">The service is running eight instances of the web role and nine instances of the worker role.</span></span>

<span data-ttu-id="6df60-292">![A frissítési tartományok terjesztési](media/cloud-services-update-azure-service/IC345533.png "frissítési tartományok terjesztése")</span><span class="sxs-lookup"><span data-stu-id="6df60-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="6df60-293">Vegye figyelembe, hogy az Azure vezérlők példányok frissítési tartományok közötti elosztását vezérli.</span><span class="sxs-lookup"><span data-stu-id="6df60-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="6df60-294">Nincs lehetőség a adja meg, melyik tartománya számára kiosztott előfordulások.</span><span class="sxs-lookup"><span data-stu-id="6df60-294">It's not possible to specify which instances are allocated to which domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="6df60-295">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="6df60-295">Next steps</span></span>
[<span data-ttu-id="6df60-296">A Cloud Services felügyelete</span><span class="sxs-lookup"><span data-stu-id="6df60-296">How to Manage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="6df60-297">Felhőszolgáltatások figyelése</span><span class="sxs-lookup"><span data-stu-id="6df60-297">How to Monitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="6df60-298">A Cloud Services Konfigurálása</span><span class="sxs-lookup"><span data-stu-id="6df60-298">How to Configure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
