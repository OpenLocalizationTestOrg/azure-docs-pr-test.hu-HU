---
title: "aaaHandle Felhőszolgáltatás életciklus-események |} Microsoft Docs"
description: "Ismerje meg, hogyan hello életciklusának egy felhőalapú szolgáltatás szerepkör metódus használható a .NET"
services: cloud-services
documentationcenter: .net
author: Thraka
manager: timlt
editor: 
ms.assetid: 39b30acd-57b9-48b7-a7c4-40ea3430e451
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/18/2017
ms.author: adegeo
ms.openlocfilehash: cc0ccc5f055b965202b6e081a6ab72ad5d39b034
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="customize-hello-lifecycle-of-a-web-or-worker-role-in-net"></a><span data-ttu-id="75a4c-103">A .NET webes vagy feldolgozói szerepkör életciklus hello testreszabása</span><span class="sxs-lookup"><span data-stu-id="75a4c-103">Customize hello Lifecycle of a Web or Worker role in .NET</span></span>
<span data-ttu-id="75a4c-104">A feldolgozói szerepkör létrehozásakor kiterjesztheti a hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) osztály, amely metódusokat biztosít az Ön toooverride, amelyek lehetővé teszik események toolifecycle válaszol.</span><span class="sxs-lookup"><span data-stu-id="75a4c-104">When you create a worker role, you extend hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) class which provides methods for you toooverride that let you respond toolifecycle events.</span></span> <span data-ttu-id="75a4c-105">A webes szerepkörök Ez az osztály nem kötelező, így toorespond toolifecycle események kell használni.</span><span class="sxs-lookup"><span data-stu-id="75a4c-105">For web roles this class is optional, so you must use it toorespond toolifecycle events.</span></span>

## <a name="extend-hello-roleentrypoint-class"></a><span data-ttu-id="75a4c-106">Hello RoleEntryPoint osztály</span><span class="sxs-lookup"><span data-stu-id="75a4c-106">Extend hello RoleEntryPoint class</span></span>
<span data-ttu-id="75a4c-107">Hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) osztály tartalmazza a módszereket, amelyek az Azure által meghívott amikor azt **elindul**, **fut**, vagy **leállítja** egy webes vagy feldolgozói szerepkörrel.</span><span class="sxs-lookup"><span data-stu-id="75a4c-107">hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) class includes methods that are called by Azure when it **starts**, **runs**, or **stops** a web or worker role.</span></span> <span data-ttu-id="75a4c-108">Ezen módszerek toomanage szerepkör inicializálása, szerepkör leállítási sorozatok vagy hello végrehajtási szállal hello szerepkör szükség lehet felülbírálni.</span><span class="sxs-lookup"><span data-stu-id="75a4c-108">You can optionally override these methods toomanage role initialization, role shutdown sequences, or hello execution thread of hello role.</span></span> 

<span data-ttu-id="75a4c-109">Amikor bővíti **RoleEntryPoint**, akkor érdemes figyelembe a következő viselkedés hello módszerek hello:</span><span class="sxs-lookup"><span data-stu-id="75a4c-109">When extending **RoleEntryPoint**, you should be aware of hello following behaviors of hello methods:</span></span>

* <span data-ttu-id="75a4c-110">Hello [OnStart](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx) és [OnStop](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) módszerek egy logikai értéket adja vissza, ezért lehetséges tooreturn **hamis** az ezen módszerek.</span><span class="sxs-lookup"><span data-stu-id="75a4c-110">hello [OnStart](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx) and [OnStop](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) methods return a boolean value, so it is possible tooreturn **false** from these methods.</span></span>
  
   <span data-ttu-id="75a4c-111">Ha a kódot adja vissza **hamis**, hello szerepkör folyamat váratlanul megszakadt, bármely leállítási folyamat futtatása nélkül előfordulhat, hogy teljesülnek.</span><span class="sxs-lookup"><span data-stu-id="75a4c-111">If your code returns **false**, hello role process is abruptly terminated, without running any shutdown sequence you may have in place.</span></span> <span data-ttu-id="75a4c-112">Általában kerülendő visszaadó **hamis** a hello **OnStart** metódust.</span><span class="sxs-lookup"><span data-stu-id="75a4c-112">In general, you should avoid returning **false** from hello **OnStart** method.</span></span>
* <span data-ttu-id="75a4c-113">A nem kezelt kivétel belül egy túlterhelése egy **RoleEntryPoint** metódus nem kezelt kivételt a rendszer.</span><span class="sxs-lookup"><span data-stu-id="75a4c-113">Any uncaught exception within an overload of a **RoleEntryPoint** method is treated as an unhandled exception.</span></span>
  
   <span data-ttu-id="75a4c-114">Ha kivétel hello életciklus módszerek belül előfordul, a Azure emeli hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) esemény, és ezután hello folyamat megszakadt.</span><span class="sxs-lookup"><span data-stu-id="75a4c-114">If an exception occurs within one of hello lifecycle methods, Azure will raise hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) event, and then hello process is terminated.</span></span> <span data-ttu-id="75a4c-115">A szerepkör offline állapotban van, után újraindul az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="75a4c-115">After your role has been taken offline, it will be restarted by Azure.</span></span> <span data-ttu-id="75a4c-116">Ha nem kezelt kivétel történik, hello [leállítása](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.stopping.aspx) esemény nem következik be, és hello **OnStop** metódus nem lett meghívva.</span><span class="sxs-lookup"><span data-stu-id="75a4c-116">When an unhandled exception occurs, hello [Stopping](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.stopping.aspx) event is not raised, and hello **OnStop** method is not called.</span></span>

<span data-ttu-id="75a4c-117">Ha a szerepkör nem indul el, vagy az újrahasznosítás hello inicializálása, foglalt, és leállítása állapotok közötti lehet, hogy a kód kiváltása hello életciklus-események idő hello szerepkörönként újraindul egy nem kezelt kivétel.</span><span class="sxs-lookup"><span data-stu-id="75a4c-117">If your role does not start, or is recycling between hello initializing, busy, and stopping states, your code may be throwing an unhandled exception within one of hello lifecycle events each time hello role restarts.</span></span> <span data-ttu-id="75a4c-118">Ebben az esetben használja a hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) esemény toodetermine hello hello kivétel okát, és megfelelően kezelje.</span><span class="sxs-lookup"><span data-stu-id="75a4c-118">In this case, use hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) event toodetermine hello cause of hello exception and handle it appropriately.</span></span> <span data-ttu-id="75a4c-119">A szerepkör is előfordulhat, hogy visszatérése hello [futtatása](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx) metódus, amely azt eredményezi, hello szerepkör toorestart.</span><span class="sxs-lookup"><span data-stu-id="75a4c-119">Your role may also be returning from hello [Run](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx) method, which causes hello role toorestart.</span></span> <span data-ttu-id="75a4c-120">További információ a központi telepítési állapotok: [gyakori problémák amely ok szerepkörök tooRecycle](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md).</span><span class="sxs-lookup"><span data-stu-id="75a4c-120">For more information about deployment states, see [Common Issues Which Cause Roles tooRecycle](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md).</span></span>

> [!NOTE]
> <span data-ttu-id="75a4c-121">Hello használata **Azure eszközök a Microsoft Visual Studio** toodevelop az alkalmazás a hello szerepkör projekt sablonok automatikus kiterjesztése hello **RoleEntryPoint** osztály, a hello *WebRole.cs* és *WorkerRole.cs* fájlokat.</span><span class="sxs-lookup"><span data-stu-id="75a4c-121">If you are using hello **Azure Tools for Microsoft Visual Studio** toodevelop your application, hello role project templates automatically extend hello **RoleEntryPoint** class for you, in hello *WebRole.cs* and *WorkerRole.cs* files.</span></span>
> 
> 

## <a name="onstart-method"></a><span data-ttu-id="75a4c-122">OnStart metódus</span><span class="sxs-lookup"><span data-stu-id="75a4c-122">OnStart method</span></span>
<span data-ttu-id="75a4c-123">Hello **OnStart** metódus lehívásra kerül, amikor a szerepkör példánya online állapotba az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="75a4c-123">hello **OnStart** method is called when your role instance is brought online by Azure.</span></span> <span data-ttu-id="75a4c-124">Hello OnStart kód végrehajtása folyik, amíg hello szerepkörpéldányt jelölésű **foglalt** és nem a külső forgalom lesz hello terheléselosztó által vezérelt tooit.</span><span class="sxs-lookup"><span data-stu-id="75a4c-124">While hello OnStart code is executing, hello role instance is marked as **Busy** and no external traffic will be directed tooit by hello load balancer.</span></span> <span data-ttu-id="75a4c-125">Felülírhatja a metódus tooperform inicializálási munka, például eseménykezelők végrehajtási és elindítása [Azure Diagnostics](cloud-services-how-to-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="75a4c-125">You can override this method tooperform initialization work, such as implementing event handlers and starting [Azure Diagnostics](cloud-services-how-to-monitor.md).</span></span>

<span data-ttu-id="75a4c-126">Ha **OnStart** adja vissza **igaz**, hello példány sikeresen inicializálva, és meghívja a Azure hello **RoleEntryPoint.Run** metódust.</span><span class="sxs-lookup"><span data-stu-id="75a4c-126">If **OnStart** returns **true**, hello instance is successfully initialized and Azure calls hello **RoleEntryPoint.Run** method.</span></span> <span data-ttu-id="75a4c-127">Ha **OnStart** adja vissza **hamis**, hello szerepkör leállítása azonnal, minden tervezett leállás sorozatok végrehajtása nélkül.</span><span class="sxs-lookup"><span data-stu-id="75a4c-127">If **OnStart** returns **false**, hello role terminates immediately, without executing any planned shutdown sequences.</span></span>

<span data-ttu-id="75a4c-128">a következő kód példa azt mutatja meg hogyan hello toooverride hello **OnStart** metódust.</span><span class="sxs-lookup"><span data-stu-id="75a4c-128">hello following code example shows how toooverride hello **OnStart** method.</span></span> <span data-ttu-id="75a4c-129">Ez a módszer konfigurálja, és egy diagnosztikai figyelő akkor kezdődik, amikor elindul és naplózási adatok tooa tárfiók átruházása beállítása a hello szerepkör példánya:</span><span class="sxs-lookup"><span data-stu-id="75a4c-129">This method configures and starts a diagnostic monitor when hello role instance starts and sets up a transfer of logging data tooa storage account:</span></span>

```csharp
public override bool OnStart()
{
    var config = DiagnosticMonitor.GetDefaultInitialConfiguration();

    config.DiagnosticInfrastructureLogs.ScheduledTransferLogLevelFilter = LogLevel.Error;
    config.DiagnosticInfrastructureLogs.ScheduledTransferPeriod = TimeSpan.FromMinutes(5);

    DiagnosticMonitor.Start("DiagnosticsConnectionString", config);

    return true;
}
```

## <a name="onstop-method"></a><span data-ttu-id="75a4c-130">OnStop módszer</span><span class="sxs-lookup"><span data-stu-id="75a4c-130">OnStop method</span></span>
<span data-ttu-id="75a4c-131">Hello **OnStop** módszer neve után a szerepkörpéldány offline állapotban van az Azure-ban, és mielőtt hello folyamat kilép.</span><span class="sxs-lookup"><span data-stu-id="75a4c-131">hello **OnStop** method is called after a role instance has been taken offline by Azure and before hello process exits.</span></span> <span data-ttu-id="75a4c-132">Ez a szerepkör-példány toocleanly, állítsa le a szükséges mód toocall kódot felülbírálható.</span><span class="sxs-lookup"><span data-stu-id="75a4c-132">You can override this method toocall code required for your role instance toocleanly shut down.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="75a4c-133">Hello futó **OnStop** metódus egy korlátozott ideig toofinish rendelkezik, ennek oka nem egy felhasználó által kezdeményezett leállítást meghívásakor.</span><span class="sxs-lookup"><span data-stu-id="75a4c-133">Code running in hello **OnStop** method has a limited time toofinish when it is called for reasons other than a user-initiated shutdown.</span></span> <span data-ttu-id="75a4c-134">Ezen idő eltelte után hello folyamat megszakadt, ezért meg kell győződnie arról, hogy a kód a hello **OnStop** metódus nem fut toocompletion eltűr vagy gyorsan futtathatók.</span><span class="sxs-lookup"><span data-stu-id="75a4c-134">After this time elapses, hello process is terminated, so you must make sure that code in hello **OnStop** method can run quickly or tolerates not running toocompletion.</span></span> <span data-ttu-id="75a4c-135">Hello **OnStop** módszer neve után hello **leállítása** egy esemény jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="75a4c-135">hello **OnStop** method is called after hello **Stopping** event is raised.</span></span>
> 
> 

## <a name="run-method"></a><span data-ttu-id="75a4c-136">Run metódus</span><span class="sxs-lookup"><span data-stu-id="75a4c-136">Run method</span></span>
<span data-ttu-id="75a4c-137">Felülbírálhatja hello **futtatása** metódus tooimplement a hosszan futó szál a szerepkör-példányhoz.</span><span class="sxs-lookup"><span data-stu-id="75a4c-137">You can override hello **Run** method tooimplement a long-running thread for your role instance.</span></span>

<span data-ttu-id="75a4c-138">Hello felülbírálása **futtatása** metódus nincs szükség; hello alapértelmezett implementációja elindítja a szál, amelyek örökre alvó állapotban van.</span><span class="sxs-lookup"><span data-stu-id="75a4c-138">Overriding hello **Run** method is not required; hello default implementation starts a thread that sleeps forever.</span></span> <span data-ttu-id="75a4c-139">Ha hello felülbírálása **futtatása** metódus, a kódot kell blokkolása határozatlan ideig.</span><span class="sxs-lookup"><span data-stu-id="75a4c-139">If you do override hello **Run** method, your code should block indefinitely.</span></span> <span data-ttu-id="75a4c-140">Ha hello **futtatása** metódus ad vissza, hello szerepkör automatikusan szabályosan újrahasznosított; más szóval Azure riasztást hello **leállítása** esemény és hívások hello **OnStop** módszer, a leállítási sorozatok hello szerepkör előtt is végrehajthat offline állapotba kerül.</span><span class="sxs-lookup"><span data-stu-id="75a4c-140">If hello **Run** method returns, hello role is automatically gracefully recycled; in other words, Azure raises hello **Stopping** event and calls hello **OnStop** method so that your shutdown sequences may be executed before hello role is taken offline.</span></span>

### <a name="implementing-hello-aspnet-lifecycle-methods-for-a-web-role"></a><span data-ttu-id="75a4c-141">A webes szerepkör végrehajtási hello ASP.NET életciklus módszerek</span><span class="sxs-lookup"><span data-stu-id="75a4c-141">Implementing hello ASP.NET lifecycle methods for a web role</span></span>
<span data-ttu-id="75a4c-142">Módszerek használhatók a hello ASP.NET életciklusát, továbbá a toothose hello által biztosított **RoleEntryPoint** osztály, toomanage inicializálása és leállítási sorozatok egy webes szerepkör.</span><span class="sxs-lookup"><span data-stu-id="75a4c-142">You can use hello ASP.NET lifecycle methods, in addition toothose provided by hello **RoleEntryPoint** class, toomanage initialization and shutdown sequences for a web role.</span></span> <span data-ttu-id="75a4c-143">Ez kompatibilitási célokra hasznos lehet, ha meg van egy meglévő ASP.NET alkalmazás tooAzure eljárás.</span><span class="sxs-lookup"><span data-stu-id="75a4c-143">This may be useful for compatibility purposes if you are porting an existing ASP.NET application tooAzure.</span></span> <span data-ttu-id="75a4c-144">hello ASP.NET életciklus módszerek is meghívhatók hello **RoleEntryPoint** módszerek.</span><span class="sxs-lookup"><span data-stu-id="75a4c-144">hello ASP.NET lifecycle methods are called from within hello **RoleEntryPoint** methods.</span></span> <span data-ttu-id="75a4c-145">Hello **alkalmazás\_Start** módszer neve után hello **RoleEntryPoint.OnStart** metódus befejeződik.</span><span class="sxs-lookup"><span data-stu-id="75a4c-145">hello **Application\_Start** method is called after hello **RoleEntryPoint.OnStart** method finishes.</span></span> <span data-ttu-id="75a4c-146">Hello **alkalmazás\_End** módszer neve előtt hello **RoleEntryPoint.OnStop** metódust.</span><span class="sxs-lookup"><span data-stu-id="75a4c-146">hello **Application\_End** method is called before hello **RoleEntryPoint.OnStop** method is called.</span></span>

## <a name="next-steps"></a><span data-ttu-id="75a4c-147">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="75a4c-147">Next steps</span></span>
<span data-ttu-id="75a4c-148">Ismerje meg, hogyan túl[cloud service-csomag létrehozása](cloud-services-model-and-package.md).</span><span class="sxs-lookup"><span data-stu-id="75a4c-148">Learn how too[create a cloud service package](cloud-services-model-and-package.md).</span></span>

