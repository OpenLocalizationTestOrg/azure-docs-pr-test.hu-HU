---
title: "A felhőalapú szolgáltatás észlelt lefoglalási hibák elhárítása |} Microsoft Docs"
description: "Hozzárendelési hibák elhárítása a Cloud Services telepítése során az Azure szolgáltatásban"
services: azure-service-management, cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 529157eb-e4a1-4388-aa2b-09e8b923af74
ms.service: cloud-services
ms.workload: na
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: 3379b6d9bea874abecae7e56d30cfb15e6b0c2fc
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/03/2017
---
# <a name="troubleshooting-allocation-failure-when-you-deploy-cloud-services-in-azure"></a><span data-ttu-id="a05c1-103">Hozzárendelési hibák elhárítása a Cloud Services telepítése során az Azure szolgáltatásban</span><span class="sxs-lookup"><span data-stu-id="a05c1-103">Troubleshooting allocation failure when you deploy Cloud Services in Azure</span></span>
## <a name="summary"></a><span data-ttu-id="a05c1-104">Összefoglalás</span><span class="sxs-lookup"><span data-stu-id="a05c1-104">Summary</span></span>
<span data-ttu-id="a05c1-105">Ha a példányok telepítése az egy felhőalapú szolgáltatás, vagy adja hozzá az új webes vagy feldolgozói szerepkör példányok, a Microsoft Azure számítási erőforrásokat foglal le.</span><span class="sxs-lookup"><span data-stu-id="a05c1-105">When you deploy instances to a Cloud Service or add new web or worker role instances, Microsoft Azure allocates compute resources.</span></span> <span data-ttu-id="a05c1-106">Hibák léphetnek ezen műveletek végrehajtásakor, még mielőtt az Azure-előfizetésre vonatkozó korlátok alkalmanként.</span><span class="sxs-lookup"><span data-stu-id="a05c1-106">You may occasionally receive errors when performing these operations even before you reach the Azure subscription limits.</span></span> <span data-ttu-id="a05c1-107">Ez a cikk ismerteti az egyes a közös pufferallokációs hibák okait, és lehetséges javítási javasol.</span><span class="sxs-lookup"><span data-stu-id="a05c1-107">This article explains the causes of some of the common allocation failures and suggests possible remediation.</span></span> <span data-ttu-id="a05c1-108">Az információ is hasznos lehet a szolgáltatásokhoz központi telepítésének tervezése során.</span><span class="sxs-lookup"><span data-stu-id="a05c1-108">The information may also be useful when you plan the deployment of your services.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

### <a name="background--how-allocation-works"></a><span data-ttu-id="a05c1-109">Háttér – foglalási működése</span><span class="sxs-lookup"><span data-stu-id="a05c1-109">Background – How allocation works</span></span>
<span data-ttu-id="a05c1-110">Az Azure adatközpontjaiban van particionálva csoportokba.</span><span class="sxs-lookup"><span data-stu-id="a05c1-110">The servers in Azure datacenters are partitioned into clusters.</span></span> <span data-ttu-id="a05c1-111">Egy új felhőalapú szolgáltatás memóriafoglalási kérelem több fürt kísérlet történik.</span><span class="sxs-lookup"><span data-stu-id="a05c1-111">A new cloud service allocation request is attempted in multiple clusters.</span></span> <span data-ttu-id="a05c1-112">Ha az első példány egy felhőalapú szolgáltatást (az átmeneti vagy üzemi), a felhőalapú szolgáltatás központi telepítése egy fürt lekérdezi rögzítve.</span><span class="sxs-lookup"><span data-stu-id="a05c1-112">When the first instance is deployed to a cloud service(in either staging or production), that cloud service gets pinned to a cluster.</span></span> <span data-ttu-id="a05c1-113">A további telepítések a felhőszolgáltatás fordul elő az ugyanabban a fürtben.</span><span class="sxs-lookup"><span data-stu-id="a05c1-113">Any further deployments for the cloud service will happen in the same cluster.</span></span> <span data-ttu-id="a05c1-114">Ebben a cikkben kifejezés ez szerint "fürt rögzítve".</span><span class="sxs-lookup"><span data-stu-id="a05c1-114">In this article, we'll refer to this as "pinned to a cluster".</span></span> <span data-ttu-id="a05c1-115">Alább 1 diagram azt ábrázolja, a kis-és egy normál foglalási, amely több fürtökben; kísérlet történik 2. ábrán látható, a kis-és memóriakiosztást, mert, ahol a meglévő felhőalapú szolgáltatás CS_1 tárolása fürt 2 van rögzítve.</span><span class="sxs-lookup"><span data-stu-id="a05c1-115">Diagram 1 below illustrates the case of a normal allocation which is attempted in multiple clusters; Diagram 2 illustrates the case of an allocation that's pinned to Cluster 2 because that's where the existing Cloud Service CS_1 is hosted.</span></span>

![Foglalási diagramja](./media/cloud-services-allocation-failure/Allocation1.png)

### <a name="why-allocation-failure-happens"></a><span data-ttu-id="a05c1-117">Miért memóriafoglalási hiba történik</span><span class="sxs-lookup"><span data-stu-id="a05c1-117">Why allocation failure happens</span></span>
<span data-ttu-id="a05c1-118">Egy memóriafoglalási kérelem fürtre van rögzítve, nincs hiányában szabad erőforrások keresésére, mivel a rendelkezésre álló erőforráskészletben található egy fürt csak egy magasabb esélyét.</span><span class="sxs-lookup"><span data-stu-id="a05c1-118">When an allocation request is pinned to a cluster, there's a higher chance of failing to find free resources since the available resource pool is limited to a cluster.</span></span> <span data-ttu-id="a05c1-119">Továbbá ha a memóriafoglalási kérelem fürtre van rögzítve, de az adott fürt nem támogatja a kért erőforrás típusát, a kérelem sikertelen lesz akkor is, ha a szabad erőforrás rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="a05c1-119">Furthermore, if your allocation request is pinned to a cluster but the type of resource you requested is not supported by that cluster, your request will fail even if the cluster has free resource.</span></span> <span data-ttu-id="a05c1-120">3. ábra alatt az esetben, ha egy rögzített foglalás sikertelen lesz, mivel az egyetlen jelölt fürtnek nincs szabad erőforrást mutatja be.</span><span class="sxs-lookup"><span data-stu-id="a05c1-120">Diagram 3 below illustrates the case where a pinned allocation fails because the only candidate cluster does not have free resources.</span></span> <span data-ttu-id="a05c1-121">4. ábrán látható, az esetet, ahol egy rögzített foglalás sikertelen lesz, mivel az egyetlen jelölt fürt nem támogatja a kért Virtuálisgép-méret, annak ellenére, hogy a fürt ingyenes erőforrással rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="a05c1-121">Diagram 4 illustrates the case where a pinned allocation fails because the only candidate cluster does not support the requested VM size, even though the cluster has free resources.</span></span>

![Rögzített memóriafoglalási hiba](./media/cloud-services-allocation-failure/Allocation2.png)

## <a name="troubleshooting-allocation-failure-for-cloud-services"></a><span data-ttu-id="a05c1-123">A felhőszolgáltatások észlelt lefoglalási hibák elhárítása</span><span class="sxs-lookup"><span data-stu-id="a05c1-123">Troubleshooting allocation failure for cloud services</span></span>
### <a name="error-message"></a><span data-ttu-id="a05c1-124">Hibaüzenet</span><span class="sxs-lookup"><span data-stu-id="a05c1-124">Error Message</span></span>
<span data-ttu-id="a05c1-125">A következő hibaüzenet jelenhet meg:</span><span class="sxs-lookup"><span data-stu-id="a05c1-125">You may see the following error message:</span></span>

    "Azure operation '{operation id}' failed with code Compute.ConstrainedAllocationFailed. Details: Allocation failed; unable to satisfy constraints in request. The requested new service deployment is bound to an Affinity Group, or it targets a Virtual Network, or there is an existing deployment under this hosted service. Any of these conditions constrains the new deployment to specific Azure resources. Please retry later or try reducing the VM size or number of role instances. Alternatively, if possible, remove the aforementioned constraints or try deploying to a different region."

### <a name="common-issues"></a><span data-ttu-id="a05c1-126">Gyakori problémák</span><span class="sxs-lookup"><span data-stu-id="a05c1-126">Common Issues</span></span>
<span data-ttu-id="a05c1-127">Az alábbiakban a gyakori foglalási forgatókönyvek, amelyek egy foglalási kérelem egy fürtön rögzítve.</span><span class="sxs-lookup"><span data-stu-id="a05c1-127">Here are the common allocation scenarios that cause an allocation request to be pinned to a single cluster.</span></span>

* <span data-ttu-id="a05c1-128">Telepítésekor átmeneti helyre - felhőszolgáltatás van a központi telepítés vagy tárolóhelye, majd a teljes körű felhőalapú szolgáltatás rögzítve fürtön.</span><span class="sxs-lookup"><span data-stu-id="a05c1-128">Deploying to Staging Slot - If a cloud service has a deployment in either slot, then the entire cloud service is pinned to a specific cluster.</span></span>  <span data-ttu-id="a05c1-129">Ez azt jelenti, hogy ha egy telepítés már szerepel az éles webalkalmazásra, majd egy új átmeneti telepítési csak lehet hozzárendelni a fürtön, amelyen az éles webalkalmazásra.</span><span class="sxs-lookup"><span data-stu-id="a05c1-129">This means that if a deployment already exists in the production slot, then a new staging deployment can only be allocated in the same cluster as the production slot.</span></span> <span data-ttu-id="a05c1-130">Ha a fürt közelít kapacitásának határához, a kérelem sikertelen lehet.</span><span class="sxs-lookup"><span data-stu-id="a05c1-130">If the cluster is nearing capacity, the request may fail.</span></span>
* <span data-ttu-id="a05c1-131">Skálázás – új példányok hozzáadása egy meglévő felhőszolgáltatáshoz kell rendelnie az ugyanabban a fürtben.</span><span class="sxs-lookup"><span data-stu-id="a05c1-131">Scaling - Adding new instances to an existing cloud service must allocate in the same cluster.</span></span>  <span data-ttu-id="a05c1-132">Rövid skálázás kérelmek általában osztják, de nem minden esetben.</span><span class="sxs-lookup"><span data-stu-id="a05c1-132">Small scaling requests can usually be allocated, but not always.</span></span> <span data-ttu-id="a05c1-133">Ha a fürt közelít kapacitásának határához, a kérelem sikertelen lehet.</span><span class="sxs-lookup"><span data-stu-id="a05c1-133">If the cluster is nearing capacity, the request may fail.</span></span>
* <span data-ttu-id="a05c1-134">Affinitáscsoport - új központi telepítést egy üres felhőszolgáltatásban foglalhatók által a hálót a fürthöz az adott régióban, kivéve, ha a felhőalapú szolgáltatás affinitáscsoporthoz van rögzítve.</span><span class="sxs-lookup"><span data-stu-id="a05c1-134">Affinity Group - A new deployment to an empty cloud service can be allocated by the fabric in any cluster in that region, unless the cloud service is pinned to an affinity group.</span></span> <span data-ttu-id="a05c1-135">Ugyanabban az affinitáscsoportban történő telepítését ugyanazon a fürtön kísérli meg a rendszer.</span><span class="sxs-lookup"><span data-stu-id="a05c1-135">Deployments to the same affinity group will be attempted on the same cluster.</span></span> <span data-ttu-id="a05c1-136">Ha a fürt közelít kapacitásának határához, a kérelem sikertelen lehet.</span><span class="sxs-lookup"><span data-stu-id="a05c1-136">If the cluster is nearing capacity, the request may fail.</span></span>
* <span data-ttu-id="a05c1-137">Affinitáscsoport vNet - régebbi virtuális hálózatok affinitáscsoportok régiókat helyett volt kötve, és ezeket a virtuális hálózatokat a cloud services az affinitáscsoport fürt lesz rögzítve.</span><span class="sxs-lookup"><span data-stu-id="a05c1-137">Affinity Group vNet - Older Virtual Networks were tied to affinity groups instead of regions, and cloud services in these Virtual Networks would be pinned to the affinity group cluster.</span></span> <span data-ttu-id="a05c1-138">Ez a fajta virtuális hálózatot való telepítésének a rögzített fürtön kísérli meg a rendszer.</span><span class="sxs-lookup"><span data-stu-id="a05c1-138">Deployments to this type of virtual network will be attempted on the pinned cluster.</span></span> <span data-ttu-id="a05c1-139">Ha a fürt közelít kapacitásának határához, a kérelem sikertelen lehet.</span><span class="sxs-lookup"><span data-stu-id="a05c1-139">If the cluster is nearing capacity, the request may fail.</span></span>

## <a name="solutions"></a><span data-ttu-id="a05c1-140">Megoldások</span><span class="sxs-lookup"><span data-stu-id="a05c1-140">Solutions</span></span>
1. <span data-ttu-id="a05c1-141">Telepítse újra az új felhőalapú szolgáltatás – Ez a megoldás valószínűleg legtöbb sikeres, az adott régióban összes fürt választhat a platform lehetővé teszi.</span><span class="sxs-lookup"><span data-stu-id="a05c1-141">Redeploy to a new cloud service - This solution is likely to be most successful as it allows the platform to choose from all clusters in that region.</span></span>

   * <span data-ttu-id="a05c1-142">Új felhőalapú szolgáltatás az alkalmazások és szolgáltatások telepítése</span><span class="sxs-lookup"><span data-stu-id="a05c1-142">Deploy the workload to a new cloud service</span></span>  
   * <span data-ttu-id="a05c1-143">Frissítheti a CNAME vagy egy olyan rekordot irányítsák a forgalmat a új felhőszolgáltatással</span><span class="sxs-lookup"><span data-stu-id="a05c1-143">Update the CNAME or A record to point traffic to the new cloud service</span></span>
   * <span data-ttu-id="a05c1-144">Nulla forgalom a régi helyhez állapotra vált, amennyiben törölheti a régi felhőalapú szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="a05c1-144">Once zero traffic is going to the old site, you can delete the old cloud service.</span></span> <span data-ttu-id="a05c1-145">Ez a megoldás kell fel Önnek leállítása nélkül.</span><span class="sxs-lookup"><span data-stu-id="a05c1-145">This solution should incur zero downtime.</span></span>
2. <span data-ttu-id="a05c1-146">Üzemi és átmeneti üzembe helyezési ponti törölni – Ez a megoldás megtartja a meglévő DNS-nevével, de az alkalmazás leállás, akkor.</span><span class="sxs-lookup"><span data-stu-id="a05c1-146">Delete both production and staging slots - This solution will preserve your existing DNS name, but will cause downtime to your application.</span></span>

   * <span data-ttu-id="a05c1-147">A szolgáltatás üzemi és átmeneti üzembe helyezési ponti egy meglévő felhőalapú szolgáltatás, így felhőszolgáltatás nem üres, törölje, majd</span><span class="sxs-lookup"><span data-stu-id="a05c1-147">Delete the production and staging slots of an existing cloud service so that the cloud service is empty, and then</span></span>
   * <span data-ttu-id="a05c1-148">Hozzon létre egy új központi telepítést a meglévő felhőalapú szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="a05c1-148">Create a new deployment in the existing cloud service.</span></span> <span data-ttu-id="a05c1-149">Ez újra megkísérli a foglalási régióban minden fürtön.</span><span class="sxs-lookup"><span data-stu-id="a05c1-149">This will re-attempt to allocation on all clusters in the region.</span></span> <span data-ttu-id="a05c1-150">Győződjön meg róla, felhőalapú szolgáltatás nem kötődik azonban egy affinitáscsoporthoz.</span><span class="sxs-lookup"><span data-stu-id="a05c1-150">Ensure the cloud service is not tied to an affinity group.</span></span>
3. <span data-ttu-id="a05c1-151">Fenntartott IP - Ez a megoldás megtartja a meglévő IP-cím, de az alkalmazás állásidőt okoz.</span><span class="sxs-lookup"><span data-stu-id="a05c1-151">Reserved IP -  This solution will preserve your existing IP address, but will cause downtime to your application.</span></span>  

   * <span data-ttu-id="a05c1-152">Hozzon létre egy foglalt IP-cím a meglévő telepítéshez Powershell használatával</span><span class="sxs-lookup"><span data-stu-id="a05c1-152">Create a ReservedIP for your existing deployment using Powershell</span></span>

     ```
     New-AzureReservedIP -ReservedIPName {new reserved IP name} -Location {location} -ServiceName {existing service name}
     ```
   * <span data-ttu-id="a05c1-153">Hajtsa végre a #2 promptjai meggyőződött arról, hogy a szolgáltatás szolgáltatáskonfigurációs SÉMA adni az új foglalt IP-címet.</span><span class="sxs-lookup"><span data-stu-id="a05c1-153">Follow #2 from above, making sure to specify the new ReservedIP in the service's CSCFG.</span></span>
4. <span data-ttu-id="a05c1-154">Távolítsa el az új központi telepítéseknél - affinitáscsoport Affinitáscsoportok már nem támogatottak.</span><span class="sxs-lookup"><span data-stu-id="a05c1-154">Remove affinity group for new deployments - Affinity Groups are no longer recommended.</span></span> <span data-ttu-id="a05c1-155">Kövesse a fenti új felhőalapú szolgáltatás telepítése #1.</span><span class="sxs-lookup"><span data-stu-id="a05c1-155">Follow steps for #1 above to deploy a new cloud service.</span></span> <span data-ttu-id="a05c1-156">Győződjön meg róla, felhőalapú szolgáltatás nem olyan affinitáscsoportban van.</span><span class="sxs-lookup"><span data-stu-id="a05c1-156">Ensure cloud service is not in an affinity group.</span></span>
5. <span data-ttu-id="a05c1-157">Regionális virtuális hálózatot – lásd: átalakítása [hogyan kell áttelepíteni egy regionális virtuális hálózatot (VNet) Affinitáscsoportok](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="a05c1-157">Convert to a Regional Virtual Network - See [How to migrate from Affinity Groups to a Regional Virtual Network (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span></span>
