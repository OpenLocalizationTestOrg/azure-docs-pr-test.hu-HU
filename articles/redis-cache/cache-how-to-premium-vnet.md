---
title: "Virtuális hálózat konfigurálása a Premium Azure Redis gyorsítótár |} Microsoft Docs"
description: "Megtudhatja, hogyan hozhatja létre és kezelheti a Premium szint Azure Redis Cache példány virtuális hálózati támogatása"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: 59d46990e02c0719d2b4df01e216a97fd649c509
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/18/2017
---
# <a name="how-to-configure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="fcf3e-103">Virtuális hálózati támogatásának konfigurálása prémium szintű Azure Redis Cache</span><span class="sxs-lookup"><span data-stu-id="fcf3e-103">How to configure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="fcf3e-104">Azure Redis Cache rendelkezik másik gyorsítótármappa ajánlatokat, amelyek gyorsítótár mérete és a funkciót, beleértve a prémium réteg szolgáltatások, például a fürtszolgáltatás, az adatmegőrzésre és a virtuális hálózat támogatásának rugalmasságot biztosítanak.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-104">Azure Redis Cache has different cache offerings, which provide flexibility in the choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="fcf3e-105">A virtuális hálózat egy magánhálózaton a felhőben.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-105">A VNet is a private network in the cloud.</span></span> <span data-ttu-id="fcf3e-106">Azure Redis Cache példány konfigurálásakor a virtuális hálózaton nincs nyilvánosan megcímezhető, és csak érhetők el a virtuális gépek és az alkalmazások a Vneten belül.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within the VNet.</span></span> <span data-ttu-id="fcf3e-107">Ez a cikk ismerteti a premium Azure Redis Cache példányt virtuális hálózat támogatásának konfigurálása.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-107">This article describes how to configure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="fcf3e-108">Azure Redis Cache támogatja mindkét klasszikus és Resource Manager Vnetek.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="fcf3e-109">Más prémium gyorsítótár funkciókról további információért lásd: [az Azure Redis Cache prémium szintjének bemutatása](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="fcf3e-109">For information on other premium cache features, see [Introduction to the Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="fcf3e-110">Miért virtuális hálózatot?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-110">Why VNet?</span></span>
<span data-ttu-id="fcf3e-111">[Az Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) telepítés biztosítja, magasabb védelmet és elszigeteltséget az Azure Redis Cache, valamint a alhálózatok, hozzáférés-vezérlési házirendeket, és további egyéb szolgáltatások elérésének korlátozása.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features to further restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="fcf3e-112">Virtuális hálózati támogatása</span><span class="sxs-lookup"><span data-stu-id="fcf3e-112">Virtual network support</span></span>
<span data-ttu-id="fcf3e-113">Virtual Network (VNet) támogatása konfigurálva van a **új Redis Cache** panel gyorsítótár létrehozása során.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-113">Virtual Network (VNet) support is configured on the **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="fcf3e-114">Miután kiválasztotta a prémium tarifacsomag, beállíthatja a Redis virtuális integráció egy Vnetet, amely ugyanazt az előfizetést és a gyorsítótár helyének kiválasztásával.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in the same subscription and location as your cache.</span></span> <span data-ttu-id="fcf3e-115">Egy új virtuális hálózat használatához először hozza létre azt a lépések [hozzon létre egy virtuális hálózatot az Azure portál használatával](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) vagy [(klasszikus) virtuális hálózat létrehozása az Azure portál használatával](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) és térjen vissza a **Új Redis Cache** létrehozása és beállítása a prémium szintű gyorsítótára panel.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-115">To use a new VNet, create it first by following the steps in [Create a virtual network using the Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using the Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return to the **New Redis Cache** blade to create and configure your premium cache.</span></span>

<span data-ttu-id="fcf3e-116">Az új gyorsítótár hálózatok konfigurálásához kattintson **virtuális hálózati** a a **új Redis Cache** panelt, és válassza ki a kívánt VNet a legördülő listából.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-116">To configure the VNet for your new cache, click **Virtual Network** on the **New Redis Cache** blade, and select the desired VNet from the drop-down list.</span></span>

![Virtuális hálózat][redis-cache-vnet]

<span data-ttu-id="fcf3e-118">Jelölje ki a kívánt alhálózatot a **alhálózati** legördülő listában, és adja meg a kívánt **statikus IP-cím**.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-118">Select the desired subnet from the **Subnet** drop-down list, and specify the desired **Static IP address**.</span></span> <span data-ttu-id="fcf3e-119">Ha a klasszikus virtuális hálózatot használ a **statikus IP-cím** mező kitöltése nem kötelező, és ha nincs megadva, egy kiválasztotta a kiválasztott alhálózatnak.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-119">If you are using a classic VNet the **Static IP address** field is optional, and if none is specified, one is chosen from the selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="fcf3e-120">Az Azure Redis Cache egy erőforrás-kezelő virtuális hálózaton történő telepítéskor a gyorsítótár az Azure Redis Cache példány kivételével nincs más erőforrásokat tartalmazó dedikált alhálózat kell lennie.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-120">When deploying an Azure Redis Cache to a Resource Manager VNet, the cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="fcf3e-121">Ha központi telepítése egy Azure Redis Cache egy erőforrás-kezelő virtuális hálózat alhálózathoz tett kísérlet, amely más erőforrások, a központi telepítés sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-121">If an attempt is made to deploy an Azure Redis Cache to a Resource Manager VNet to a subnet that contains other resources, the deployment fails.</span></span>
> 
> 

![Virtuális hálózat][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="fcf3e-123">Azure fenntartja az egyes IP-címek minden alhálózaton belül, és ezeknél a címeknél nem használható.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="fcf3e-124">Az első és utolsó IP-címek alhálózatok protokoll megfelelési, valamint három további címek az Azure-szolgáltatásokhoz használt számára vannak fenntartva.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-124">The first and last IP addresses of the subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="fcf3e-125">További információkért lásd: [vannak-e bármilyen korlátozás belül ezek alhálózatok IP-címeket használnak?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="fcf3e-126">Mellett az IP-címeit az Azure virtuális hálózat infrastruktúra minden egyes Redis példány / shard alhálózati használja a két IP-címek és egy további IP-címet a terheléselosztóhoz.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-126">In addition to the IP addresses used by the Azure VNET infrastructure, each Redis instance in the subnet uses two IP addresses per shard and one additional IP address for the load balancer.</span></span> <span data-ttu-id="fcf3e-127">Egy nem fürtözött gyorsítótár egy shard tekinthető.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-127">A non-clustered cache is considered to have one shard.</span></span>
> 
> 

<span data-ttu-id="fcf3e-128">A gyorsítótár létrehozása után meg kattintva megtekintheti a VNet konfigurációját **virtuális hálózati** a a **erőforrás menü**.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-128">After the cache is created, you can view the configuration for the VNet by clicking **Virtual Network** from the **Resource menu**.</span></span>

![Virtuális hálózat][redis-cache-vnet-info]

<span data-ttu-id="fcf3e-130">Csatlakozni az Azure Redis cache példány egy virtuális hálózat használatával, adja meg a gyorsítótár állomás nevét a kapcsolati karakterláncban a következő példában látható módon:</span><span class="sxs-lookup"><span data-stu-id="fcf3e-130">To connect to your Azure Redis cache instance when using a VNet, specify the host name of your cache in the connection string as shown in the following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="fcf3e-131">Azure Redis Cache VNet – gyakori kérdések</span><span class="sxs-lookup"><span data-stu-id="fcf3e-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="fcf3e-132">A következő lista az Azure Redis Cache skálázás gyakran feltett kérdésekre adott válaszokat tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-132">The following list contains answers to commonly asked questions about the Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="fcf3e-133">Mik azok a gyakori hiba a konfiguráció problémákat az Azure Redis Cache és Vnetekhez?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="fcf3e-134">Hogyan ellenőrizhetem, hogy működik-e a gyorsítótár a VNETEN belül?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="fcf3e-135">Használható alapszintű vagy standard gyorsítótárával Vnetekhez?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="fcf3e-136">Miért nem a Redis gyorsítótár létrehozása sikertelen lesz az egyes alhálózatok, de nem mások?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="fcf3e-137">Mik azok az alhálózati kapcsolatos követelmények?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-137">What are the subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="fcf3e-138">Működnek-e minden gyorsítótár-funkciók egy VNETET a gyorsítótárhoz esetén?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="fcf3e-139">Mik azok a gyakori hiba a konfiguráció problémákat az Azure Redis Cache és Vnetekhez?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="fcf3e-140">Azure Redis Cache a Vneten belül helyezkedik el, amikor a rendszer az alábbi táblázatban a portokat használja.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-140">When Azure Redis Cache is hosted in a VNet, the ports in the following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="fcf3e-141">Ha blokkolja az alábbi táblázatban a portokat, előfordulhat, hogy a gyorsítótár nem működik megfelelően.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-141">If the ports in the following tables are blocked, the cache may not function correctly.</span></span> <span data-ttu-id="fcf3e-142">Rendelkezik egy vagy több ezeket a portokat, blokkolja a leggyakrabban használt helytelen konfiguráció probléma használata esetén egy Vnetet az Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-142">Having one or more of these ports blocked is the most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="fcf3e-143">Kimenő portokra vonatkozó követelmények</span><span class="sxs-lookup"><span data-stu-id="fcf3e-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="fcf3e-144">Bejövő portokra vonatkozó követelmények</span><span class="sxs-lookup"><span data-stu-id="fcf3e-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="fcf3e-145">Kimenő portokra vonatkozó követelmények</span><span class="sxs-lookup"><span data-stu-id="fcf3e-145">Outbound port requirements</span></span>

<span data-ttu-id="fcf3e-146">Nincsenek hét kimenő port.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="fcf3e-147">Ha a kívánt, az összes kimenő kapcsolatok az interneten keresztül módosítható egy ügyfél a helyszíni naplózási eszköz.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-147">If desired, all outbound connections to the internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="fcf3e-148">Azure-végpontok Azure Storage és az Azure DNS-karbantartási forgalom átirányítása három port.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-148">Three of the ports route traffic to Azure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="fcf3e-149">A fennmaradó porttartományok és a belső Redis alhálózati kommunikációhoz.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-149">The remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="fcf3e-150">Nincs alhálózat NSG-szabályok a belső Redis alhálózati kommunikációhoz szükségesek.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="fcf3e-151">Port(ok)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-151">Port(s)</span></span> | <span data-ttu-id="fcf3e-152">Irány</span><span class="sxs-lookup"><span data-stu-id="fcf3e-152">Direction</span></span> | <span data-ttu-id="fcf3e-153">Átviteli protokoll</span><span class="sxs-lookup"><span data-stu-id="fcf3e-153">Transport Protocol</span></span> | <span data-ttu-id="fcf3e-154">Cél</span><span class="sxs-lookup"><span data-stu-id="fcf3e-154">Purpose</span></span> | <span data-ttu-id="fcf3e-155">Helyi IP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-155">Local IP</span></span> | <span data-ttu-id="fcf3e-156">Távoli IP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="fcf3e-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="fcf3e-157">80, 443</span></span> |<span data-ttu-id="fcf3e-158">Kimenő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-158">Outbound</span></span> |<span data-ttu-id="fcf3e-159">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-159">TCP</span></span> |<span data-ttu-id="fcf3e-160">Redis függőségek az Azure Storage/nyilvános kulcsokra épülő infrastruktúra (Internet)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="fcf3e-161">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="fcf3e-162">53</span><span class="sxs-lookup"><span data-stu-id="fcf3e-162">53</span></span> |<span data-ttu-id="fcf3e-163">Kimenő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-163">Outbound</span></span> |<span data-ttu-id="fcf3e-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-164">TCP/UDP</span></span> |<span data-ttu-id="fcf3e-165">A DNS-(Internet/VNet) függőségek redis</span><span class="sxs-lookup"><span data-stu-id="fcf3e-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="fcf3e-166">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="fcf3e-167">8443</span><span class="sxs-lookup"><span data-stu-id="fcf3e-167">8443</span></span> |<span data-ttu-id="fcf3e-168">Kimenő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-168">Outbound</span></span> |<span data-ttu-id="fcf3e-169">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-169">TCP</span></span> |<span data-ttu-id="fcf3e-170">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-170">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-171">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-171">(Redis subnet)</span></span> | <span data-ttu-id="fcf3e-172">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-172">(Redis subnet)</span></span> |
| <span data-ttu-id="fcf3e-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="fcf3e-173">10221-10231</span></span> |<span data-ttu-id="fcf3e-174">Kimenő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-174">Outbound</span></span> |<span data-ttu-id="fcf3e-175">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-175">TCP</span></span> |<span data-ttu-id="fcf3e-176">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-176">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-177">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-177">(Redis subnet)</span></span> | <span data-ttu-id="fcf3e-178">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-178">(Redis subnet)</span></span> |
| <span data-ttu-id="fcf3e-179">20226</span><span class="sxs-lookup"><span data-stu-id="fcf3e-179">20226</span></span> |<span data-ttu-id="fcf3e-180">Kimenő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-180">Outbound</span></span> |<span data-ttu-id="fcf3e-181">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-181">TCP</span></span> |<span data-ttu-id="fcf3e-182">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-182">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-183">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-183">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-184">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-184">(Redis subnet)</span></span> |
| <span data-ttu-id="fcf3e-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="fcf3e-185">13000-13999</span></span> |<span data-ttu-id="fcf3e-186">Kimenő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-186">Outbound</span></span> |<span data-ttu-id="fcf3e-187">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-187">TCP</span></span> |<span data-ttu-id="fcf3e-188">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-188">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-189">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-189">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-190">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-190">(Redis subnet)</span></span> |
| <span data-ttu-id="fcf3e-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="fcf3e-191">15000-15999</span></span> |<span data-ttu-id="fcf3e-192">Kimenő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-192">Outbound</span></span> |<span data-ttu-id="fcf3e-193">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-193">TCP</span></span> |<span data-ttu-id="fcf3e-194">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-194">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-195">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-195">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-196">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="fcf3e-197">Bejövő portokra vonatkozó követelmények</span><span class="sxs-lookup"><span data-stu-id="fcf3e-197">Inbound port requirements</span></span>

<span data-ttu-id="fcf3e-198">Nincsenek nyolc bejövő port tartományon.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="fcf3e-199">Bejövő kérelmek ezen tartományok, vagy más, ugyanazon virtuális üzemeltetett szolgáltatások bejövő vagy belső a Redis alhálózati kommunikáció.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-199">Inbound requests in these ranges are either inbound from other services hosted in the same VNET or internal to the Redis subnet communications.</span></span>

| <span data-ttu-id="fcf3e-200">Port(ok)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-200">Port(s)</span></span> | <span data-ttu-id="fcf3e-201">Irány</span><span class="sxs-lookup"><span data-stu-id="fcf3e-201">Direction</span></span> | <span data-ttu-id="fcf3e-202">Átviteli protokoll</span><span class="sxs-lookup"><span data-stu-id="fcf3e-202">Transport Protocol</span></span> | <span data-ttu-id="fcf3e-203">Cél</span><span class="sxs-lookup"><span data-stu-id="fcf3e-203">Purpose</span></span> | <span data-ttu-id="fcf3e-204">Helyi IP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-204">Local IP</span></span> | <span data-ttu-id="fcf3e-205">Távoli IP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="fcf3e-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="fcf3e-206">6379, 6380</span></span> |<span data-ttu-id="fcf3e-207">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-207">Inbound</span></span> |<span data-ttu-id="fcf3e-208">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-208">TCP</span></span> |<span data-ttu-id="fcf3e-209">Ügyfél-kommunikációt kíván Redis, Azure terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="fcf3e-209">Client communication to Redis, Azure load balancing</span></span> | <span data-ttu-id="fcf3e-210">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-210">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-211">Virtuális hálózat, az Azure terheléselosztó</span><span class="sxs-lookup"><span data-stu-id="fcf3e-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="fcf3e-212">8443</span><span class="sxs-lookup"><span data-stu-id="fcf3e-212">8443</span></span> |<span data-ttu-id="fcf3e-213">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-213">Inbound</span></span> |<span data-ttu-id="fcf3e-214">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-214">TCP</span></span> |<span data-ttu-id="fcf3e-215">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-215">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-216">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-216">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-217">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-217">(Redis subnet)</span></span> |
| <span data-ttu-id="fcf3e-218">8500</span><span class="sxs-lookup"><span data-stu-id="fcf3e-218">8500</span></span> |<span data-ttu-id="fcf3e-219">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-219">Inbound</span></span> |<span data-ttu-id="fcf3e-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-220">TCP/UDP</span></span> |<span data-ttu-id="fcf3e-221">Az Azure terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="fcf3e-221">Azure load balancing</span></span> | <span data-ttu-id="fcf3e-222">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-222">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-223">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="fcf3e-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="fcf3e-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="fcf3e-224">10221-10231</span></span> |<span data-ttu-id="fcf3e-225">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-225">Inbound</span></span> |<span data-ttu-id="fcf3e-226">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-226">TCP</span></span> |<span data-ttu-id="fcf3e-227">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-227">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-228">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-228">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-229">(Redis alhálózati), Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="fcf3e-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="fcf3e-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="fcf3e-230">13000-13999</span></span> |<span data-ttu-id="fcf3e-231">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-231">Inbound</span></span> |<span data-ttu-id="fcf3e-232">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-232">TCP</span></span> |<span data-ttu-id="fcf3e-233">Ügyfél-kommunikáció Redis-fürtök, Azure terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="fcf3e-233">Client communication to Redis Clusters, Azure load balancing</span></span> | <span data-ttu-id="fcf3e-234">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-234">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-235">Virtuális hálózat, az Azure terheléselosztó</span><span class="sxs-lookup"><span data-stu-id="fcf3e-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="fcf3e-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="fcf3e-236">15000-15999</span></span> |<span data-ttu-id="fcf3e-237">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-237">Inbound</span></span> |<span data-ttu-id="fcf3e-238">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-238">TCP</span></span> |<span data-ttu-id="fcf3e-239">Ügyfél-kommunikáció Redis-fürtök, Azure betöltése terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="fcf3e-239">Client communication to Redis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="fcf3e-240">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-240">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-241">Virtuális hálózat, az Azure terheléselosztó</span><span class="sxs-lookup"><span data-stu-id="fcf3e-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="fcf3e-242">16001</span><span class="sxs-lookup"><span data-stu-id="fcf3e-242">16001</span></span> |<span data-ttu-id="fcf3e-243">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-243">Inbound</span></span> |<span data-ttu-id="fcf3e-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-244">TCP/UDP</span></span> |<span data-ttu-id="fcf3e-245">Az Azure terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="fcf3e-245">Azure load balancing</span></span> | <span data-ttu-id="fcf3e-246">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-246">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-247">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="fcf3e-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="fcf3e-248">20226</span><span class="sxs-lookup"><span data-stu-id="fcf3e-248">20226</span></span> |<span data-ttu-id="fcf3e-249">Bejövő</span><span class="sxs-lookup"><span data-stu-id="fcf3e-249">Inbound</span></span> |<span data-ttu-id="fcf3e-250">TCP</span><span class="sxs-lookup"><span data-stu-id="fcf3e-250">TCP</span></span> |<span data-ttu-id="fcf3e-251">Belső Redis-kommunikáció</span><span class="sxs-lookup"><span data-stu-id="fcf3e-251">Internal communications for Redis</span></span> | <span data-ttu-id="fcf3e-252">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-252">(Redis subnet)</span></span> |<span data-ttu-id="fcf3e-253">(Redis alhálózati)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="fcf3e-254">További virtuális hálózat hálózati kapcsolat követelmények</span><span class="sxs-lookup"><span data-stu-id="fcf3e-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="fcf3e-255">Nincsenek hálózati kapcsolat az Azure Redis Cache, előfordulhat, hogy kezdetben jutott virtuális hálózatban.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="fcf3e-256">Azure Redis Cache-gyorsítótár a következő elemek megfelelően működnek, ha a virtuális hálózaton belül van szükség.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-256">Azure Redis Cache requires all the following items to function properly when used within a virtual network.</span></span>

* <span data-ttu-id="fcf3e-257">Azure Storage végpontok világszerte kimenő hálózati kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-257">Outbound network connectivity to Azure Storage endpoints worldwide.</span></span> <span data-ttu-id="fcf3e-258">Ez magában foglalja a végpontok Azure Redis Cache példányt ugyanabban a régióban található, valamint tárolási végpontok található **más** Azure-régiók.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-258">This includes endpoints located in the same region as the Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="fcf3e-259">Azure Storage-végpontok oldja meg a következő DNS-tartományok alatt: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, és *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-259">Azure Storage endpoints resolve under the following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="fcf3e-260">Kimenő hálózati kapcsolattal *ocsp.msocsp.com*, *mscrl.microsoft.com*, és *crl.microsoft.com*. Ez az összekapcsolhatóság SSL támogatásához van szükség.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-260">Outbound network connectivity to *ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed to support SSL functionality.</span></span>
* <span data-ttu-id="fcf3e-261">A DNS-beállításait a virtuális hálózat összes végpontok és a korábbi pontban tartományok megoldásának képesnek kell lennie.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-261">The DNS configuration for the virtual network must be capable of resolving all of the endpoints and domains mentioned in the earlier points.</span></span> <span data-ttu-id="fcf3e-262">A DNS-követelmények érheti el, egy érvényes DNS-infrastruktúra van beállítva, és a virtuális hálózat megmarad biztosításával.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for the virtual network.</span></span>
* <span data-ttu-id="fcf3e-263">Kimenő hálózati kapcsolata a következő Azure figyelési végpontok, amelyek alapján a következő DNS-tartományok megoldásához: shoebox2-black.shoebox2.metrics.nsatc.net, Észak-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net , shoebox2-red.shoebox2.metrics.nsatc.net, kelet-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-263">Outbound network connectivity to the following Azure Monitoring endpoints, which resolve under the following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="fcf3e-264">Hogyan ellenőrizhetem, hogy működik-e a gyorsítótár a VNETEN belül?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="fcf3e-265">Amikor egy virtuális hálózat alkotóelem Azure Redis Cache példány csatlakozik, a gyorsítótárazási ügyfelek számára ugyanazon virtuális, beleértve az alkalmazások tesztelése vagy diagnosztikai pingelés eszközök kell lennie.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-265">When connecting to an Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in the same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="fcf3e-266">Az előző szakaszban leírtak a portokra vonatkozó követelmények konfigurálása után ellenőrizheti, hogy működik-e a gyorsítótár a következő lépések elvégzésével.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-266">Once the port requirements are configured as described in the previous section, you can verify that your cache is working by performing the following steps.</span></span>

- <span data-ttu-id="fcf3e-267">[Újraindítás](cache-administration.md#reboot) minden gyorsítótár-csomópont.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-267">[Reboot](cache-administration.md#reboot) all of the cache nodes.</span></span> <span data-ttu-id="fcf3e-268">Ha az összes szükséges gyorsítótár-függőségeit nem érhető el (ahogy [portokra vonatkozó követelmények bejövő](cache-how-to-premium-vnet.md#inbound-port-requirements) és [kimenő portokra vonatkozó követelmények](cache-how-to-premium-vnet.md#outbound-port-requirements)), a gyorsítótár nem fog tudni újraindítása sikeresen megtörtént.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-268">If all of the required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), the cache won't be able to restart successfully.</span></span>
- <span data-ttu-id="fcf3e-269">Ha a gyorsítótár-csomópontok (mint a gyorsítótár állapotát, az Azure portálon által jelentett) újraindítása, a következő teszteket hajthat végre:</span><span class="sxs-lookup"><span data-stu-id="fcf3e-269">Once the cache nodes have restarted (as reported by the cache status in the Azure portal), you can perform the following tests:</span></span>
  - <span data-ttu-id="fcf3e-270">Pingelje meg a gyorsítótár végpont (port 6380) a gép, amely ugyanazt a virtuális Hálózatot, mint a gyorsítótár belül használatával [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="fcf3e-270">ping the cache endpoint (using port 6380) from a machine that is within the same VNET as the cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="fcf3e-271">Példa:</span><span class="sxs-lookup"><span data-stu-id="fcf3e-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="fcf3e-272">Ha a `tcping` eszköz jelzi, hogy a port meg nyitva, a gyorsítótár érhető el a virtuális hálózaton lévő ügyfelek közötti kapcsolat.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-272">If the `tcping` tool reports that the port is open, the cache is available for connection from clients in the VNET.</span></span>

  - <span data-ttu-id="fcf3e-273">Tesztelheti egy másik módja, ha a teszt gyorsítótárügyfél (amely lehet egy egyszerű konzolalkalmazást StackExchange.Redis használatával), amely a gyorsítótár csatlakozik, és hozzáadja, és néhány elemet lekéri a gyorsítótárból.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-273">Another way to test is to create a test cache client (which could be a simple console application using StackExchange.Redis) that connects to the cache and adds and retrieves some items from the cache.</span></span> <span data-ttu-id="fcf3e-274">A mintaalkalmazás ügyfél, amely ugyanazt a virtuális Hálózatot, mint a gyorsítótárban, és futtassa ellenőrzésére a gyorsítótár-kiszolgálóra telepítse.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-274">Install the sample client application onto a VM that is in the same VNET as the cache and run it to verify connectivity to the cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="fcf3e-275">Használható alapszintű vagy standard gyorsítótárával Vnetekhez?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="fcf3e-276">Vnetek csak prémium szintű gyorsítótárak használható.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="fcf3e-277">Miért nem a Redis gyorsítótár létrehozása sikertelen lesz az egyes alhálózatok, de nem mások?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="fcf3e-278">Ha telepíti az Azure Redis Cache egy erőforrás-kezelő virtuális hálózatba, a gyorsítótár nincs más erőforrástípus tartalmazó dedikált alhálózat kell lennie.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-278">If you are deploying an Azure Redis Cache to a Resource Manager VNet, the cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="fcf3e-279">Ha központi telepítése egy Azure Redis Cache erőforrás-kezelő virtuális hálózat alhálózathoz tett kísérlet, amely más erőforrások, a telepítés sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-279">If an attempt is made to deploy an Azure Redis Cache to a Resource Manager VNet subnet that contains other resources, the deployment fails.</span></span> <span data-ttu-id="fcf3e-280">Egy új Redis gyorsítótár létrehozása előtt törölnie kell a meglévő erőforrásokat az alhálózaton belül.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-280">You must delete the existing resources inside the subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="fcf3e-281">Telepítene többféle típusú erőforrások egy klasszikus virtuális hálózatot, amíg elegendő elérhető IP-cím van.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-281">You can deploy multiple types of resources to a classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-the-subnet-address-space-requirements"></a><span data-ttu-id="fcf3e-282">Mik azok az alhálózati kapcsolatos követelmények?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-282">What are the subnet address space requirements?</span></span>
<span data-ttu-id="fcf3e-283">Azure fenntartja az egyes IP-címek minden alhálózaton belül, és ezeknél a címeknél nem használható.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="fcf3e-284">Az első és utolsó IP-címek alhálózatok protokoll megfelelési, valamint három további címek az Azure-szolgáltatásokhoz használt számára vannak fenntartva.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-284">The first and last IP addresses of the subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="fcf3e-285">További információkért lásd: [vannak-e bármilyen korlátozás belül ezek alhálózatok IP-címeket használnak?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="fcf3e-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="fcf3e-286">Mellett az IP-címeit az Azure virtuális hálózat infrastruktúra minden egyes Redis példány / shard alhálózati használja a két IP-címek és egy további IP-címet a terheléselosztóhoz.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-286">In addition to the IP addresses used by the Azure VNET infrastructure, each Redis instance in the subnet uses two IP addresses per shard and one additional IP address for the load balancer.</span></span> <span data-ttu-id="fcf3e-287">Egy nem fürtözött gyorsítótár egy shard tekinthető.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-287">A non-clustered cache is considered to have one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="fcf3e-288">Működnek-e minden gyorsítótár-funkciók egy VNETET a gyorsítótárhoz esetén?</span><span class="sxs-lookup"><span data-stu-id="fcf3e-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="fcf3e-289">Ha a gyorsítótár egy virtuális hálózat része, csak a virtuális hálózaton lévő ügyfelek is gyorsítótár-hozzáféréshez.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-289">When your cache is part of a VNET, only clients in the VNET can access the cache.</span></span> <span data-ttu-id="fcf3e-290">Ennek eredményeképpen a következő gyorsítótár-felügyeleti funkciók jelenleg nem működnek.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-290">As a result, the following cache management features don't work at this time.</span></span>

* <span data-ttu-id="fcf3e-291">Konzol redis - konzol Redis fut a helyi böngészőben, amely a virtuális hálózaton kívül, mert nem tud kapcsolódni a gyorsítótárhoz.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-291">Redis Console - Because Redis Console runs in your local browser, which is outside the VNET, it can't connect to your cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="fcf3e-292">Azure Redis gyorsítótár ExpressRoute használata</span><span class="sxs-lookup"><span data-stu-id="fcf3e-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="fcf3e-293">Az ügyfelek kapcsolódhatnak egy [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) kapcsolat a virtuális hálózati infrastruktúrára, így kiterjesztése a helyszíni hálózat az Azure-bA.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit to their virtual network infrastructure, thus extending their on-premises network to Azure.</span></span> 

<span data-ttu-id="fcf3e-294">Alapértelmezés szerint egy újonnan létrehozott ExpressRoute-kapcsolatcsoport nem végzi el a kényszerített bújtatás (az alapértelmezett útvonal hirdetmény 0.0.0.0/0) egy virtuális hálózaton.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="fcf3e-295">Ennek eredményeképpen kimenő internetkapcsolat engedélyezett a VNET-ről és ügyfélalkalmazások csatlakozni más Azure-végpontok Azure Redis Cache beleértve.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-295">As a result, outbound Internet connectivity is allowed directly from the VNET and client applications are able to connect to other Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="fcf3e-296">Azonban egy közös felhasználói konfigurálása, hogy használja kényszerített bújtatás (az alapértelmezett útvonal hirdetése) amely arra kényszeríti a kimenő Internet forgalmat inkább a helyszíni.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-296">However a common customer configuration is to use forced tunneling (advertise a default route) which forces outbound Internet traffic to instead flow on-premises.</span></span> <span data-ttu-id="fcf3e-297">A forgalom áramlását a kimenő forgalom esetén az Azure Redis Cache kapcsolat megsérti, majd a helyszíni blokkolva, például úgy, hogy az Azure Redis Cache példány nem tud kommunikálni a függőségeit.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-297">This traffic flow breaks connectivity with Azure Redis Cache if the outbound traffic is then blocked on-premises such that the Azure Redis Cache instance is not able to communicate with its dependencies.</span></span>

<span data-ttu-id="fcf3e-298">A megoldás, hogy egy (vagy több) felhasználó által definiált útvonalak (udr-EK) adja meg az alhálózatot, amely tartalmazza az Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-298">The solution is to define one (or more) user-defined routes (UDRs) on the subnet that contains the Azure Redis Cache.</span></span> <span data-ttu-id="fcf3e-299">Egy UDR helyett az alapértelmezett útvonal szembeni szerződéses kötelezettségeket vonatkozó alhálózati útvonalakat határozza meg.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-299">A UDR defines subnet-specific routes that will be honored instead of the default route.</span></span>

<span data-ttu-id="fcf3e-300">Ha lehetséges javasoljuk, hogy az alábbi konfigurációt használja:</span><span class="sxs-lookup"><span data-stu-id="fcf3e-300">If possible, it is recommended to use the following configuration:</span></span>

* <span data-ttu-id="fcf3e-301">Az ExpressRoute konfigurációs hirdeti 0.0.0.0/0, és alapértelmezés szerint kényszerített bújtatja minden kimenő forgalom helyszíni.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-301">The ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="fcf3e-302">Az alhálózatot, amely tartalmazza az Azure Redis Cache alkalmazott UDR a TCP/IP-forgalmat olyan működő útvonalat a 0.0.0.0/0 meghatározása a nyilvános internethez; például az beállítása a következő ugrás típusa "Internet".</span><span class="sxs-lookup"><span data-stu-id="fcf3e-302">The UDR applied to the subnet containing the Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic to the public internet; for example by setting the next hop type to 'Internet'.</span></span>

<span data-ttu-id="fcf3e-303">A kombinált hatását, hogy ezeket a lépéseket az, hogy az alhálózat-szintű UDR elsőbbséget élvez az ExpressRoute kényszerített bújtatás, biztosítva ezzel kimenő internetkapcsolattal az Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-303">The combined effect of these steps is that the subnet level UDR takes precedence over the ExpressRoute forced tunneling, thus ensuring outbound Internet access from the Azure Redis Cache.</span></span>

<span data-ttu-id="fcf3e-304">Azure Redis Cache példány csatlakozik egy helyszíni alkalmazásból ExpressRoute segítségével nincs tipikus használati eset miatt teljesítmény érdekében (a legjobb teljesítmény érdekében Azure Redis Cache-ügyfelek és az Azure Redis Cache ugyanabban a régióban kell lennie).</span><span class="sxs-lookup"><span data-stu-id="fcf3e-304">Connecting to an Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due to performance reasons (for best performance Azure Redis Cache clients should be in the same region as the Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="fcf3e-305">Egy UDR definiált útvonalak **kell** kellően specifikus elsőbbséget élveznek a bármely az ExpressRoute-konfiguráció által hirdetett útvonalakat.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-305">The routes defined in a UDR **must** be specific enough to take precedence over any routes advertised by the ExpressRoute configuration.</span></span> <span data-ttu-id="fcf3e-306">A következő példa a széles körű 0.0.0.0/0 címtartományt használja, és ilyen potenciálisan véletlenül felülbírálhatja útvonal-hirdetéseinek pontosabb címtartomány segítségével.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-306">The following example uses the broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="fcf3e-307">Azure Redis Cache ExpressRoute-konfigurációk használata nem támogatott, amelyek **helytelenül kereszt-hirdetményt a magánhálózati társviszony-létesítési elérési utat a nyilvános társviszony-létesítési elérési útvonalak**.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from the public peering path to the private peering path**.</span></span> <span data-ttu-id="fcf3e-308">ExpressRoute konfigurációkat, amelyek rendelkeznek a nyilvános társviszony konfigurálva, a Microsoft Azure IP-címtartományok számos útvonal-hirdetéseinek kapni a Microsofttól.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="fcf3e-309">Ha a címtartomány helytelenül határokon meghirdetett a magánhálózati társviszony-létesítési útvonalon, az eredménye, hogy minden kimenő hálózati rendszer érkező csomagokat, az Azure Redis Cache példány alhálózati helytelenül kényszerített-tunneled az ügyfél a helyi hálózati infrastruktúra .</span><span class="sxs-lookup"><span data-stu-id="fcf3e-309">If these address ranges are incorrectly cross-advertised on the private peering path, the result is that all outbound network packets from the Azure Redis Cache instance's subnet are incorrectly force-tunneled to a customer's on-premises network infrastructure.</span></span> <span data-ttu-id="fcf3e-310">A hálózati folyamata Azure Redis Cache megszakad.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="fcf3e-311">Ez a probléma megoldása, hogy állítsa le a kereszt-hirdetési útvonalak a nyilvános társviszony-létesítési elérési útról a magánhálózati társviszony-létesítési elérési utat.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-311">The solution to this problem is to stop cross-advertising routes from the public peering path to the private peering path.</span></span>


<span data-ttu-id="fcf3e-312">Háttér-információkat a felhasználó által definiált útvonalak érhető el ezen [áttekintése](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fcf3e-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="fcf3e-313">ExpressRoute kapcsolatos további információkért lásd: [ExpressRoute műszaki áttekintés](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="fcf3e-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="fcf3e-314">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="fcf3e-314">Next steps</span></span>
<span data-ttu-id="fcf3e-315">Megtudhatja, hogyan további premium gyorsítótár-funkciók használatára.</span><span class="sxs-lookup"><span data-stu-id="fcf3e-315">Learn how to use more premium cache features.</span></span>

* [<span data-ttu-id="fcf3e-316">Az Azure Redis Cache prémium szintjének bemutatása</span><span class="sxs-lookup"><span data-stu-id="fcf3e-316">Introduction to the Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

