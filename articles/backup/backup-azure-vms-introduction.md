---
title: "A virtuális gép az Azure biztonsági mentési infrastruktúra megtervezése |} Microsoft Docs"
description: "Az Azure virtuális gépek biztonsági megtervezésekor fontos tudnivalók találhatók"
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: "virtuális gépek biztonsági mentése, a virtuális gépek biztonsági mentése"
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: 0c930c7413b24a811707c3a1ff3d7d70585bc528
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/29/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="00ead-104">Virtuális gép biztonsági infrastruktúrájának megtervezése az Azure-ban</span><span class="sxs-lookup"><span data-stu-id="00ead-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="00ead-105">Ez a cikk ismerteti a teljesítmény- és erőforrás-javaslatok a virtuális gép biztonsági mentési infrastruktúra tervezéséhez nyújtanak segítséget.</span><span class="sxs-lookup"><span data-stu-id="00ead-105">This article provides performance and resource suggestions to help you plan your VM backup infrastructure.</span></span> <span data-ttu-id="00ead-106">A biztonsági mentési szolgáltatás; fő szempontjait is meghatározza lehet, hogy ezeket az jellemzőket fontos meghatározni, hogy az architektúra a kapacitástervezés és ütemezés.</span><span class="sxs-lookup"><span data-stu-id="00ead-106">It also defines key aspects of the Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="00ead-107">Ha megismerte [a környezet előkészítése](backup-azure-vms-prepare.md), tervezés, mint a megkezdése előtt [biztonsági mentése a virtuális gépek](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="00ead-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is the next step before you begin [to back up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="00ead-108">Ha az Azure virtuális gépek több információra van szüksége, tekintse meg a [Virtual Machines – dokumentáció](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="00ead-108">If you need more information about Azure virtual machines, see the [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="00ead-109">Hogyan működik az Azure virtuális gépek biztonsági mentése?</span><span class="sxs-lookup"><span data-stu-id="00ead-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="00ead-110">Az Azure Backup szolgáltatás a biztonsági mentési feladatot indít el a megadott időpontban, amikor elindítja a tartalék mellék időpontban pillanatképének elkészítéséhez.</span><span class="sxs-lookup"><span data-stu-id="00ead-110">When the Azure Backup service initiates a backup job at the scheduled time, it triggers the backup extension to take a point-in-time snapshot.</span></span> <span data-ttu-id="00ead-111">Az Azure Backup szolgáltatás használ a _VMSnapshot_ Windows, a bővítmény és a _VMSnapshotLinux_ Linux bővítményt.</span><span class="sxs-lookup"><span data-stu-id="00ead-111">The Azure Backup service uses the _VMSnapshot_ extension in Windows, and the _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="00ead-112">A bővítmény telepítve van a virtuális gép első biztonsági mentés során.</span><span class="sxs-lookup"><span data-stu-id="00ead-112">The extension is installed during the first VM backup.</span></span> <span data-ttu-id="00ead-113">A bővítmény telepítéséhez, a virtuális Gépen kell futnia.</span><span class="sxs-lookup"><span data-stu-id="00ead-113">To install the extension, the VM must be running.</span></span> <span data-ttu-id="00ead-114">Ha a virtuális gép nem fut, a biztonsági mentési szolgáltatás pillanatképet készít a az alapul szolgáló tárolási (mert nem alkalmazás írások végrehajthatók, miközben a virtuális gép le van állítva).</span><span class="sxs-lookup"><span data-stu-id="00ead-114">If the VM is not running, the Backup service takes a snapshot of the underlying storage (since no application writes occur while the VM is stopped).</span></span>

<span data-ttu-id="00ead-115">Windows virtuális gépek pillanatkép létrehozása van folyamatban, amikor a biztonsági mentési szolgáltatás koordinálja a a kötet árnyékmásolata szolgáltatás (VSS) a virtuális gép lemezeinek konzisztens pillanatképének eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="00ead-115">When taking a snapshot of Windows VMs, the Backup service coordinates with the Volume Shadow Copy Service (VSS) to get a consistent snapshot of the virtual machine's disks.</span></span> <span data-ttu-id="00ead-116">Ha biztonsági mentést készít a Linux virtuális gépek, szkripteket saját egyéni konzisztencia biztosításához, ha a virtuális gép pillanatkép létrehozása van folyamatban.</span><span class="sxs-lookup"><span data-stu-id="00ead-116">If you're backing up Linux VMs, you can write your own custom scripts to ensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="00ead-117">Meghívja a parancsfájlokat a részletek a cikk későbbi részében találhatók.</span><span class="sxs-lookup"><span data-stu-id="00ead-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="00ead-118">Miután az Azure Backup szolgáltatás a pillanatfelvételt, az adatátvitel a tárolóba.</span><span class="sxs-lookup"><span data-stu-id="00ead-118">Once the Azure Backup service takes the snapshot, the data is transferred to the vault.</span></span> <span data-ttu-id="00ead-119">Hatékonyságának maximalizálása érdekében a szolgáltatás azonosítja, és csak az adatok a korábbi biztonsági mentés óta módosult blokkok átvitele.</span><span class="sxs-lookup"><span data-stu-id="00ead-119">To maximize efficiency, the service identifies and transfers only the blocks of data that have changed since the previous backup.</span></span>

![Azure virtuális gép biztonsági mentési architektúra](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="00ead-121">Ha az adatok átvitele befejeződött, a rendszer eltávolítja a pillanatkép, és egy helyreállítási pontot hoz létre.</span><span class="sxs-lookup"><span data-stu-id="00ead-121">When the data transfer is complete, the snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="00ead-122">A biztonsági mentési folyamat során Azure biztonsági mentés nem tartalmazza a ideiglenes lemezt a virtuális géphez csatolt.</span><span class="sxs-lookup"><span data-stu-id="00ead-122">During the backup process, Azure Backup doesn't include the temporary disk attached to the virtual machine.</span></span> <span data-ttu-id="00ead-123">További információkért tekintse meg a blog [ideiglenes tárolási](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="00ead-123">For more information, see the blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="00ead-124">Mivel az Azure biztonsági mentési tároló szintű pillanatképet készít, és továbbítja a tároló, ne változtassa meg a tárfiók kulcsait a biztonsági mentési feladat befejezéséig.</span><span class="sxs-lookup"><span data-stu-id="00ead-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot to vault, do not change the storage account keys until the backup job finishes.</span></span>
> 3. <span data-ttu-id="00ead-125">Prémium szintű virtuális gépek a tárfiók a pillanatkép másolja azt.</span><span class="sxs-lookup"><span data-stu-id="00ead-125">For premium VMs, we copy the snapshot to storage account.</span></span> <span data-ttu-id="00ead-126">Ez a, győződjön meg arról, hogy Azure Backup szolgáltatás elegendő IOPS lekérdezi az adatoknak a tároló.</span><span class="sxs-lookup"><span data-stu-id="00ead-126">This is to make sure that Azure Backup service gets sufficient IOPS for transferring data to vault.</span></span> <span data-ttu-id="00ead-127">A tárolási további példányának fel van töltve, a virtuális gép lefoglalt méret szerint.</span><span class="sxs-lookup"><span data-stu-id="00ead-127">This additional copy of storage is charged as per the VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="00ead-128">Adatkonzisztencia</span><span class="sxs-lookup"><span data-stu-id="00ead-128">Data consistency</span></span>
<span data-ttu-id="00ead-129">Biztonsági mentése és visszaállítása a kritikus fontosságú adatok bonyolítja van arra, hogy üzleti szempontból fontos adatokhoz kell biztonsági mentése során az alkalmazások az adatokat előállító üzleti futnak.</span><span class="sxs-lookup"><span data-stu-id="00ead-129">Backing up and restoring business critical data is complicated by the fact that business critical data must be backed up while the applications that produce the data are running.</span></span> <span data-ttu-id="00ead-130">Orvoslása érdekében Azure biztonsági mentés támogatja az alkalmazáskonzisztens biztonsági mentés a Windows és a Linux virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="00ead-130">To address this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="00ead-131">Windowsos VM</span><span class="sxs-lookup"><span data-stu-id="00ead-131">Windows VM</span></span>
<span data-ttu-id="00ead-132">Azure biztonsági mentés VSS teljes biztonsági mentés a Windows virtuális gépeken időt vesz igénybe. (további információk [VSS teljes biztonsági mentés](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="00ead-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="00ead-133">Ahhoz, hogy a VSS másolásos biztonsági mentéshez, a következő beállításkulcsot kell állítani a virtuális Gépen.</span><span class="sxs-lookup"><span data-stu-id="00ead-133">To enable VSS copy backups, the following registry key needs to be set on the VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="00ead-134">Linux rendszerű virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="00ead-134">Linux VMs</span></span>
<span data-ttu-id="00ead-135">Azure biztonsági mentés egy parancsfájl-kezelési keretrendszert biztosít.</span><span class="sxs-lookup"><span data-stu-id="00ead-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="00ead-136">Linux virtuális gépek biztonsági mentéséről alkalmazás konzisztencia érdekében hozzon létre egyéni előtti és utáni parancsfájlok, amelyek vezérlik a biztonsági mentési munkafolyamat és a környezetben.</span><span class="sxs-lookup"><span data-stu-id="00ead-136">To ensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control the backup workflow and environment.</span></span> <span data-ttu-id="00ead-137">Azure biztonsági mentés előtti parancsfájl elindítja a virtuális gép pillanatképének készítése előtt, és meghívja az utólagos parancsfájl a virtuális gép pillanatkép-feladat befejeződése után.</span><span class="sxs-lookup"><span data-stu-id="00ead-137">Azure Backup invokes the pre-script before taking the VM snapshot and invokes the post-script once the VM snapshot job completes.</span></span> <span data-ttu-id="00ead-138">További részletekért lásd: [alkalmazás konzisztens VM a biztonsági mentéseket parancsfájl előtti és utáni parancsfájl](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="00ead-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="00ead-139">Azure biztonsági mentés csak hív meg, az ügyfél-írt előtti és utáni parancsfájlokat.</span><span class="sxs-lookup"><span data-stu-id="00ead-139">Azure Backup only invokes the customer-written pre- and post-scripts.</span></span> <span data-ttu-id="00ead-140">Ha a előtti parancsfájl és utáni parancsfájlok végrehajtása sikertelen, Azure biztonsági mentés állapotúként jelöli meg a helyreállítási pont alkalmazás konzisztens.</span><span class="sxs-lookup"><span data-stu-id="00ead-140">If the pre-script and post-scripts execute successfully, Azure Backup marks the recovery point as application consistent.</span></span> <span data-ttu-id="00ead-141">Azonban az ügyfél akkor végső soron felelős alkalmazás konzisztenciájának, amikor egyéni parancsfájlok használatával.</span><span class="sxs-lookup"><span data-stu-id="00ead-141">However, the customer is ultimately responsible for the application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="00ead-142">Ez a táblázat ismerteti az konzisztencia típusát és a feltételeket, ezek alapján során felmerülő Azure virtuális gép biztonsági mentési és helyreállítási eljárásokat.</span><span class="sxs-lookup"><span data-stu-id="00ead-142">This table explains the types of consistency and the conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="00ead-143">Konzisztencia</span><span class="sxs-lookup"><span data-stu-id="00ead-143">Consistency</span></span> | <span data-ttu-id="00ead-144">VSS-alapú</span><span class="sxs-lookup"><span data-stu-id="00ead-144">VSS-based</span></span> | <span data-ttu-id="00ead-145">MAGYARÁZAT és részletek</span><span class="sxs-lookup"><span data-stu-id="00ead-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="00ead-146">Alkalmazáskonzisztencia</span><span class="sxs-lookup"><span data-stu-id="00ead-146">Application consistency</span></span> |<span data-ttu-id="00ead-147">Igen, a Windows rendszerhez</span><span class="sxs-lookup"><span data-stu-id="00ead-147">Yes for Windows</span></span>|<span data-ttu-id="00ead-148">Alkalmazás konzisztencia ideális munkaterhelésekhez, biztosítja, hogy:</span><span class="sxs-lookup"><span data-stu-id="00ead-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="00ead-149">A virtuális gép *elindul a*.</span><span class="sxs-lookup"><span data-stu-id="00ead-149">The VM *boots up*.</span></span> <li><span data-ttu-id="00ead-150">Nincs *sérülés nem*.</span><span class="sxs-lookup"><span data-stu-id="00ead-150">There is *no corruption*.</span></span> <li><span data-ttu-id="00ead-151">Nincs *adatvesztés nélküli*.</span><span class="sxs-lookup"><span data-stu-id="00ead-151">There is *no data loss*.</span></span><li> <span data-ttu-id="00ead-152">Az adatok minden az alkalmazáshoz, amely az adatokat, használja az alkalmazás biztonsági mentés – VSS vagy előkészítő/utólagos parancsfájl használatával bevonásával konzisztens.</span><span class="sxs-lookup"><span data-stu-id="00ead-152">The data is consistent to the application that uses the data, by involving the application at the time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="00ead-153">*Windows virtuális gépek*-legtöbb Microsoft-munkaterhelések rendelkeznek VSS-író, amely kapcsolódik az adatok konzisztenciájának munkaterhelés-specifikus műveleteket hajthatja végre.</span><span class="sxs-lookup"><span data-stu-id="00ead-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related to data consistency.</span></span> <span data-ttu-id="00ead-154">Például a Microsoft SQL Server, amely biztosítja, hogy az írási műveleteket ad ki az adatbázis és a tranzakciós naplófájlt megfelelően történik-e VSS-író tartozik.</span><span class="sxs-lookup"><span data-stu-id="00ead-154">For example, Microsoft SQL Server has a VSS writer that ensures that the writes to the transaction log file and the database are done correctly.</span></span> <span data-ttu-id="00ead-155">Az Azure Windows virtuális gép biztonsági mentések alkalmazáskonzisztens helyreállítási pont létrehozása a tartalék mellék kell meghívni a VSS munkafolyamat és befejeződését, mielőtt a virtuális gép pillanatképének készítése.</span><span class="sxs-lookup"><span data-stu-id="00ead-155">For Azure Windows VM backups, to create an application-consistent recovery point, the backup extension must invoke the VSS workflow and complete it before taking the VM snapshot.</span></span> <span data-ttu-id="00ead-156">Az Azure virtuális gép pillanatképének pontosak, az összes Azure virtuális gép alkalmazás VSS-író elvégzése után is.</span><span class="sxs-lookup"><span data-stu-id="00ead-156">For the Azure VM snapshot to be accurate, the VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="00ead-157">(További a [VSS alapjait](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) és mély alaposabban részleteit [működésének](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="00ead-157">(Learn the [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into the details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="00ead-158">*Linux virtuális gépek*-ügyfelek végrehajtható [egyéni előtti parancsfájl és az alkalmazás konzisztencia biztosításához utáni parancsfájl](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="00ead-158">*Linux VMs*- Customers can execute [custom pre-script and post-script to ensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="00ead-159">Fájlrendszer-konzisztenciával</span><span class="sxs-lookup"><span data-stu-id="00ead-159">File-system consistency</span></span> |<span data-ttu-id="00ead-160">Igen – Windows-alapú számítógépekhez</span><span class="sxs-lookup"><span data-stu-id="00ead-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="00ead-161">Két esetben, ahol a helyreállítási pont lehet *fájlrendszer konzisztens*:</span><span class="sxs-lookup"><span data-stu-id="00ead-161">There are two scenarios where the recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="00ead-162">Linux virtuális gépek Azure nélkül előtti-script/követő-script, vagy ha előtti-script/követő-script nem sikerült biztonsági mentést.</span><span class="sxs-lookup"><span data-stu-id="00ead-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="00ead-163">VSS-hiba történt a Windows Azure virtuális gépek biztonsági mentését.</span><span class="sxs-lookup"><span data-stu-id="00ead-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="00ead-164">Mindkét esetben a legjobb végezheti el, hogy ellenőrizze, hogy:</span><span class="sxs-lookup"><span data-stu-id="00ead-164">In both these cases, the best that can be done is to ensure that:</span></span> <ol><li> <span data-ttu-id="00ead-165">A virtuális gép *elindul a*.</span><span class="sxs-lookup"><span data-stu-id="00ead-165">The VM *boots up*.</span></span> <li><span data-ttu-id="00ead-166">Nincs *sérülés nem*.</span><span class="sxs-lookup"><span data-stu-id="00ead-166">There is *no corruption*.</span></span><li><span data-ttu-id="00ead-167">Nincs *adatvesztés nélküli*.</span><span class="sxs-lookup"><span data-stu-id="00ead-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="00ead-168">Alkalmazásokat kell megvalósítani a saját "javítás felfelé" mechanizmus a visszaállított adatok.</span><span class="sxs-lookup"><span data-stu-id="00ead-168">Applications need to implement their own "fix-up" mechanism on the restored data.</span></span> |
| <span data-ttu-id="00ead-169">Összeomlás-konzisztencia</span><span class="sxs-lookup"><span data-stu-id="00ead-169">Crash consistency</span></span> |<span data-ttu-id="00ead-170">Nem</span><span class="sxs-lookup"><span data-stu-id="00ead-170">No</span></span> |<span data-ttu-id="00ead-171">Ez a helyzet megegyezik egy virtuális gép "összeomlási" (keresztül letölthető vagy rögzített reset) tapasztal.</span><span class="sxs-lookup"><span data-stu-id="00ead-171">This situation is equivalent to a virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="00ead-172">Összeomlási konzisztencia általában akkor fordul elő, le, amikor virtuális gépet az Azure biztonsági mentés idején.</span><span class="sxs-lookup"><span data-stu-id="00ead-172">Crash consistency typically happens when the Azure virtual machine is shut down at the time of backup.</span></span> <span data-ttu-id="00ead-173">Összeomlás-konzisztens helyreállítási pontot nyújt az adathordozón tárolt--vagy az operációs rendszer vagy az alkalmazás szempontjából nem garantálja az adatok konzisztenciájának körül.</span><span class="sxs-lookup"><span data-stu-id="00ead-173">A crash-consistent recovery point provides no guarantees around the consistency of the data on the storage medium--either from the perspective of the operating system or the application.</span></span> <span data-ttu-id="00ead-174">Csak a biztonsági mentés idején a lemezen már meglévő adatok rögzítése és biztonsági mentése.</span><span class="sxs-lookup"><span data-stu-id="00ead-174">Only the data that already exists on the disk at the time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="00ead-175">Amíg vannak általában nem garantálja, az operációs rendszer indítása követ lemez ellenőrzése eljárás, például a chkdsk eszközhöz, bármely sérülést hibák elhárításához.</span><span class="sxs-lookup"><span data-stu-id="00ead-175">While there are no guarantees, usually, the operating system boots, followed by disk-checking procedure, like chkdsk, to fix any corruption errors.</span></span> <span data-ttu-id="00ead-176">Bármely a memóriában levő vagy nem átadott a lemezre írás elvesznek.</span><span class="sxs-lookup"><span data-stu-id="00ead-176">Any in-memory data or writes that have not been transferred to the disk are lost.</span></span> <span data-ttu-id="00ead-177">Az alkalmazás általában követi a saját hitelesítési mechanizmus, abban az esetben adatok visszaállítás azért van szükség.</span><span class="sxs-lookup"><span data-stu-id="00ead-177">The application typically follows with its own verification mechanism in case data rollback needs to be done.</span></span> <br><br><span data-ttu-id="00ead-178">Tegyük fel Ha a tranzakciós napló bejegyzéseit, amelyek nincsenek jelen az adatbázisban, majd adatbázis letiltását a visszaállítás addig, amíg az adatok nem konzisztens.</span><span class="sxs-lookup"><span data-stu-id="00ead-178">As an example, if the transaction log has entries that are not present in the database, then the database software does a rollback until the data is consistent.</span></span> <span data-ttu-id="00ead-179">Adatok (például átnyúló kötetek) több virtuális lemez van elosztva, összeomlás-konzisztens helyreállítási pontot az adatok helyességét garanciát nem biztosít.</span><span class="sxs-lookup"><span data-stu-id="00ead-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for the correctness of the data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="00ead-180">Teljesítmény- és erőforrás-használat</span><span class="sxs-lookup"><span data-stu-id="00ead-180">Performance and resource utilization</span></span>
<span data-ttu-id="00ead-181">Telepített helyszíni biztonsági mentési szoftver, például meg kell terveznie a kapacitás és az erőforrás-használat igényeinek biztonsági mentésekor az Azure virtuális gépeken.</span><span class="sxs-lookup"><span data-stu-id="00ead-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="00ead-182">A [Azure Storage korlátozza](../azure-subscription-service-limits.md#storage-limits) meghatározhatja, hogyan kell a struktúra maximális teljesítménye érdekében minimális hatással van a munkafolyamatot futtató Virtuálisgép-telepítések.</span><span class="sxs-lookup"><span data-stu-id="00ead-182">The [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how to structure VM deployments to get maximum performance with minimum impact to running workloads.</span></span>

<span data-ttu-id="00ead-183">A következő Azure Storage-korlátok különös biztonsági mentés teljesítményét tervezése során:</span><span class="sxs-lookup"><span data-stu-id="00ead-183">Pay attention to the following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="00ead-184">Maximális kilépő / storage-fiók</span><span class="sxs-lookup"><span data-stu-id="00ead-184">Max egress per storage account</span></span>
* <span data-ttu-id="00ead-185">A tárfiók egy teljes kérelmek gyakorisága</span><span class="sxs-lookup"><span data-stu-id="00ead-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="00ead-186">Tárfiókok korlátai</span><span class="sxs-lookup"><span data-stu-id="00ead-186">Storage account limits</span></span>
<span data-ttu-id="00ead-187">Biztonsági mentési adatokat másolni a tárfiókból, hozzáadja a bemeneti/kimeneti műveletek száma másodpercenként (IOPS) és a kimenő forgalom (vagy átviteli) metrikákat a tárfiók.</span><span class="sxs-lookup"><span data-stu-id="00ead-187">Backup data copied from a storage account, adds to the input/output operations per second (IOPS) and egress (or throughput) metrics of the storage account.</span></span> <span data-ttu-id="00ead-188">Ugyanakkor a virtuális gépek is fel iops-érték és a teljesítményt.</span><span class="sxs-lookup"><span data-stu-id="00ead-188">At the same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="00ead-189">A cél, hogy ellenőrizze a biztonsági mentési és a virtuális gép forgalom nem lépik túl a tárfiókok korlátai.</span><span class="sxs-lookup"><span data-stu-id="00ead-189">The goal is to ensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="00ead-190">Lemezek száma</span><span class="sxs-lookup"><span data-stu-id="00ead-190">Number of disks</span></span>
<span data-ttu-id="00ead-191">A biztonsági mentési folyamat megkísérli a lehető leggyorsabban végezze el a biztonsági mentési feladatot.</span><span class="sxs-lookup"><span data-stu-id="00ead-191">The backup process tries to complete a backup job as quickly as possible.</span></span> <span data-ttu-id="00ead-192">Ennek során, akkor használhatja a lehető legtöbb erőforrást.</span><span class="sxs-lookup"><span data-stu-id="00ead-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="00ead-193">Azonban minden i/o-műveletek korlátozza a *egyetlen BLOB tároló átviteli*, 60 MB másodpercenként legfeljebb tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="00ead-193">However, all I/O operations are limited by the *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="00ead-194">Az a sebesség maximalizálása érdekében tett kísérlet, a biztonsági mentési folyamat megpróbálja készítsen biztonsági másolatot a virtuális gép lemezeinek mindegyikének *párhuzamosan*.</span><span class="sxs-lookup"><span data-stu-id="00ead-194">In an attempt to maximize its speed, the backup process tries to back up each of the VM's disks *in parallel*.</span></span> <span data-ttu-id="00ead-195">Ha egy virtuális gép négy lemezzel rendelkezik, a szolgáltatás megkísérli készítsen biztonsági másolatot az összes négy lemez párhuzamosan.</span><span class="sxs-lookup"><span data-stu-id="00ead-195">If a VM has four disks, the service attempts to back up all four disks in parallel.</span></span> <span data-ttu-id="00ead-196">A **lemezek száma** a tárolási fiók biztonsági mentési forgalom meghatározásának egyik legfontosabb szempontja biztonsági mentése, folyamatban.</span><span class="sxs-lookup"><span data-stu-id="00ead-196">The **number of disks** being backed up, is the most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="00ead-197">Biztonsági mentés ütemezése</span><span class="sxs-lookup"><span data-stu-id="00ead-197">Backup schedule</span></span>
<span data-ttu-id="00ead-198">Egy további tényező, amely hatással van a teljesítmény a **biztonsági mentés ütemezése**.</span><span class="sxs-lookup"><span data-stu-id="00ead-198">An additional factor that impacts performance is the **backup schedule**.</span></span> <span data-ttu-id="00ead-199">Így minden virtuális gép biztonsági mentése egy időben konfigurálhatja a házirendeket, ha beütemeztek egy forgalom a probléma megoldásáig.</span><span class="sxs-lookup"><span data-stu-id="00ead-199">If you configure the policies so all VMs are backed up at the same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="00ead-200">A biztonsági mentési folyamat megpróbálja készítsen biztonsági másolatot az összes lemez párhuzamosan.</span><span class="sxs-lookup"><span data-stu-id="00ead-200">The backup process attempts to back up all disks in parallel.</span></span> <span data-ttu-id="00ead-201">A biztonsági mentési adatforgalom csökkentése a tárfiókból, készítsen biztonsági másolatot különböző virtuális gépek különböző időpontban a nap-átlapolás nélkül.</span><span class="sxs-lookup"><span data-stu-id="00ead-201">To reduce the backup traffic from a storage account, back up different VMs at different time of the day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="00ead-202">Kapacitástervezés</span><span class="sxs-lookup"><span data-stu-id="00ead-202">Capacity planning</span></span>
<span data-ttu-id="00ead-203">Üzembe az előző tényezőket, meg kell terveznie az a tárolási fiók igényei.</span><span class="sxs-lookup"><span data-stu-id="00ead-203">Putting the previous factors together, you need to plan for the storage account usage needs.</span></span> <span data-ttu-id="00ead-204">Töltse le a [virtuális gép biztonsági mentési kapacitástervezési Excel-táblázat](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) a lemez és a biztonsági mentés ütemezése lehetőségei hatásának megjelenítéséhez.</span><span class="sxs-lookup"><span data-stu-id="00ead-204">Download the [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) to see the impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="00ead-205">Biztonsági mentési átviteli sebesség</span><span class="sxs-lookup"><span data-stu-id="00ead-205">Backup throughput</span></span>
<span data-ttu-id="00ead-206">Az egyes lemezek biztonsági mentés alatt Azure biztonsági mentési olvassa be a lemezen a blokkok és csak a módosított adatokat (növekményes biztonsági mentés) tárolja.</span><span class="sxs-lookup"><span data-stu-id="00ead-206">For each disk being backed up, Azure Backup reads the blocks on the disk and stores only the changed data (incremental backup).</span></span> <span data-ttu-id="00ead-207">A következő táblázat a biztonsági másolat szolgáltatás átlagos átviteli értékek.</span><span class="sxs-lookup"><span data-stu-id="00ead-207">The following table shows the average Backup service throughput values.</span></span> <span data-ttu-id="00ead-208">A következő adatokat használja, megbecsülheti biztonsági mentése egy adott ekkora lemezt szükséges időt.</span><span class="sxs-lookup"><span data-stu-id="00ead-208">Using the following data, you can estimate the amount of time needed to back up a disk of a given size.</span></span>

| <span data-ttu-id="00ead-209">Biztonsági mentési művelet</span><span class="sxs-lookup"><span data-stu-id="00ead-209">Backup operation</span></span> | <span data-ttu-id="00ead-210">Hányad átviteli sebesség</span><span class="sxs-lookup"><span data-stu-id="00ead-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="00ead-211">Kezdeti biztonsági mentés</span><span class="sxs-lookup"><span data-stu-id="00ead-211">Initial backup</span></span> |<span data-ttu-id="00ead-212">160 MB/s</span><span class="sxs-lookup"><span data-stu-id="00ead-212">160 Mbps</span></span> |
| <span data-ttu-id="00ead-213">A növekményes biztonsági mentés (DR)</span><span class="sxs-lookup"><span data-stu-id="00ead-213">Incremental backup (DR)</span></span> |<span data-ttu-id="00ead-214">640 MB/s</span><span class="sxs-lookup"><span data-stu-id="00ead-214">640 Mbps</span></span> <br><br> <span data-ttu-id="00ead-215">Átviteli sebesség jelentősen csökken, ha a lemez közötti megvédheti a módosított adatokat (igénylő biztonsági mentése).</span><span class="sxs-lookup"><span data-stu-id="00ead-215">Throughput drops significantly if the changed data (that needs to be backed up) is dispersed across the disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="00ead-216">Virtuális gép teljes biztonsági mentés ideje</span><span class="sxs-lookup"><span data-stu-id="00ead-216">Total VM backup time</span></span>
<span data-ttu-id="00ead-217">A biztonsági mentési legtöbbször ennek olvasását és az adatok másolásának telik, amíg más műveletek hozzájárul a teljes ideje, készítsen biztonsági másolatot a virtuális gép szükséges.</span><span class="sxs-lookup"><span data-stu-id="00ead-217">While most of the backup time is spent reading and copying data, other operations contribute to the total time needed to back up a VM:</span></span>

* <span data-ttu-id="00ead-218">Szükséges idő [telepítse vagy frissítse a tartalék mellék](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="00ead-218">Time needed to [install or update the backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="00ead-219">Pillanatkép ideje, ami időn belül elindítani egy pillanatkép.</span><span class="sxs-lookup"><span data-stu-id="00ead-219">Snapshot time, which is the time taken to trigger a snapshot.</span></span> <span data-ttu-id="00ead-220">A pillanatképek megközelíti az ütemezett biztonsági mentéskor aktiválódnak.</span><span class="sxs-lookup"><span data-stu-id="00ead-220">Snapshots are triggered close to the scheduled backup time.</span></span>
* <span data-ttu-id="00ead-221">Várakozási ideje.</span><span class="sxs-lookup"><span data-stu-id="00ead-221">Queue wait time.</span></span> <span data-ttu-id="00ead-222">A biztonsági mentési szolgáltatás biztonsági mentések több ügyfél feldolgozása, mert pillanatkép biztonsági mentési adatok másolása a biztonsági mentési vagy a Recovery Services-tároló esetleg nem azonnal elindítani.</span><span class="sxs-lookup"><span data-stu-id="00ead-222">Since the Backup service is processing backups from multiple customers, copying backup data from snapshot to the backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="00ead-223">A maximális idejét betöltése, és a várakozási is stretch legfeljebb nyolc óra feldolgozott biztonsági másolatok száma miatt.</span><span class="sxs-lookup"><span data-stu-id="00ead-223">In times of peak load, the wait can stretch up to eight hours due to the number of backups being processed.</span></span> <span data-ttu-id="00ead-224">Azonban a teljes virtuális gép biztonsági mentési ideje 24 óránál kevesebb napi biztonsági mentési házirendek.</span><span class="sxs-lookup"><span data-stu-id="00ead-224">However, the total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="00ead-225">Adatátviteli idő, a biztonsági mentési szolgáltatás számára, a korábbi biztonsági mentés a növekményes változásokat számítási és a változások átvitele tárolási tároló szükséges idő.</span><span class="sxs-lookup"><span data-stu-id="00ead-225">Data transfer time, time needed for backup service to compute the incremental changes from previous backup and transfer those changes to vault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="00ead-226">Miért vagyok I betartásával longer(>12 hours) biztonsági mentés ideje?</span><span class="sxs-lookup"><span data-stu-id="00ead-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="00ead-227">Biztonsági mentés két fázisból áll: pillanatképek készítése, és a pillanatképek átvitele a tárolóban.</span><span class="sxs-lookup"><span data-stu-id="00ead-227">Backup consists of two phases: taking snapshots and transferring the snapshots to the vault.</span></span> <span data-ttu-id="00ead-228">A biztonsági mentési szolgáltatás optimalizálja a tároláshoz.</span><span class="sxs-lookup"><span data-stu-id="00ead-228">The Backup service optimizes for storage.</span></span> <span data-ttu-id="00ead-229">A pillanatkép-adatok átviteléhez a tárolóba, a szolgáltatás csak a növekményes változásokat átviszi az előző pillanatképet.</span><span class="sxs-lookup"><span data-stu-id="00ead-229">When transferring the snapshot data to a vault, the service only transfers incremental changes from the previous snapshot.</span></span>  <span data-ttu-id="00ead-230">Annak megállapításához, a növekményes módosításokat, a szolgáltatás kiszámítja a blokkok ellenőrzőösszeg.</span><span class="sxs-lookup"><span data-stu-id="00ead-230">To determine the incremental changes, the service computes the checksum of the blocks.</span></span> <span data-ttu-id="00ead-231">Ha a blokk módosul, a blokk egy blokkot, a tároló küldendő azonosítja.</span><span class="sxs-lookup"><span data-stu-id="00ead-231">If a block is changed, the block is identified as a block to be sent to the vault.</span></span> <span data-ttu-id="00ead-232">A szolgáltatás csukja majd további mindegyik azonosított blokkok, minimálisra csökkentése érdekében az adatok átvitele lehetőségek keres.</span><span class="sxs-lookup"><span data-stu-id="00ead-232">Then the service drills further into each of the identified blocks, looking for opportunities to minimize the data to transfer.</span></span> <span data-ttu-id="00ead-233">Minden megváltozott blokkokat kiértékelése, után a szolgáltatás egyesíti a módosításokat, és elküldi azokat a tárolóban.</span><span class="sxs-lookup"><span data-stu-id="00ead-233">After evaluating all changed blocks, the service coalesces the changes and sends them to the vault.</span></span> <span data-ttu-id="00ead-234">Néhány örökölt alkalmazás kicsi, töredezett írások optimálisak nem tárolására.</span><span class="sxs-lookup"><span data-stu-id="00ead-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="00ead-235">A pillanatkép tartalmazza a sok kisméretű, töredezett írási műveleteket, ha a szolgáltatás fordít további időt, az alkalmazások által írt adatok feldolgozására.</span><span class="sxs-lookup"><span data-stu-id="00ead-235">If the snapshot contains many small, fragmented writes, the service spends additional time processing the data written by the applications.</span></span> <span data-ttu-id="00ead-236">Az ajánlott alkalmazás írási kitiltás az Azure, a virtuális Gépen belül futó alkalmazások, legalább 8 KB-os van.</span><span class="sxs-lookup"><span data-stu-id="00ead-236">The recommended application write block from Azure, for applications running inside the VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="00ead-237">Ha az alkalmazás egy legfeljebb 8 KB-os blokkméretet, a biztonsági mentés teljesítményét történik.</span><span class="sxs-lookup"><span data-stu-id="00ead-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="00ead-238">Az alkalmazás biztonsági mentési teljesítményének javítása érdekében hangolása kapcsolatban lásd: [alkalmazások az Azure storage optimális teljesítményének hangolása](../storage/common/storage-premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="00ead-238">For help with tuning your application to improve backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="00ead-239">Bár a biztonsági mentés teljesítményét foglalkozó prémium szintű storage példák használ, a útmutatást esetén szabványos tárolólemezek alkalmazható.</span><span class="sxs-lookup"><span data-stu-id="00ead-239">Though the article on backup performance uses Premium storage examples, the guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="00ead-240">Teljes helyreállítás időpontjára</span><span class="sxs-lookup"><span data-stu-id="00ead-240">Total restore time</span></span>
<span data-ttu-id="00ead-241">A visszaállítási művelet áll két fő sub feladat: adatok másolása a kiválasztott ügyfél tárfiókja vissza a tárolóból, és a virtuális gép létrehozása.</span><span class="sxs-lookup"><span data-stu-id="00ead-241">A restore operation consists of two main sub tasks: Copying data back from the vault to the chosen customer storage account, and creating the virtual machine.</span></span> <span data-ttu-id="00ead-242">Az adatok másolásának vissza a tárolóból, a biztonsági másolatokat tároló belső az Azure-ban, és az ügyfél tárfiókja tároló függ.</span><span class="sxs-lookup"><span data-stu-id="00ead-242">Copying data back from the vault depends on where the backups are stored internally in Azure, and where the customer storage account is stored.</span></span> <span data-ttu-id="00ead-243">Adat másolása szükséges idő függ:</span><span class="sxs-lookup"><span data-stu-id="00ead-243">Time taken to copy data depends upon:</span></span>
* <span data-ttu-id="00ead-244">Várakozási ideje - dolgozza fel az szolgáltatás feladatok visszaállítása több ügyfél egyszerre, mivel visszaállítási kérések használata várólista be.</span><span class="sxs-lookup"><span data-stu-id="00ead-244">Queue wait time - Since the service processes restore jobs from multiple customers at the same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="00ead-245">Az adatmásolási idő - adatokat az ügyfél tárfiókja másolja a tárolóból.</span><span class="sxs-lookup"><span data-stu-id="00ead-245">Data copy time - Data is copied from the vault to the customer storage account.</span></span> <span data-ttu-id="00ead-246">Visszaállítás idő függ az IOPS és átviteli Azure Backup szolgáltatás lekérdezi a kijelölt ügyfél tárfiók.</span><span class="sxs-lookup"><span data-stu-id="00ead-246">Restore time depends on IOPS and throughput Azure Backup service gets on the selected customer storage account.</span></span> <span data-ttu-id="00ead-247">A visszaállítás során a másolási idejének csökkentése érdekében válasszon egy nem betöltött más alkalmazás írások és olvasások tárfiókot.</span><span class="sxs-lookup"><span data-stu-id="00ead-247">To reduce the copying time during the restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="00ead-248">Ajánlott eljárások</span><span class="sxs-lookup"><span data-stu-id="00ead-248">Best practices</span></span>
<span data-ttu-id="00ead-249">Javasoljuk, hogy ezeket a gyakorlatokat, virtuális gépek biztonsági mentéseinek konfigurálása közben követően:</span><span class="sxs-lookup"><span data-stu-id="00ead-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="00ead-250">Nem ütemezhető be a 10-nél több klasszikus virtuális gépek biztonsági mentése egyszerre ugyanazon felhőalapú szolgáltatásából.</span><span class="sxs-lookup"><span data-stu-id="00ead-250">Don't schedule more than 10 classic VMs from the same cloud service to back up at the same time.</span></span> <span data-ttu-id="00ead-251">Ha azt szeretné, a biztonsági mentés több virtuális gép ugyanazon a felhőalapú szolgáltatás, a biztonsági mentés kezdési idejének eltolása a egy órával.</span><span class="sxs-lookup"><span data-stu-id="00ead-251">If you want to back up multiple VMs from same cloud service, stagger the backup start times by an hour.</span></span>
* <span data-ttu-id="00ead-252">Nem ütemezhető be a 40-nél több virtuális gépek biztonsági mentése egy időben.</span><span class="sxs-lookup"><span data-stu-id="00ead-252">Do not schedule more than 40 VMs to back up at the same time.</span></span>
* <span data-ttu-id="00ead-253">Virtuális gép biztonsági mentések ütemezése során csúcsidőn kívül.</span><span class="sxs-lookup"><span data-stu-id="00ead-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="00ead-254">Ily módon a biztonsági mentési szolgáltatás IOPS használ az ügyfél tárfiókja adatokat továbbít a tárolóban.</span><span class="sxs-lookup"><span data-stu-id="00ead-254">This way the Backup service uses IOPS for transferring data from the customer storage account to the vault.</span></span>
* <span data-ttu-id="00ead-255">Győződjön meg arról, hogy a házirend érvényben van-e elosztva a eltérő tárfiókokból virtuális gépeken.</span><span class="sxs-lookup"><span data-stu-id="00ead-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="00ead-256">Javasoljuk, hogy legfeljebb 20 teljes lemezek egyetlen tárfiókból védi a ugyanazt biztonsági mentés ütemezése.</span><span class="sxs-lookup"><span data-stu-id="00ead-256">We suggest no more than 20 total disks from a single storage account be protected by the same backup schedule.</span></span> <span data-ttu-id="00ead-257">Ha nagyobb, mint 20 lemezek tárfiókokban, a virtuális gépek elosztva több házirendet a szükséges IOPS lekérni a biztonsági mentési folyamat átviteli szakasza során.</span><span class="sxs-lookup"><span data-stu-id="00ead-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies to get the required IOPS during the transfer phase of the backup process.</span></span>
* <span data-ttu-id="00ead-258">Ne állítson vissza egy virtuális Gépen futó prémium szintű storage ugyanazt a tárfiókot.</span><span class="sxs-lookup"><span data-stu-id="00ead-258">Do not restore a VM running on Premium storage to same storage account.</span></span> <span data-ttu-id="00ead-259">Ha a visszaállítási művelet folyamat megegyezik a biztonsági mentési művelet, csökkenti a rendelkezésre álló IOPS a biztonsági mentéshez.</span><span class="sxs-lookup"><span data-stu-id="00ead-259">If the restore operation process coincides with the backup operation, it reduces the available IOPS for backup.</span></span>
* <span data-ttu-id="00ead-260">A prémium szintű virtuális gép biztonsági mentése győződjön meg arról, hogy az állomások premium lemezek rendelkezik-e legalább 50 % szabad terület a sikeres biztonsági mentéshez pillanatkép átmeneti tárolási fiók.</span><span class="sxs-lookup"><span data-stu-id="00ead-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="00ead-261">Győződjön meg arról, hogy a Linux virtuális gépeken python verzió engedélyezett a biztonsági mentés 2.7</span><span class="sxs-lookup"><span data-stu-id="00ead-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="00ead-262">Adattitkosítás</span><span class="sxs-lookup"><span data-stu-id="00ead-262">Data encryption</span></span>
<span data-ttu-id="00ead-263">Azure biztonsági mentés titkosítja az adatokat a biztonsági mentési folyamatának részeként.</span><span class="sxs-lookup"><span data-stu-id="00ead-263">Azure Backup does not encrypt data as a part of the backup process.</span></span> <span data-ttu-id="00ead-264">Azonban titkosítsa az adatokat a virtuális Gépen belül, és a védett adatok biztonsági mentése zökkenőmentesen (tudjon meg többet az [titkosított adatok biztonsági mentését](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="00ead-264">However, you can encrypt data within the VM and back up the protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-the-cost-of-protected-instances"></a><span data-ttu-id="00ead-265">Védett példányok költségének kiszámítása</span><span class="sxs-lookup"><span data-stu-id="00ead-265">Calculating the cost of protected instances</span></span>
<span data-ttu-id="00ead-266">Azure Backup használatával biztonsági mentése Azure virtuális gépek vannak vetve [Azure Backup árairól](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="00ead-266">Azure virtual machines that are backed up through Azure Backup are subject to [Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="00ead-267">Védett példányok kiszámítása alapul a *tényleges* a virtuális gép, amely a virtuális gépen – a "erőforrás lemez." kivéve az adatok mérete</span><span class="sxs-lookup"><span data-stu-id="00ead-267">The Protected Instances calculation is based on the *actual* size of the virtual machine, which is the sum of all the data in the virtual machine--excluding the “resource disk.”</span></span>

<span data-ttu-id="00ead-268">A virtuális gépek biztonsági mentéséről árképzési *nem* a virtuális géphez csatolt adatok lemezek legnagyobb támogatott mérete alapján.</span><span class="sxs-lookup"><span data-stu-id="00ead-268">Pricing for backing up VMs is *not* based on the maximum supported size for each data disk attached to the virtual machine.</span></span> <span data-ttu-id="00ead-269">Árképzési a tényleges adatlemeze tárolt adatok alapján.</span><span class="sxs-lookup"><span data-stu-id="00ead-269">Pricing is based on the actual data stored in the data disk.</span></span> <span data-ttu-id="00ead-270">Hasonlóképpen a biztonsági másolatok tárolásának számlázási tárolt adatokat az Azure biztonsági mentési szolgáltatásban, ez az egyes helyreállítási pontok a tényleges adatok összege mennyisége alapul.</span><span class="sxs-lookup"><span data-stu-id="00ead-270">Similarly, the backup storage bill is based on the amount of data that is stored in Azure Backup, which is the sum of the actual data in each recovery point.</span></span>

<span data-ttu-id="00ead-271">Vegyük például, egy szabványos A2 méretű virtuális gépekről, amelyek két adatlemeznek 1 TB maximális mérettel.</span><span class="sxs-lookup"><span data-stu-id="00ead-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="00ead-272">Az alábbi táblázat áttekintést nyújt az egyes lemezeken tárolt adatok:</span><span class="sxs-lookup"><span data-stu-id="00ead-272">The following table gives the actual data stored on each of these disks:</span></span>

| <span data-ttu-id="00ead-273">Lemez típusa</span><span class="sxs-lookup"><span data-stu-id="00ead-273">Disk type</span></span> | <span data-ttu-id="00ead-274">Maximális méret</span><span class="sxs-lookup"><span data-stu-id="00ead-274">Max size</span></span> | <span data-ttu-id="00ead-275">Tényleges adatok</span><span class="sxs-lookup"><span data-stu-id="00ead-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="00ead-276">Operációsrendszer-lemez</span><span class="sxs-lookup"><span data-stu-id="00ead-276">Operating system disk</span></span> |<span data-ttu-id="00ead-277">1023 GB</span><span class="sxs-lookup"><span data-stu-id="00ead-277">1023 GB</span></span> |<span data-ttu-id="00ead-278">17 GB</span><span class="sxs-lookup"><span data-stu-id="00ead-278">17 GB</span></span> |
| <span data-ttu-id="00ead-279">Helyi lemez / erőforrás lemez</span><span class="sxs-lookup"><span data-stu-id="00ead-279">Local disk / Resource disk</span></span> |<span data-ttu-id="00ead-280">135 GB</span><span class="sxs-lookup"><span data-stu-id="00ead-280">135 GB</span></span> |<span data-ttu-id="00ead-281">5 GB (biztonsági mentés nem tartalmazza)</span><span class="sxs-lookup"><span data-stu-id="00ead-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="00ead-282">Adatlemez 1</span><span class="sxs-lookup"><span data-stu-id="00ead-282">Data disk 1</span></span> |<span data-ttu-id="00ead-283">1023 GB</span><span class="sxs-lookup"><span data-stu-id="00ead-283">1023 GB</span></span> |<span data-ttu-id="00ead-284">30 GB</span><span class="sxs-lookup"><span data-stu-id="00ead-284">30 GB</span></span> |
| <span data-ttu-id="00ead-285">Adatlemez 2</span><span class="sxs-lookup"><span data-stu-id="00ead-285">Data disk 2</span></span> |<span data-ttu-id="00ead-286">1023 GB</span><span class="sxs-lookup"><span data-stu-id="00ead-286">1023 GB</span></span> |<span data-ttu-id="00ead-287">0 GB</span><span class="sxs-lookup"><span data-stu-id="00ead-287">0 GB</span></span> |

<span data-ttu-id="00ead-288">A *tényleges* a virtuális gép ebben az esetben mérete 17 GB + 30 GB + 0 GB = 47 GB.</span><span class="sxs-lookup"><span data-stu-id="00ead-288">The *actual* size of the virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="00ead-289">A védett példányméretének (47 GB) válik a havi számlán alapját.</span><span class="sxs-lookup"><span data-stu-id="00ead-289">This Protected Instance size (47 GB) becomes the basis for the monthly bill.</span></span> <span data-ttu-id="00ead-290">A virtuális gép adatmennyiség növekedésével védett példányméretének használt számlázási változásainak megfelelően.</span><span class="sxs-lookup"><span data-stu-id="00ead-290">As the amount of data in the virtual machine grows, the Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="00ead-291">Számlázási nem indul el, amíg befejeződik az első sikeres biztonsági mentés.</span><span class="sxs-lookup"><span data-stu-id="00ead-291">Billing does not start until the first successful backup completes.</span></span> <span data-ttu-id="00ead-292">Ezen a ponton a számlázás mind a tároló, mind a védett példányok kezdődik.</span><span class="sxs-lookup"><span data-stu-id="00ead-292">At this point, the billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="00ead-293">Számlázási továbbra is fennáll, mindaddig, amíg nincs *bármely tárolóban tárolt adatok biztonsági mentését* a virtuális géphez.</span><span class="sxs-lookup"><span data-stu-id="00ead-293">Billing continues as long as there is *any backup data stored in a vault* for the virtual machine.</span></span> <span data-ttu-id="00ead-294">Ha leállítja a virtuális gépen, de a virtuális gép biztonsági mentési adatok létezik-e az adott tárolóban, számlázási továbbra is.</span><span class="sxs-lookup"><span data-stu-id="00ead-294">If you stop protection on the virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="00ead-295">A megadott virtuális gép leáll, csak akkor, ha a védelem ki van kapcsolva számlázási *és* minden biztonsági mentési adatok törlése.</span><span class="sxs-lookup"><span data-stu-id="00ead-295">Billing for a specified virtual machine stops only if the protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="00ead-296">Amikor a védelem leáll, de nincs aktív biztonsági mentési feladatok, a legutóbbi sikeres VM biztonsági mentés mérete a védett példányméretének a havi számlán használt válik.</span><span class="sxs-lookup"><span data-stu-id="00ead-296">When protection stops and there are no active backup jobs, the size of the last successful VM backup becomes the Protected Instance size used for the monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="00ead-297">Kérdései vannak?</span><span class="sxs-lookup"><span data-stu-id="00ead-297">Questions?</span></span>
<span data-ttu-id="00ead-298">Ha kérdései vannak, vagy van olyan szolgáltatás, amelyről hallani szeretne, [küldjön visszajelzést](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="00ead-298">If you have questions, or if there is any feature that you would like to see included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="00ead-299">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="00ead-299">Next steps</span></span>
* [<span data-ttu-id="00ead-300">Készítsen biztonsági másolatot a virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="00ead-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="00ead-301">Kezelheti a virtuális gép biztonsági mentése</span><span class="sxs-lookup"><span data-stu-id="00ead-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="00ead-302">Virtuális gépek visszaállítása</span><span class="sxs-lookup"><span data-stu-id="00ead-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="00ead-303">Virtuális gép biztonsági másolatával kapcsolatos problémák elhárítása</span><span class="sxs-lookup"><span data-stu-id="00ead-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
