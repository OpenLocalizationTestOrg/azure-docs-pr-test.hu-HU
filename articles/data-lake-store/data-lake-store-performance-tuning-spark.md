---
title: "Az Azure Data Lake Store Spark teljesítményének hangolása irányelvek |} Microsoft Docs"
description: "Az Azure Data Lake Store Spark teljesítményének hangolása irányelvek"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 2109744fb7ffdfafb7a86bbea355e119718af099
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="c3d0b-103">A Spark on HDInsight és az Azure Data Lake Store útmutatást teljesítményhangolása</span><span class="sxs-lookup"><span data-stu-id="c3d0b-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="c3d0b-104">Amikor Spark teljesítményének hangolása, kell figyelembe venni a fürtön futó alkalmazások számát.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-104">When tuning performance on Spark, you need to consider the number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="c3d0b-105">Alapértelmezés szerint 4 futtatható egyidejűleg a HDI-fürtön lévő alkalmazások (Megjegyzés: az alapértelmezett beállítás: változhat).</span><span class="sxs-lookup"><span data-stu-id="c3d0b-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: the default setting is subject to change).</span></span>  <span data-ttu-id="c3d0b-106">Előfordulhat, hogy kevesebb alkalmazásokat használ, így felülírják az alapértelmezett beállításokat, és több fürt használata az alkalmazások mellett dönt.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-106">You may decide to use fewer apps so you can override the default settings and use more of the cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="c3d0b-107">Előfeltételek</span><span class="sxs-lookup"><span data-stu-id="c3d0b-107">Prerequisites</span></span>

* <span data-ttu-id="c3d0b-108">**Azure-előfizetés**.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-108">**An Azure subscription**.</span></span> <span data-ttu-id="c3d0b-109">Lásd: [Ingyenes Azure-fiók létrehozása](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="c3d0b-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="c3d0b-110">**Egy Azure Data Lake Store-fiók**.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="c3d0b-111">Hogyan hozhat létre ilyet, lásd: [Ismerkedés az Azure Data Lake Store](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="c3d0b-111">For instructions on how to create one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="c3d0b-112">**Az Azure HDInsight-fürt** a Data Lake Store-fiók eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-112">**Azure HDInsight cluster** with access to a Data Lake Store account.</span></span> <span data-ttu-id="c3d0b-113">Lásd: [HDInsight-fürtök létrehozása a Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="c3d0b-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="c3d0b-114">Győződjön meg arról, hogy a fürt számára engedélyezi a távoli asztal.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-114">Make sure you enable Remote Desktop for the cluster.</span></span>
* <span data-ttu-id="c3d0b-115">**Spark-fürtön futó Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="c3d0b-116">További információkért lásd: [adatelemzéshez a Data Lake Store használata a HDInsight Spark-fürt](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span><span class="sxs-lookup"><span data-stu-id="c3d0b-116">For more information, see [Use HDInsight Spark cluster to analyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="c3d0b-117">**Teljesítményhangolás ADLS iránymutatást**.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="c3d0b-118">Általános teljesítmény fogalmakat, lásd: [Data Lake Store teljesítmény hangolása útmutató](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="c3d0b-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="c3d0b-119">Paraméterek</span><span class="sxs-lookup"><span data-stu-id="c3d0b-119">Parameters</span></span>

<span data-ttu-id="c3d0b-120">Amikor Spark futó feladatok, az alábbiakban a legfontosabb beállítások, amelyek szabályozható ADLS a teljesítmény növelése érdekében:</span><span class="sxs-lookup"><span data-stu-id="c3d0b-120">When running Spark jobs, here are the most important settings that can be tuned to increase performance on ADLS:</span></span>

* <span data-ttu-id="c3d0b-121">**NUM-végrehajtója** -végrehajtható egyidejű feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-121">**Num-executors** - The number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="c3d0b-122">**Végrehajtó memóriában** -minden végrehajtó kiosztott memória mennyisége.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-122">**Executor-memory** - The amount of memory allocated to each executor.</span></span>

* <span data-ttu-id="c3d0b-123">**Végrehajtó-magok** -az egyes végrehajtó lefoglalt magok száma.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-123">**Executor-cores** - The number of cores allocated to each executor.</span></span>                     

<span data-ttu-id="c3d0b-124">**NUM-végrehajtója** Num-végrehajtója állítja be a párhuzamosan futó feladatok maximális száma.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-124">**Num-executors** Num-executors will set the maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="c3d0b-125">A párhuzamosan futó feladatok tényleges száma a memória és a fürt rendelkezésre álló Processzor-erőforrások korlátozódik.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-125">The actual number of tasks that can run in parallel is bounded by the memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="c3d0b-126">**Végrehajtó memóriában** Ez az egyes végrehajtó lefoglalt memória mennyiségét.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-126">**Executor-memory** This is the amount of memory that is being allocated to each executor.</span></span>  <span data-ttu-id="c3d0b-127">A minden végrehajtó szükséges memória mérete a feladat függ.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-127">The memory needed for each executor is dependent on the job.</span></span>  <span data-ttu-id="c3d0b-128">Összetett műveletek a memória eltérőnek kell lennie a magasabb.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-128">For complex operations, the memory needs to be higher.</span></span>  <span data-ttu-id="c3d0b-129">Egyszerű műveletek tartoznak, mint az olvasási és írási alacsonyabb lesz memóriára vonatkozó követelményeknek.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="c3d0b-130">Az egyes végrehajtó memória Ambari tekintheti meg.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-130">The amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="c3d0b-131">Az Ambari keresse meg a Spark, és a Configs lapon.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-131">In Ambari, navigate to Spark and view the Configs tab.</span></span>  

<span data-ttu-id="c3d0b-132">**Végrehajtó-magok** Ez meghatározza azt a végrehajtó, amely megadja, hogy futtatható végrehajtó száma párhuzamos szálak száma használt magszámra vonatkozó követelménynek.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-132">**Executor-cores** This sets the amount of cores used per executor, which determines the number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="c3d0b-133">Például ha végrehajtó-magok = 2, majd minden egyes végrehajtó 2 párhuzamos feladatokat futtathat a végrehajtó.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in the executor.</span></span>  <span data-ttu-id="c3d0b-134">Az executor-magok függ, a feladat szükség lesz.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-134">The executor-cores needed will be dependent on the job.</span></span>  <span data-ttu-id="c3d0b-135">Intenzív i/o-feladatok nem igényelnek nagy mennyiségű memória feladat, ezért minden végrehajtó kezelni tud a további párhuzamos tevékenységeket.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="c3d0b-136">Alapértelmezés szerint két virtuális YARN magok megadva minden fizikai magok a HDInsight Spark futtatásakor.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="c3d0b-137">Ez a szám concurrecy és a környezetben több szál való váltás egyensúlyt biztosít.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="c3d0b-138">Útmutatás</span><span class="sxs-lookup"><span data-stu-id="c3d0b-138">Guidance</span></span>

<span data-ttu-id="c3d0b-139">Futtatásakor a Spark adatok a Data Lake Store koncepción alapuló adatelemzési célokra, azt javasoljuk, hogy a HDInsight legfrissebb használatával a Data Lake Store a legjobb teljesítmény eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-139">While running Spark analytic workloads to work with data in Data Lake Store, we recommend that you use the most recent HDInsight version to get the best performance with Data Lake Store.</span></span> <span data-ttu-id="c3d0b-140">Ha a feladat több i/o-igényes, majd bizonyos paraméterek beállítható úgy, hogy a teljesítmény javítása.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-140">When your job is more I/O intensive, then certain parameters can be configured to improve performance.</span></span>  <span data-ttu-id="c3d0b-141">Azure Data Lake Store egy kiválóan méretezhető tárolás platform, amely képes kezelni a magas teljesítmény.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="c3d0b-142">Ha a feladat főként olvasási vagy írási műveleteket, majd növelése egyidejű i/o, és az Azure Data Lake Store sikerült teljesítmény növelése érdekében.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-142">If the job mainly consists of read or writes, then increasing concurrency for I/O to and from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="c3d0b-143">Növelheti a párhuzamosságot i/o-igényes feladatok néhány általános módja van.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-143">There are a few general ways to increase concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="c3d0b-144">**1. lépés: Annak ellenőrzése, hogy hány alkalmazások futnak, a fürt** – Ha tisztában van a fürt, beleértve a jelenlegivel hány alkalmazásokat futtat.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on the cluster including the current one.</span></span>  <span data-ttu-id="c3d0b-145">Minden egyes Spark, a beállítás azt feltételezi, hogy az alapértelmezett értékeit, hogy problémamentes-4 egyidejűleg futó alkalmazások.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-145">The default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="c3d0b-146">Ezért csak akkor 25 %-át a fürt minden alkalmazás elérhető.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-146">Therefore, you will only have 25% of the cluster available for each app.</span></span>  <span data-ttu-id="c3d0b-147">Ahhoz, hogy a jobb teljesítmény, a beállítás felülbírálható az alapértelmezett beállításokat végrehajtója számának módosítása.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-147">To get better performance, you can override the defaults by changing the number of executors.</span></span>  

<span data-ttu-id="c3d0b-148">**2. lépés: Állítsa be az executor-memória** – először hozzá kell beállítani az executor-memória.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-148">**Step 2: Set executor-memory** – the first thing to set is the executor-memory.</span></span>  <span data-ttu-id="c3d0b-149">A memória lesz a feladatot, amely futtatni fogja függ.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-149">The memory will be dependent on the job that you are going to run.</span></span>  <span data-ttu-id="c3d0b-150">Párhuzamossági növelheti, ha a végrehajtó kevesebb memória lefoglalásakor.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="c3d0b-151">Ha memória kivételek kívül a feladat futtatásakor, majd növelje a paraméter értékét.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-151">If you see out of memory exceptions when you run your job, then you should increase the value for this parameter.</span></span>  <span data-ttu-id="c3d0b-152">Egy esetben több memóriát beolvasása nagyobb mennyiségű memóriával rendelkező fürtnek használatával, vagy a fürt méretének növelését.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-152">One alternative is to get more memory by using a cluster that has higher amounts of memory or increasing the size of your cluster.</span></span>  <span data-ttu-id="c3d0b-153">További memória lehetővé teszi több végrehajtója használni, ami azt jelenti, hogy több egyidejű.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-153">More memory will enable more executors to be used, which means more concurrency.</span></span>

<span data-ttu-id="c3d0b-154">**3. lépés: Állítsa be az executor-magok** – az I/O teljesítményigényű munkaterhelések kiszolgálásához, amelyek nem rendelkeznek összetett műveletek már jó végrehajtó-magok száma párhuzamos tevékenységek maximális száma végrehajtó növeléséhez nagyszámú kezdődik.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good to start with a high number of executor-cores to increase the number of parallel tasks per executor.</span></span>  <span data-ttu-id="c3d0b-155">4-es végrehajtó-magok beállítással remek kezdőpont.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-155">Setting executor-cores to 4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="c3d0b-156">Az executor-magok száma növelése Erre azért van szükség további párhuzamossági, különböző végrehajtó-magok kísérletezhet.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-156">Increasing the number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="c3d0b-157">Az összetettebb műveleteket, feladatok csökkentse végrehajtó magok számát.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-157">For jobs that have more complex operations, you should reduce the number of cores per executor.</span></span>  <span data-ttu-id="c3d0b-158">Ha végrehajtó-magok nagyobb, mint 4, majd szemétgyűjtés előfordulhat, hogy nem elég hatékony lesz és csökkentheti a teljesítményt.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="c3d0b-159">**4. lépés: Fürt YARN memóriamennyiség meghatározása** – ezt az információt az Ambari érhető el.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="c3d0b-160">A YARN és a Configs lapon.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-160">Navigate to YARN and view the Configs tab.</span></span>  <span data-ttu-id="c3d0b-161">A YARN memória ebben az ablakban jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-161">The YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="c3d0b-162">Megjegyzés:, amíg az ablak, megtekintheti az alapértelmezett YARN tároló mérete.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-162">Note: while you are in the window, you can also see the default YARN container size.</span></span>  <span data-ttu-id="c3d0b-163">A YARN tároló mérete megegyezik a memória mennyisége végrehajtó paramétere.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-163">The YARN container size is the same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="c3d0b-164">**5. lépés: Num-végrehajtója kiszámítása**</span><span class="sxs-lookup"><span data-stu-id="c3d0b-164">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="c3d0b-165">**Memória megkötés kiszámításához** -num-végrehajtója paraméter memória vagy CPU korlátozza.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-165">**Calculate memory constraint** - The num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="c3d0b-166">Az memória határértékét az alkalmazáshoz rendelkezésre álló YARN memória mennyisége határozza meg.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-166">The memory constraint is determined by the amount of available YARN memory for your application.</span></span>  <span data-ttu-id="c3d0b-167">Teljes YARN memória érvénybe kell, és osztás, amely végrehajtó memóriában.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-167">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="c3d0b-168">A korlátozás kell lennie való méretezése alkalmazások számát, ezért azt el kell osztani a alkalmazások száma.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-168">The constraint needs to be de-scaled for the number of apps so we divide by the number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="c3d0b-169">**CPU-korlátozás kiszámításához** -végrehajtó magok száma osztva a teljes virtuális magok számítása a CPU-korlátozás.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-169">**Calculate CPU constraint** - The CPU constraint is calculated as the total virtual cores divided by the number of cores per executor.</span></span>  <span data-ttu-id="c3d0b-170">Nincsenek minden fizikai magok virtuális 2 magos.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-170">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="c3d0b-171">A memória megkötés hasonló, tudunk osztási alkalmazások száma szerint.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-171">Similar to the memory constraint, we have divide by the number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="c3d0b-172">**Num-végrehajtója beállítása** – a num-végrehajtója paraméter határozza meg a minimális a memória korlátozás és a CPU-korlátozás véve.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-172">**Set num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="c3d0b-173">Ha egy nagyobb num-végrehajtója nem feltétlenül teljesítmény növelése.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-173">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="c3d0b-174">Vegye figyelembe, hogy további végrehajtója felveszi extra általános az egyes további végrehajtó, amely potenciálisan ronthatja a teljesítményt.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-174">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="c3d0b-175">NUM-végrehajtója a fürterőforrásokat korlátozódik.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-175">Num-executors is bounded by the cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="c3d0b-176">Példa kiszámítása</span><span class="sxs-lookup"><span data-stu-id="c3d0b-176">Example Calculation</span></span>

<span data-ttu-id="c3d0b-177">Tegyük fel, már van egy 8 D4v2 csomópont álló, 2 rendszert futtató fürt alkalmazások, beleértve futtatni fogja.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-177">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including the one you are going to run.</span></span>  

<span data-ttu-id="c3d0b-178">**1. lépés: Annak ellenőrzése, hogy hány alkalmazások futnak, a fürt** –, hogy rendelkezik-e 2 ismeri a fürtben, beleértve futtatni kívánt alkalmazásokhoz.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-178">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including the one you are going to run.</span></span>  

<span data-ttu-id="c3d0b-179">**2. lépés: Állítsa be az executor-memória** – ebben a példában azt határozza meg, hogy 6 GB memória végrehajtó intenzív i/o-feladat elegendő lesz-e.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-179">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="c3d0b-180">**3. lépés: Állítsa be az executor-magok** – mivel ez egy i/o-igényes feladat, azt adhatja meg az magok száma minden végrehajtó 4.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-180">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set the number of cores for each executor to 4.</span></span>  <span data-ttu-id="c3d0b-181">Magok száma végrehajtó beállítást nagyobb, mint 4 szemétgyűjtési gyűjtemény problémákat okozhat.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-181">Setting cores per executor to larger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="c3d0b-182">**4. lépés: Fürt YARN memóriamennyiség meghatározása** – azt navigáljon Ambari tudja meg, hogy minden D4v2 rendelkezik-e a YARN memória 25 GB.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-182">**Step 4: Determine amount of YARN memory in cluster** – We navigate to Ambari to find out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="c3d0b-183">Mivel nincsenek 8 csomópont, a rendszer megszorozza a YARN memória 8.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-183">Since there are 8 nodes, the available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="c3d0b-184">**5. lépés: Kiszámításához num-végrehajtója** – a num-végrehajtója paraméter határozza meg a minimális memória-korlátozás véve, és a CPU-korlátozás Spark futó alkalmazások száma osztva.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-184">**Step 5: Calculate num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint divided by the # of apps running on Spark.</span></span>    

<span data-ttu-id="c3d0b-185">**Memória megkötés kiszámításához** – a memória megkötés kiszámítása a teljes YARN memória, a memória mennyisége végrehajtó hányadosa.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-185">**Calculate memory constraint** – The memory constraint is calculated as the total YARN memory divided by the memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="c3d0b-186">**CPU-korlátozás kiszámításához** -végrehajtó magok száma osztva teljes yarn mag számítása a CPU-korlátozás.</span><span class="sxs-lookup"><span data-stu-id="c3d0b-186">**Calculate CPU constraint** - The CPU constraint is calculated as the total yarn cores divided by the number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="c3d0b-187">**Num-végrehajtója beállítása**</span><span class="sxs-lookup"><span data-stu-id="c3d0b-187">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

