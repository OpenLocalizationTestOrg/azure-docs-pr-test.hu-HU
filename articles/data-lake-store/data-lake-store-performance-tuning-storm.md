---
title: "Azure Data Lake Store Storm teljesítményének hangolása irányelvek |} Microsoft Docs"
description: "Azure Data Lake Store Storm teljesítményének hangolása irányelvek"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 1dfa93643f45a96ded3fd022aa8b1c71d487acb4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="performance-tuning-guidance-for-storm-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="d118d-103">Útmutató a Storm on HDInsight és az Azure Data Lake Store teljesítményhangolása</span><span class="sxs-lookup"><span data-stu-id="d118d-103">Performance tuning guidance for Storm on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="d118d-104">Ismerje meg a tényezőket kell figyelembe venni, amikor egy Azure Storm-topológia teljesítményének beállításakor.</span><span class="sxs-lookup"><span data-stu-id="d118d-104">Understand the factors that should be considered when you tune the performance of an Azure Storm topology.</span></span> <span data-ttu-id="d118d-105">Például fontos tudni, hogy a spoutokkal kapcsolatban, és a boltokhoz (a munkahelyi-e i/o- vagy memóriaigényes) dolgozott jellemzőit.</span><span class="sxs-lookup"><span data-stu-id="d118d-105">For example, it's important to understand the characteristics of the work done by the spouts and the bolts (whether the work is I/O or memory intensive).</span></span> <span data-ttu-id="d118d-106">Ez a cikk foglalkozik számos különböző teljesítményének hangolása útmutatást, beleértve a gyakori problémák elhárításához.</span><span class="sxs-lookup"><span data-stu-id="d118d-106">This article covers a range of performance tuning guidelines, including troubleshooting common issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="d118d-107">Előfeltételek</span><span class="sxs-lookup"><span data-stu-id="d118d-107">Prerequisites</span></span>

* <span data-ttu-id="d118d-108">**Azure-előfizetés**.</span><span class="sxs-lookup"><span data-stu-id="d118d-108">**An Azure subscription**.</span></span> <span data-ttu-id="d118d-109">Lásd: [Ingyenes Azure-fiók létrehozása](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="d118d-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="d118d-110">**Egy Azure Data Lake Store-fiók**.</span><span class="sxs-lookup"><span data-stu-id="d118d-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="d118d-111">Hogyan hozhat létre ilyet, lásd: [Ismerkedés az Azure Data Lake Store](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="d118d-111">For instructions on how to create one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md).</span></span>
* <span data-ttu-id="d118d-112">**Egy Azure HDInsight fürt** a Data Lake Store-fiók eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="d118d-112">**An Azure HDInsight cluster** with access to a Data Lake Store account.</span></span> <span data-ttu-id="d118d-113">Lásd: [HDInsight-fürtök létrehozása a Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="d118d-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="d118d-114">Győződjön meg arról, hogy a fürt számára engedélyezi a távoli asztal.</span><span class="sxs-lookup"><span data-stu-id="d118d-114">Make sure you enable Remote Desktop for the cluster.</span></span>
* <span data-ttu-id="d118d-115">**A Data Lake Store egy Storm-fürt futtató**.</span><span class="sxs-lookup"><span data-stu-id="d118d-115">**Running a Storm cluster on Data Lake Store**.</span></span> <span data-ttu-id="d118d-116">További információkért lásd: [HDInsight alatt futó Storm](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span><span class="sxs-lookup"><span data-stu-id="d118d-116">For more information, see [Storm on HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span></span>
* <span data-ttu-id="d118d-117">**Teljesítményhangolás irányelvek a Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="d118d-117">**Performance tuning guidelines on Data Lake Store**.</span></span>  <span data-ttu-id="d118d-118">Általános teljesítmény fogalmakat, lásd: [Data Lake Store teljesítmény hangolása útmutatást](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="d118d-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span></span>  

## <a name="tune-the-parallelism-of-the-topology"></a><span data-ttu-id="d118d-119">A topológia párhuzamosságát hangolása</span><span class="sxs-lookup"><span data-stu-id="d118d-119">Tune the parallelism of the topology</span></span>

<span data-ttu-id="d118d-120">Előfordulhat, hogy növeli a Data Lake Store érkező vagy oda irányuló i/o feldolgozási teljesítmény javítása érdekében.</span><span class="sxs-lookup"><span data-stu-id="d118d-120">You might be able to improve performance by increasing the concurrency of the I/O to and from Data Lake Store.</span></span> <span data-ttu-id="d118d-121">A Storm-topológia párhuzamosságát meghatározó konfigurációk rendelkezik:</span><span class="sxs-lookup"><span data-stu-id="d118d-121">A Storm topology has a set of configurations that determine the parallelism:</span></span>
* <span data-ttu-id="d118d-122">Munkavégző folyamatok (a munkavállalók egyenlően elosztott a virtuális gépek) száma.</span><span class="sxs-lookup"><span data-stu-id="d118d-122">Number of worker processes (the workers are evenly distributed across the VMs).</span></span>
* <span data-ttu-id="d118d-123">Spout végrehajtó példányok száma.</span><span class="sxs-lookup"><span data-stu-id="d118d-123">Number of spout executor instances.</span></span>
* <span data-ttu-id="d118d-124">Bolt végrehajtó példányok száma.</span><span class="sxs-lookup"><span data-stu-id="d118d-124">Number of bolt executor instances.</span></span>
* <span data-ttu-id="d118d-125">Spout feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="d118d-125">Number of spout tasks.</span></span>
* <span data-ttu-id="d118d-126">Bolt feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="d118d-126">Number of bolt tasks.</span></span>

<span data-ttu-id="d118d-127">Például egy fürtön 4 virtuális gépek és 4 munkavégző folyamatok, 32 spout végrehajtója és 32 spout feladatokat, és 256 bolt végrehajtója és 512 bolt feladatok, vegye figyelembe a következőket:</span><span class="sxs-lookup"><span data-stu-id="d118d-127">For example, on a cluster with 4 VMs and 4 worker processes, 32 spout executors and 32 spout tasks, and 256 bolt executors and 512 bolt tasks, consider the following:</span></span>

<span data-ttu-id="d118d-128">Minden egyes felügyelő, amely a munkavégző csomópont, a Java virtuális gép (JVM) folyamat egyetlen worker rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="d118d-128">Each supervisor, which is a worker node, has a single worker Java virtual machine (JVM) process.</span></span> <span data-ttu-id="d118d-129">A JVM folyamat 4 spout szál és 64 bolt szál kezeli.</span><span class="sxs-lookup"><span data-stu-id="d118d-129">This JVM process manages 4 spout threads and 64 bolt threads.</span></span> <span data-ttu-id="d118d-130">Minden egyes szál belül feladatok egymás után futnak.</span><span class="sxs-lookup"><span data-stu-id="d118d-130">Within each thread, tasks are run sequentially.</span></span> <span data-ttu-id="d118d-131">Az előző konfigurációval minden spout szál 1 tevékenység rendelkezik, és minden egyes bolt szál 2 tevékenységet tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="d118d-131">With the preceding configuration, each spout thread has 1 task, and each bolt thread has 2 tasks.</span></span>

<span data-ttu-id="d118d-132">A Storm Itt a különböző összetevőt használnak, és a szint van párhuzamossági hatásuk:</span><span class="sxs-lookup"><span data-stu-id="d118d-132">In Storm, here are the various components involved, and how they affect the level of parallelism you have:</span></span>
* <span data-ttu-id="d118d-133">Az átjárócsomópont (Storm Nimbus néven) segítségével küldje el, majd a feladatok kezelése.</span><span class="sxs-lookup"><span data-stu-id="d118d-133">The head node (called Nimbus in Storm) is used to submit and manage jobs.</span></span> <span data-ttu-id="d118d-134">Ezek a csomópontok befolyásolni párhuzamossági fokát.</span><span class="sxs-lookup"><span data-stu-id="d118d-134">These nodes have no impact on the degree of parallelism.</span></span>
* <span data-ttu-id="d118d-135">A felügyeleti csomópontok.</span><span class="sxs-lookup"><span data-stu-id="d118d-135">The supervisor nodes.</span></span> <span data-ttu-id="d118d-136">A Hdinsightban Ez megfelel a munkavégző csomópont Azure virtuális Gépen.</span><span class="sxs-lookup"><span data-stu-id="d118d-136">In HDInsight, this corresponds to a worker node Azure VM.</span></span>
* <span data-ttu-id="d118d-137">A munkavégző feladatokat a virtuális gépeken futó Storm folyamatok is.</span><span class="sxs-lookup"><span data-stu-id="d118d-137">The worker tasks are Storm processes running in the VMs.</span></span> <span data-ttu-id="d118d-138">Minden egyes munkavégző feladat felel meg a JVM példánya.</span><span class="sxs-lookup"><span data-stu-id="d118d-138">Each worker task corresponds to a JVM instance.</span></span> <span data-ttu-id="d118d-139">A Storm osztja el a lehető egyenlően osztható meg a munkavégző csomópontokhoz munkavégző folyamatok száma.</span><span class="sxs-lookup"><span data-stu-id="d118d-139">Storm distributes the number of worker processes you specify to the worker nodes as evenly as possible.</span></span>
* <span data-ttu-id="d118d-140">Spout és boltok végrehajtó példányok.</span><span class="sxs-lookup"><span data-stu-id="d118d-140">Spout and bolt executor instances.</span></span> <span data-ttu-id="d118d-141">Egy szál a munkavállalók (JVMs) belül futó minden végrehajtó példány felel meg.</span><span class="sxs-lookup"><span data-stu-id="d118d-141">Each executor instance corresponds to a thread running within the workers (JVMs).</span></span>
* <span data-ttu-id="d118d-142">A Storm feladatok.</span><span class="sxs-lookup"><span data-stu-id="d118d-142">Storm tasks.</span></span> <span data-ttu-id="d118d-143">Ezek a logikai feladatok, hogy minden egyes szálait futtatható.</span><span class="sxs-lookup"><span data-stu-id="d118d-143">These are logical tasks that each of these threads run.</span></span> <span data-ttu-id="d118d-144">Ez nem módosítja a szint párhuzamossági, ki kell értékelnie, hogy több feladat végrehajtója / kell-e.</span><span class="sxs-lookup"><span data-stu-id="d118d-144">This does not change the level of parallelism, so you should evaluate if you need multiple tasks per executor or not.</span></span>

### <a name="get-the-best-performance-from-data-lake-store"></a><span data-ttu-id="d118d-145">A legjobb teljesítmény eléréséhez Data Lake Store-ból</span><span class="sxs-lookup"><span data-stu-id="d118d-145">Get the best performance from Data Lake Store</span></span>

<span data-ttu-id="d118d-146">A Data Lake Store használatakor a lehető legjobb teljesítményt elérhetővé ellenkező esetben a következő:</span><span class="sxs-lookup"><span data-stu-id="d118d-146">When working with Data Lake Store, you get the best performance if you do the following:</span></span>
* <span data-ttu-id="d118d-147">Nyílt meg kis hozzáfűzi a nagyobb méretű (ideális esetben 4 MB).</span><span class="sxs-lookup"><span data-stu-id="d118d-147">Coalesce your small appends into larger sizes (ideally 4 MB).</span></span>
* <span data-ttu-id="d118d-148">Hajtsa végre, mint a sok egyidejű kéréssel.</span><span class="sxs-lookup"><span data-stu-id="d118d-148">Do as many concurrent requests as you can.</span></span> <span data-ttu-id="d118d-149">Minden egyes bolt szál blokkoló olvasások végez műveletet, mert szeretné valahol core szálak 8 – 12 tartományba.</span><span class="sxs-lookup"><span data-stu-id="d118d-149">Because each bolt thread is doing blocking reads, you want to have somewhere in the range of 8-12 threads per core.</span></span> <span data-ttu-id="d118d-150">Így a hálózati adapter és a CPU-t is alkalmazhatja.</span><span class="sxs-lookup"><span data-stu-id="d118d-150">This keeps the NIC and the CPU well utilized.</span></span> <span data-ttu-id="d118d-151">A nagyobb virtuális gépek lehetővé teszi több egyidejű kérelmet.</span><span class="sxs-lookup"><span data-stu-id="d118d-151">A larger VM enables more concurrent requests.</span></span>  

### <a name="example-topology"></a><span data-ttu-id="d118d-152">Példa topológia</span><span class="sxs-lookup"><span data-stu-id="d118d-152">Example topology</span></span>

<span data-ttu-id="d118d-153">Tegyük fel, hogy rendelkezik egy 8 munkavégző csomópontot tartalmazó fürtben D13v2 Azure virtuális gépen.</span><span class="sxs-lookup"><span data-stu-id="d118d-153">Let’s assume you have an 8 worker node cluster with a D13v2 Azure VM.</span></span> <span data-ttu-id="d118d-154">A virtuális gép rendelkezik 8 processzormag, 8 munkavégző csomópontok közötti 64 teljes mag van.</span><span class="sxs-lookup"><span data-stu-id="d118d-154">This VM has 8 cores, so among the 8 worker nodes, you have 64 total cores.</span></span>

<span data-ttu-id="d118d-155">Tegyük fel, 8 bolt szálak száma core végezzük.</span><span class="sxs-lookup"><span data-stu-id="d118d-155">Let’s say we do 8 bolt threads per core.</span></span> <span data-ttu-id="d118d-156">A megadott 64 mag, amely azt jelenti, hogy azt szeretnénk, ha 512 teljes bolt végrehajtó példányok (Ez azt jelenti, hogy a szál).</span><span class="sxs-lookup"><span data-stu-id="d118d-156">Given 64 cores, that means we want 512 total bolt executor instances (that is, threads).</span></span> <span data-ttu-id="d118d-157">Ebben az esetben tegyük fel, azt egy JVM-et virtuális gépenként kezdődnie, és főként használja a szál egyidejűségi belül a JVM-et egyidejűségi eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="d118d-157">In this case, let’s say we start with one JVM per VM, and mainly use the thread concurrency within the JVM to achieve concurrency.</span></span> <span data-ttu-id="d118d-158">Ez azt jelenti, hogy 8 munkavégző feladatokat (egy Azure virtuális gépenként), és 512 bolt végrehajtója kell.</span><span class="sxs-lookup"><span data-stu-id="d118d-158">That means we need 8 worker tasks (one per Azure VM), and 512 bolt executors.</span></span> <span data-ttu-id="d118d-159">Ebben a konfigurációban a Storm megpróbálja terjeszteni a munkavállalók egyenletesen munkavégző csomópontokhoz (más néven a felügyelő csomópontok) keresztül jogosultságot ad az egyes feldolgozó csomópontok 1 JVM-et.</span><span class="sxs-lookup"><span data-stu-id="d118d-159">Given this configuration, Storm tries to distribute the workers evenly across worker nodes (also known as supervisor nodes), giving each worker node 1 JVM.</span></span> <span data-ttu-id="d118d-160">A felügyelők belül Storm próbál egyenletesen közötti felügyelők végrehajtója terjesztése, most jogosultságot ad az egyes felügyelő (Ez azt jelenti, hogy JVM) 8 szálait egyes.</span><span class="sxs-lookup"><span data-stu-id="d118d-160">Now within the supervisors, Storm tries to distribute the executors evenly between supervisors, giving each supervisor (that is, JVM) 8 threads each.</span></span>

## <a name="tune-additional-parameters"></a><span data-ttu-id="d118d-161">További paraméterek hangolása</span><span class="sxs-lookup"><span data-stu-id="d118d-161">Tune additional parameters</span></span>
<span data-ttu-id="d118d-162">Miután az alapszintű topológia, fontolja meg hogy szeretné-e végeznünk a paraméterek egyikét:</span><span class="sxs-lookup"><span data-stu-id="d118d-162">After you have the basic topology, you can consider whether you want to tweak any of the parameters:</span></span>
* <span data-ttu-id="d118d-163">**Egyes feldolgozó csomópontok JVMs száma.**</span><span class="sxs-lookup"><span data-stu-id="d118d-163">**Number of JVMs per worker node.**</span></span> <span data-ttu-id="d118d-164">Ha nagy adatszerkezet (például egy keresési tábla) a memóriában, minden egyes JVM állomás szükséges egy külön példányát.</span><span class="sxs-lookup"><span data-stu-id="d118d-164">If you have a large data structure (for example, a lookup table) that you host in memory, each JVM requires a separate copy.</span></span> <span data-ttu-id="d118d-165">Azt is megteheti használhatja a adatszerkezet sok szálakon Ha kevesebb JVMs rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="d118d-165">Alternatively, you can use the data structure across many threads if you have fewer JVMs.</span></span> <span data-ttu-id="d118d-166">I/o. a bolt JVMs száma tegye ugyanennyi különbség a között ezek JVMs hozzáadott szálak számának.</span><span class="sxs-lookup"><span data-stu-id="d118d-166">For the bolt’s I/O, the number of JVMs does not make as much of a difference as the number of threads added across those JVMs.</span></span> <span data-ttu-id="d118d-167">Az egyszerűség kedvéért célszerű egy JVM / munkavégző rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="d118d-167">For simplicity, it's a good idea to have one JVM per worker.</span></span> <span data-ttu-id="d118d-168">Attól függően, hogy milyen módon tartalmaz a bolt vagy milyen alkalmazás feldolgozása az Ön igényelnek, bár ez a szám módosítani szeretne.</span><span class="sxs-lookup"><span data-stu-id="d118d-168">Depending on what your bolt is doing or what application processing you require, though, you may need to change this number.</span></span>
* <span data-ttu-id="d118d-169">**Spout végrehajtója száma.**</span><span class="sxs-lookup"><span data-stu-id="d118d-169">**Number of spout executors.**</span></span> <span data-ttu-id="d118d-170">Mivel az előző példában boltokhoz Data Lake Store írásához használja, a spoutokkal kapcsolatban nincs közvetlenül kapcsolódik a bolt teljesítményét.</span><span class="sxs-lookup"><span data-stu-id="d118d-170">Because the preceding example uses bolts for writing to Data Lake Store, the number of spouts is not directly relevant to the bolt performance.</span></span> <span data-ttu-id="d118d-171">Azonban feldolgozás vagy i/o történik a spout a mennyiségétől függően célszerű egy finomhangolhatják a spoutokkal kapcsolatban, a legjobb teljesítmény érdekében.</span><span class="sxs-lookup"><span data-stu-id="d118d-171">However, depending on the amount of processing or I/O happening in the spout, it's a good idea to tune the spouts for best performance.</span></span> <span data-ttu-id="d118d-172">Győződjön meg arról, hogy rendelkezik-e elegendő szeretné megtartani a boltokhoz foglalt spoutokkal kapcsolatban.</span><span class="sxs-lookup"><span data-stu-id="d118d-172">Ensure that you have enough spouts to be able to keep the bolts busy.</span></span> <span data-ttu-id="d118d-173">A kimeneti sebességű a spoutokkal kapcsolatban meg kell felelnie az átviteli sebessége a boltokhoz.</span><span class="sxs-lookup"><span data-stu-id="d118d-173">The output rates of the spouts should match the throughput of the bolts.</span></span> <span data-ttu-id="d118d-174">A tényleges konfiguráció a spout függ.</span><span class="sxs-lookup"><span data-stu-id="d118d-174">The actual configuration depends on the spout.</span></span>
* <span data-ttu-id="d118d-175">**Feladatok száma.**</span><span class="sxs-lookup"><span data-stu-id="d118d-175">**Number of tasks.**</span></span> <span data-ttu-id="d118d-176">Minden egyes bolt egyetlen szálon futtatja.</span><span class="sxs-lookup"><span data-stu-id="d118d-176">Each bolt runs as a single thread.</span></span> <span data-ttu-id="d118d-177">További feladatok / bolt nem ad meg semmilyen további egyidejűségi.</span><span class="sxs-lookup"><span data-stu-id="d118d-177">Additional tasks per bolt don't provide any additional concurrency.</span></span> <span data-ttu-id="d118d-178">Csak azok előnyös, ha a folyamat a rekord igazolása időt vesz igénybe a bolt végrehajtási idő nagy részét.</span><span class="sxs-lookup"><span data-stu-id="d118d-178">The only time they are of benefit is if your process of acknowledging the tuple takes a large proportion of your bolt execution time.</span></span> <span data-ttu-id="d118d-179">Célszerű a csoporthoz be egy nagyobb sok rekordokat hozzáfűzése a tartalmaz a bolt nyugtázást elküldése előtt.</span><span class="sxs-lookup"><span data-stu-id="d118d-179">It's a good idea to group many tuples into a larger append before you send an acknowledgement from the bolt.</span></span> <span data-ttu-id="d118d-180">Így a legtöbb esetben több feladat nincs további előnye adja meg.</span><span class="sxs-lookup"><span data-stu-id="d118d-180">So, in most cases, multiple tasks provide no additional benefit.</span></span>
* <span data-ttu-id="d118d-181">**Helyi vagy véletlen csoportosítása.**</span><span class="sxs-lookup"><span data-stu-id="d118d-181">**Local or shuffle grouping.**</span></span> <span data-ttu-id="d118d-182">Ha ez a beállítás engedélyezve van, rekordokat küldése a boltokhoz belül az azonos munkavégző folyamatot.</span><span class="sxs-lookup"><span data-stu-id="d118d-182">When this setting is enabled, tuples are sent to bolts within the same worker process.</span></span> <span data-ttu-id="d118d-183">Ez csökkenti a folyamatok közötti kommunikációt és a hálózati hívások.</span><span class="sxs-lookup"><span data-stu-id="d118d-183">This reduces inter-process communication and network calls.</span></span> <span data-ttu-id="d118d-184">Ez a legtöbb topológiák javasolt.</span><span class="sxs-lookup"><span data-stu-id="d118d-184">This is recommended for most topologies.</span></span>

<span data-ttu-id="d118d-185">A alapvető forgatókönyv, az jó kiindulási pont.</span><span class="sxs-lookup"><span data-stu-id="d118d-185">This basic scenario is a good starting point.</span></span> <span data-ttu-id="d118d-186">Tesztelje a optimális teljesítmény érdekében az előző paraméterek végeznünk a saját adataival.</span><span class="sxs-lookup"><span data-stu-id="d118d-186">Test with your own data to tweak the preceding parameters to achieve optimal performance.</span></span>

## <a name="tune-the-spout"></a><span data-ttu-id="d118d-187">A spout hangolása</span><span class="sxs-lookup"><span data-stu-id="d118d-187">Tune the spout</span></span>

<span data-ttu-id="d118d-188">A következő beállításokat a spout hangolásához módosíthatja.</span><span class="sxs-lookup"><span data-stu-id="d118d-188">You can modify the following settings to tune the spout.</span></span>

- <span data-ttu-id="d118d-189">**Rekord időtúllépés: topology.message.timeout.secs**.</span><span class="sxs-lookup"><span data-stu-id="d118d-189">**Tuple timeout: topology.message.timeout.secs**.</span></span> <span data-ttu-id="d118d-190">Ez a beállítás határozza meg egy üzenetet, majd nyugtázása, fogadásához szükséges idő előtt figyelembe veendő, nem sikerült.</span><span class="sxs-lookup"><span data-stu-id="d118d-190">This setting determines the amount of time a message takes to complete, and receive acknowledgement, before it is considered failed.</span></span>

- <span data-ttu-id="d118d-191">**Munkavégző folyamatok maximális memória: worker.childopts**.</span><span class="sxs-lookup"><span data-stu-id="d118d-191">**Max memory per worker process: worker.childopts**.</span></span> <span data-ttu-id="d118d-192">Ez a beállítás lehetővé teszi a Java Worker parancssori paraméter.</span><span class="sxs-lookup"><span data-stu-id="d118d-192">This setting lets you specify additional command-line parameters to the Java workers.</span></span> <span data-ttu-id="d118d-193">A leggyakrabban használt beállítás itt XmX, amely megadja, hogy a maximális halommemória a JVM kiosztott memória.</span><span class="sxs-lookup"><span data-stu-id="d118d-193">The most commonly used setting here is XmX, which determines the maximum memory allocated to a JVM’s heap.</span></span>

- <span data-ttu-id="d118d-194">**Függőben lévő maximális spout: topology.max.spout.pending**.</span><span class="sxs-lookup"><span data-stu-id="d118d-194">**Max spout pending: topology.max.spout.pending**.</span></span> <span data-ttu-id="d118d-195">Ez a beállítás határozza meg, amely a felhőszolgáltató közötti átviteléhez (a topológia összes csomópontjának, még nem nyugtázott) spout szálankénti bármikor rekordjainak számát.</span><span class="sxs-lookup"><span data-stu-id="d118d-195">This setting determines the number of tuples that can in be flight (not yet acknowledged at all nodes in the topology) per spout thread at any time.</span></span>

 <span data-ttu-id="d118d-196">Egy jó számítás ehhez a rekordokat méretének becsléséhez.</span><span class="sxs-lookup"><span data-stu-id="d118d-196">A good calculation to do is to estimate the size of each of your tuples.</span></span> <span data-ttu-id="d118d-197">Majd mérje fel, hogy mennyi memória egy spout szál.</span><span class="sxs-lookup"><span data-stu-id="d118d-197">Then figure out how much memory one spout thread has.</span></span> <span data-ttu-id="d118d-198">A szálhoz, ez az érték osztva lefoglalt teljes memória biztosítani fogja a felső határa a függőben lévő paraméter maximális spout.</span><span class="sxs-lookup"><span data-stu-id="d118d-198">The total memory allocated to a thread, divided by this value, should give you the upper bound for the max spout pending parameter.</span></span>

## <a name="tune-the-bolt"></a><span data-ttu-id="d118d-199">A bolt hangolása</span><span class="sxs-lookup"><span data-stu-id="d118d-199">Tune the bolt</span></span>
<span data-ttu-id="d118d-200">Ha a Data Lake Store ír le, beállított mérete szinkronizálási házirend (ügyféloldali puffer) 4 MB.</span><span class="sxs-lookup"><span data-stu-id="d118d-200">When you're writing to Data Lake Store, set a size sync policy (buffer on the client side) to 4 MB.</span></span> <span data-ttu-id="d118d-201">Csak akkor, ha a pufferméret majd végre a könyvelési vagy hsync() a következő ezt az értéket.</span><span class="sxs-lookup"><span data-stu-id="d118d-201">A flushing or hsync() is then performed only when the buffer size is the at this value.</span></span> <span data-ttu-id="d118d-202">A Data Lake Store illesztőprogram be a feldolgozón VM automatikusan végzi a pufferelés, kivéve, ha egy hsync() explicit módon elvégezhető.</span><span class="sxs-lookup"><span data-stu-id="d118d-202">The Data Lake Store driver on the worker VM automatically does this buffering, unless you explicitly perform an hsync().</span></span>

<span data-ttu-id="d118d-203">Az alapértelmezett Data Lake Store Storm bolt mérete szinkronizálási házirend paraméter tartozik (fileBufferSize) Ez a paraméter hangolására használható.</span><span class="sxs-lookup"><span data-stu-id="d118d-203">The default Data Lake Store Storm bolt has a size sync policy parameter (fileBufferSize) that can be used to tune this parameter.</span></span>

<span data-ttu-id="d118d-204">Az I/O-igényes topológia esetén is célszerű minden egyes bolt szál írni a saját fájlba lesz, és fájl Elforgatás házirend (fileRotationSize).</span><span class="sxs-lookup"><span data-stu-id="d118d-204">In I/O-intensive topologies, it's a good idea to have each bolt thread write to its own file, and to set a file rotation policy (fileRotationSize).</span></span> <span data-ttu-id="d118d-205">Ha a fájl elér egy adott méretet, a stream automatikusan ki van ürítve nevével, és egy új fájlt.</span><span class="sxs-lookup"><span data-stu-id="d118d-205">When the file reaches a certain size, the stream is automatically flushed and a new file is written to.</span></span> <span data-ttu-id="d118d-206">A váltakozó használatának ajánlott fájl mérete 1 GB.</span><span class="sxs-lookup"><span data-stu-id="d118d-206">The recommended file size for rotation is 1 GB.</span></span>

### <a name="handle-tuple-data"></a><span data-ttu-id="d118d-207">Rekord adatok kezelése</span><span class="sxs-lookup"><span data-stu-id="d118d-207">Handle tuple data</span></span>

<span data-ttu-id="d118d-208">A Storm egy spout fenn rekordot amíg explicit módon tartalmaz a bolt által elfogadott.</span><span class="sxs-lookup"><span data-stu-id="d118d-208">In Storm, a spout holds on to a tuple until it is explicitly acknowledged by the bolt.</span></span> <span data-ttu-id="d118d-209">Ha egy rekord tartalmaz a bolt által beolvasása megtörtént, de még nem nyugtázták, a spout előfordulhat, hogy nem rendelkezik állandóként létrehozni a Data Lake Store háttér.</span><span class="sxs-lookup"><span data-stu-id="d118d-209">If a tuple has been read by the bolt but has not been acknowledged yet, the spout might not have persisted into Data Lake Store back end.</span></span> <span data-ttu-id="d118d-210">A nyugtázott egy rekord, miután a spout garantálható adatmegőrzési tartalmaz a bolt által, és majd törölheti az adatok bármilyen forrásból történt a olvasásakor.</span><span class="sxs-lookup"><span data-stu-id="d118d-210">After a tuple is acknowledged, the spout can be guaranteed persistence by the bolt, and can then delete the source data from whatever source it is reading from.</span></span>  

<span data-ttu-id="d118d-211">A legjobb teljesítmény elérése érdekében a Data Lake Store rendelkezik tartalmaz a bolt rekordot adatok 4 MB-os puffer.</span><span class="sxs-lookup"><span data-stu-id="d118d-211">For best performance on Data Lake Store, have the bolt buffer 4 MB of tuple data.</span></span> <span data-ttu-id="d118d-212">Majd visszaírni a Data Lake Store célból egy 4 MB-os írhatóként.</span><span class="sxs-lookup"><span data-stu-id="d118d-212">Then write to the Data Lake Store back end as one 4-MB write.</span></span> <span data-ttu-id="d118d-213">Miután az adatok írása sikeresen befejeződött az áruház (hívó hflush()) tartalmaz a bolt is jelenti az adatokat a spout.</span><span class="sxs-lookup"><span data-stu-id="d118d-213">After the data has been successfully written to the store (by calling hflush()), the bolt can acknowledge the data back to the spout.</span></span> <span data-ttu-id="d118d-214">Ez az itt megadott példa tartalmaz a bolt funkciója.</span><span class="sxs-lookup"><span data-stu-id="d118d-214">This is what the example bolt supplied here does.</span></span> <span data-ttu-id="d118d-215">Egyúttal elfogadható előtt a hflush() kezdeményezték a rekordokat és a rekordokat a nyugtázott nagyobb számú tárolásához.</span><span class="sxs-lookup"><span data-stu-id="d118d-215">It is also acceptable to hold a larger number of tuples before the hflush() call is made and the tuples acknowledged.</span></span> <span data-ttu-id="d118d-216">Azonban ez növeli a spout tárolásához szükséges, és ezért növeli a szükséges memória mérete / JVM útban rekordjainak számát.</span><span class="sxs-lookup"><span data-stu-id="d118d-216">However, this increases the number of tuples in flight that the spout needs to hold, and therefore increases the amount of memory required per JVM.</span></span>

> [!NOTE]
<span data-ttu-id="d118d-217">Előfordulhat, hogy az alkalmazások számára, hogy tudomásul gyakrabban (a adatok mérete MB-nál kisebb 4) rekordokat más nem teljesítményének javítására szolgál.</span><span class="sxs-lookup"><span data-stu-id="d118d-217">Applications might have a requirement to acknowledge tuples more frequently (at data sizes less than 4 MB) for other non-performance reasons.</span></span> <span data-ttu-id="d118d-218">Azonban, hogy a tároló háttér az i/o átviteli hatással lehetnek.</span><span class="sxs-lookup"><span data-stu-id="d118d-218">However, that might affect the I/O throughput to the storage back end.</span></span> <span data-ttu-id="d118d-219">Gondosan mérjük ez kompromisszumot tartalmaz a bolt i/o-teljesítmény ellen.</span><span class="sxs-lookup"><span data-stu-id="d118d-219">Carefully weigh this tradeoff against the bolt’s I/O performance.</span></span>

<span data-ttu-id="d118d-220">Ha a listának beérkezési sebessége nem magas, a 4 MB-os puffer kitöltésének hosszú ideig tart, érdemes kiküszöböléséhez ezt úgy:</span><span class="sxs-lookup"><span data-stu-id="d118d-220">If the incoming rate of tuples is not high, so the 4-MB buffer takes a long time to fill, consider mitigating this by:</span></span>
* <span data-ttu-id="d118d-221">Boltokhoz számának csökkentése, így nincsenek kevesebb pufferek kitöltéséhez.</span><span class="sxs-lookup"><span data-stu-id="d118d-221">Reducing the number of bolts, so there are fewer buffers to fill.</span></span>
* <span data-ttu-id="d118d-222">Minden kiürítéseinek x vagy minden y ezredmásodperc rendelkező időalapú vagy count-alapú szabályzat, ahol egy hflush() van elindítva, és a rekordokat, amennyiben halmozott ismernek vissza.</span><span class="sxs-lookup"><span data-stu-id="d118d-222">Having a time-based or count-based policy, where an hflush() is triggered every x flushes or every y milliseconds, and the tuples accumulated so far are acknowledged back.</span></span>

<span data-ttu-id="d118d-223">Fontos megjegyezni, hogy az átviteli sebesség a jelen esetben ez alacsonyabb események lassú sebesség, maximális átviteli sebesség célja nem a legnagyobb ennek ellenére is.</span><span class="sxs-lookup"><span data-stu-id="d118d-223">Note that the throughput in this case is lower, but with a slow rate of events, maximum throughput is not the biggest objective anyway.</span></span> <span data-ttu-id="d118d-224">A megoldást, amely egy rekordot az áruház áramlása érdekében szükséges teljes idő csökkentése érdekében.</span><span class="sxs-lookup"><span data-stu-id="d118d-224">These mitigations help you reduce the total time that it takes for a tuple to flow through to the store.</span></span> <span data-ttu-id="d118d-225">Ez lehet, hogy számít, ha azt szeretné, hogy még egy kis események száma a valós idejű folyamat.</span><span class="sxs-lookup"><span data-stu-id="d118d-225">This might matter if you want a real-time pipeline even with a low event rate.</span></span> <span data-ttu-id="d118d-226">Ne feledje, hogy ha a bejövő rekordot aránya alacsony, kell beállítani a topology.message.timeout_secs paraméter, a rekordok nem túllépi az időkorlátot, miközben azok első pufferelt vagy nem dolgozható fel.</span><span class="sxs-lookup"><span data-stu-id="d118d-226">Also note that if your incoming tuple rate is low, you should adjust the topology.message.timeout_secs parameter, so the tuples don’t time out while they are getting buffered or processed.</span></span>

## <a name="monitor-your-topology-in-storm"></a><span data-ttu-id="d118d-227">A topológia a Storm figyelése</span><span class="sxs-lookup"><span data-stu-id="d118d-227">Monitor your topology in Storm</span></span>  
<span data-ttu-id="d118d-228">A topológia futása közben, a figyelheti a Storm felhasználói felületén.</span><span class="sxs-lookup"><span data-stu-id="d118d-228">While your topology is running, you can monitor it in the Storm user interface.</span></span> <span data-ttu-id="d118d-229">Az alábbiakban a fő paraméterek közül:</span><span class="sxs-lookup"><span data-stu-id="d118d-229">Here are the main parameters to look at:</span></span>

* <span data-ttu-id="d118d-230">**Teljes folyamat végrehajtása késés.**</span><span class="sxs-lookup"><span data-stu-id="d118d-230">**Total process execution latency.**</span></span> <span data-ttu-id="d118d-231">Ez az egy rekordot a spout által kibocsátott, a bolt által feldolgozott és nyugtázott szükséges átlagos idő.</span><span class="sxs-lookup"><span data-stu-id="d118d-231">This is the average time one tuple takes to be emitted by the spout, processed by the bolt, and acknowledged.</span></span>

* <span data-ttu-id="d118d-232">**Teljes bolt folyamat várakozási ideje**</span><span class="sxs-lookup"><span data-stu-id="d118d-232">**Total bolt process latency.**</span></span> <span data-ttu-id="d118d-233">Ez az az átlagos feldolgozási idő által a rekord tartalmaz a bolt, amíg nem kap nyugtázást.</span><span class="sxs-lookup"><span data-stu-id="d118d-233">This is the average time spent by the tuple at the bolt until it receives an acknowledgement.</span></span>

* <span data-ttu-id="d118d-234">**Teljes bolt késés hajtható végre.**</span><span class="sxs-lookup"><span data-stu-id="d118d-234">**Total bolt execute latency.**</span></span> <span data-ttu-id="d118d-235">Ez az az execute metódus a bolt által töltött átlagos idő.</span><span class="sxs-lookup"><span data-stu-id="d118d-235">This is the average time spent by the bolt in the execute method.</span></span>

* <span data-ttu-id="d118d-236">**Hibák száma.**</span><span class="sxs-lookup"><span data-stu-id="d118d-236">**Number of failures.**</span></span> <span data-ttu-id="d118d-237">Ez vonatkozik, amelyek nem tudta teljesen feldolgozni ahhoz, azok túllépte az időkorlátot rekordjainak számát.</span><span class="sxs-lookup"><span data-stu-id="d118d-237">This refers to the number of tuples that failed to be fully processed before they timed out.</span></span>

* <span data-ttu-id="d118d-238">**A kapacitás.**</span><span class="sxs-lookup"><span data-stu-id="d118d-238">**Capacity.**</span></span> <span data-ttu-id="d118d-239">Ez a méri, hogy foglalt a rendszer.</span><span class="sxs-lookup"><span data-stu-id="d118d-239">This is a measure of how busy your system is.</span></span> <span data-ttu-id="d118d-240">Ha ez a szám 1, a boltokhoz gyors a következőkre dolgozik.</span><span class="sxs-lookup"><span data-stu-id="d118d-240">If this number is 1, your bolts are working as fast as they can.</span></span> <span data-ttu-id="d118d-241">Ha 1-nél kisebb, növelheti a párhuzamosságot.</span><span class="sxs-lookup"><span data-stu-id="d118d-241">If it is less than 1, increase the parallelism.</span></span> <span data-ttu-id="d118d-242">Ha nagyobb, mint 1, csökkentse a párhuzamos végrehajtás.</span><span class="sxs-lookup"><span data-stu-id="d118d-242">If it is greater than 1, reduce the parallelism.</span></span>

## <a name="troubleshoot-common-problems"></a><span data-ttu-id="d118d-243">Gyakori hibák elhárítása</span><span class="sxs-lookup"><span data-stu-id="d118d-243">Troubleshoot common problems</span></span>
<span data-ttu-id="d118d-244">Az alábbiakban néhány gyakori hibaelhárítási forgatókönyveket.</span><span class="sxs-lookup"><span data-stu-id="d118d-244">Here are a few common troubleshooting scenarios.</span></span>
* <span data-ttu-id="d118d-245">**Sok listának vannak időtúllépés miatt.**</span><span class="sxs-lookup"><span data-stu-id="d118d-245">**Many tuples are timing out.**</span></span> <span data-ttu-id="d118d-246">Tekintse meg a topológia annak megállapításához, ahol a szűk keresztmetszetek minden csomópontja.</span><span class="sxs-lookup"><span data-stu-id="d118d-246">Look at each node in the topology to determine where the bottleneck is.</span></span> <span data-ttu-id="d118d-247">Ennek leggyakoribb oka az, hogy a boltokhoz nem képesek a spoutokkal kapcsolatban tartani.</span><span class="sxs-lookup"><span data-stu-id="d118d-247">The most common reason for this is that the bolts are not able to keep up with the spouts.</span></span> <span data-ttu-id="d118d-248">Ennek eredménye a belső puffer eltömődés közben feldolgozásra váró rekordokat.</span><span class="sxs-lookup"><span data-stu-id="d118d-248">This leads to tuples clogging the internal buffers while waiting to be processed.</span></span> <span data-ttu-id="d118d-249">Vegye figyelembe az időkorlát értékének növelésével vagy csökkentésével a maximális spout függőben.</span><span class="sxs-lookup"><span data-stu-id="d118d-249">Consider increasing the timeout value or decreasing the max spout pending.</span></span>

* <span data-ttu-id="d118d-250">**Nincs, a magas teljes folyamat végrehajtása késés, de egy kis bolt folyamat várakozási ideje.**</span><span class="sxs-lookup"><span data-stu-id="d118d-250">**There is a high total process execution latency, but a low bolt process latency.**</span></span> <span data-ttu-id="d118d-251">Ebben az esetben is lehet, hogy a rekordok nem alatt ismernek elég gyorsan.</span><span class="sxs-lookup"><span data-stu-id="d118d-251">In this case, it is possible that the tuples are not being acknowledged fast enough.</span></span> <span data-ttu-id="d118d-252">Ellenőrizze, hogy vannak-e elegendő acknowledgers.</span><span class="sxs-lookup"><span data-stu-id="d118d-252">Check that there are a sufficient number of acknowledgers.</span></span> <span data-ttu-id="d118d-253">Egy másik lehetőség, hogy várnak a várakozási sorban túl hosszú őket a boltokhoz előtt.</span><span class="sxs-lookup"><span data-stu-id="d118d-253">Another possibility is that they are waiting in the queue for too long before the bolts start processing them.</span></span> <span data-ttu-id="d118d-254">A függőben lévő maximális spout csökkentése.</span><span class="sxs-lookup"><span data-stu-id="d118d-254">Decrease the max spout pending.</span></span>

* <span data-ttu-id="d118d-255">**Nincs a magas bolt késés hajtható végre.**</span><span class="sxs-lookup"><span data-stu-id="d118d-255">**There is a high bolt execute latency.**</span></span> <span data-ttu-id="d118d-256">Ez azt jelenti, hogy a bolt az execute() metódus metódusában túl sokáig tart.</span><span class="sxs-lookup"><span data-stu-id="d118d-256">This means that the execute() method of your bolt is taking too long.</span></span> <span data-ttu-id="d118d-257">Optimalizálni a kódot, vagy írási méretben keresse meg és ürítse ki a viselkedést.</span><span class="sxs-lookup"><span data-stu-id="d118d-257">Optimize the code, or look at write sizes and flush behavior.</span></span>

### <a name="data-lake-store-throttling"></a><span data-ttu-id="d118d-258">Data Lake Store-szabályozás</span><span class="sxs-lookup"><span data-stu-id="d118d-258">Data Lake Store throttling</span></span>
<span data-ttu-id="d118d-259">Elérte a Data Lake Store által biztosított sávszélesség korlátai, ha a feladat sikertelen jelenhet meg.</span><span class="sxs-lookup"><span data-stu-id="d118d-259">If you hit the limits of bandwidth provided by Data Lake Store, you might see task failures.</span></span> <span data-ttu-id="d118d-260">Tekintse meg a feladat naplókat hibák szabályozás.</span><span class="sxs-lookup"><span data-stu-id="d118d-260">Check task logs for throttling errors.</span></span> <span data-ttu-id="d118d-261">A párhuzamos tároló méretének növelésével csökkenthető.</span><span class="sxs-lookup"><span data-stu-id="d118d-261">You can decrease the parallelism by increasing container size.</span></span>    

<span data-ttu-id="d118d-262">Ellenőrizze, hogy Ön első szabályozott, engedélyezze a hibakeresési naplózás ügyféloldali:</span><span class="sxs-lookup"><span data-stu-id="d118d-262">To check if you are getting throttled, enable the debug logging on the client side:</span></span>

1. <span data-ttu-id="d118d-263">A **Ambari** > **Storm** > **Config** > **storm-worker-log4j speciális**, módosítsa  **&lt;gyökér szintű = "Infó"&gt;**  való  **&lt;legfelső szintű = "debug"&gt;**.</span><span class="sxs-lookup"><span data-stu-id="d118d-263">In **Ambari** > **Storm** > **Config** > **Advanced storm-worker-log4j**, change **&lt;root level="info"&gt;** to **&lt;root level=”debug”&gt;**.</span></span> <span data-ttu-id="d118d-264">Indítsa újra az összes a csomópontok/szolgáltatást a konfigurációjának érvénybe léptetéséhez.</span><span class="sxs-lookup"><span data-stu-id="d118d-264">Restart all the nodes/service for the configuration to take effect.</span></span>
2. <span data-ttu-id="d118d-265">A Storm-topológia bejelentkezik a munkavégző csomópont monitor (alatt /var/log/storm/worker-artifacts /&lt;TopologyName&gt;/&lt;port&gt;/worker.log) a Data Lake Store szabályozási kivételeket.</span><span class="sxs-lookup"><span data-stu-id="d118d-265">Monitor the Storm topology logs on worker nodes (under /var/log/storm/worker-artifacts/&lt;TopologyName&gt;/&lt;port&gt;/worker.log) for Data Lake Store throttling exceptions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d118d-266">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="d118d-266">Next steps</span></span>
<span data-ttu-id="d118d-267">További teljesítményhangolás, a Storm hivatkozható [ebben a blogban](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span><span class="sxs-lookup"><span data-stu-id="d118d-267">Additional performance tuning for Storm can be referenced in [this blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span></span>

<span data-ttu-id="d118d-268">További például futtatásához, [erre a Githubon](https://github.com/hdinsight/storm-performance-automation).</span><span class="sxs-lookup"><span data-stu-id="d118d-268">For an additional example to run, see [this one on GitHub](https://github.com/hdinsight/storm-performance-automation).</span></span>
