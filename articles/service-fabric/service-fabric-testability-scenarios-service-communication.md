---
title: "Tesztelhetőségi: Szolgáltatás kommunikációs |} Microsoft Docs"
description: "Szolgáltatások közötti kommunikáció az olyan kritikus integrációs pont Service Fabric-alkalmazás. A cikk ismerteti a tervezési szempontokat és tesztelési módszereket."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: 017557df-fb59-4e4a-a65d-2732f29255b8
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 4a8f941c1e8e641384a9ee3a1149dabaaf9983cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-testability-scenarios-service-communication"></a><span data-ttu-id="465ac-104">A Service Fabric tesztelhetőségi forgatókönyvek: kommunikációs szolgáltatás</span><span class="sxs-lookup"><span data-stu-id="465ac-104">Service Fabric testability scenarios: Service communication</span></span>
<span data-ttu-id="465ac-105">Mikroszolgáltatások létrehozására és természetesen az Azure Service Fabric architekturális stílusok szolgáltatásorientált felülete.</span><span class="sxs-lookup"><span data-stu-id="465ac-105">Microservices and service-oriented architectural styles surface naturally in Azure Service Fabric.</span></span> <span data-ttu-id="465ac-106">Az elosztott-architektúrák típusai componentized mikroszolgáltatási alkalmazások általában több szolgáltatás igénylő tootalk tooeach más álló.</span><span class="sxs-lookup"><span data-stu-id="465ac-106">In these types of distributed architectures, componentized microservice applications are typically composed of multiple services that need tootalk tooeach other.</span></span> <span data-ttu-id="465ac-107">Még akkor is, hello legegyszerűbb esetben általában van legalább egy állapot nélküli webszolgáltatás és egy állapotalapú tárolási szolgáltatás toocommunicate igénylő.</span><span class="sxs-lookup"><span data-stu-id="465ac-107">In even hello simplest cases, you generally have at least a stateless web service and a stateful data storage service that need toocommunicate.</span></span>

<span data-ttu-id="465ac-108">Szolgáltatások közötti kommunikáció nem egy alkalmazást, az kritikus integrációs pont, mert minden egyes szolgáltatás elérhetővé teszi a távoli API tooother szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="465ac-108">Service-to-service communication is a critical integration point of an application, because each service exposes a remote API tooother services.</span></span> <span data-ttu-id="465ac-109">API határok olyan készlete, amelyek i/o általában végzett néhány eljárni, tesztelése és érvényesítési megfelelő mennyiségű igényel.</span><span class="sxs-lookup"><span data-stu-id="465ac-109">Working with a set of API boundaries that involves I/O generally requires some care, with a good amount of testing and validation.</span></span>

<span data-ttu-id="465ac-110">Ha a szolgáltatás határok vezetékes együtt egy elosztott rendszerben, nincsenek számos szempontok toomake:</span><span class="sxs-lookup"><span data-stu-id="465ac-110">There are numerous considerations toomake when these service boundaries are wired together in a distributed system:</span></span>

* <span data-ttu-id="465ac-111">*Átviteli protokoll*.</span><span class="sxs-lookup"><span data-stu-id="465ac-111">*Transport protocol*.</span></span> <span data-ttu-id="465ac-112">Fog alkalmazni a megnövekedett való együttműködés HTTP, vagy egy egyéni bináris protokoll maximális átviteli sebesség eléréséhez?</span><span class="sxs-lookup"><span data-stu-id="465ac-112">Will you use HTTP for increased interoperability, or a custom binary protocol for maximum throughput?</span></span>
* <span data-ttu-id="465ac-113">*Hibakezelés*.</span><span class="sxs-lookup"><span data-stu-id="465ac-113">*Error handling*.</span></span> <span data-ttu-id="465ac-114">Állandó és átmeneti hibák kezelésének módját?</span><span class="sxs-lookup"><span data-stu-id="465ac-114">How will permanent and transient errors be handled?</span></span> <span data-ttu-id="465ac-115">Mi történik, ha a szolgáltatás helyezi tooa másik csomópont?</span><span class="sxs-lookup"><span data-stu-id="465ac-115">What will happen when a service moves tooa different node?</span></span>
* <span data-ttu-id="465ac-116">*Időtúllépések és a késleltetés*.</span><span class="sxs-lookup"><span data-stu-id="465ac-116">*Timeouts and latency*.</span></span> <span data-ttu-id="465ac-117">Állással alkalmazásokban hogyan minden szolgáltatási réteg kezelnek hello verem és toohello felhasználó késést?</span><span class="sxs-lookup"><span data-stu-id="465ac-117">In multitiered applications, how will each service layer handle latency through hello stack and toohello user?</span></span>

<span data-ttu-id="465ac-118">Service Fabric által biztosított hello beépített szolgáltatás kommunikációs összetevők valamelyikét használja, vagy hoz létre a saját, kritikus tooensuring rugalmasságot az alkalmazás tesztelése a szolgáltatások közötti hello kapcsolati.</span><span class="sxs-lookup"><span data-stu-id="465ac-118">Whether you use one of hello built-in service communication components provided by Service Fabric or you build your own, testing hello interactions between your services is critical tooensuring resiliency in your application.</span></span>

## <a name="prepare-for-services-toomove"></a><span data-ttu-id="465ac-119">Szolgáltatások toomove előkészítése</span><span class="sxs-lookup"><span data-stu-id="465ac-119">Prepare for services toomove</span></span>
<span data-ttu-id="465ac-120">Előfordulhat, hogy idővel Navigálás szolgáltatáspéldány.</span><span class="sxs-lookup"><span data-stu-id="465ac-120">Service instances may move around over time.</span></span> <span data-ttu-id="465ac-121">Ez akkor különösen igaz olyan esetben, ha vannak konfigurálva az optimális erőforrás egyéni szabott terheléselosztás betöltési metrikáit.</span><span class="sxs-lookup"><span data-stu-id="465ac-121">This is especially true when they are configured with load metrics for custom-tailored optimal resource balancing.</span></span> <span data-ttu-id="465ac-122">A Service Fabric helyezi át a szolgáltatás példányok toomaximize a rendelkezésre állásuk frissítések, a feladatátvétel, a kibővített és a más elosztott rendszer hello élettartamuk során előforduló helyzetek esetén.</span><span class="sxs-lookup"><span data-stu-id="465ac-122">Service Fabric moves your service instances toomaximize their availability even during upgrades, failovers, scale-out, and other situations that occur over hello lifetime of a distributed system.</span></span>

<span data-ttu-id="465ac-123">Hello fürt Navigálás szolgáltatások, az ügyfelek és egyéb szolgáltatások kell előkészített toohandle két olyan eset, amikor azok beszélgetés tooa szolgáltatás:</span><span class="sxs-lookup"><span data-stu-id="465ac-123">As services move around in hello cluster, your clients and other services should be prepared toohandle two scenarios when they talk tooa service:</span></span>

* <span data-ttu-id="465ac-124">hello szolgáltatás példányt, vagy a partíció replika óta hello legutóbbi tooit volt szó, akkor át lett helyezve.</span><span class="sxs-lookup"><span data-stu-id="465ac-124">hello service instance or partition replica has moved since hello last time you talked tooit.</span></span> <span data-ttu-id="465ac-125">Ez a szolgáltatási életciklus részét, és várt toohappen kell az alkalmazás hello élettartama során.</span><span class="sxs-lookup"><span data-stu-id="465ac-125">This is a normal part of a service lifecycle, and it should be expected toohappen during hello lifetime of your application.</span></span>
* <span data-ttu-id="465ac-126">hello szolgáltatás példányt, vagy a partíció replikája hello során.</span><span class="sxs-lookup"><span data-stu-id="465ac-126">hello service instance or partition replica is in hello process of moving.</span></span> <span data-ttu-id="465ac-127">A szolgáltatás egy csomópont tooanother történő feladatátvételt nagyon gyorsan a Service Fabric, bár lehet késleltetést a rendelkezésre állási Ha hello kommunikációs összetevő a szolgáltatás lassú toostart.</span><span class="sxs-lookup"><span data-stu-id="465ac-127">Although failover of a service from one node tooanother occurs very quickly in Service Fabric, there may be a delay in availability if hello communication component of your service is slow toostart.</span></span>

<span data-ttu-id="465ac-128">Ezek a forgatókönyvek szabályosan kezelése fontos smooth futó rendszer esetén.</span><span class="sxs-lookup"><span data-stu-id="465ac-128">Handling these scenarios gracefully is important for a smooth-running system.</span></span> <span data-ttu-id="465ac-129">toodo Igen, vegye figyelembe, hogy:</span><span class="sxs-lookup"><span data-stu-id="465ac-129">toodo so, keep in mind that:</span></span>

* <span data-ttu-id="465ac-130">Minden szolgáltatás, amely csatlakoztatott toohas egy *cím* (például a HTTP vagy a websocket elemek) figyelő.</span><span class="sxs-lookup"><span data-stu-id="465ac-130">Every service that can be connected toohas an *address* that it listens on (for example, HTTP or WebSockets).</span></span> <span data-ttu-id="465ac-131">Ha egy szolgáltatáspéldány vagy partíció helyezi, a cím végpont változik.</span><span class="sxs-lookup"><span data-stu-id="465ac-131">When a service instance or partition moves, its address endpoint changes.</span></span> <span data-ttu-id="465ac-132">(Tooa másik csomópont egy másik IP-címmel áthelyezi azt.) Hello beépített kommunikációs összetevők használata, azok újra feloldó szolgáltatás címek meg fogja kezelni.</span><span class="sxs-lookup"><span data-stu-id="465ac-132">(It moves tooa different node with a different IP address.) If you're using hello built-in communication components, they will handle re-resolving service addresses for you.</span></span>
* <span data-ttu-id="465ac-133">Előfordulhat, a szolgáltatás késés hello szolgáltatás példány indításakor a figyelő mentése másként ideiglenes növelése újra.</span><span class="sxs-lookup"><span data-stu-id="465ac-133">There may be a temporary increase in service latency as hello service instance starts up its listener again.</span></span> <span data-ttu-id="465ac-134">Ez attól függ, hogy milyen gyorsan hello szolgáltatás hello figyelő követően megnyílik hello szolgáltatáspéldány kerül.</span><span class="sxs-lookup"><span data-stu-id="465ac-134">This depends on how quickly hello service opens hello listener after hello service instance is moved.</span></span>
* <span data-ttu-id="465ac-135">A meglévő kapcsolatokat kell toobe zárva, és újra megnyitja a hello szolgáltatást egy új csomópont megnyitása után.</span><span class="sxs-lookup"><span data-stu-id="465ac-135">Any existing connections need toobe closed and reopened after hello service opens on a new node.</span></span> <span data-ttu-id="465ac-136">Egy szabályos csomópont leállítása vagy újraindítása lehetővé teszi a meglévő kapcsolatok toobe leállítása ideje.</span><span class="sxs-lookup"><span data-stu-id="465ac-136">A graceful node shutdown or restart allows time for existing connections toobe shut down gracefully.</span></span>

### <a name="test-it-move-service-instances"></a><span data-ttu-id="465ac-137">Tesztelheti: szolgáltatáspéldány áthelyezése</span><span class="sxs-lookup"><span data-stu-id="465ac-137">Test it: Move service instances</span></span>
<span data-ttu-id="465ac-138">A Service Fabric tesztelhetőségi eszközök segítségével hozhat létre egy tesztelési forgatókönyvhöz tootest ezekben a helyzetekben különböző módon:</span><span class="sxs-lookup"><span data-stu-id="465ac-138">By using Service Fabric's testability tools, you can author a test scenario tootest these situations in different ways:</span></span>

1. <span data-ttu-id="465ac-139">Helyezze át egy állapotalapú szolgáltatás elsődleges másodpéldány.</span><span class="sxs-lookup"><span data-stu-id="465ac-139">Move a stateful service's primary replica.</span></span>
   
    <span data-ttu-id="465ac-140">hello állapotalapú szolgáltatási partíció elsődleges replika áthelyezhető sem állhat okokra vezethető vissza.</span><span class="sxs-lookup"><span data-stu-id="465ac-140">hello primary replica of a stateful service partition can be moved for any number of reasons.</span></span> <span data-ttu-id="465ac-141">Használja a tootarget hello elsődleges másodpéldányának egy adott partícióra toosee hogyan helyezze át a szolgáltatások reagálni toohello nagyon szabályozott módon.</span><span class="sxs-lookup"><span data-stu-id="465ac-141">Use this tootarget hello primary replica of a specific partition toosee how your services react toohello move in a very controlled manner.</span></span>
   
    ```powershell
   
    PS > Move-ServiceFabricPrimaryReplica -PartitionId 6faa4ffa-521a-44e9-8351-dfca0f7e0466 -ServiceName fabric:/MyApplication/MyService
   
    ```
2. <span data-ttu-id="465ac-142">Csomópont leállítása.</span><span class="sxs-lookup"><span data-stu-id="465ac-142">Stop a node.</span></span>
   
    <span data-ttu-id="465ac-143">Ha egy csomópont leáll, a Service Fabric helyezi át az összes hello szolgáltatás példányok vagy azelőtt, hogy a csomópont tooone található partíciók hello más elérhető hello fürt csomópontja.</span><span class="sxs-lookup"><span data-stu-id="465ac-143">When a node is stopped, Service Fabric moves all of hello service instances or partitions that were on that node tooone of hello other available nodes in hello cluster.</span></span> <span data-ttu-id="465ac-144">Ez a helyzet, ha egy csomópontot a fürtről elvész, és minden hello szolgáltatás példányainak és ezen a csomóponton replikák rendelkezik, toomove tootest használja.</span><span class="sxs-lookup"><span data-stu-id="465ac-144">Use this tootest a situation where a node is lost from your cluster and all of hello service instances and replicas on that node have toomove.</span></span>
   
    <span data-ttu-id="465ac-145">Egy csomópont le is hello PowerShell használatával **Stop-ServiceFabricNode** parancsmagot:</span><span class="sxs-lookup"><span data-stu-id="465ac-145">You can stop a node by using hello PowerShell **Stop-ServiceFabricNode** cmdlet:</span></span>
   
    ```powershell
   
    PS > Restart-ServiceFabricNode -NodeName Node_1
   
    ```

## <a name="maintain-service-availability"></a><span data-ttu-id="465ac-146">Szolgáltatás rendelkezésre állása karbantartása</span><span class="sxs-lookup"><span data-stu-id="465ac-146">Maintain service availability</span></span>
<span data-ttu-id="465ac-147">Platformként a Service Fabric tervezett tooprovide magas rendelkezésre állású a szolgáltatásokat.</span><span class="sxs-lookup"><span data-stu-id="465ac-147">As a platform, Service Fabric is designed tooprovide high availability of your services.</span></span> <span data-ttu-id="465ac-148">De szélsőséges esetben alapul szolgáló infrastruktúra problémákat is okozhatnak elérhetetlensége.</span><span class="sxs-lookup"><span data-stu-id="465ac-148">But in extreme cases, underlying infrastructure problems can still cause unavailability.</span></span> <span data-ttu-id="465ac-149">Ezek a forgatókönyvek esetén fontos tootest túl.</span><span class="sxs-lookup"><span data-stu-id="465ac-149">It is important tootest for these scenarios, too.</span></span>

<span data-ttu-id="465ac-150">Állapotalapú szolgáltatások egy kvórum-alapú rendszerállapot tooreplicate használja a magas rendelkezésre állás érdekében.</span><span class="sxs-lookup"><span data-stu-id="465ac-150">Stateful services use a quorum-based system tooreplicate state for high availability.</span></span> <span data-ttu-id="465ac-151">Ez azt jelenti, hogy a replikákat másodlagosak kell toobe elérhető tooperform írási műveleteket.</span><span class="sxs-lookup"><span data-stu-id="465ac-151">This means that a quorum of replicas needs toobe available tooperform write operations.</span></span> <span data-ttu-id="465ac-152">Bizonyos ritkán előforduló esetekben, például a széles körű hardverhiba replikák kvórum nem érhetők el.</span><span class="sxs-lookup"><span data-stu-id="465ac-152">In rare cases, such as a widespread hardware failure, a quorum of replicas may not be available.</span></span> <span data-ttu-id="465ac-153">Ebben az esetben nem fogja tudni tooperform írási műveleteket, de továbbra is meg fogja tudni tooperform olvasási műveletek.</span><span class="sxs-lookup"><span data-stu-id="465ac-153">In these cases, you will not be able tooperform write operations, but you will still be able tooperform read operations.</span></span>

### <a name="test-it-write-operation-unavailability"></a><span data-ttu-id="465ac-154">Tesztelheti: írási művelet elérhetetlensége</span><span class="sxs-lookup"><span data-stu-id="465ac-154">Test it: Write operation unavailability</span></span>
<span data-ttu-id="465ac-155">A Service Fabric hello tesztelhetőségi eszközök használatával helyezhet el a hibát, amely a kvórum elvesztése, mert egy tesztelési kapott.</span><span class="sxs-lookup"><span data-stu-id="465ac-155">By using hello testability tools in Service Fabric, you can inject a fault that induces quorum loss as a test.</span></span> <span data-ttu-id="465ac-156">Bár az ilyen esetben nem ritka, fontos, hogy az ügyfelek és a szolgáltatás, amely egy állapotalapú szolgáltatás függ toohandle olyan helyzetekben, ahol azok nem hajtható végre írási kérések tooit előkészítése.</span><span class="sxs-lookup"><span data-stu-id="465ac-156">Although such a scenario is rare, it is important that clients and services that depend on a stateful service are prepared toohandle situations where they cannot make write requests tooit.</span></span> <span data-ttu-id="465ac-157">Fontos továbbá hello állapotalapú szolgáltatás felismeri ezt a lehetőséget, és lehet szabályosan tájékoztatni toocallers.</span><span class="sxs-lookup"><span data-stu-id="465ac-157">It is also important that hello stateful service itself is aware of this possibility and can gracefully communicate it toocallers.</span></span>

<span data-ttu-id="465ac-158">Hello PowerShell segítségével lehet szükség a kvórum elvesztése **Invoke-ServiceFabricPartitionQuorumLoss** parancsmagot:</span><span class="sxs-lookup"><span data-stu-id="465ac-158">You can induce quorum loss by using hello PowerShell **Invoke-ServiceFabricPartitionQuorumLoss** cmdlet:</span></span>

```powershell

PS > Invoke-ServiceFabricPartitionQuorumLoss -ServiceName fabric:/Myapplication/MyService -QuorumLossMode QuorumReplicas -QuorumLossDurationInSeconds 20

```

<span data-ttu-id="465ac-159">Ebben a példában hivatott `QuorumLossMode` túl`QuorumReplicas` tooindicate, amely azt szeretnénk, ha tooinduce kvórum elvesztése nélkül összes replika le.</span><span class="sxs-lookup"><span data-stu-id="465ac-159">In this example, we set `QuorumLossMode` too`QuorumReplicas` tooindicate that we want tooinduce quorum loss without taking down all replicas.</span></span> <span data-ttu-id="465ac-160">Ezzel a módszerrel az olvasási műveletek is továbbra is lehetséges.</span><span class="sxs-lookup"><span data-stu-id="465ac-160">This way, read operations are still possible.</span></span> <span data-ttu-id="465ac-161">tootest olyan forgatókönyvekben, ahol egy teljes partíció nem érhető el, beállíthatja a kapcsoló túl`AllReplicas`.</span><span class="sxs-lookup"><span data-stu-id="465ac-161">tootest a scenario where an entire partition is unavailable, you can set this switch too`AllReplicas`.</span></span>

## <a name="next-steps"></a><span data-ttu-id="465ac-162">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="465ac-162">Next steps</span></span>
[<span data-ttu-id="465ac-163">További tudnivalók tesztelhetőségi műveletek</span><span class="sxs-lookup"><span data-stu-id="465ac-163">Learn more about testability actions</span></span>](service-fabric-testability-actions.md)

[<span data-ttu-id="465ac-164">További tudnivalók tesztelhetőségi forgatókönyvek</span><span class="sxs-lookup"><span data-stu-id="465ac-164">Learn more about testability scenarios</span></span>](service-fabric-testability-scenarios.md)

