---
title: "egyéni Service Fabric állapotjelentések aaaAdd |} Microsoft Docs"
description: "Ismerteti, hogyan toosend egyéni rendszerállapot-jelentéseket tooAzure Service Fabric állapotfigyelő entitásokat. Ad javaslatokat megtervezése és minőségi állapotjelentések végrehajtása."
services: service-fabric
documentationcenter: .net
author: oanapl
manager: timlt
editor: 
ms.assetid: 0a00a7d2-510e-47d0-8aa8-24c851ea847f
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/19/2017
ms.author: oanapl
ms.openlocfilehash: 12c9f664e2a457b4e1e8f340873ca60ebcefb097
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="add-custom-service-fabric-health-reports"></a><span data-ttu-id="f3780-104">Egyéni Service Fabric-állapotjelentések hozzáadása</span><span class="sxs-lookup"><span data-stu-id="f3780-104">Add custom Service Fabric health reports</span></span>
<span data-ttu-id="f3780-105">Az Azure Service Fabric vezet be a [állapotmodell](service-fabric-health-introduction.md) tooflag sérült fürt és az alkalmazás feltételeket az adott entitásokra.</span><span class="sxs-lookup"><span data-stu-id="f3780-105">Azure Service Fabric introduces a [health model](service-fabric-health-introduction.md) designed tooflag unhealthy cluster and application conditions on specific entities.</span></span> <span data-ttu-id="f3780-106">hello állapotfigyelő modellje **állapotfigyelő jelentéskészítők** (rendszer összetevőit és watchdogs).</span><span class="sxs-lookup"><span data-stu-id="f3780-106">hello health model uses **health reporters** (system components and watchdogs).</span></span> <span data-ttu-id="f3780-107">könnyű és gyors diagnosztikai és javítási hello célja.</span><span class="sxs-lookup"><span data-stu-id="f3780-107">hello goal is easy and fast diagnosis and repair.</span></span> <span data-ttu-id="f3780-108">Szolgáltatás írók kell kapcsolatos állapotfigyelő toothink előzetes megfizetése esetén.</span><span class="sxs-lookup"><span data-stu-id="f3780-108">Service writers need toothink upfront about health.</span></span> <span data-ttu-id="f3780-109">Minden olyan esetben, kedvezőtlen hatással lehet az állapotfigyelő kell kiválasztását, különösen akkor, ha segíthet jelző problémák toohello legfelső szintű bezárásához.</span><span class="sxs-lookup"><span data-stu-id="f3780-109">Any condition that can impact health should be reported on, especially if it can help flag problems close toohello root.</span></span> <span data-ttu-id="f3780-110">hello állapottal kapcsolatos adatok is mentheti időt és erőfeszítést Hibakeresés és a vizsgálat.</span><span class="sxs-lookup"><span data-stu-id="f3780-110">hello health information can save time and effort on debugging and investigation.</span></span> <span data-ttu-id="f3780-111">hello hasznosságát különösen törlése után hello szolgáltatás megfelelően működik, és hello felhőben léptékű (magán- vagy Azure).</span><span class="sxs-lookup"><span data-stu-id="f3780-111">hello usefulness is especially clear once hello service is up and running at scale in hello cloud (private or Azure).</span></span>

<span data-ttu-id="f3780-112">a Service Fabric-jelentéskészítők nevű figyelő hello azonosított feltételek egyik fontos.</span><span class="sxs-lookup"><span data-stu-id="f3780-112">hello Service Fabric reporters monitor identified conditions of interest.</span></span> <span data-ttu-id="f3780-113">Azok a helyi nézet alapján feltételek jelentést.</span><span class="sxs-lookup"><span data-stu-id="f3780-113">They report on those conditions based on their local view.</span></span> <span data-ttu-id="f3780-114">Hello [a health Store adatbázisban](service-fabric-health-introduction.md#health-store) összesíti az összes jelentéskészítők toodetermine által küldött, hogy az entitások globálisan kifogástalan állapotának adatait.</span><span class="sxs-lookup"><span data-stu-id="f3780-114">hello [health store](service-fabric-health-introduction.md#health-store) aggregates health data sent by all reporters toodetermine whether entities are globally healthy.</span></span> <span data-ttu-id="f3780-115">hello modell tervezett toobe sokoldalú, rugalmasan és egyszerűen toouse.</span><span class="sxs-lookup"><span data-stu-id="f3780-115">hello model is intended toobe rich, flexible, and easy toouse.</span></span> <span data-ttu-id="f3780-116">hello állapotjelentések hello minőségének hello állapot nézet hello fürt hello pontosságát határozza meg.</span><span class="sxs-lookup"><span data-stu-id="f3780-116">hello quality of hello health reports determines hello accuracy of hello health view of hello cluster.</span></span> <span data-ttu-id="f3780-117">Téves tévesen jeleníti meg a nem megfelelő negatívan befolyásolhatja a frissítések vagy az egészségügyi adatokat használó más szolgáltatásokba.</span><span class="sxs-lookup"><span data-stu-id="f3780-117">False positives that wrongly show unhealthy issues can negatively impact upgrades or other services that use health data.</span></span> <span data-ttu-id="f3780-118">Ezek a szolgáltatások többek között a javítása és a riasztási mechanizmusokat.</span><span class="sxs-lookup"><span data-stu-id="f3780-118">Examples of such services are repair services and alerting mechanisms.</span></span> <span data-ttu-id="f3780-119">Néhány gondolat ezért hello érdeklődik feltételeinek rögzítéséhez szükséges tooprovide jelentések lehetséges módja az ajánlott.</span><span class="sxs-lookup"><span data-stu-id="f3780-119">Therefore, some thought is needed tooprovide reports that capture conditions of interest in hello best possible way.</span></span>

<span data-ttu-id="f3780-120">Állapotfigyelő jelentések, a watchdogs és a rendszer összetevők toodesign és megvalósítása kell:</span><span class="sxs-lookup"><span data-stu-id="f3780-120">toodesign and implement health reporting, watchdogs and system components must:</span></span>

* <span data-ttu-id="f3780-121">Hello számítógép megfigyelés alatt áll, és a hello hatással lehet a hello fürt vagy az alkalmazás funkcióit és azok iránt érdeklődik hello feltétel meghatározása.</span><span class="sxs-lookup"><span data-stu-id="f3780-121">Define hello condition they are interested in, hello way it is monitored, and hello impact on hello cluster or application functionality.</span></span> <span data-ttu-id="f3780-122">Ezen információ alapján, döntse el, a hello jelentés tulajdonság és egészségügyi állapota.</span><span class="sxs-lookup"><span data-stu-id="f3780-122">Based on this information, decide on hello health report property and health state.</span></span>
* <span data-ttu-id="f3780-123">Határozza meg a hello [entitás](service-fabric-health-introduction.md#health-entities-and-hierarchy) , hogy hello jelentés vonatkozik.</span><span class="sxs-lookup"><span data-stu-id="f3780-123">Determine hello [entity](service-fabric-health-introduction.md#health-entities-and-hierarchy) that hello report applies to.</span></span>
* <span data-ttu-id="f3780-124">Határozza meg, ahol hello reporting történik, belül hello szolgáltatást vagy a belső vagy külső figyelő.</span><span class="sxs-lookup"><span data-stu-id="f3780-124">Determine where hello reporting is done, from within hello service or from an internal or external watchdog.</span></span>
* <span data-ttu-id="f3780-125">Adja meg a használt forrás tooidentify hello jelentéskészítői.</span><span class="sxs-lookup"><span data-stu-id="f3780-125">Define a source used tooidentify hello reporter.</span></span>
* <span data-ttu-id="f3780-126">Válassza ki a jelentéskészítési stratégiát, vagy rendszeres időközönként, vagy a átmenetek.</span><span class="sxs-lookup"><span data-stu-id="f3780-126">Choose a reporting strategy, either periodically or on transitions.</span></span> <span data-ttu-id="f3780-127">hello ajánlott módja a rendszeres időközönként, egyszerűbb kód szükséges, és kevesebb a hibalehetőség tooerrors azt.</span><span class="sxs-lookup"><span data-stu-id="f3780-127">hello recommended way is periodically, as it requires simpler code and is less prone tooerrors.</span></span>
* <span data-ttu-id="f3780-128">Mennyi ideig hello jelentés határozza meg, a nem megfelelő feltételek hello a health Store adatbázisban kell maradnak, és hogyan azt törölni kell.</span><span class="sxs-lookup"><span data-stu-id="f3780-128">Determine how long hello report for unhealthy conditions should stay in hello health store and how it should be cleared.</span></span> <span data-ttu-id="f3780-129">Ezen információk alapján döntse el, hello jelentés toolive és eltávolítása a lejárati viselkedés.</span><span class="sxs-lookup"><span data-stu-id="f3780-129">Using this information, decide hello report's time toolive and remove-on-expiration behavior.</span></span>

<span data-ttu-id="f3780-130">Ahogy azt korábban említettük, reporting teheti meg:</span><span class="sxs-lookup"><span data-stu-id="f3780-130">As mentioned, reporting can be done from:</span></span>

* <span data-ttu-id="f3780-131">hello figyeli a rendszer a Service Fabric szolgáltatás replika.</span><span class="sxs-lookup"><span data-stu-id="f3780-131">hello monitored Service Fabric service replica.</span></span>
* <span data-ttu-id="f3780-132">Belső watchdogs telepített Service Fabric szolgáltatás (például a Service Fabric állapotmentes szolgáltatások, amely figyeli a feltételek és a jelentések problémák).</span><span class="sxs-lookup"><span data-stu-id="f3780-132">Internal watchdogs deployed as a Service Fabric service (for example, a Service Fabric stateless service that monitors conditions and issues reports).</span></span> <span data-ttu-id="f3780-133">hello watchdogs lehet telepíteni az összes csomópont, vagy a hozzárendelt toohello figyelt szolgáltatás lehet.</span><span class="sxs-lookup"><span data-stu-id="f3780-133">hello watchdogs can be deployed an all nodes or can be affinitized toohello monitored service.</span></span>
* <span data-ttu-id="f3780-134">Hello Service Fabric-csomópontokon futó, de belső watchdogs *nem* valósul meg a Service Fabric-szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="f3780-134">Internal watchdogs that run on hello Service Fabric nodes but are *not* implemented as Service Fabric services.</span></span>
* <span data-ttu-id="f3780-135">Külső watchdogs a mintavételi hello erőforrás *kívül* hello Service Fabric-fürt (például figyelőszolgáltatás Gomez hasonlóan).</span><span class="sxs-lookup"><span data-stu-id="f3780-135">External watchdogs that probe hello resource from *outside* hello Service Fabric cluster (for example, monitoring service like Gomez).</span></span>

> [!NOTE]
> <span data-ttu-id="f3780-136">Hello kezdő verzióról a hello fürt hello rendszerösszetevők által küldött állapotjelentések telepítéskor.</span><span class="sxs-lookup"><span data-stu-id="f3780-136">Out of hello box, hello cluster is populated with health reports sent by hello system components.</span></span> <span data-ttu-id="f3780-137">További információ: [hibaelhárítási rendszerállapot használatával jelentéseket](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span><span class="sxs-lookup"><span data-stu-id="f3780-137">Read more at [Using system health reports for troubleshooting](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span></span> <span data-ttu-id="f3780-138">hello felhasználói jelentések kell küldeni [állapotfigyelő entitások](service-fabric-health-introduction.md#health-entities-and-hierarchy) már létrehozott hello rendszer.</span><span class="sxs-lookup"><span data-stu-id="f3780-138">hello user reports must be sent on [health entities](service-fabric-health-introduction.md#health-entities-and-hierarchy) that have already been created by hello system.</span></span>
> 
> 

<span data-ttu-id="f3780-139">Egyszer hello jelentéskészítési állapotfigyelő Tervező nincs bejelölve, állapotjelentések könnyen küldhetők el.</span><span class="sxs-lookup"><span data-stu-id="f3780-139">Once hello health reporting design is clear, health reports can be sent easily.</span></span> <span data-ttu-id="f3780-140">Használhat [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport állapotát, ha hello fürt nem [biztonságos](service-fabric-cluster-security.md) , vagy ha hello fabric-ügyfélnek rendszergazdai jogosultságokkal rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="f3780-140">You can use [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport health if hello cluster is not [secure](service-fabric-cluster-security.md) or if hello fabric client has admin privileges.</span></span> <span data-ttu-id="f3780-141">Jelentéskészítési végezhető el hello API által használatával [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), PowerShell vagy a többi útján.</span><span class="sxs-lookup"><span data-stu-id="f3780-141">Reporting can be done through hello API by using [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), through PowerShell, or through REST.</span></span> <span data-ttu-id="f3780-142">Konfigurációs forgatógombját kötegelt javítja a teljesítményt a jelentésekre.</span><span class="sxs-lookup"><span data-stu-id="f3780-142">Configuration knobs batch reports for improved performance.</span></span>

> [!NOTE]
> <span data-ttu-id="f3780-143">A jelentés állapotának szinkron, és azt jelenti, hogy csak hello érvényesítési munkahelyi hello ügyféloldalon.</span><span class="sxs-lookup"><span data-stu-id="f3780-143">Report health is synchronous, and it represents only hello validation work on hello client side.</span></span> <span data-ttu-id="f3780-144">hello tényt, hogy a jelentés hello hello állapotfigyelő ügyfél vagy elfogadják hello `Partition` vagy `CodePackageActivationContext` objektumok nem jelenti azt, hogy az hello áruházbeli alkalmazásának.</span><span class="sxs-lookup"><span data-stu-id="f3780-144">hello fact that hello report is accepted by hello health client or hello `Partition` or `CodePackageActivationContext` objects doesn't mean that it is applied in hello store.</span></span> <span data-ttu-id="f3780-145">Küldött aszinkron módon történik, és esetleg kötegelni más jelentésekre.</span><span class="sxs-lookup"><span data-stu-id="f3780-145">It is sent asynchronously and possibly batched with other reports.</span></span> <span data-ttu-id="f3780-146">hello kiszolgálón feldolgozása hello továbbra is sikertelen lehet: hello sorszám elavult, mely hello a jelentés alkalmazni kell a hello entitás lett törölve, stb.</span><span class="sxs-lookup"><span data-stu-id="f3780-146">hello processing on hello server may still fail: hello sequence number could be stale, hello entity on which hello report must be applied has been deleted, etc.</span></span>
> 
> 

## <a name="health-client"></a><span data-ttu-id="f3780-147">Rendszerállapot-ügyfél</span><span class="sxs-lookup"><span data-stu-id="f3780-147">Health client</span></span>
<span data-ttu-id="f3780-148">hello rendszerállapot-jelentések küldése toohello a health Store adatbázisban egy állapotfigyelő ügyfélen, amely él belül hello fabric-ügyfélnek.</span><span class="sxs-lookup"><span data-stu-id="f3780-148">hello health reports are sent toohello health store through a health client, which lives inside hello fabric client.</span></span> <span data-ttu-id="f3780-149">a következő beállítások hello hello állapotfigyelő ügyfél konfigurálható:</span><span class="sxs-lookup"><span data-stu-id="f3780-149">hello health client can be configured with hello following settings:</span></span>

* <span data-ttu-id="f3780-150">**HealthReportSendInterval**: hello idő hello jelentés hello késleltetés az hozzáadott toohello ügyfél és a hello idő toohello a health Store adatbázisban továbbítja azokat.</span><span class="sxs-lookup"><span data-stu-id="f3780-150">**HealthReportSendInterval**: hello delay between hello time hello report is added toohello client and hello time it is sent toohello health store.</span></span> <span data-ttu-id="f3780-151">Egyetlen üzenet ahelyett, hogy az egyes jelentések küldő egy üzenetet a jelentések használt toobatch.</span><span class="sxs-lookup"><span data-stu-id="f3780-151">Used toobatch reports into a single message, rather than sending one message for each report.</span></span> <span data-ttu-id="f3780-152">hello kötegelés javítja a teljesítményt.</span><span class="sxs-lookup"><span data-stu-id="f3780-152">hello batching improves performance.</span></span> <span data-ttu-id="f3780-153">Alapértelmezett: 30 másodperc.</span><span class="sxs-lookup"><span data-stu-id="f3780-153">Default: 30 seconds.</span></span>
* <span data-ttu-id="f3780-154">**HealthReportRetrySendInterval**: hello időköz, mely hello állapotfigyelő újraküldi halmozott health jelentéseket toohello a health Store adatbázisban.</span><span class="sxs-lookup"><span data-stu-id="f3780-154">**HealthReportRetrySendInterval**: hello interval at which hello health client resends accumulated health reports toohello health store.</span></span> <span data-ttu-id="f3780-155">Alapértelmezett: 30 másodperc.</span><span class="sxs-lookup"><span data-stu-id="f3780-155">Default: 30 seconds.</span></span>
* <span data-ttu-id="f3780-156">**HealthOperationTimeout**: hello időkorlát jelentés üzenetet küldött toohello a health Store adatbázisban.</span><span class="sxs-lookup"><span data-stu-id="f3780-156">**HealthOperationTimeout**: hello timeout period for a report message sent toohello health store.</span></span> <span data-ttu-id="f3780-157">Ha az üzenet túllépi az időkorlátot, hello állapotfigyelő ügyfél azt újrapróbálkozik, amíg hello a health Store adatbázisban megerősíti, hogy hello jelentés feldolgozása.</span><span class="sxs-lookup"><span data-stu-id="f3780-157">If a message times out, hello health client retries it until hello health store confirms that hello report has been processed.</span></span> <span data-ttu-id="f3780-158">Alapértelmezett: két perc.</span><span class="sxs-lookup"><span data-stu-id="f3780-158">Default: two minutes.</span></span>

> [!NOTE]
> <span data-ttu-id="f3780-159">Amikor hello jelentések vannak kötegelni, hello fabric-ügyfélnek kell életben tartania az legalább hello HealthReportSendInterval tooensure, amely elküldi őket.</span><span class="sxs-lookup"><span data-stu-id="f3780-159">When hello reports are batched, hello fabric client must be kept alive for at least hello HealthReportSendInterval tooensure that they are sent.</span></span> <span data-ttu-id="f3780-160">Ha üdvözlőüzenetére elvész, vagy hello a health Store adatbázisban nem vihetők át őket tootransient hibák miatt, hello fabric-ügyfélnek kell tartani életben hosszabb toogive azt egy alkalommal tooretry.</span><span class="sxs-lookup"><span data-stu-id="f3780-160">If hello message is lost or hello health store cannot apply them due tootransient errors, hello fabric client must be kept alive longer toogive it a chance tooretry.</span></span>
> 
> 

<span data-ttu-id="f3780-161">hello pufferelés hello ügyfélen hello egyediségi hello jelentések figyelembe vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="f3780-161">hello buffering on hello client takes hello uniqueness of hello reports into consideration.</span></span> <span data-ttu-id="f3780-162">Például ha egy adott rossz jelentéskészítői az jelentéskészítési 100 jelentések / másodperc hello azonos hello tulajdonságának ugyanaz az entitás, hello jelentések cserélése hello legfrissebb verziója.</span><span class="sxs-lookup"><span data-stu-id="f3780-162">For example, if a particular bad reporter is reporting 100 reports per second on hello same property of hello same entity, hello reports are replaced with hello last version.</span></span> <span data-ttu-id="f3780-163">Legfeljebb egy ilyen jelentés hello ügyfél várólista létezik.</span><span class="sxs-lookup"><span data-stu-id="f3780-163">At most one such report exists in hello client queue.</span></span> <span data-ttu-id="f3780-164">Ha kötegelés van konfigurálva, hello számos olyan jelentést küldeni toohello a health Store adatbázisban csak egy küldési időszakonként.</span><span class="sxs-lookup"><span data-stu-id="f3780-164">If batching is configured, hello number of reports sent toohello health store is just one per send interval.</span></span> <span data-ttu-id="f3780-165">Ez a jelentés hello utolsó hozzáadott jelentést, amely tükrözi a legfrissebb állapotba hello hello entitás.</span><span class="sxs-lookup"><span data-stu-id="f3780-165">This report is hello last added report, which reflects hello most current state of hello entity.</span></span>
<span data-ttu-id="f3780-166">Adja meg a konfigurációs paraméterek amikor `FabricClient` jön létre úgy, hogy [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) hello a kívánt állapotát befolyásoló tételek értékeit.</span><span class="sxs-lookup"><span data-stu-id="f3780-166">Specify configuration parameters when `FabricClient` is created by passing [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) with hello desired values for health-related entries.</span></span>

<span data-ttu-id="f3780-167">hello alábbi példa létrehoz egy fabric-ügyfélnek, és meghatározza, hogy hello jelentéseket küldhetnek-e, amikor hozzáadja őket.</span><span class="sxs-lookup"><span data-stu-id="f3780-167">hello following example creates a fabric client and specifies that hello reports should be sent when they are added.</span></span> <span data-ttu-id="f3780-168">Időtúllépések és követően újra megkísérelhető a hibákról újrapróbálkozások 40 másodpercenként kerül sor.</span><span class="sxs-lookup"><span data-stu-id="f3780-168">On timeouts and errors that can be retried, retries happen every 40 seconds.</span></span>

```csharp
var clientSettings = new FabricClientSettings()
{
    HealthOperationTimeout = TimeSpan.FromSeconds(120),
    HealthReportSendInterval = TimeSpan.FromSeconds(0),
    HealthReportRetrySendInterval = TimeSpan.FromSeconds(40),
};
var fabricClient = new FabricClient(clientSettings);
```

<span data-ttu-id="f3780-169">Azt javasoljuk, hogy hello alapértelmezett fabric ügyfélbeállítások, amelyek `HealthReportSendInterval` too30 másodperc.</span><span class="sxs-lookup"><span data-stu-id="f3780-169">We recommend keeping hello default fabric client settings, which set `HealthReportSendInterval` too30 seconds.</span></span> <span data-ttu-id="f3780-170">Ez a beállítás biztosítja az optimális teljesítmény esedékes toobatching.</span><span class="sxs-lookup"><span data-stu-id="f3780-170">This setting ensures optimal performance due toobatching.</span></span> <span data-ttu-id="f3780-171">A kritikus jelentések, amelyek a lehető leghamarabb el kell küldeni, használjon `HealthReportSendOptions` az Immediate `true` a [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span><span class="sxs-lookup"><span data-stu-id="f3780-171">For critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true` in [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span></span> <span data-ttu-id="f3780-172">Azonnali jelentések időköz kötegelés hello kihagyása.</span><span class="sxs-lookup"><span data-stu-id="f3780-172">Immediate reports bypass hello batching interval.</span></span> <span data-ttu-id="f3780-173">Ez a jelző körültekintően; használja azt szeretnénk, hogy a kötegelés, amikor csak lehetséges hello állapotfigyelő ügyfél tootake előnyeit.</span><span class="sxs-lookup"><span data-stu-id="f3780-173">Use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span> <span data-ttu-id="f3780-174">Azonnali küldés akkor hasznos, ha bezárja a hello háló ügyfél (például hello folyamat állapota érvénytelen megállapítása és tooshut tooprevent hatásai le kell).</span><span class="sxs-lookup"><span data-stu-id="f3780-174">Immediate send is also useful when hello fabric client is closing (for example, hello process has determined invalid state and needs tooshut down tooprevent side effects).</span></span> <span data-ttu-id="f3780-175">Biztosítja a legjobb küldési halmozott hello jelentések.</span><span class="sxs-lookup"><span data-stu-id="f3780-175">It ensures a best-effort send of hello accumulated reports.</span></span> <span data-ttu-id="f3780-176">Egy jelentés azonnali jelzővel felvételekor hello állapotfigyelő ügyfél kötegek hello összegzi a rendszer minden jelentést utolsó küldési óta.</span><span class="sxs-lookup"><span data-stu-id="f3780-176">When one report is added with Immediate flag, hello health client batches all hello accumulated reports since last send.</span></span>

<span data-ttu-id="f3780-177">Paramétereket a PowerShell segítségével egy kapcsolat tooa fürt létrehozásakor adható meg.</span><span class="sxs-lookup"><span data-stu-id="f3780-177">Same parameters can be specified when a connection tooa cluster is created through PowerShell.</span></span> <span data-ttu-id="f3780-178">a következő példa hello elindul egy kapcsolat tooa helyi fürt:</span><span class="sxs-lookup"><span data-stu-id="f3780-178">hello following example starts a connection tooa local cluster:</span></span>

```powershell
PS C:\> Connect-ServiceFabricCluster -HealthOperationTimeoutInSec 120 -HealthReportSendIntervalInSec 0 -HealthReportRetrySendIntervalInSec 40
True

ConnectionEndpoint   :
FabricClientSettings : {
                       ClientFriendlyName                   : PowerShell-1944858a-4c6d-465f-89c7-9021c12ac0bb
                       PartitionLocationCacheLimit          : 100000
                       PartitionLocationCacheBucketCount    : 1024
                       ServiceChangePollInterval            : 00:02:00
                       ConnectionInitializationTimeout      : 00:00:02
                       KeepAliveInterval                    : 00:00:20
                       HealthOperationTimeout               : 00:02:00
                       HealthReportSendInterval             : 00:00:00
                       HealthReportRetrySendInterval        : 00:00:40
                       NotificationGatewayConnectionTimeout : 00:00:00
                       NotificationCacheUpdateTimeout       : 00:00:00
                       }
GatewayInformation   : {
                       NodeAddress                          : localhost:19000
                       NodeId                               : 1880ec88a3187766a6da323399721f53
                       NodeInstanceId                       : 130729063464981219
                       NodeName                             : Node.1
                       }
```

<span data-ttu-id="f3780-179">Hasonlóképpen tooAPI, jelentések is küld a `-Immediate` küldött azonnal, függetlenül attól, hello toobe kapcsoló `HealthReportSendInterval` érték.</span><span class="sxs-lookup"><span data-stu-id="f3780-179">Similarly tooAPI, reports can be sent using `-Immediate` switch toobe sent immediately, regardless of hello `HealthReportSendInterval` value.</span></span>

<span data-ttu-id="f3780-180">A többi hello jelentések küldése toohello Service Fabric átjárón, amely rendelkezik egy belső fabric-ügyfélnek.</span><span class="sxs-lookup"><span data-stu-id="f3780-180">For REST, hello reports are sent toohello Service Fabric gateway, which has an internal fabric client.</span></span> <span data-ttu-id="f3780-181">Alapértelmezés szerint ez az ügyfél 30 másodpercenként kötegelni konfigurált toosend jelentések.</span><span class="sxs-lookup"><span data-stu-id="f3780-181">By default, this client is configured toosend reports batched every 30 seconds.</span></span> <span data-ttu-id="f3780-182">Hello időköze módosítható hello fürt konfigurációs beállítással `HttpGatewayHealthReportSendInterval` a `HttpGateway`.</span><span class="sxs-lookup"><span data-stu-id="f3780-182">You can change hello batch interval with hello cluster configuration setting `HttpGatewayHealthReportSendInterval` on `HttpGateway`.</span></span> <span data-ttu-id="f3780-183">Ahogy azt korábban említettük, a jobb megoldás toosend hello jelentéseket `Immediate` igaz.</span><span class="sxs-lookup"><span data-stu-id="f3780-183">As mentioned, a better option is toosend hello reports with `Immediate` true.</span></span> 

> [!NOTE]
> <span data-ttu-id="f3780-184">amely nem engedélyezett szolgáltatások tooensure nem tud jelenteni állapotfigyelő elleni hello entitások hello fürtben, konfigurálja a hello server tooaccept csak a biztonságos ügyfelektől érkező kéréseket.</span><span class="sxs-lookup"><span data-stu-id="f3780-184">tooensure that unauthorized services can't report health against hello entities in hello cluster, configure hello server tooaccept requests only from secured clients.</span></span> <span data-ttu-id="f3780-185">Hello `FabricClient` jelentéskészítési engedélyezve vannak az biztonsági toobe képes toocommunicate hello fürttel (például a Kerberos- vagy Tanúsítványalapú hitelesítés).</span><span class="sxs-lookup"><span data-stu-id="f3780-185">hello `FabricClient` used for reporting must have security enabled toobe able toocommunicate with hello cluster (for example, with Kerberos or certificate authentication).</span></span> <span data-ttu-id="f3780-186">Tudjon meg többet az [fürt biztonsági](service-fabric-cluster-security.md).</span><span class="sxs-lookup"><span data-stu-id="f3780-186">Read more about [cluster security](service-fabric-cluster-security.md).</span></span>
> 
> 

## <a name="report-from-within-low-privilege-services"></a><span data-ttu-id="f3780-187">Jelentés az alacsony jogosultságú szolgáltatások belül</span><span class="sxs-lookup"><span data-stu-id="f3780-187">Report from within low privilege services</span></span>
<span data-ttu-id="f3780-188">Service Fabric-szolgáltatás nem rendelkezik rendszergazdai hozzáférési toohello fürt, ha az aktuális környezetből hello keresztül entitásokra állapotfigyelő jelentést `Partition` vagy `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="f3780-188">If Service Fabric services do not have admin access toohello cluster, you can report health on entities from hello current context through `Partition` or `CodePackageActivationContext`.</span></span>

* <span data-ttu-id="f3780-189">Az állapotmentes szolgáltatásokhoz használja [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport hello aktuális szolgáltatáspéldányt a.</span><span class="sxs-lookup"><span data-stu-id="f3780-189">For stateless services, use [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport on hello current service instance.</span></span>
* <span data-ttu-id="f3780-190">Állapotalapú szolgáltatások esetén használjon [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport aktuális replikán.</span><span class="sxs-lookup"><span data-stu-id="f3780-190">For stateful services, use [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport on current replica.</span></span>
* <span data-ttu-id="f3780-191">Használjon [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport hello aktuális partíció entitás.</span><span class="sxs-lookup"><span data-stu-id="f3780-191">Use [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport on hello current partition entity.</span></span>
* <span data-ttu-id="f3780-192">Használjon [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport aktuális alkalmazásban.</span><span class="sxs-lookup"><span data-stu-id="f3780-192">Use [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport on current application.</span></span>
* <span data-ttu-id="f3780-193">Használjon [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport hello hello az aktuális csomóponton telepített aktuális alkalmazásban.</span><span class="sxs-lookup"><span data-stu-id="f3780-193">Use [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport on hello current application deployed on hello current node.</span></span>
* <span data-ttu-id="f3780-194">Használjon [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport egy szolgáltatás csomag hello alkalmazás telepített hello az aktuális csomóponton.</span><span class="sxs-lookup"><span data-stu-id="f3780-194">Use [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport on a service package for hello application deployed on hello current node.</span></span>

> [!NOTE]
> <span data-ttu-id="f3780-195">Belsőleg, hello `Partition` és hello `CodePackageActivationContext` állapotát az ügyfél alapértelmezett beállításokkal rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="f3780-195">Internally, hello `Partition` and hello `CodePackageActivationContext` hold a health client configured with default settings.</span></span> <span data-ttu-id="f3780-196">Ahogy a hello [állapotfigyelő ügyfél](service-fabric-report-health.md#health-client), jelentések vannak és időzítő küldi.</span><span class="sxs-lookup"><span data-stu-id="f3780-196">As explained for hello [health client](service-fabric-report-health.md#health-client), reports are batched and sent on a timer.</span></span> <span data-ttu-id="f3780-197">hello objektumok kell tartani életben toohave alkalommal toosend hello jelentést.</span><span class="sxs-lookup"><span data-stu-id="f3780-197">hello objects should be kept alive toohave a chance toosend hello report.</span></span>
> 
> 

<span data-ttu-id="f3780-198">Megadhat `HealthReportSendOptions` keresztül jelentések küldéséhez `Partition` és `CodePackageActivationContext` rendszerállapot API-k.</span><span class="sxs-lookup"><span data-stu-id="f3780-198">You can specify `HealthReportSendOptions` when sending reports through `Partition` and `CodePackageActivationContext` health APIs.</span></span> <span data-ttu-id="f3780-199">Ha kritikus jelentések, amelyek a lehető leghamarabb el kell küldeni, használja `HealthReportSendOptions` az Immediate `true`.</span><span class="sxs-lookup"><span data-stu-id="f3780-199">If you have critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true`.</span></span> <span data-ttu-id="f3780-200">Azonnali jelentések hello belső rendszerállapot ügyfél-ek intervallumának kötegelés hello kihagyása.</span><span class="sxs-lookup"><span data-stu-id="f3780-200">Immediate reports bypass hello batching interval of hello internal health client.</span></span> <span data-ttu-id="f3780-201">Ahogy korábban említettük, körültekintően; használja ezt a jelzőt azt szeretnénk, hogy a kötegelés, amikor csak lehetséges hello állapotfigyelő ügyfél tootake előnyeit.</span><span class="sxs-lookup"><span data-stu-id="f3780-201">As mentioned before, use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span>

## <a name="design-health-reporting"></a><span data-ttu-id="f3780-202">Állapotfigyelő jelentéskészítés tervezése</span><span class="sxs-lookup"><span data-stu-id="f3780-202">Design health reporting</span></span>
<span data-ttu-id="f3780-203">hello kiváló minőségű jelentések létrehozásának első lépéseként azonosítja hello feltételek, amelyek befolyásolják hello hello szolgáltatásának állapotát.</span><span class="sxs-lookup"><span data-stu-id="f3780-203">hello first step in generating high-quality reports is identifying hello conditions that can impact hello health of hello service.</span></span> <span data-ttu-id="f3780-204">Minden feltétel, amely segíthet a hello szolgáltatást vagy a fürt jelző problémák--és még jobban előtt történik, a probléma – is potenciálisan dolláros egy mentés.</span><span class="sxs-lookup"><span data-stu-id="f3780-204">Any condition that can help flag problems in hello service or cluster when it starts--or even better, before a problem happens--can potentially save billions of dollars.</span></span> <span data-ttu-id="f3780-205">hello előnyöket nyújtja kisebb állásidő, kevesebb éjszakai töltött vizsgálja, és problémákat, és magasabb szintű ügyfelek elégedettségének javítása.</span><span class="sxs-lookup"><span data-stu-id="f3780-205">hello benefits include less down time, fewer night hours spent investigating and repairing issues, and higher customer satisfaction.</span></span>

<span data-ttu-id="f3780-206">Miután hello feltételeket azonosítja, a figyelő írók kell toofigure hello őket a terhelés és hasznosságát közötti elosztása legjobb módja toomonitor ki.</span><span class="sxs-lookup"><span data-stu-id="f3780-206">Once hello conditions are identified, watchdog writers need toofigure out hello best way toomonitor them for balance between overhead and usefulness.</span></span> <span data-ttu-id="f3780-207">Tegyük fel, amelyet összetett számítások bizonyos megosztott fájlokat használó szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="f3780-207">For example, consider a service that does complex calculations that use some temporary files on a share.</span></span> <span data-ttu-id="f3780-208">Egy figyelő figyelni hello megosztás tooensure elég hely áll rendelkezésre.</span><span class="sxs-lookup"><span data-stu-id="f3780-208">A watchdog could monitor hello share tooensure that enough space is available.</span></span> <span data-ttu-id="f3780-209">Azt tudta figyelni az értesítéseket a fájl vagy könyvtár változások.</span><span class="sxs-lookup"><span data-stu-id="f3780-209">It could listen for notifications of file or directory changes.</span></span> <span data-ttu-id="f3780-210">Az sikerült jelentést egy figyelmeztetés, ha egy társaságuk küszöbérték elérésekor, és hibaüzenetet jelenít meg, ha hello megosztás teljes.</span><span class="sxs-lookup"><span data-stu-id="f3780-210">It could report a warning if an upfront threshold is reached, and report an error if hello share is full.</span></span> <span data-ttu-id="f3780-211">A figyelmeztetést, a javítási rendszer elindítása volt, törölje a régebbi hello-megosztáson található fájlok.</span><span class="sxs-lookup"><span data-stu-id="f3780-211">On a warning, a repair system could start cleaning up older files on hello share.</span></span> <span data-ttu-id="f3780-212">Hiba a javítási rendszer hello szolgáltatás replika tooanother csomópont sikerült áthelyezni.</span><span class="sxs-lookup"><span data-stu-id="f3780-212">On an error, a repair system could move hello service replica tooanother node.</span></span> <span data-ttu-id="f3780-213">Vegye figyelembe a módját ismerteti a hello feltétel állapotok állapotfigyelő tekintetében: hello hello feltételt tekinthető Kifogástalan (ok), vagy nem megfelelő (figyelmeztetés vagy hibaüzenet) állapotát.</span><span class="sxs-lookup"><span data-stu-id="f3780-213">Note how hello condition states are described in terms of health: hello state of hello condition that can be considered healthy (ok) or unhealthy (warning or error).</span></span>

<span data-ttu-id="f3780-214">Hello figyelési részletek van beállítva, ha egy figyelő írójának toofigure ki hogyan tooimplement hello figyelő.</span><span class="sxs-lookup"><span data-stu-id="f3780-214">Once hello monitoring details are set, a watchdog writer needs toofigure out how tooimplement hello watchdog.</span></span> <span data-ttu-id="f3780-215">Hello feltételek hello szolgáltatáson belül lehet határozni, ha a hello figyelő figyelt hello szolgáltatás része lehet.</span><span class="sxs-lookup"><span data-stu-id="f3780-215">If hello conditions can be determined from within hello service, hello watchdog can be part of hello monitored service itself.</span></span> <span data-ttu-id="f3780-216">Például hello szolgáltatás kódot ellenőrizze hello megosztás használatát, és jelentést készít a minden alkalommal, amikor egy fájl toowrite megkísérli.</span><span class="sxs-lookup"><span data-stu-id="f3780-216">For example, hello service code can check hello share usage, and then report every time it tries toowrite a file.</span></span> <span data-ttu-id="f3780-217">hello ezt a módszert előnye, hogy a reporting felettébb egyszerű.</span><span class="sxs-lookup"><span data-stu-id="f3780-217">hello advantage of this approach is that reporting is simple.</span></span> <span data-ttu-id="f3780-218">Gondot kell fordítani a tooprevent figyelő hibák a hello szolgáltatást érintő.</span><span class="sxs-lookup"><span data-stu-id="f3780-218">Care must be taken tooprevent watchdog bugs from impacting hello service functionality.</span></span>

<span data-ttu-id="f3780-219">Figyelt hello szolgáltatáson belül jelentések lehetőség nem mindig érhető el.</span><span class="sxs-lookup"><span data-stu-id="f3780-219">Reporting from within hello monitored service is not always an option.</span></span> <span data-ttu-id="f3780-220">Egy figyelő hello szolgáltatáson belül nem lehet képes toodetect hello feltételeket.</span><span class="sxs-lookup"><span data-stu-id="f3780-220">A watchdog within hello service may not be able toodetect hello conditions.</span></span> <span data-ttu-id="f3780-221">Még nem rendelkezik hello logika és adatok toomake hello meghatározása.</span><span class="sxs-lookup"><span data-stu-id="f3780-221">It may not have hello logic or data toomake hello determination.</span></span> <span data-ttu-id="f3780-222">hello terhek hello feltételek figyelési magas lehet.</span><span class="sxs-lookup"><span data-stu-id="f3780-222">hello overhead of monitoring hello conditions may be high.</span></span> <span data-ttu-id="f3780-223">hello feltételek is előfordulhat, hogy nem adott tooa szolgáltatást, de ehelyett a szolgáltatások közötti párbeszéd hatással.</span><span class="sxs-lookup"><span data-stu-id="f3780-223">hello conditions also may not be specific tooa service, but instead affect interactions between services.</span></span> <span data-ttu-id="f3780-224">Másik lehetőség is toohave watchdogs hello fürt különálló folyamatként.</span><span class="sxs-lookup"><span data-stu-id="f3780-224">Another option is toohave watchdogs in hello cluster as separate processes.</span></span> <span data-ttu-id="f3780-225">hello watchdogs figyelése hello feltételek és a jelentés, az nem befolyásolja a hello fő szolgáltatások bármely olyan módon.</span><span class="sxs-lookup"><span data-stu-id="f3780-225">hello watchdogs monitor hello conditions and report, without affecting hello main services in any way.</span></span> <span data-ttu-id="f3780-226">Például ezek watchdogs sikerült implementálható hello állapotmentes szolgáltatások telepítve vannak minden csomópont vagy hello ugyanazon alkalmazás ugyanazon csomópontok hello szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="f3780-226">For example, these watchdogs could be implemented as stateless services in hello same application, deployed on all nodes or on hello same nodes as hello service.</span></span>

<span data-ttu-id="f3780-227">Bizonyos esetekben egy figyelő hello fürtben futó lehetőség nem érhető el vagy.</span><span class="sxs-lookup"><span data-stu-id="f3780-227">Sometimes, a watchdog running in hello cluster is not an option either.</span></span> <span data-ttu-id="f3780-228">Figyelt hello feltétele hello rendelkezésre állás vagy a hello szolgáltatás funkcióit, a felhasználók látni, esetén ajánlott toohave hello watchdogs hello hello felhasználói ügyfelek azonos helyen található.</span><span class="sxs-lookup"><span data-stu-id="f3780-228">If hello monitored condition is hello availability or functionality of hello service as users see it, it's best toohave hello watchdogs in hello same place as hello user clients.</span></span> <span data-ttu-id="f3780-229">Nincs, akkor tesztelheti hello műveletek a hello azonos módon felhasználók keresheti őket.</span><span class="sxs-lookup"><span data-stu-id="f3780-229">There, they can test hello operations in hello same way users call them.</span></span> <span data-ttu-id="f3780-230">Lehet például egy figyelő hello fürtön kívüli él, problémák kérelmek toohello szolgáltatás, amely hello késést és hello eredményének helyességét ellenőrzi.</span><span class="sxs-lookup"><span data-stu-id="f3780-230">For example, you can have a watchdog that lives outside hello cluster, issues requests toohello service, and checks hello latency and correctness of hello result.</span></span> <span data-ttu-id="f3780-231">(A Számológép szolgáltatáshoz, például nem 2 + 2 vissza 4 elfogadható időn belül?)</span><span class="sxs-lookup"><span data-stu-id="f3780-231">(For a calculator service, for example, does 2+2 return 4 in a reasonable amount of time?)</span></span>

<span data-ttu-id="f3780-232">Miután hello figyelő részletek véglegesítése megtörtént, meg kell határoznia egy adatforrás azonosítója, amely egyedileg azonosítja a.</span><span class="sxs-lookup"><span data-stu-id="f3780-232">Once hello watchdog details have been finalized, you should decide on a source ID that uniquely identifies it.</span></span> <span data-ttu-id="f3780-233">Az azonos típusú élő hello több watchdogs hello fürt, ha azok kell különböző entitások jelentést, vagy, ha azok jelentést hello azonos entitás, használjon különböző adatforrás-azonosítója vagy tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="f3780-233">If multiple watchdogs of hello same type are living in hello cluster, they must report on different entities, or, if they report on hello same entity, use different source ID or property.</span></span> <span data-ttu-id="f3780-234">Ezzel a módszerrel a jelentések egyszerre is használható.</span><span class="sxs-lookup"><span data-stu-id="f3780-234">This way, their reports can coexist.</span></span> <span data-ttu-id="f3780-235">hello tulajdonsága hello állapotjelentése figyelendő hello feltétel kell rögzíti.</span><span class="sxs-lookup"><span data-stu-id="f3780-235">hello property of hello health report should capture hello monitored condition.</span></span> <span data-ttu-id="f3780-236">(Például hello fenti hello tulajdonság lehet **ShareSize**.) Ha több jelentések toohello alkalmazza ugyanazt a feltétel, hello tulajdonság néhány dinamikus információkkal rendelkezhetnek, amely lehetővé teszi a jelentések toocoexist kell tartalmaznia.</span><span class="sxs-lookup"><span data-stu-id="f3780-236">(For hello example above, hello property could be **ShareSize**.) If multiple reports apply toohello same condition, hello property should contain some dynamic information that allows reports toocoexist.</span></span> <span data-ttu-id="f3780-237">Például, ha több megosztás toobe figyelni kell, hello tulajdonság neve lehet **ShareSize-megosztásnév**.</span><span class="sxs-lookup"><span data-stu-id="f3780-237">For example, if multiple shares need toobe monitored, hello property name can be **ShareSize-sharename**.</span></span>

> [!NOTE]
> <span data-ttu-id="f3780-238">Tegye *nem* hello tároló tookeep állapotadatainak használja.</span><span class="sxs-lookup"><span data-stu-id="f3780-238">Do *not* use hello health store tookeep status information.</span></span> <span data-ttu-id="f3780-239">Csak a rendszerállapot-kapcsolatos információkkal kell jelentett állapotát, az információ hatások hello állapotfigyelő értékelése entitás.</span><span class="sxs-lookup"><span data-stu-id="f3780-239">Only health-related information should be reported as health, as this information impacts hello health evaluation of an entity.</span></span> <span data-ttu-id="f3780-240">hello a health Store adatbázisban nem egy általános célú tárolóként úgy lett kialakítva.</span><span class="sxs-lookup"><span data-stu-id="f3780-240">hello health store was not designed as a general-purpose store.</span></span> <span data-ttu-id="f3780-241">Használja állapota kiértékelési logika tooaggregate minden adat hello állapotfigyelő állapotba kerülnek.</span><span class="sxs-lookup"><span data-stu-id="f3780-241">It uses health evaluation logic tooaggregate all data into hello health state.</span></span> <span data-ttu-id="f3780-242">Küldő adatokat (például a jelentéskészítési OK állapotot az állapot) független toohealth nem befolyásolja a hello összesített állapotát, de ronthatják hello a health Store adatbázisban hello teljesítményét.</span><span class="sxs-lookup"><span data-stu-id="f3780-242">Sending information unrelated toohealth (like reporting status with a health state of OK) doesn't impact hello aggregated health state, but it can negatively affect hello performance of hello health store.</span></span>
> 
> 

<span data-ttu-id="f3780-243">hello következő döntési tényező mely entitás tooreport kapcsolva.</span><span class="sxs-lookup"><span data-stu-id="f3780-243">hello next decision point is which entity tooreport on.</span></span> <span data-ttu-id="f3780-244">Legtöbbször ennek hello hello feltétel egyértelműen idetifies hello entitás.</span><span class="sxs-lookup"><span data-stu-id="f3780-244">Most of hello time, hello condition clearly idetifies hello entity.</span></span> <span data-ttu-id="f3780-245">Válassza ki a hello entitás legjobb lehetséges lépésköz.</span><span class="sxs-lookup"><span data-stu-id="f3780-245">Choose hello entity with best possible granularity.</span></span> <span data-ttu-id="f3780-246">Ha egy feltétel hatással van egy partíció összes replika, hello partíció nem hello szolgáltatást a jelentést.</span><span class="sxs-lookup"><span data-stu-id="f3780-246">If a condition impacts all replicas in a partition, report on hello partition, not on hello service.</span></span> <span data-ttu-id="f3780-247">Ha további gondolat van szükség, azonban esetekben van.</span><span class="sxs-lookup"><span data-stu-id="f3780-247">There are corner cases where more thought is needed, though.</span></span> <span data-ttu-id="f3780-248">Ha hello feltétel hatással van egy entitás, például egy replikát, de hello desire toohave hello feltétel meg van jelölve a replika élettartama hello időtartama meghaladja majd hello partíción kell megadni.</span><span class="sxs-lookup"><span data-stu-id="f3780-248">If hello condition impacts an entity, such as a replica, but hello desire is toohave hello condition flagged for more than hello duration of replica life, then it should be reported on hello partition.</span></span> <span data-ttu-id="f3780-249">Ellenkező esetben hello replika törlésekor hello a health Store adatbázisban a szükségtelenné vált a jelentéseket.</span><span class="sxs-lookup"><span data-stu-id="f3780-249">Otherwise, when hello replica is deleted, hello health store cleans up all its reports.</span></span> <span data-ttu-id="f3780-250">Figyelő írók hello élettartama hello entitás és hello jelentés kell gondolni.</span><span class="sxs-lookup"><span data-stu-id="f3780-250">Watchdog writers must think about hello lifetimes of hello entity and hello report.</span></span> <span data-ttu-id="f3780-251">Törölje a jelet kell, amikor egy jelentés tisztítani kell a tárolóból (például ha már nem érvényes egy entitás jelentett hiba).</span><span class="sxs-lookup"><span data-stu-id="f3780-251">It must be clear when a report should be cleaned up from a store (for example, when an error reported on an entity no longer applies).</span></span>

<span data-ttu-id="f3780-252">Egy példa, amely az együtt I leírt hello pontok vizsgáljuk meg.</span><span class="sxs-lookup"><span data-stu-id="f3780-252">Let's look at an example that puts together hello points I described.</span></span> <span data-ttu-id="f3780-253">Vegye figyelembe, hogy a Service Fabric-alkalmazás fő állapot-nyilvántartó állandó szolgáltatás és a másodlagos állapotmentes szolgáltatásokhoz (egy másodlagos szolgáltatás típusa az egyes feladatok) összes csomópontjára telepíti állnak.</span><span class="sxs-lookup"><span data-stu-id="f3780-253">Consider a Service Fabric application composed of a master stateful persistent service and secondary stateless services deployed on all nodes (one secondary service type for each type of task).</span></span> <span data-ttu-id="f3780-254">hello fő van parancsok toobe hajtja végre a másodlagos adatbázist tartalmazó feldolgozási várólista.</span><span class="sxs-lookup"><span data-stu-id="f3780-254">hello master has a processing queue that contains commands toobe executed by secondaries.</span></span> <span data-ttu-id="f3780-255">hello másodlagos hello a bejövő kérelmeket, és hátsó nyugtázási jelek küldésére.</span><span class="sxs-lookup"><span data-stu-id="f3780-255">hello secondaries execute hello incoming requests and send back acknowledgement signals.</span></span> <span data-ttu-id="f3780-256">Egy olyan feltételt, amely ellenőrizhető hello hello feldolgozási várólistájának hossza.</span><span class="sxs-lookup"><span data-stu-id="f3780-256">One condition that could be monitored is hello length of hello master processing queue.</span></span> <span data-ttu-id="f3780-257">Ha hello fő várólista hossza eléri a, a rendszer figyelmeztetést igen.</span><span class="sxs-lookup"><span data-stu-id="f3780-257">If hello master queue length reaches a threshold, a warning is reported.</span></span> <span data-ttu-id="f3780-258">hello figyelmeztetés azt jelzi, hogy hello másodlagos adatbázis nem terhelhető hello.</span><span class="sxs-lookup"><span data-stu-id="f3780-258">hello warning indicates that hello secondaries can't handle hello load.</span></span> <span data-ttu-id="f3780-259">Ha parancsok eldobott hello várólista eléri maximális hossza hello, rendszer hibát jelez, mint hello szolgáltatást nem lehet helyreállítani.</span><span class="sxs-lookup"><span data-stu-id="f3780-259">If hello queue reaches hello maximum length and commands are dropped, an error is reported, as hello service can't recover.</span></span> <span data-ttu-id="f3780-260">hello jelentések lehet hello tulajdonság **QueueStatus**.</span><span class="sxs-lookup"><span data-stu-id="f3780-260">hello reports can be on hello property **QueueStatus**.</span></span> <span data-ttu-id="f3780-261">hello figyelő él belül hello szolgáltatást, majd hello fő elsődleges replikán rendszeresen továbbítja.</span><span class="sxs-lookup"><span data-stu-id="f3780-261">hello watchdog lives inside hello service, and it's sent periodically on hello master primary replica.</span></span> <span data-ttu-id="f3780-262">hello toolive ideje két percet, és rendszeres időközönként 30 másodpercenként továbbítja azokat.</span><span class="sxs-lookup"><span data-stu-id="f3780-262">hello time toolive is two minutes, and it's sent periodically every 30 seconds.</span></span> <span data-ttu-id="f3780-263">Ha elsődleges hello leáll, hello jelentés automatikusan törlődnek áruházból.</span><span class="sxs-lookup"><span data-stu-id="f3780-263">If hello primary goes down, hello report is cleaned up automatically from store.</span></span> <span data-ttu-id="f3780-264">Ha hello szolgáltatás replika működik-e, de van-e holtpontba vagy egyéb problémák történtek hello jelentés hello a health Store adatbázisban lejár.</span><span class="sxs-lookup"><span data-stu-id="f3780-264">If hello service replica is up, but it is deadlocked or having other issues, hello report expires in hello health store.</span></span> <span data-ttu-id="f3780-265">Ebben az esetben hello entitás: hiba ki lesz értékelve.</span><span class="sxs-lookup"><span data-stu-id="f3780-265">In this case, hello entity is evaluated at error.</span></span>

<span data-ttu-id="f3780-266">Egy másik figyelhető feltétele feladat végrehajtási ideje.</span><span class="sxs-lookup"><span data-stu-id="f3780-266">Another condition that can be monitored is task execution time.</span></span> <span data-ttu-id="f3780-267">hello fő osztja el a feladatok toohello másodlagos hello feladat típusától függően.</span><span class="sxs-lookup"><span data-stu-id="f3780-267">hello master distributes tasks toohello secondaries based on hello task type.</span></span> <span data-ttu-id="f3780-268">Attól függően, hogy hello tervezési hello fő sikerült kérdezze le hello másodlagos adatbázist, a feladatok állapotát.</span><span class="sxs-lookup"><span data-stu-id="f3780-268">Depending on hello design, hello master could poll hello secondaries for task status.</span></span> <span data-ttu-id="f3780-269">Az sikerült is, amíg a másodlagos adatbázisok toosend hátsó nyugtázási jelek azok szabásakor.</span><span class="sxs-lookup"><span data-stu-id="f3780-269">It could also wait for secondaries toosend back acknowledgement signals when they are done.</span></span> <span data-ttu-id="f3780-270">Hello második esetben gondot kell fordítani a toodetect olyan helyzetekben, ahol a másodlagos adatbázisok die vagy üzenetek elvesznek.</span><span class="sxs-lookup"><span data-stu-id="f3780-270">In hello second case, care must be taken toodetect situations where secondaries die or messages are lost.</span></span> <span data-ttu-id="f3780-271">Egy beállítás olyan hello fő toosend egy ping kérelem toohello azonos másodlagos, amely küld vissza az állapotát.</span><span class="sxs-lookup"><span data-stu-id="f3780-271">One option is for hello master toosend a ping request toohello same secondary, which sends back its status.</span></span> <span data-ttu-id="f3780-272">Ha nincs állapot érkezik, hello master tartja hibát, és reschedules hello feladat.</span><span class="sxs-lookup"><span data-stu-id="f3780-272">If no status is received, hello master considers it a failure and reschedules hello task.</span></span> <span data-ttu-id="f3780-273">Ez a viselkedés feltételezi, hogy az idempotent hello feladatok.</span><span class="sxs-lookup"><span data-stu-id="f3780-273">This behavior assumes that hello tasks are idempotent.</span></span>

<span data-ttu-id="f3780-274">figyelt hello feltétel fordítható Figyelmeztetés Ha hello feladatot nem végezheti el a bizonyos ideig (**t1**, például 10 perc).</span><span class="sxs-lookup"><span data-stu-id="f3780-274">hello monitored condition can be translated as a warning if hello task is not done in a certain time (**t1**, for example 10 minutes).</span></span> <span data-ttu-id="f3780-275">Ha hello feladat nem fejeződött be időben (**t2**, például 20 perc), figyelt hello feltétel fordítható – hiba.</span><span class="sxs-lookup"><span data-stu-id="f3780-275">If hello task is not completed in time (**t2**, for example 20 minutes), hello monitored condition can be translated as Error.</span></span> <span data-ttu-id="f3780-276">Ehhez a jelentéshez végezhető többféle módon:</span><span class="sxs-lookup"><span data-stu-id="f3780-276">This reporting can be done in multiple ways:</span></span>

* <span data-ttu-id="f3780-277">hello eredeti elsődleges replika jelentések maga rendszeres időközönként.</span><span class="sxs-lookup"><span data-stu-id="f3780-277">hello master primary replica reports on itself periodically.</span></span> <span data-ttu-id="f3780-278">Hello várólista akkor is az összes függő tevékenység egy tulajdonságot.</span><span class="sxs-lookup"><span data-stu-id="f3780-278">You can have one property for all pending tasks in hello queue.</span></span> <span data-ttu-id="f3780-279">Ha legalább egy feladat eljárás tovább tart, hello állapotjelentést hello tulajdonság **PendingTasks** figyelmeztető vagy hibaüzenet, szükség szerint van.</span><span class="sxs-lookup"><span data-stu-id="f3780-279">If at least one task takes longer, hello report status on hello property **PendingTasks** is a warning or error, as appropriate.</span></span> <span data-ttu-id="f3780-280">Ha nincs folyamatban lévő tevékenységek, vagy minden feladat végrehajtási, hello jelentés állapota OK gombra.</span><span class="sxs-lookup"><span data-stu-id="f3780-280">If there are no pending tasks or all tasks started execution, hello report status is OK.</span></span> <span data-ttu-id="f3780-281">hello feladatokat is állandó.</span><span class="sxs-lookup"><span data-stu-id="f3780-281">hello tasks are persistent.</span></span> <span data-ttu-id="f3780-282">Ha elsődleges hello nem működik, újonnan előléptetett hello elsődleges továbbra is tooreport megfelelően.</span><span class="sxs-lookup"><span data-stu-id="f3780-282">If hello primary goes down, hello newly promoted primary can continue tooreport properly.</span></span>
* <span data-ttu-id="f3780-283">(A felhő hello vagy külső) egy másik figyelő folyamat ellenőrzi hello feladatok (a kívül, alapján szükséges hello feladat eredményét) toosee Ha teljesítése.</span><span class="sxs-lookup"><span data-stu-id="f3780-283">Another watchdog process (in hello cloud or external) checks hello tasks (from outside, based on hello desired task result) toosee if they are completed.</span></span> <span data-ttu-id="f3780-284">Ha nem veszik figyelembe hello küszöbértékeket, hogy jelentést küld hello fő szolgáltatáson.</span><span class="sxs-lookup"><span data-stu-id="f3780-284">If they do not respect hello thresholds, a report is sent on hello master service.</span></span> <span data-ttu-id="f3780-285">A jelentés is lett van küldve, amely tartalmazza az hello feladatazonosítót a feladat, például minden tevékenység **PendingTask + taskId**.</span><span class="sxs-lookup"><span data-stu-id="f3780-285">A report is also sent on each task that includes hello task identifier, like **PendingTask+taskId**.</span></span> <span data-ttu-id="f3780-286">Jelentések csak nem kifogástalan állapotok kellene elküldeni.</span><span class="sxs-lookup"><span data-stu-id="f3780-286">Reports should be sent only on unhealthy states.</span></span> <span data-ttu-id="f3780-287">Állítsa idő toolive tooa néhány percet, majd hello jelentések toobe távolítja el, amikor a várósorban tooensure tisztítás megjelölni.</span><span class="sxs-lookup"><span data-stu-id="f3780-287">Set time toolive tooa few minutes, and mark hello reports toobe removed when they expire tooensure cleanup.</span></span>
* <span data-ttu-id="f3780-288">hello másodlagos, a feladat éppen futó jelentést, ha hosszabb ideig tart, mint a várt toorun azt.</span><span class="sxs-lookup"><span data-stu-id="f3780-288">hello secondary that is executing a task reports when it takes longer than expected toorun it.</span></span> <span data-ttu-id="f3780-289">Hello tulajdonság példányáról hello szolgáltatást jelenti **PendingTasks**.</span><span class="sxs-lookup"><span data-stu-id="f3780-289">It reports on hello service instance on hello property **PendingTasks**.</span></span> <span data-ttu-id="f3780-290">hello jelentés pinpoints problémákkal rendelkezik hello szolgáltatáspéldány, de nem rögzíti a ahol hello példány elhalálozik hello helyzet.</span><span class="sxs-lookup"><span data-stu-id="f3780-290">hello report pinpoints hello service instance that has issues, but it doesn't capture hello situation where hello instance dies.</span></span> <span data-ttu-id="f3780-291">hello jelentések majd megtisztítva.</span><span class="sxs-lookup"><span data-stu-id="f3780-291">hello reports are cleaned up then.</span></span> <span data-ttu-id="f3780-292">Az sikerült jelentés másodlagos hello szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="f3780-292">It could report on hello secondary service.</span></span> <span data-ttu-id="f3780-293">Ha másodlagos hello hello feladat befejeződött, hello másodlagos példány törlése hello jelentés hello áruházból.</span><span class="sxs-lookup"><span data-stu-id="f3780-293">If hello secondary completes hello task, hello secondary instance clears hello report from hello store.</span></span> <span data-ttu-id="f3780-294">hello jelentés nem rögzíti a hello helyzet, ahol nyugtázási üdvözlőüzenetére elvész, és a hello feladat nem fejeződött be a hello fő szempontjából.</span><span class="sxs-lookup"><span data-stu-id="f3780-294">hello report doesn't capture hello situation where hello acknowledgement message is lost and hello task is not finished from hello master's point of view.</span></span>

<span data-ttu-id="f3780-295">A fent leírt hello esetekben hello reporting történik, de alkalmazás állapotának rögzített hello jelentések vannak, állapotának kiértékelésekor.</span><span class="sxs-lookup"><span data-stu-id="f3780-295">However hello reporting is done in hello cases described above, hello reports are captured in application health when health is evaluated.</span></span>

## <a name="report-periodically-vs-on-transition"></a><span data-ttu-id="f3780-296">Jelentés rendszeres időközönként és átmenet</span><span class="sxs-lookup"><span data-stu-id="f3780-296">Report periodically vs. on transition</span></span>
<span data-ttu-id="f3780-297">Hello állapotfigyelő reporting modell használatával watchdogs küldhet jelentések rendszeres időközönként vagy átmenetek.</span><span class="sxs-lookup"><span data-stu-id="f3780-297">By using hello health reporting model, watchdogs can send reports periodically or on transitions.</span></span> <span data-ttu-id="f3780-298">hello ajánlott, hogy a figyelő reporting módja a rendszeres időközönként, mivel hello kód sokkal egyszerűbb, és kevesebb a hibalehetőség tooerrors.</span><span class="sxs-lookup"><span data-stu-id="f3780-298">hello recommended way for watchdog reporting is periodically, because hello code is much simpler and less prone tooerrors.</span></span> <span data-ttu-id="f3780-299">hello watchdogs kell törekedni toobe más dolga, mint lehetséges tooavoid hibák helytelen jelentések kiváltani.</span><span class="sxs-lookup"><span data-stu-id="f3780-299">hello watchdogs must strive toobe as simple as possible tooavoid bugs that trigger incorrect reports.</span></span> <span data-ttu-id="f3780-300">Helytelen *sérült* jelentések hatással lehet a rendszerállapot-értékelések és forgatókönyvek alapján állapota, beleértve a frissítéseket.</span><span class="sxs-lookup"><span data-stu-id="f3780-300">Incorrect *unhealthy* reports impact health evaluations and scenarios based on health, including upgrades.</span></span> <span data-ttu-id="f3780-301">Helytelen *kifogástalan* jelentések elrejtése problémák hello fürt, amely nem kívánatos.</span><span class="sxs-lookup"><span data-stu-id="f3780-301">Incorrect *healthy* reports hide issues in hello cluster, which is not desired.</span></span>

<span data-ttu-id="f3780-302">A rendszeres jelentési hello figyelő egy időzítővel valósítható meg.</span><span class="sxs-lookup"><span data-stu-id="f3780-302">For periodic reporting, hello watchdog can be implemented with a timer.</span></span> <span data-ttu-id="f3780-303">Egy időzítő visszahíváskor hello figyelő hello állapota, és küldjön jelentést a hello aktuális állapotán alapuló korlátozásához.</span><span class="sxs-lookup"><span data-stu-id="f3780-303">On a timer callback, hello watchdog can check hello state and send a report based on hello current state.</span></span> <span data-ttu-id="f3780-304">Nincs szükség toosee mely jelentés korábban lett elküldve, vagy bármely optimalizálás szempontjából üzenetküldési ellenőrizze van.</span><span class="sxs-lookup"><span data-stu-id="f3780-304">There is no need toosee which report was sent previously or make any optimizations in terms of messaging.</span></span> <span data-ttu-id="f3780-305">hello állapotfigyelő ügyfél rendelkezik kötegelés logika toohelp teljesítménnyel.</span><span class="sxs-lookup"><span data-stu-id="f3780-305">hello health client has batching logic toohelp with performance.</span></span> <span data-ttu-id="f3780-306">Hello állapotfigyelő ügyfél aktív marad, amíg újbóli belső hello jelentés elfogadja hello a health Store adatbázisban vagy hello figyelő hello az újabb jelentést hoz létre ugyanazon entitás, property és forrás.</span><span class="sxs-lookup"><span data-stu-id="f3780-306">While hello health client is kept alive, it retries internally until hello report is acknowledged by hello health store or hello watchdog generates a newer report with hello same entity, property, and source.</span></span>

<span data-ttu-id="f3780-307">A átmenetek jelentéskészítéshez gondos kezelésére vonatkozó állapotát.</span><span class="sxs-lookup"><span data-stu-id="f3780-307">Reporting on transitions requires careful handling of state.</span></span> <span data-ttu-id="f3780-308">hello figyelő bizonyos feltételek figyeli, és csak akkor, ha hello feltételek módosítása jelenti.</span><span class="sxs-lookup"><span data-stu-id="f3780-308">hello watchdog monitors some conditions and reports only when hello conditions change.</span></span> <span data-ttu-id="f3780-309">Ez a megközelítés fejjel hello, hogy kevesebb jelentések van szükség.</span><span class="sxs-lookup"><span data-stu-id="f3780-309">hello upside of this approach is that fewer reports are needed.</span></span> <span data-ttu-id="f3780-310">hello hátránya az, hogy hello figyelő hello logikája összetett.</span><span class="sxs-lookup"><span data-stu-id="f3780-310">hello downside is that hello logic of hello watchdog is complex.</span></span> <span data-ttu-id="f3780-311">hello figyelő kezelnie kell hello feltételek vagy hello jelentéseket, hogy ellenőrzött toodetermine állapotváltozások el.</span><span class="sxs-lookup"><span data-stu-id="f3780-311">hello watchdog must maintain hello conditions or hello reports, so that they can be inspected toodetermine state changes.</span></span> <span data-ttu-id="f3780-312">Feladatátvétel esetén ügyelni kell a jelentések hozzá, de nem küldött toohello a health Store adatbázisban.</span><span class="sxs-lookup"><span data-stu-id="f3780-312">On failover, care must be taken with reports added, but not yet sent toohello health store.</span></span> <span data-ttu-id="f3780-313">hello sorszám egyre növekvő kell lennie.</span><span class="sxs-lookup"><span data-stu-id="f3780-313">hello sequence number must be ever-increasing.</span></span> <span data-ttu-id="f3780-314">Ha nem, hello jelentések szerint elavult utasítja el.</span><span class="sxs-lookup"><span data-stu-id="f3780-314">If not, hello reports are rejected as stale.</span></span> <span data-ttu-id="f3780-315">Hello bizonyos ritkán előforduló esetekben ahol adatvesztés van szükség a szinkronizálási hello jelentéskészítői hello állapotának és hello hello a health Store adatbázisban levő között lehet szükség.</span><span class="sxs-lookup"><span data-stu-id="f3780-315">In hello rare cases where data loss is incurred, synchronization may be needed between hello state of hello reporter and hello state of hello health store.</span></span>

<span data-ttu-id="f3780-316">Jelentés készítését átmenetek szabálykészletében keresztül, a reporting Services `Partition` vagy `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="f3780-316">Reporting on transitions makes sense for services reporting on themselves, through `Partition` or `CodePackageActivationContext`.</span></span> <span data-ttu-id="f3780-317">Ha a helyi objektum hello (replika vagy a telepített szervizcsomag / alkalmazást telepített) van eltávolítva, a jelentések is törlődnek.</span><span class="sxs-lookup"><span data-stu-id="f3780-317">When hello local object (replica or deployed service package / deployed application) is removed, all its reports are also removed.</span></span> <span data-ttu-id="f3780-318">Az automatikus tisztítás visszaállítja jelentéskészítői és a health Store adatbázisban közötti szinkronizálás hello szükségességét.</span><span class="sxs-lookup"><span data-stu-id="f3780-318">This automatic cleanup relaxes hello need for synchronization between reporter and health store.</span></span> <span data-ttu-id="f3780-319">Ha hello jelentés szülő alkalmazás vagy a szülőpartíció számára, ügyelni kell a feladatátvételi tooavoid elavult jelentésekben hello a health Store adatbázisban.</span><span class="sxs-lookup"><span data-stu-id="f3780-319">If hello report is for parent partition or parent application, care must be taken on failover tooavoid stale reports in hello health store.</span></span> <span data-ttu-id="f3780-320">Logikai hozzá kell adni toomaintain hello megfelelő állapotban, és törölje a jelet hello jelentés, ha már nincs szükség a.</span><span class="sxs-lookup"><span data-stu-id="f3780-320">Logic must be added toomaintain hello correct state and clear hello report from store when not needed anymore.</span></span>

## <a name="implement-health-reporting"></a><span data-ttu-id="f3780-321">Állapotfigyelő reporting megvalósítása</span><span class="sxs-lookup"><span data-stu-id="f3780-321">Implement health reporting</span></span>
<span data-ttu-id="f3780-322">Miután hello entitás és a jelentés adatainak törlése, rendszerállapot-jelentések küldése végezhető el hello API, a PowerShell vagy a többi.</span><span class="sxs-lookup"><span data-stu-id="f3780-322">Once hello entity and report details are clear, sending health reports can be done through hello API, PowerShell, or REST.</span></span>

### <a name="api"></a><span data-ttu-id="f3780-323">API</span><span class="sxs-lookup"><span data-stu-id="f3780-323">API</span></span>
<span data-ttu-id="f3780-324">tooreport hello API keresztül, toocreate állapotfigyelő jelentés adott toohello entitástípus azokat a kívánt tooreport kell.</span><span class="sxs-lookup"><span data-stu-id="f3780-324">tooreport through hello API, you need toocreate a health report specific toohello entity type they want tooreport on.</span></span> <span data-ttu-id="f3780-325">Hello jelentés tooa állapotfigyelő ügyfél biztosítják.</span><span class="sxs-lookup"><span data-stu-id="f3780-325">Give hello report tooa health client.</span></span> <span data-ttu-id="f3780-326">Alternatív megoldásként hozzon létre egy állapottal kapcsolatos adatok, és adja át a jelentéskészítési módszerrel toocorrect `Partition` vagy `CodePackageActivationContext` tooreport az aktuális entitásokra.</span><span class="sxs-lookup"><span data-stu-id="f3780-326">Alternatively, create a health information and pass it toocorrect reporting methods on `Partition` or `CodePackageActivationContext` tooreport on current entities.</span></span>

<span data-ttu-id="f3780-327">hello következő példa bemutatja, rendszeres hello fürtön belül a figyelő jelentést.</span><span class="sxs-lookup"><span data-stu-id="f3780-327">hello following example shows periodic reporting from a watchdog within hello cluster.</span></span> <span data-ttu-id="f3780-328">hello figyelő ellenőrzi, hogy egy külső forrásból elérhető csomóponton belül.</span><span class="sxs-lookup"><span data-stu-id="f3780-328">hello watchdog checks whether an external resource can be accessed from within a node.</span></span> <span data-ttu-id="f3780-329">a szolgáltatás jegyzék hello alkalmazáson belül hello erőforrás van szükség.</span><span class="sxs-lookup"><span data-stu-id="f3780-329">hello resource is needed by a service manifest within hello application.</span></span> <span data-ttu-id="f3780-330">Hello erőforrás nem érhető el, ha hello hello alkalmazáson belül más szolgáltatások is megfelelő működéséhez.</span><span class="sxs-lookup"><span data-stu-id="f3780-330">If hello resource is unavailable, hello other services within hello application can still function properly.</span></span> <span data-ttu-id="f3780-331">Ezért hello jelentés küldött telepített hello szolgáltatás csomag entitás 30 másodpercenként.</span><span class="sxs-lookup"><span data-stu-id="f3780-331">Therefore, hello report is sent on hello deployed service package entity every 30 seconds.</span></span>

```csharp
private static Uri ApplicationName = new Uri("fabric:/WordCount");
private static string ServiceManifestName = "WordCount.Service";
private static string NodeName = FabricRuntime.GetNodeContext().NodeName;
private static Timer ReportTimer = new Timer(new TimerCallback(SendReport), null, 30 * 1000, 30 * 1000);
private static FabricClient Client = new FabricClient(new FabricClientSettings() { HealthReportSendInterval = TimeSpan.FromSeconds(0) });

public static void SendReport(object obj)
{
    // Test whether hello resource can be accessed from hello node
    HealthState healthState = this.TestConnectivityToExternalResource();

    // Send report on deployed service package, as hello connectivity is needed by hello specific service manifest
    // and can be different on different nodes
    var deployedServicePackageHealthReport = new DeployedServicePackageHealthReport(
        ApplicationName,
        ServiceManifestName,
        NodeName,
        new HealthInformation("ExternalSourceWatcher", "Connectivity", healthState));

    // TODO: handle exception. Code omitted for snippet brevity.
    // Possible exceptions: FabricException with error codes
    // FabricHealthStaleReport (non-retryable, hello report is already queued on hello health client),
    // FabricHealthMaxReportsReached (retryable; user should retry with exponential delay until hello report is accepted).
    Client.HealthManager.ReportHealth(deployedServicePackageHealthReport);
}
```

### <a name="powershell"></a><span data-ttu-id="f3780-332">PowerShell</span><span class="sxs-lookup"><span data-stu-id="f3780-332">PowerShell</span></span>
<span data-ttu-id="f3780-333">A rendszerállapot-jelentések küldése  **küldési-ServiceFabric*EntityType*HealthReport **.</span><span class="sxs-lookup"><span data-stu-id="f3780-333">Send health reports with **Send-ServiceFabric*EntityType*HealthReport**.</span></span>

<span data-ttu-id="f3780-334">hello következő példa bemutatja, rendszeres jelentés készítését a csomópont CPU-értékek.</span><span class="sxs-lookup"><span data-stu-id="f3780-334">hello following example shows periodic reporting on CPU values on a node.</span></span> <span data-ttu-id="f3780-335">hello jelentéseket küldjön 30 másodpercenként, és egyszerre pedig két perc toolive rendelkeznek.</span><span class="sxs-lookup"><span data-stu-id="f3780-335">hello reports should be sent every 30 seconds, and they have a time toolive of two minutes.</span></span> <span data-ttu-id="f3780-336">Járnak, ha az hello jelentéskészítői rendelkezik, így hello csomópont ki lesz értékelve, hiba: problémákkal kapcsolatban.</span><span class="sxs-lookup"><span data-stu-id="f3780-336">If they expire, hello reporter has issues, so hello node is evaluated at error.</span></span> <span data-ttu-id="f3780-337">Ha hello CPU küszöbértéket, a hello jelentés rendelkezik figyelmeztetési állapotot.</span><span class="sxs-lookup"><span data-stu-id="f3780-337">When hello CPU is above a threshold, hello report has a health state of warning.</span></span> <span data-ttu-id="f3780-338">Hello CPU a küszöbérték felett marad, több mint hello beállított idő, amikor azt az elvártnak megfelelően hiba.</span><span class="sxs-lookup"><span data-stu-id="f3780-338">When hello CPU remains above a threshold for more than hello configured time, it's reported as an error.</span></span> <span data-ttu-id="f3780-339">Ellenkező esetben a hello jelentéskészítői OK állapotot küld.</span><span class="sxs-lookup"><span data-stu-id="f3780-339">Otherwise, hello reporter sends a health state of OK.</span></span>

```powershell
PS C:\> Send-ServiceFabricNodeHealthReport -NodeName Node.1 -HealthState Warning -SourceId PowershellWatcher -HealthProperty CPU -Description "CPU is above 80% threshold" -TimeToLiveSec 120

PS C:\> Get-ServiceFabricNodeHealth -NodeName Node.1
NodeName              : Node.1
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='CPU', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.FM
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 5
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Fabric node is up.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : CPU
                        HealthState           : Warning
                        SequenceNumber        : 130741236814913394
                        SentAt                : 4/21/2015 9:01:21 PM
                        ReceivedAt            : 4/21/2015 9:01:21 PM
                        TTL                   : 00:02:00
                        Description           : CPU is above 80% threshold
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:01:21 PM
```

<span data-ttu-id="f3780-340">hello alábbi példa hiányára átmeneti replikán.</span><span class="sxs-lookup"><span data-stu-id="f3780-340">hello following example reports a transient warning on a replica.</span></span> <span data-ttu-id="f3780-341">Először lekérdezi a hello Partícióazonosító, és ezután hello hello szolgáltatás iránt érdeklődik, másodpéldány-azonosító.</span><span class="sxs-lookup"><span data-stu-id="f3780-341">It first gets hello partition ID and then hello replica ID for hello service it is interested in.</span></span> <span data-ttu-id="f3780-342">Ezután elküldi a jelentést a **PowershellWatcher** hello tulajdonság **ResourceDependency**.</span><span class="sxs-lookup"><span data-stu-id="f3780-342">It then sends a report from **PowershellWatcher** on hello property **ResourceDependency**.</span></span> <span data-ttu-id="f3780-343">hello jelentés egyik fontos csak két percig, és el van távolítva hello tároló automatikusan.</span><span class="sxs-lookup"><span data-stu-id="f3780-343">hello report is of interest for only two minutes, and it is removed from hello store automatically.</span></span>

```powershell
PS C:\> $partitionId = (Get-ServiceFabricPartition -ServiceName fabric:/WordCount/WordCount.Service).PartitionId

PS C:\> $replicaId = (Get-ServiceFabricReplica -PartitionId $partitionId | where {$_.ReplicaRole -eq "Primary"}).ReplicaId

PS C:\> Send-ServiceFabricReplicaHealthReport -PartitionId $partitionId -ReplicaId $replicaId -HealthState Warning -SourceId PowershellWatcher -HealthProperty ResourceDependency -Description "hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes." -TimeToLiveSec 120 -RemoveWhenExpired

PS C:\> Get-ServiceFabricReplicaHealth  -PartitionId $partitionId -ReplicaOrInstanceId $replicaId


PartitionId           : 8f82daff-eb68-4fd9-b631-7a37629e08c0
ReplicaId             : 130740415594605869
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='ResourceDependency', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.RA
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 130740768777734943
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Replica has been created.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : ResourceDependency
                        HealthState           : Warning
                        SequenceNumber        : 130741243777723555
                        SentAt                : 4/21/2015 9:12:57 PM
                        ReceivedAt            : 4/21/2015 9:12:57 PM
                        TTL                   : 00:02:00
                        Description           : hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes.
                        RemoveWhenExpired     : True
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:12:32 PM
```

### <a name="rest"></a><span data-ttu-id="f3780-344">REST</span><span class="sxs-lookup"><span data-stu-id="f3780-344">REST</span></span>
<span data-ttu-id="f3780-345">Nyissa meg a szükséges toohello entitást, és hello törzs hello állapotfigyelő jelentés leírása a POST kérelmek használatával REST állapotjelentések küldése.</span><span class="sxs-lookup"><span data-stu-id="f3780-345">Send health reports using REST with POST requests that go toohello desired entity and have in hello body hello health report description.</span></span> <span data-ttu-id="f3780-346">Lásd például: hogyan REST-toosend [állapotjelentések fürt](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) vagy [állapotjelentések szolgáltatás](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span><span class="sxs-lookup"><span data-stu-id="f3780-346">For example, see how toosend REST [cluster health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) or [service health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span></span> <span data-ttu-id="f3780-347">Minden entitások támogatottak.</span><span class="sxs-lookup"><span data-stu-id="f3780-347">All entities are supported.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f3780-348">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="f3780-348">Next steps</span></span>
<span data-ttu-id="f3780-349">Hello egészségügyi adatok alapján, szolgáltatás írók és a fürt/rendszergazdái tulajdonképpen módon tooconsume hello információkat.</span><span class="sxs-lookup"><span data-stu-id="f3780-349">Based on hello health data, service writers and cluster/application administrators can think of ways tooconsume hello information.</span></span> <span data-ttu-id="f3780-350">Például akkor állíthat be egészségi állapot toocatch súlyos problémák értesítőket ahhoz, azok kiváltó kimaradások esetén.</span><span class="sxs-lookup"><span data-stu-id="f3780-350">For example, they can set up alerts based on health status toocatch severe issues before they provoke outages.</span></span> <span data-ttu-id="f3780-351">Rendszergazdák is beállíthatnak javítási rendszerek toofix problémákat automatikusan.</span><span class="sxs-lookup"><span data-stu-id="f3780-351">Administrators can also set up repair systems toofix issues automatically.</span></span>

[<span data-ttu-id="f3780-352">Bevezetés tooService állapotát figyelés</span><span class="sxs-lookup"><span data-stu-id="f3780-352">Introduction tooService Fabric health Monitoring</span></span>](service-fabric-health-introduction.md)

[<span data-ttu-id="f3780-353">A Service Fabric rendszerállapot-jelentések megtekintése</span><span class="sxs-lookup"><span data-stu-id="f3780-353">View Service Fabric health reports</span></span>](service-fabric-view-entities-aggregated-health.md)

[<span data-ttu-id="f3780-354">Hogyan tooreport és ellenőrzés szolgáltatás állapotát</span><span class="sxs-lookup"><span data-stu-id="f3780-354">How tooreport and check service health</span></span>](service-fabric-diagnostics-how-to-report-and-check-service-health.md)

[<span data-ttu-id="f3780-355">Rendszerállapot-jelentések használata a hibaelhárításhoz</span><span class="sxs-lookup"><span data-stu-id="f3780-355">Use system health reports for troubleshooting</span></span>](service-fabric-understand-and-troubleshoot-with-system-health-reports.md)

[<span data-ttu-id="f3780-356">Figyelése és diagnosztizálása helyileg szolgáltatások</span><span class="sxs-lookup"><span data-stu-id="f3780-356">Monitor and diagnose services locally</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[<span data-ttu-id="f3780-357">A Service Fabric-alkalmazás frissítése</span><span class="sxs-lookup"><span data-stu-id="f3780-357">Service Fabric application upgrade</span></span>](service-fabric-application-upgrade.md)

