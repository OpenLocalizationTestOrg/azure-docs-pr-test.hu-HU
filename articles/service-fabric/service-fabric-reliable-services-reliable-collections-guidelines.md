---
title: "Irányelvek és javaslatok az Azure-ban megbízható gyűjtemények szolgáltatás háló |} Microsoft Docs"
description: "Irányelvek és javaslatok a Service Fabric megbízható gyűjtemények"
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/3/2017
ms.author: mcoskun
ms.openlocfilehash: 053a7bca76362035e428fc11806b3e4f83d00946
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="guidelines-and-recommendations-for-reliable-collections-in-azure-service-fabric"></a><span data-ttu-id="dce93-103">Irányelvek és javaslatok az Azure Service Fabric megbízható gyűjtemények</span><span class="sxs-lookup"><span data-stu-id="dce93-103">Guidelines and recommendations for Reliable Collections in Azure Service Fabric</span></span>
<span data-ttu-id="dce93-104">Ez a szakasz útmutatást nyújt a megbízható állapotkezelője és megbízható gyűjtemények használatával.</span><span class="sxs-lookup"><span data-stu-id="dce93-104">This section provides guidelines for using Reliable State Manager and Reliable Collections.</span></span> <span data-ttu-id="dce93-105">A cél, hogy a felhasználók közös nehézségek elkerülése érdekében.</span><span class="sxs-lookup"><span data-stu-id="dce93-105">The goal is to help users avoid common pitfalls.</span></span>

<span data-ttu-id="dce93-106">Az irányelvek egyszerű ajánlásokat a feltételeket a következő előtaggal vannak sorolva *tegye*, *fontolja meg*, *kerülje* és *nem*.</span><span class="sxs-lookup"><span data-stu-id="dce93-106">The guidelines are organized as simple recommendations prefixed with the terms *Do*, *Consider*, *Avoid* and *Do not*.</span></span>

* <span data-ttu-id="dce93-107">Ne módosítsa az olvasási műveletek által visszaadott egyéni típusú objektum (például `TryPeekAsync` vagy `TryGetValueAsync`).</span><span class="sxs-lookup"><span data-stu-id="dce93-107">Do not modify an object of custom type returned by read operations (for example, `TryPeekAsync` or `TryGetValueAsync`).</span></span> <span data-ttu-id="dce93-108">Megbízható gyűjtemények, egyidejű gyűjtemények, mint például egy hivatkozást az objektumok és másolatát nem adhat vissza.</span><span class="sxs-lookup"><span data-stu-id="dce93-108">Reliable Collections, just like Concurrent Collections, return a reference to the objects and not a copy.</span></span>
* <span data-ttu-id="dce93-109">Lemásolni mély visszaadott típusú objektumhoz tartozó olyan egyéni módosítás előtt.</span><span class="sxs-lookup"><span data-stu-id="dce93-109">Do deep copy the returned object of a custom type before modifying it.</span></span> <span data-ttu-id="dce93-110">Mivel a struktúrák és beépített pass-by-value, nem kell részletes lemásolni rajtuk.</span><span class="sxs-lookup"><span data-stu-id="dce93-110">Since structs and built-in types are pass-by-value, you do not need to do a deep copy on them.</span></span>
* <span data-ttu-id="dce93-111">Ne használjon `TimeSpan.MaxValue` időtúllépési.</span><span class="sxs-lookup"><span data-stu-id="dce93-111">Do not use `TimeSpan.MaxValue` for time-outs.</span></span> <span data-ttu-id="dce93-112">Időtúllépések holtpont észleléséhez használandó.</span><span class="sxs-lookup"><span data-stu-id="dce93-112">Time-outs should be used to detect deadlocks.</span></span>
* <span data-ttu-id="dce93-113">Ne használjon tranzakció, miután ez befejeződött, megszakított, vagy elvetése megtörtént.</span><span class="sxs-lookup"><span data-stu-id="dce93-113">Do not use a transaction after it has been committed, aborted, or disposed.</span></span>
* <span data-ttu-id="dce93-114">Ne használja az enumerálás a létrehozták a tranzakció hatókörén kívül.</span><span class="sxs-lookup"><span data-stu-id="dce93-114">Do not use an enumeration outside of the transaction scope it was created in.</span></span>
* <span data-ttu-id="dce93-115">Ne hozzon létre egy tranzakcióban, másik tranzakcióban `using` utasítás mert holtpont lehet okozni.</span><span class="sxs-lookup"><span data-stu-id="dce93-115">Do not create a transaction within another transaction’s `using` statement because it can cause deadlocks.</span></span>
* <span data-ttu-id="dce93-116">Győződjön meg arról, hogy a `IComparable<TKey>` implementációjának helyességét.</span><span class="sxs-lookup"><span data-stu-id="dce93-116">Do ensure that your `IComparable<TKey>` implementation is correct.</span></span> <span data-ttu-id="dce93-117">A rendszer mennyi függőségi `IComparable<TKey>` az ellenőrzőpontok és sorok egyesítéshez.</span><span class="sxs-lookup"><span data-stu-id="dce93-117">The system takes dependency on `IComparable<TKey>` for merging checkpoints and rows.</span></span>
* <span data-ttu-id="dce93-118">Módosítási zárolást szándéka elemet olvasásakor frissítésére használni megakadályozhatja, hogy egy bizonyos osztály holtpont.</span><span class="sxs-lookup"><span data-stu-id="dce93-118">Do use Update lock when reading an item with an intention to update it to prevent a certain class of deadlocks.</span></span>
* <span data-ttu-id="dce93-119">Vegye figyelembe a megőrzi az elemeket (például TKey + TValue megbízható szótár) 80 KB alatt: kisebb annál pontosabb.</span><span class="sxs-lookup"><span data-stu-id="dce93-119">Consider keeping your items (for example, TKey + TValue for Reliable Dictionary) below 80 KBytes: smaller the better.</span></span> <span data-ttu-id="dce93-120">Ez csökkenti a nagy objektumok halommemóriájának kihasználtsága, valamint a lemezek és a hálózati IO-követelményeket.</span><span class="sxs-lookup"><span data-stu-id="dce93-120">This reduces the amount of Large Object Heap usage as well as disk and network IO requirements.</span></span> <span data-ttu-id="dce93-121">Gyakran csökkentik az ismétlődő adatokat replikál, az érték csak egy kis részét frissítésekor.</span><span class="sxs-lookup"><span data-stu-id="dce93-121">Often, it reduces replicating duplicate data when only one small part of the value is being updated.</span></span> <span data-ttu-id="dce93-122">Közös ennek érdekében a megbízható szótárban módja a sorok megszüntetése több sort.</span><span class="sxs-lookup"><span data-stu-id="dce93-122">Common way to achieve this in Reliable Dictionary, is to break your rows in to multiple rows.</span></span>
* <span data-ttu-id="dce93-123">Érdemes biztonsági mentést, és állítsa vissza a vész-helyreállítási funkció.</span><span class="sxs-lookup"><span data-stu-id="dce93-123">Consider using backup and restore functionality to have disaster recovery.</span></span>
* <span data-ttu-id="dce93-124">Elkerülése érdekében egyetlen entitás műveletek és többentitásos műveletek (például `GetCountAsync`, `CreateEnumerableAsync`) miatt a különböző elkülönítési szinten ugyanabban a tranzakcióban.</span><span class="sxs-lookup"><span data-stu-id="dce93-124">Avoid mixing single entity operations and multi-entity operations (e.g `GetCountAsync`, `CreateEnumerableAsync`) in the same transaction due to the different isolation levels.</span></span>
* <span data-ttu-id="dce93-125">InvalidOperationException kezelni.</span><span class="sxs-lookup"><span data-stu-id="dce93-125">Do handle InvalidOperationException.</span></span> <span data-ttu-id="dce93-126">A rendszer számos okból felhasználói tranzakció is megszakítja.</span><span class="sxs-lookup"><span data-stu-id="dce93-126">User transactions can be aborted by the system for variety of reasons.</span></span> <span data-ttu-id="dce93-127">Például ha a megbízható állapotkezelője-jal kívül elsődleges szerepet a, vagy ha egy hosszú ideig futó tranzakció blokkolja a tranzakciós napló csonkolási.</span><span class="sxs-lookup"><span data-stu-id="dce93-127">For example, when the Reliable State Manager is changing its role out of Primary or when a long-running transaction is blocking truncation of the transactional log.</span></span> <span data-ttu-id="dce93-128">Ilyen esetben felhasználói InvalidOperationException, amely azt jelzi, hogy a tranzakció már meg lett szakítva, jelenhet meg.</span><span class="sxs-lookup"><span data-stu-id="dce93-128">In such cases, user may receive InvalidOperationException indicating that their transaction has already been terminated.</span></span> <span data-ttu-id="dce93-129">Ha, a tranzakció futása nem volt szükség a felhasználó által kezelni ezt a kivételt legjobb módja, ha a tranzakció eldobásakor ellenőrizze, hogy a megszakítási token felé a jelzésküldés (vagy a replika szerepkörét az megváltozott), és ha nem hozzon létre egy új tranzakció, és próbálkozzon újra.</span><span class="sxs-lookup"><span data-stu-id="dce93-129">Assuming, the termination of the transaction was not requested by the user, best way to handle this exception is to dispose the transaction, check if the cancellation token has been signaled (or the role of the replica has been changed), and if not create a new transaction and retry.</span></span>  

<span data-ttu-id="dce93-130">Az alábbiakban néhány dolgot figyelembe venni:</span><span class="sxs-lookup"><span data-stu-id="dce93-130">Here are some things to keep in mind:</span></span>

* <span data-ttu-id="dce93-131">Az alapértelmezett érték négy másodperc minden megbízható gyűjtemény API.</span><span class="sxs-lookup"><span data-stu-id="dce93-131">The default time-out is four seconds for all the Reliable Collection APIs.</span></span> <span data-ttu-id="dce93-132">A legtöbb felhasználónak alapértelmezett időkorlátja kell használnia.</span><span class="sxs-lookup"><span data-stu-id="dce93-132">Most users should use the default time-out.</span></span>
* <span data-ttu-id="dce93-133">Az alapértelmezett megszakítási lexikális elem `CancellationToken.None` a gyűjtemények API-k az összes megbízható.</span><span class="sxs-lookup"><span data-stu-id="dce93-133">The default cancellation token is `CancellationToken.None` in all Reliable Collections APIs.</span></span>
* <span data-ttu-id="dce93-134">A kulcs típusú paraméter (*TKey*) a megbízható Dictionary megfelelően meg kell valósítania `GetHashCode()` és `Equals()`.</span><span class="sxs-lookup"><span data-stu-id="dce93-134">The key type parameter (*TKey*) for a Reliable Dictionary must correctly implement `GetHashCode()` and `Equals()`.</span></span> <span data-ttu-id="dce93-135">Lehet, hogy a kulcsok nem módosítható.</span><span class="sxs-lookup"><span data-stu-id="dce93-135">Keys must be immutable.</span></span>
* <span data-ttu-id="dce93-136">Magas rendelkezésre állás biztosítása a megbízható gyűjtemények, minden egyes szolgáltatás legalább egy célként és a replikakészlet minimális mérete 3 beállítása kell rendelkeznie.</span><span class="sxs-lookup"><span data-stu-id="dce93-136">To achieve high availability for the Reliable Collections, each service should have at least a target and minimum replica set size of 3.</span></span>
* <span data-ttu-id="dce93-137">A másodlagos olvasási műveletek nem kvórum véglegesített verziók lehet olvasni.</span><span class="sxs-lookup"><span data-stu-id="dce93-137">Read operations on the secondary may read versions that are not quorum committed.</span></span>
  <span data-ttu-id="dce93-138">Ez azt jelenti, hogy egy verziója, amely egyetlen másodlagos olvasható adatok előfordulhat, hogy lehet hamis jutott el.</span><span class="sxs-lookup"><span data-stu-id="dce93-138">This means that a version of data that is read from a single secondary might be false progressed.</span></span>
  <span data-ttu-id="dce93-139">Elsődleges olvasások a rendszer mindig stabil: is soha nem lehet false jutott el.</span><span class="sxs-lookup"><span data-stu-id="dce93-139">Reads from Primary are always stable: can never be false progressed.</span></span>

### <a name="next-steps"></a><span data-ttu-id="dce93-140">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="dce93-140">Next steps</span></span>
* [<span data-ttu-id="dce93-141">A Reliable Collections használata</span><span class="sxs-lookup"><span data-stu-id="dce93-141">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="dce93-142">Tranzakciók és a zárolásokat</span><span class="sxs-lookup"><span data-stu-id="dce93-142">Transactions and Locks</span></span>](service-fabric-reliable-services-reliable-collections-transactions-locks.md)
* [<span data-ttu-id="dce93-143">Megbízható állapot Manager és a gyűjtemény belső funkciói</span><span class="sxs-lookup"><span data-stu-id="dce93-143">Reliable State Manager and Collection Internals</span></span>](service-fabric-reliable-services-reliable-collections-internals.md)
* <span data-ttu-id="dce93-144">Adatok kezelése</span><span class="sxs-lookup"><span data-stu-id="dce93-144">Managing Data</span></span>
  * [<span data-ttu-id="dce93-145">Biztonsági mentés és visszaállítás</span><span class="sxs-lookup"><span data-stu-id="dce93-145">Backup and Restore</span></span>](service-fabric-reliable-services-backup-restore.md)
  * [<span data-ttu-id="dce93-146">Értesítések</span><span class="sxs-lookup"><span data-stu-id="dce93-146">Notifications</span></span>](service-fabric-reliable-services-notifications.md)
  * [<span data-ttu-id="dce93-147">Szerializálási és frissítése</span><span class="sxs-lookup"><span data-stu-id="dce93-147">Serialization and Upgrade</span></span>](service-fabric-application-upgrade-data-serialization.md)
  * [<span data-ttu-id="dce93-148">Megbízható állapot Manager konfigurálása</span><span class="sxs-lookup"><span data-stu-id="dce93-148">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* <span data-ttu-id="dce93-149">Egyéb</span><span class="sxs-lookup"><span data-stu-id="dce93-149">Others</span></span>
  * [<span data-ttu-id="dce93-150">Megbízható szolgáltatások – első lépések</span><span class="sxs-lookup"><span data-stu-id="dce93-150">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
  * [<span data-ttu-id="dce93-151">Fejlesztői leírás megbízható gyűjtemények</span><span class="sxs-lookup"><span data-stu-id="dce93-151">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)
