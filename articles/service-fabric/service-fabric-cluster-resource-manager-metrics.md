---
title: "aaaManage Azure mikroszolgáltatási terhelés mérőszámainkat |} Microsoft Docs"
description: "További információk a hogyan tooconfigure és -felhasználási metrikát a Service Fabric toomanage szolgáltatás hálózatierőforrás-fogyasztás."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 0d622ea6-a7c7-4bef-886b-06e6b85a97fb
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 592dc749ce30683a1e439a702b7d0dc0a638276f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="managing-resource-consumption-and-load-in-service-fabric-with-metrics"></a><span data-ttu-id="7c36f-103">Kezelése erőforrás-felhasználás és a metrikák a Service Fabric terheléselosztási</span><span class="sxs-lookup"><span data-stu-id="7c36f-103">Managing resource consumption and load in Service Fabric with metrics</span></span>
<span data-ttu-id="7c36f-104">*Metrikák* hello erőforrás, a szolgáltatások ítélt információkat, és amely hello hello fürt csomópontja által biztosított.</span><span class="sxs-lookup"><span data-stu-id="7c36f-104">*Metrics* are hello resources that your services care about and which are provided by hello nodes in hello cluster.</span></span> <span data-ttu-id="7c36f-105">Egy metrika bármilyen, hogy a rendelés tooimprove vagy a figyelő hello teljesítményét a szolgáltatások toomanage.</span><span class="sxs-lookup"><span data-stu-id="7c36f-105">A metric is anything that you want toomanage in order tooimprove or monitor hello performance of your services.</span></span> <span data-ttu-id="7c36f-106">Például memória-felhasználás tooknow előfordulhat, hogy figyelje, ha a szolgáltatás túlterhelt.</span><span class="sxs-lookup"><span data-stu-id="7c36f-106">For example, you might watch memory consumption tooknow if your service is overloaded.</span></span> <span data-ttu-id="7c36f-107">Egy másik toofigure ki, hogy hello szolgáltatás tudta áthelyezni máshol esetén a kisebb korlátozottan működik rendelés tooget jobb teljesítmény memória használata.</span><span class="sxs-lookup"><span data-stu-id="7c36f-107">Another use is toofigure out whether hello service could move elsewhere where memory is less constrained in order tooget better performance.</span></span>

<span data-ttu-id="7c36f-108">Többek között a memória, a lemez és a CPU-használati metrikák példák.</span><span class="sxs-lookup"><span data-stu-id="7c36f-108">Things like Memory, Disk, and CPU usage are examples of metrics.</span></span> <span data-ttu-id="7c36f-109">A metrikák fizikai metrika, erőforrásokat, amelyek megfelelnek a felügyelt toobe igénylő hello csomóponton toophysical erőforrások.</span><span class="sxs-lookup"><span data-stu-id="7c36f-109">These metrics are physical metrics, resources that correspond toophysical resources on hello node that need toobe managed.</span></span> <span data-ttu-id="7c36f-110">Metrikák is lehet (és gyakran) logikai metrikákat.</span><span class="sxs-lookup"><span data-stu-id="7c36f-110">Metrics can also be (and commonly are) logical metrics.</span></span> <span data-ttu-id="7c36f-111">Logikai metrikák többek között a "MyWorkQueueDepth" vagy "MessagesToProcess" vagy "TotalRecords".</span><span class="sxs-lookup"><span data-stu-id="7c36f-111">Logical metrics are things like “MyWorkQueueDepth” or "MessagesToProcess" or "TotalRecords".</span></span> <span data-ttu-id="7c36f-112">Logikai metrikák alkalmazás által meghatározott, és toosome fizikai erőforrás-felhasználás közvetve tartozik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-112">Logical metrics are application-defined and indirectly correspond toosome physical resource consumption.</span></span> <span data-ttu-id="7c36f-113">Logikai metrikák közös, mivel azok rögzített toomeasure és a szolgáltatás alapú fizikai erőforrások felhasználását.</span><span class="sxs-lookup"><span data-stu-id="7c36f-113">Logical metrics are common because it can be hard toomeasure and report consumption of physical resources on a per-service basis.</span></span> <span data-ttu-id="7c36f-114">Miért Service Fabric biztosít bizonyos alapértelmezett metrikák méri, és jelentéskészítés a saját fizikai metrikák hello összetettsége is.</span><span class="sxs-lookup"><span data-stu-id="7c36f-114">hello complexity of measuring and reporting your own physical metrics is also why Service Fabric provides some default metrics.</span></span>

## <a name="default-metrics"></a><span data-ttu-id="7c36f-115">Alapértelmezett metrikák</span><span class="sxs-lookup"><span data-stu-id="7c36f-115">Default metrics</span></span>
<span data-ttu-id="7c36f-116">Tegyük fel, amelyet az tooget írást, és a szolgáltatás telepítése megkezdődött.</span><span class="sxs-lookup"><span data-stu-id="7c36f-116">Let’s say that you want tooget started writing and deploying your service.</span></span> <span data-ttu-id="7c36f-117">Ezen a ponton nem tudható, hogy milyen fizikai vagy logikai erőforrások.</span><span class="sxs-lookup"><span data-stu-id="7c36f-117">At this point you don’t know what physical or logical resources it consumes.</span></span> <span data-ttu-id="7c36f-118">Ez ideális!</span><span class="sxs-lookup"><span data-stu-id="7c36f-118">That’s fine!</span></span> <span data-ttu-id="7c36f-119">Service Fabric fürt erőforrás-kezelő hello néhány alapértelmezett metrikákat használ, ha nincs más metrikákkal meg van adva.</span><span class="sxs-lookup"><span data-stu-id="7c36f-119">hello Service Fabric Cluster Resource Manager uses some default metrics when no other metrics are specified.</span></span> <span data-ttu-id="7c36f-120">Ezek a következők:</span><span class="sxs-lookup"><span data-stu-id="7c36f-120">They are:</span></span>

  - <span data-ttu-id="7c36f-121">PrimaryCount - hello csomóponton elsődleges replikák száma</span><span class="sxs-lookup"><span data-stu-id="7c36f-121">PrimaryCount - count of Primary replicas on hello node</span></span> 
  - <span data-ttu-id="7c36f-122">ReplicaCount - hello csomóponton teljes állapot-nyilvántartó replikák száma</span><span class="sxs-lookup"><span data-stu-id="7c36f-122">ReplicaCount - count of total stateful replicas on hello node</span></span>
  - <span data-ttu-id="7c36f-123">Szám - szolgáltatás-objektumok (állapotmentes és állapotalapú) hello csomóponton száma</span><span class="sxs-lookup"><span data-stu-id="7c36f-123">Count - count of all service objects (stateless and stateful) on hello node</span></span>

| <span data-ttu-id="7c36f-124">Metrika</span><span class="sxs-lookup"><span data-stu-id="7c36f-124">Metric</span></span> | <span data-ttu-id="7c36f-125">Állapot nélküli példány betöltése</span><span class="sxs-lookup"><span data-stu-id="7c36f-125">Stateless Instance Load</span></span> | <span data-ttu-id="7c36f-126">Állapot-nyilvántartó másodlagos betöltése</span><span class="sxs-lookup"><span data-stu-id="7c36f-126">Stateful Secondary Load</span></span> | <span data-ttu-id="7c36f-127">Állapot-nyilvántartó elsődleges betöltése</span><span class="sxs-lookup"><span data-stu-id="7c36f-127">Stateful Primary Load</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="7c36f-128">PrimaryCount</span><span class="sxs-lookup"><span data-stu-id="7c36f-128">PrimaryCount</span></span> |<span data-ttu-id="7c36f-129">0</span><span class="sxs-lookup"><span data-stu-id="7c36f-129">0</span></span> |<span data-ttu-id="7c36f-130">0</span><span class="sxs-lookup"><span data-stu-id="7c36f-130">0</span></span> |<span data-ttu-id="7c36f-131">1</span><span class="sxs-lookup"><span data-stu-id="7c36f-131">1</span></span> |
| <span data-ttu-id="7c36f-132">ReplicaCount</span><span class="sxs-lookup"><span data-stu-id="7c36f-132">ReplicaCount</span></span> |<span data-ttu-id="7c36f-133">0</span><span class="sxs-lookup"><span data-stu-id="7c36f-133">0</span></span> |<span data-ttu-id="7c36f-134">1</span><span class="sxs-lookup"><span data-stu-id="7c36f-134">1</span></span> |<span data-ttu-id="7c36f-135">1</span><span class="sxs-lookup"><span data-stu-id="7c36f-135">1</span></span> |
| <span data-ttu-id="7c36f-136">Darabszám</span><span class="sxs-lookup"><span data-stu-id="7c36f-136">Count</span></span> |<span data-ttu-id="7c36f-137">1</span><span class="sxs-lookup"><span data-stu-id="7c36f-137">1</span></span> |<span data-ttu-id="7c36f-138">1</span><span class="sxs-lookup"><span data-stu-id="7c36f-138">1</span></span> |<span data-ttu-id="7c36f-139">1</span><span class="sxs-lookup"><span data-stu-id="7c36f-139">1</span></span> |

<span data-ttu-id="7c36f-140">Alapszintű munkaterhelések hello alapértelmezett metrikák hello fürt munka decent terjesztési adja meg.</span><span class="sxs-lookup"><span data-stu-id="7c36f-140">For basic workloads, hello default metrics provide a decent distribution of work in hello cluster.</span></span> <span data-ttu-id="7c36f-141">A következő példa hello nézzük meg, mi történik, ha azt hozzon létre két szolgáltatást, és a hello alapértelmezett metrikák a(z) terheléselosztást.</span><span class="sxs-lookup"><span data-stu-id="7c36f-141">In hello following example, let’s see what happens when we create two services and rely on hello default metrics for balancing.</span></span> <span data-ttu-id="7c36f-142">hello első szolgáltatás egy állapotalapú szolgáltatás három partíciókat és a cél replika három méretének beállítása.</span><span class="sxs-lookup"><span data-stu-id="7c36f-142">hello first service is a stateful service with three partitions and a target replica set size of three.</span></span> <span data-ttu-id="7c36f-143">második hello szolgáltatás egy olyan állapot nélküli szolgáltatás egy partíciót és három példányszám.</span><span class="sxs-lookup"><span data-stu-id="7c36f-143">hello second service is a stateless service with one partition and an instance count of three.</span></span>

<span data-ttu-id="7c36f-144">Íme tartalmával:</span><span class="sxs-lookup"><span data-stu-id="7c36f-144">Here's what you get:</span></span>

<span data-ttu-id="7c36f-145"><center>
![Alapértelmezett metrikák fürt elrendezése][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="7c36f-145"><center>
![Cluster Layout with Default Metrics][Image1]
</center></span></span>

<span data-ttu-id="7c36f-146">Néhány dolgot toonote:</span><span class="sxs-lookup"><span data-stu-id="7c36f-146">Some things toonote:</span></span>
  - <span data-ttu-id="7c36f-147">Elsődleges replikára változott hello állapotalapú szolgáltatás több csomópontot különböző pontjain.</span><span class="sxs-lookup"><span data-stu-id="7c36f-147">Primary replicas for hello stateful service are distributed across several nodes</span></span>
  - <span data-ttu-id="7c36f-148">A különböző csomópontokon vannak partícióra hello replikáit</span><span class="sxs-lookup"><span data-stu-id="7c36f-148">Replicas for hello same partition are on different nodes</span></span>
  - <span data-ttu-id="7c36f-149">elsődleges és másodlagos adatbázis teljes száma hello hello fürt terjesztése</span><span class="sxs-lookup"><span data-stu-id="7c36f-149">hello total number of primaries and secondaries is distributed in hello cluster</span></span>
  - <span data-ttu-id="7c36f-150">minden egyes csomóponton egyenletesen kiosztott hello szolgáltatás objektumok teljes száma</span><span class="sxs-lookup"><span data-stu-id="7c36f-150">hello total number of service objects are evenly allocated on each node</span></span>

<span data-ttu-id="7c36f-151">jó!</span><span class="sxs-lookup"><span data-stu-id="7c36f-151">Good!</span></span>

<span data-ttu-id="7c36f-152">hello alapértelmezett metrikák nagy egy indításakor működik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-152">hello default metrics work great as a start.</span></span> <span data-ttu-id="7c36f-153">Azonban hello alapértelmezett metrikák csak végezze, amennyiben.</span><span class="sxs-lookup"><span data-stu-id="7c36f-153">However, hello default metrics will only carry you so far.</span></span> <span data-ttu-id="7c36f-154">Például: Mi hello valószínűsége, hogy Ön hello particionálási sémáját nek eredmények a tökéletesen még akkor is terhelése minden partíció?</span><span class="sxs-lookup"><span data-stu-id="7c36f-154">For example: What's hello likelihood that hello partitioning scheme you picked results in perfectly even utilization by all partitions?</span></span> <span data-ttu-id="7c36f-155">Mi az az hello esélye annak, hogy egy adott szolgáltatáshoz terhelés hello állandó adott idő alatt, vagy akár legkisebb hello azonos között több partíciót most?</span><span class="sxs-lookup"><span data-stu-id="7c36f-155">What’s hello chance that hello load for a given service is constant over time, or even just hello same across multiple partitions right now?</span></span>

<span data-ttu-id="7c36f-156">Az imént hello alapértelmezett metrikák futtatható.</span><span class="sxs-lookup"><span data-stu-id="7c36f-156">You could run with just hello default metrics.</span></span> <span data-ttu-id="7c36f-157">Azonban ez általában azt jelenti, hogy a fürtkihasználtság kevesebb, illetve több egyenetlen, mint szeretné.</span><span class="sxs-lookup"><span data-stu-id="7c36f-157">However, doing so usually means that your cluster utilization is lower and more uneven than you’d like.</span></span> <span data-ttu-id="7c36f-158">Ennek az az oka hello alapértelmezett metrikák nem adaptív, és feltételezik, hogy minden megegyezik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-158">This is because hello default metrics aren't adaptive and presume everything is equivalent.</span></span> <span data-ttu-id="7c36f-159">Például az elfoglalt elsődleges, a másik nincs mindkét az "1" toohello PrimaryCount metrika függ.</span><span class="sxs-lookup"><span data-stu-id="7c36f-159">For example, a Primary that is busy and one that is not both contribute "1" toohello PrimaryCount metric.</span></span> <span data-ttu-id="7c36f-160">Hello legrosszabb esetben csak a hello alapértelmezett mérőszámainkat is eredményezhet teljesítményproblémák eredményezve overscheduled csomópontok.</span><span class="sxs-lookup"><span data-stu-id="7c36f-160">In hello worst case, using only hello default metrics can also result in overscheduled nodes resulting in performance issues.</span></span> <span data-ttu-id="7c36f-161">Ha érdekli hello legtöbb kívül a fürt és a teljesítménnyel kapcsolatos problémák elkerülése, akkor toouse egyéni metrikák és a dinamikus terheléselosztó jelentéskészítési.</span><span class="sxs-lookup"><span data-stu-id="7c36f-161">If you're interested in getting hello most out of your cluster and avoiding performance issues, you need toouse custom metrics and dynamic load reporting.</span></span>

## <a name="custom-metrics"></a><span data-ttu-id="7c36f-162">Egyéni metrikák</span><span class="sxs-lookup"><span data-stu-id="7c36f-162">Custom metrics</span></span>
<span data-ttu-id="7c36f-163">Metrikák konfigurálása egy nevű-szolgáltatás-példányonként hello szolgáltatás létrehozásakor.</span><span class="sxs-lookup"><span data-stu-id="7c36f-163">Metrics are configured on a per-named-service-instance basis when you’re creating hello service.</span></span>

<span data-ttu-id="7c36f-164">Bármely metrika rendelkezik néhány tulajdonság, amely azt írják le: a neve, a súly és egy alapértelmezett betöltési.</span><span class="sxs-lookup"><span data-stu-id="7c36f-164">Any metric has some properties that describe it: a name, a weight, and a default load.</span></span>

* <span data-ttu-id="7c36f-165">Metrika neve: hello hello metrika neve.</span><span class="sxs-lookup"><span data-stu-id="7c36f-165">Metric Name: hello name of hello metric.</span></span> <span data-ttu-id="7c36f-166">hello metrika neve hello metrika hello Resource Manager szempontjából hello fürtön belül egyedi azonosítója.</span><span class="sxs-lookup"><span data-stu-id="7c36f-166">hello metric name is a unique identifier for hello metric within hello cluster from hello Resource Manager’s perspective.</span></span>
* <span data-ttu-id="7c36f-167">Súly: Metrika súlyának határozza meg, hogy mennyire fontos ez a metrika relatív toohello más metrikákkal ezt a szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="7c36f-167">Weight: Metric weight defines how important this metric is relative toohello other metrics for this service.</span></span>
* <span data-ttu-id="7c36f-168">Alapértelmezett betöltési: hello alapértelmezett betöltési képviselt másképp attól függően, hogy hello szolgáltatás állapot nélküli és állapotalapú.</span><span class="sxs-lookup"><span data-stu-id="7c36f-168">Default Load: hello default load is represented differently depending on whether hello service is stateless or stateful.</span></span>
  * <span data-ttu-id="7c36f-169">Az állapotmentes szolgáltatások mindegyik metrikát DefaultLoad nevű egyetlen tulajdonsággal rendelkezik</span><span class="sxs-lookup"><span data-stu-id="7c36f-169">For stateless services, each metric has a single property named DefaultLoad</span></span>
  * <span data-ttu-id="7c36f-170">Az állapotalapú szolgáltatások adhat meg:</span><span class="sxs-lookup"><span data-stu-id="7c36f-170">For stateful services you define:</span></span>
    * <span data-ttu-id="7c36f-171">PrimaryDefaultLoad: Ez a mérőszám a szolgáltatás fogyaszt elsődleges hello alapértelmezés szerinti</span><span class="sxs-lookup"><span data-stu-id="7c36f-171">PrimaryDefaultLoad: hello default amount of this metric this service consumes when it is a Primary</span></span>
    * <span data-ttu-id="7c36f-172">SecondaryDefaultLoad: Ez a mérőszám a szolgáltatás fogyaszt másodlagos hello alapértelmezés szerinti</span><span class="sxs-lookup"><span data-stu-id="7c36f-172">SecondaryDefaultLoad: hello default amount of this metric this service consumes when it is a Secondary</span></span>

> [!NOTE]
> <span data-ttu-id="7c36f-173">Ha szeretné too_also_ használata hello alapértelmezett metrikák egyéni metrikáinak definiálása, szükség van-e too_explicitly_ hozzáadása hello alapértelmezett metrikák biztonsági másolatot, és az őket súlyok és értékek meghatározása.</span><span class="sxs-lookup"><span data-stu-id="7c36f-173">If you define custom metrics and you want too_also_ use hello default metrics, you need too_explicitly_ add hello default metrics back and define weights and values for them.</span></span> <span data-ttu-id="7c36f-174">Ennek oka az, meg kell adnia a hello alapértelmezett metrikák és a egyéni metrikákat hello kapcsolatát.</span><span class="sxs-lookup"><span data-stu-id="7c36f-174">This is because you must define hello relationship between hello default metrics and your custom metrics.</span></span> <span data-ttu-id="7c36f-175">Például lehet, hogy az Ön számára legfontosabb ConnectionCount vagy WorkQueueDepth több mint elsődleges elosztása.</span><span class="sxs-lookup"><span data-stu-id="7c36f-175">For example, maybe you care about ConnectionCount or WorkQueueDepth more than Primary distribution.</span></span> <span data-ttu-id="7c36f-176">Alapértelmezett hello súlya hello PrimaryCount metrika az magas, tehát tooreduce azt tooMedium a azok elsőbbséget más metrikák tooensure hozzáadásakor.</span><span class="sxs-lookup"><span data-stu-id="7c36f-176">By default hello weight of hello PrimaryCount metric is High, so you want tooreduce it tooMedium when you add your other metrics tooensure they take precedence.</span></span>
>

### <a name="defining-metrics-for-your-service---an-example"></a><span data-ttu-id="7c36f-177">A szolgáltatás - példa metrikák meghatározása</span><span class="sxs-lookup"><span data-stu-id="7c36f-177">Defining metrics for your service - an example</span></span>
<span data-ttu-id="7c36f-178">Tegyük fel, azt szeretné, hogy a következő konfigurációs hello:</span><span class="sxs-lookup"><span data-stu-id="7c36f-178">Let’s say you want hello following configuration:</span></span>

  - <span data-ttu-id="7c36f-179">A szolgáltatás "ConnectionCount" nevű metrika jelentések</span><span class="sxs-lookup"><span data-stu-id="7c36f-179">Your service reports a metric named "ConnectionCount”</span></span>
  - <span data-ttu-id="7c36f-180">Azt is szeretné toouse hello alapértelmezett metrikák</span><span class="sxs-lookup"><span data-stu-id="7c36f-180">You also want toouse hello default metrics</span></span> 
  - <span data-ttu-id="7c36f-181">Régebben már kötöttek néhány mérések és tudja, hogy általában egy elsődleges replika az adott szolgáltatás foglalja el "ConnectionCount" a 20 egység</span><span class="sxs-lookup"><span data-stu-id="7c36f-181">You’ve done some measurements and know that normally a Primary replica of that service takes up 20 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="7c36f-182">Másodlagos adatbázis használja a "ConnectionCount" 5 egység</span><span class="sxs-lookup"><span data-stu-id="7c36f-182">Secondaries use 5 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="7c36f-183">Hogy "ConnectionCount" hello legfontosabb mérőszám szempontjából az adott szolgáltatás hello a teljesítmény kezelése</span><span class="sxs-lookup"><span data-stu-id="7c36f-183">You know that "ConnectionCount" is hello most important metric in terms of managing hello performance of this particular service</span></span>
  - <span data-ttu-id="7c36f-184">Továbbra is szeretné az elosztott terhelésű elsődleges replikára változott.</span><span class="sxs-lookup"><span data-stu-id="7c36f-184">You still want Primary replicas balanced.</span></span> <span data-ttu-id="7c36f-185">Terheléselosztás elsődleges replikára változott érdemes általában függetlenül attól, milyen.</span><span class="sxs-lookup"><span data-stu-id="7c36f-185">Balancing primary replicas is generally a good idea no matter what.</span></span> <span data-ttu-id="7c36f-186">Ez segít a befolyásolása mellett az elsődleges replikák többsége néhány csomópont vagy a tartalék tartomány hello az adatvesztés elkerülése érdekében.</span><span class="sxs-lookup"><span data-stu-id="7c36f-186">This helps prevent hello loss of some node or fault domain from impacting a majority of primary replicas along with it.</span></span> 
  - <span data-ttu-id="7c36f-187">Ellenkező esetben hello alapértelmezett metrikák rendben.</span><span class="sxs-lookup"><span data-stu-id="7c36f-187">Otherwise, hello default metrics are fine</span></span>

<span data-ttu-id="7c36f-188">Íme hello, hogy volna írt kódot toocreate egy szolgáltatást, hogy a mérték konfigurálása:</span><span class="sxs-lookup"><span data-stu-id="7c36f-188">Here’s hello code that you would write toocreate a service with that metric configuration:</span></span>

<span data-ttu-id="7c36f-189">Kód:</span><span class="sxs-lookup"><span data-stu-id="7c36f-189">Code:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
StatefulServiceLoadMetricDescription connectionMetric = new StatefulServiceLoadMetricDescription();
connectionMetric.Name = "ConnectionCount";
connectionMetric.PrimaryDefaultLoad = 20;
connectionMetric.SecondaryDefaultLoad = 5;
connectionMetric.Weight = ServiceLoadMetricWeight.High;

StatefulServiceLoadMetricDescription primaryCountMetric = new StatefulServiceLoadMetricDescription();
primaryCountMetric.Name = "PrimaryCount";
primaryCountMetric.PrimaryDefaultLoad = 1;
primaryCountMetric.SecondaryDefaultLoad = 0;
primaryCountMetric.Weight = ServiceLoadMetricWeight.Medium;

StatefulServiceLoadMetricDescription replicaCountMetric = new StatefulServiceLoadMetricDescription();
replicaCountMetric.Name = "ReplicaCount";
replicaCountMetric.PrimaryDefaultLoad = 1;
replicaCountMetric.SecondaryDefaultLoad = 1;
replicaCountMetric.Weight = ServiceLoadMetricWeight.Low;

StatefulServiceLoadMetricDescription totalCountMetric = new StatefulServiceLoadMetricDescription();
totalCountMetric.Name = "Count";
totalCountMetric.PrimaryDefaultLoad = 1;
totalCountMetric.SecondaryDefaultLoad = 1;
totalCountMetric.Weight = ServiceLoadMetricWeight.Low;

serviceDescription.Metrics.Add(connectionMetric);
serviceDescription.Metrics.Add(primaryCountMetric);
serviceDescription.Metrics.Add(replicaCountMetric);
serviceDescription.Metrics.Add(totalCountMetric);

await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="7c36f-190">PowerShell:</span><span class="sxs-lookup"><span data-stu-id="7c36f-190">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ConnectionCount,High,20,5”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

> [!NOTE]
> <span data-ttu-id="7c36f-191">Példák fent hello és hello Ez a dokumentum többi részén leírást kezelése metrikák /-nevű-szolgáltatás alapon.</span><span class="sxs-lookup"><span data-stu-id="7c36f-191">hello above examples and hello rest of this document describe managing metrics on a per-named-service basis.</span></span> <span data-ttu-id="7c36f-192">Az is lehetséges toodefine metrikáját hello szolgáltatást a szolgáltatások _típus_ szintjét.</span><span class="sxs-lookup"><span data-stu-id="7c36f-192">It is also possible toodefine metrics for your services at hello service _type_ level.</span></span> <span data-ttu-id="7c36f-193">Ez a szolgáltatás jegyzékfájlokban megadásával valósítható meg.</span><span class="sxs-lookup"><span data-stu-id="7c36f-193">This is accomplished by specifying them in your service manifests.</span></span> <span data-ttu-id="7c36f-194">Több okból nem ajánlott a típus szintű metrikák meghatározása.</span><span class="sxs-lookup"><span data-stu-id="7c36f-194">Defining type level metrics is not recommended for several reasons.</span></span> <span data-ttu-id="7c36f-195">hello első oka az, hogy a mérték neve gyakran környezetre specifikus.</span><span class="sxs-lookup"><span data-stu-id="7c36f-195">hello first reason is that metric names are frequently environment-specific.</span></span> <span data-ttu-id="7c36f-196">Kivéve, ha egy fixen szerződés helyen, nem lehet arról, hogy egy környezetben hello metrika "Magok" nem "MiliCores" vagy "Magok" mások számára.</span><span class="sxs-lookup"><span data-stu-id="7c36f-196">Unless there is a firm contract in place, you cannot be sure that hello metric "Cores" in one environment isn't "MiliCores" or "CoReS" in others.</span></span> <span data-ttu-id="7c36f-197">Ha a metrikákat vannak meghatározva a jegyzékfájlban toocreate új jegyzékfájlokat egy környezetben kell.</span><span class="sxs-lookup"><span data-stu-id="7c36f-197">If your metrics are defined in your manifest you need toocreate new manifests per environment.</span></span> <span data-ttu-id="7c36f-198">Ez általában csak a kisebb különbségek, ami toomanagement nehézségek tooa elterjedése a különböző jegyzékfájlokban érdeklődők.</span><span class="sxs-lookup"><span data-stu-id="7c36f-198">This usually leads tooa proliferation of different manifests with only minor differences, which can lead toomanagement difficulties.</span></span>  
>
> <span data-ttu-id="7c36f-199">Metrika terhelések általában a egy nevű-szolgáltatás-példányonként vannak hozzárendelve.</span><span class="sxs-lookup"><span data-stu-id="7c36f-199">Metric loads are commonly assigned on a per-named-service-instance basis.</span></span> <span data-ttu-id="7c36f-200">Például tételezzük fel hello egy példányának létrehozása a toouse tervez CustomerA azt kiszolgálni csak némileg.</span><span class="sxs-lookup"><span data-stu-id="7c36f-200">For example, let's say you create one instance of hello service for CustomerA who plans toouse it only lightly.</span></span> <span data-ttu-id="7c36f-201">Tételezzük is fel számára hoz létre egy másik CustomerB, aki rendelkezik egy nagyobb munkaterhelés.</span><span class="sxs-lookup"><span data-stu-id="7c36f-201">Let's also say you create another for CustomerB who has a larger workload.</span></span> <span data-ttu-id="7c36f-202">Ebben az esetben valószínűleg kívánt tootweak hello alapértelmezett ezekbe a szolgáltatásokba tölt be.</span><span class="sxs-lookup"><span data-stu-id="7c36f-202">In this case, you'd probably want tootweak hello default loads for those services.</span></span> <span data-ttu-id="7c36f-203">Ha metrikák és keresztül jegyzékfájlokban, és meghatározott terhelések szeretné toosupport ebben a forgatókönyvben, azt másik alkalmazás és a szükséges szolgáltatástípusok minden ügyfél esetében.</span><span class="sxs-lookup"><span data-stu-id="7c36f-203">If you have metrics and loads defined via manifests and you want toosupport this scenario, it requires different application and service types for each customer.</span></span> <span data-ttu-id="7c36f-204">a szolgáltatás-létrehozás időpontjában hello értékek felülbírálják a hello jegyzékben meghatározott úgy, hogy tooset hello adott Alapértelmezések használata.</span><span class="sxs-lookup"><span data-stu-id="7c36f-204">hello values defined at service creation time override those defined in hello manifest, so you could use that tooset hello specific defaults.</span></span> <span data-ttu-id="7c36f-205">Azonban történt, amely azt eredményezi, hello értékek hello jegyzékfájlokat toonot egyezést e hello szolgáltatás ténylegesen fut, deklarálva.</span><span class="sxs-lookup"><span data-stu-id="7c36f-205">However, doing that causes hello values declared in hello manifests toonot match those hello service actually runs with.</span></span> <span data-ttu-id="7c36f-206">Ennek eredményeképpen előfordulhat tooconfusion.</span><span class="sxs-lookup"><span data-stu-id="7c36f-206">This can lead tooconfusion.</span></span> 
>

<span data-ttu-id="7c36f-207">Ne feledje: Ha csak toouse hello alapértelmezett metrikák, nem tootouch hello metrikák gyűjtemény minden kell vagy semmit különleges a szolgáltatás létrehozásakor.</span><span class="sxs-lookup"><span data-stu-id="7c36f-207">As a reminder: if you just want toouse hello default metrics, you don’t need tootouch hello metrics collection at all or do anything special when creating your service.</span></span> <span data-ttu-id="7c36f-208">hello alapértelmezett metrikák beolvasása automatikusan használja, ha nincs más vannak definiálva.</span><span class="sxs-lookup"><span data-stu-id="7c36f-208">hello default metrics get used automatically when no others are defined.</span></span> 

<span data-ttu-id="7c36f-209">Most ugorjunk végig részletesebben ezeket a beállításokat, és szolgáltatással kapcsolatban, annak hatását hello viselkedését.</span><span class="sxs-lookup"><span data-stu-id="7c36f-209">Now, let's go through each of these settings in more detail and talk about hello behavior that it influences.</span></span>

## <a name="load"></a><span data-ttu-id="7c36f-210">Betöltés</span><span class="sxs-lookup"><span data-stu-id="7c36f-210">Load</span></span>
<span data-ttu-id="7c36f-211">teljes pont metrikák meghatározásának hello toorepresent van néhány betöltése.</span><span class="sxs-lookup"><span data-stu-id="7c36f-211">hello whole point of defining metrics is toorepresent some load.</span></span> <span data-ttu-id="7c36f-212">*Betöltési* van mennyi egy metrika fel néhány szolgáltatáspéldány vagy egy adott csomópont a replikát.</span><span class="sxs-lookup"><span data-stu-id="7c36f-212">*Load* is how much of a given metric is consumed by some service instance or replica on a given node.</span></span> <span data-ttu-id="7c36f-213">Betöltési szinte minden ponton konfigurálható.</span><span class="sxs-lookup"><span data-stu-id="7c36f-213">Load can be configured at almost any point.</span></span> <span data-ttu-id="7c36f-214">Példa:</span><span class="sxs-lookup"><span data-stu-id="7c36f-214">For example:</span></span>

  - <span data-ttu-id="7c36f-215">Betöltési szolgáltatás létrehozásakor adható meg.</span><span class="sxs-lookup"><span data-stu-id="7c36f-215">Load can be defined when a service is created.</span></span> <span data-ttu-id="7c36f-216">Ez a lehetőség _alapértelmezett betöltési_.</span><span class="sxs-lookup"><span data-stu-id="7c36f-216">This is called _default load_.</span></span>
  - <span data-ttu-id="7c36f-217">hello kapcsolatos metrika-információkat, beleértve az alapértelmezett betölti, az a szolgáltatás frissítése is hello szolgáltatás létrehozása után.</span><span class="sxs-lookup"><span data-stu-id="7c36f-217">hello metric information, including default loads, for a service can updated after hello service is created.</span></span> <span data-ttu-id="7c36f-218">Ez a lehetőség _szolgáltatás frissítése_.</span><span class="sxs-lookup"><span data-stu-id="7c36f-218">This is called _updating a service_.</span></span> 
  - <span data-ttu-id="7c36f-219">egy adott partícióra hello terhelések alaphelyzetbe állítása toohello alapértelmezett értékeket, hogy a szolgáltatás lehet.</span><span class="sxs-lookup"><span data-stu-id="7c36f-219">hello loads for a given partition can be reset toohello default values for that service.</span></span> <span data-ttu-id="7c36f-220">Ez a lehetőség _partícióterhelés_.</span><span class="sxs-lookup"><span data-stu-id="7c36f-220">This is called _resetting partition load_.</span></span>
  - <span data-ttu-id="7c36f-221">Betöltési jelenthetők a egy szolgáltatás objektum alapján dinamikusan futásidőben száma.</span><span class="sxs-lookup"><span data-stu-id="7c36f-221">Load can be reported on a per service object basis dynamically during runtime.</span></span> <span data-ttu-id="7c36f-222">Ez a lehetőség _terhelés reporting_.</span><span class="sxs-lookup"><span data-stu-id="7c36f-222">This is called _reporting load_.</span></span> 
  
<span data-ttu-id="7c36f-223">Az összes alábbi stratégiák hello ugyanaz az élettartama szolgáltatás használhatja.</span><span class="sxs-lookup"><span data-stu-id="7c36f-223">All of these strategies can be used within hello same service over its lifetime.</span></span> 

## <a name="default-load"></a><span data-ttu-id="7c36f-224">Alapértelmezett betöltése</span><span class="sxs-lookup"><span data-stu-id="7c36f-224">Default load</span></span>
<span data-ttu-id="7c36f-225">*Alapértelmezett betöltési* mennyi hello metrika minden szolgáltatás objektum (állapot nélküli példány vagy állapot-nyilvántartó replika) a szolgáltatás-t használ fel.</span><span class="sxs-lookup"><span data-stu-id="7c36f-225">*Default load* is how much of hello metric each service object (stateless instance or stateful replica) of this service consumes.</span></span> <span data-ttu-id="7c36f-226">hello fürt erőforrás-kezelő ennyi amíg nem kap további információkat, például a dinamikus terheléselosztó jelentés hello terhelés hello szolgáltatás objektum használja.</span><span class="sxs-lookup"><span data-stu-id="7c36f-226">hello Cluster Resource Manager uses this number for hello load of hello service object until it receives other information, such as a dynamic load report.</span></span> <span data-ttu-id="7c36f-227">Az egyszerűbb szolgáltatások hello alapértelmezett betöltési egy statikus definíciója.</span><span class="sxs-lookup"><span data-stu-id="7c36f-227">For simpler services, hello default load is a static definition.</span></span> <span data-ttu-id="7c36f-228">hello alapértelmezett betöltési soha nem frissül, és hello élettartama hello szolgáltatás használható.</span><span class="sxs-lookup"><span data-stu-id="7c36f-228">hello default load is never updated and is used for hello lifetime of hello service.</span></span> <span data-ttu-id="7c36f-229">Alapértelmezett betölti működik nagy az egyszerű kapacitástervezési esetek, amikor bizonyos mennyiségű erőforrások dedikált toodifferent munkaterhelés, így nem módosítható.</span><span class="sxs-lookup"><span data-stu-id="7c36f-229">Default loads works great for simple capacity planning scenarios where certain amounts of resources are dedicated toodifferent workloads and do not change.</span></span>

> [!NOTE]
> <span data-ttu-id="7c36f-230">A kapacitás felügyeleti és a kapacitások hello csomópontok meghatározása a fürt további információkért lásd: [Ez a cikk](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span><span class="sxs-lookup"><span data-stu-id="7c36f-230">For more information on capacity management and defining capacities for hello nodes in your cluster, please see [this article](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span></span>
> 

<span data-ttu-id="7c36f-231">hello fürt erőforrás-kezelő lehetővé teszi az állapotalapú szolgáltatások toospecify egy másik alapértelmezett betöltési az elsődleges és másodlagos.</span><span class="sxs-lookup"><span data-stu-id="7c36f-231">hello Cluster Resource Manager allows stateful services toospecify a different default load for their Primaries and Secondaries.</span></span> <span data-ttu-id="7c36f-232">Állapotmentes szolgáltatásokhoz csak tooall példányok alkalmazó egy értéket lehet megadni.</span><span class="sxs-lookup"><span data-stu-id="7c36f-232">Stateless services can only specify one value that applies tooall instances.</span></span> <span data-ttu-id="7c36f-233">Állapotalapú szolgáltatások esetén az elsődleges és másodlagos replikák hello alapértelmezett betöltési eltérőek általában óta replikák hajtsa végre az egyes szerepkörökhöz munkahelyi különböző típusú.</span><span class="sxs-lookup"><span data-stu-id="7c36f-233">For stateful services, hello default load for Primary and Secondary replicas are typically different since replicas do different kinds of work in each role.</span></span> <span data-ttu-id="7c36f-234">Például elsődleges általában mind az Olvasás, mind az írás szolgálnak, és többségének hello számítási terhet, miközben a másodlagos adatbázisok azonban nem.</span><span class="sxs-lookup"><span data-stu-id="7c36f-234">For example, Primaries usually serve both reads and writes, and handle most of hello computational burden, while secondaries do not.</span></span> <span data-ttu-id="7c36f-235">Általában egy elsődleges replika hello alapértelmezett betöltési értéke magasabb, mint a másodlagos replikák hello alapértelmezett betöltési.</span><span class="sxs-lookup"><span data-stu-id="7c36f-235">Usually hello default load for a primary replica is higher than hello default load for secondary replicas.</span></span> <span data-ttu-id="7c36f-236">hello valós számok saját mérések függ.</span><span class="sxs-lookup"><span data-stu-id="7c36f-236">hello real numbers should depend on your own measurements.</span></span>

## <a name="dynamic-load"></a><span data-ttu-id="7c36f-237">Dinamikus terheléselosztó</span><span class="sxs-lookup"><span data-stu-id="7c36f-237">Dynamic load</span></span>
<span data-ttu-id="7c36f-238">Tegyük fel, hogy Ön már futott a szolgáltatás egy ideig.</span><span class="sxs-lookup"><span data-stu-id="7c36f-238">Let’s say that you’ve been running your service for a while.</span></span> <span data-ttu-id="7c36f-239">Az egyes figyeléssel, amikor észrevette, hogy:</span><span class="sxs-lookup"><span data-stu-id="7c36f-239">With some monitoring, you’ve noticed that:</span></span>

1. <span data-ttu-id="7c36f-240">Mint mások egyes partíciók vagy egy megadott szolgáltatás példányának több erőforrást</span><span class="sxs-lookup"><span data-stu-id="7c36f-240">Some partitions or instances of a given service consume more resources than others</span></span>
2. <span data-ttu-id="7c36f-241">Egyes szolgáltatások időnként eltérő terhelést rendelkeznek.</span><span class="sxs-lookup"><span data-stu-id="7c36f-241">Some services have load that varies over time.</span></span>

<span data-ttu-id="7c36f-242">Nincs nagy mennyiségű dolog, ami ilyen típusú terheléselosztási ingadozását.</span><span class="sxs-lookup"><span data-stu-id="7c36f-242">There's lots of things that could cause these types of load fluctuations.</span></span> <span data-ttu-id="7c36f-243">Például különböző szolgáltatásokat vagy partíciók társított eltérő követelményekkel rendelkező, különböző ügyfelektől.</span><span class="sxs-lookup"><span data-stu-id="7c36f-243">For example, different services or partitions are associated with different customers with different requirements.</span></span> <span data-ttu-id="7c36f-244">Betöltési is volt módosítani, mert a munkahelyi hello szolgáltatás hello mennyisége hello nap hello folyamán változik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-244">Load could also change because hello amount of work hello service does varies over hello course of hello day.</span></span> <span data-ttu-id="7c36f-245">Függetlenül hello OK akkor általában egyetlen szám nem használhatja az alapértelmezett.</span><span class="sxs-lookup"><span data-stu-id="7c36f-245">Regardless of hello reason, there’s usually no single number that you can use for default.</span></span> <span data-ttu-id="7c36f-246">Ez különösen igaz, ha azt szeretné, tooget hello hello fürtön kívüli legtöbb kihasználtságát.</span><span class="sxs-lookup"><span data-stu-id="7c36f-246">This is especially true if you want tooget hello most utilization out of hello cluster.</span></span> <span data-ttu-id="7c36f-247">Az alapértelmezett betöltési probléma néhány hello idő válasszon értéket.</span><span class="sxs-lookup"><span data-stu-id="7c36f-247">Any value you pick for default load is wrong some of hello time.</span></span> <span data-ttu-id="7c36f-248">Helytelen alapértelmezett betölti hello fürt erőforrás-kezelő erőforrások lefoglalása alatt vagy fölött eredményez.</span><span class="sxs-lookup"><span data-stu-id="7c36f-248">Incorrect default loads result in hello Cluster Resource Manager either over or under allocating resources.</span></span> <span data-ttu-id="7c36f-249">Ennek eredményeképpen a csomópontokra, amelyeket felett vagy alatt felhasználtuk annak ellenére, hogy a fürt erőforrás-kezelő hello úgy értelmezi hello fürt kiegyensúlyozott rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-249">As a result, you have nodes that are over or under utilized even though hello Cluster Resource Manager thinks hello cluster is balanced.</span></span> <span data-ttu-id="7c36f-250">Alapértelmezett terhelés továbbra is megfelelőek, mivel a kezdeti elhelyezésre néhány információt biztosítanak, de nem valódi munkaterhelések teljes szövegegység fontosságúak.</span><span class="sxs-lookup"><span data-stu-id="7c36f-250">Default loads are still good since they provide some information for initial placement, but they're not a complete story for real workloads.</span></span> <span data-ttu-id="7c36f-251">erőforrás-követelmények és erőforrás-kezelő fürt hello módosítása tooaccurately rögzítési lehetővé teszi, hogy minden egyes szolgáltatás objektum tooupdate saját terhelést futásidőben.</span><span class="sxs-lookup"><span data-stu-id="7c36f-251">tooaccurately capture changing resource requirements, hello Cluster Resource Manager allows each service object tooupdate its own load during runtime.</span></span> <span data-ttu-id="7c36f-252">Ezt nevezik a dinamikus terheléselosztó jelentéskészítési.</span><span class="sxs-lookup"><span data-stu-id="7c36f-252">This is called dynamic load reporting.</span></span>

<span data-ttu-id="7c36f-253">A dinamikus terheléselosztási jelentések metrikákat a foglalási/jelentett betöltése lehetővé replikák és példányok tooadjust az élettartamuk során.</span><span class="sxs-lookup"><span data-stu-id="7c36f-253">Dynamic load reports allow replicas or instances tooadjust their allocation/reported load of metrics over their lifetime.</span></span> <span data-ttu-id="7c36f-254">A szolgáltatás replika vagy a cold és a nem végzett munka volt példány általában küldenek, hogy egy metrika kis mennyiségű használta.</span><span class="sxs-lookup"><span data-stu-id="7c36f-254">A service replica or instance that was cold and not doing any work would usually report that it was using low amounts of a given metric.</span></span> <span data-ttu-id="7c36f-255">Egy foglalt replika- vagy küldenek, hogy használják több.</span><span class="sxs-lookup"><span data-stu-id="7c36f-255">A busy replica or instance would report that they are using more.</span></span>

<span data-ttu-id="7c36f-256">Betöltés / replika- vagy jelentéskészítő lehetővé teszi a fürt erőforrás-kezelő tooreorganize hello hello szolgáltatás objektumok hello fürtben.</span><span class="sxs-lookup"><span data-stu-id="7c36f-256">Reporting load per replica or instance allows hello Cluster Resource Manager tooreorganize hello individual service objects in hello cluster.</span></span> <span data-ttu-id="7c36f-257">Hello szolgáltatások átrendezése segít biztosítjuk, hogy hello erőforrások van szükségük.</span><span class="sxs-lookup"><span data-stu-id="7c36f-257">Reorganizing hello services helps ensure that they get hello resources they require.</span></span> <span data-ttu-id="7c36f-258">Foglalt szolgáltatások hatékonyan beolvasása túl "VISSZAIGÉNYLÉSE" erőforrásokat más replikákat vagy a számlálókat, amelyek jelenleg a gyenge vagy kevesebb munka során.</span><span class="sxs-lookup"><span data-stu-id="7c36f-258">Busy services effectively get too"reclaim" resources from other replicas or instances that are currently cold or doing less work.</span></span>

<span data-ttu-id="7c36f-259">Reliable Services belül hello kód tooreport terhelés dinamikusan néz ki:</span><span class="sxs-lookup"><span data-stu-id="7c36f-259">Within Reliable Services, hello code tooreport load dynamically looks like this:</span></span>

<span data-ttu-id="7c36f-260">Kód:</span><span class="sxs-lookup"><span data-stu-id="7c36f-260">Code:</span></span>

```csharp
this.Partition.ReportLoad(new List<LoadMetric> { new LoadMetric("CurrentConnectionCount", 1234), new LoadMetric("metric1", 42) });
```

<span data-ttu-id="7c36f-261">A szolgáltatás bármely hello metrikák létrehozáskor definiálva hozzá is tud jelentéseket.</span><span class="sxs-lookup"><span data-stu-id="7c36f-261">A service can report on any of hello metrics defined for it at creation time.</span></span> <span data-ttu-id="7c36f-262">Ha olyan metrikajelentés, amely nem egy szolgáltatás jelentések terheléselosztási toouse konfigurálva, a Service Fabric, amelyek jelentést készítenek figyelmen kívül hagyja.</span><span class="sxs-lookup"><span data-stu-id="7c36f-262">If a service reports load for a metric that it is not configured toouse, Service Fabric ignores that report.</span></span> <span data-ttu-id="7c36f-263">Ha nincsenek más metrikák jelentett hello azonos idő, amelyek érvényesek a jelentések elfogadottak.</span><span class="sxs-lookup"><span data-stu-id="7c36f-263">If there are other metrics reported at hello same time that are valid, those reports are accepted.</span></span> <span data-ttu-id="7c36f-264">Szolgáltatás kódot mérésére és jelentés összes hello metrikák tudja, hogyan és operátorok adhat meg hello konfigurációja toouse toochange hello szolgáltatást kód nélkül.</span><span class="sxs-lookup"><span data-stu-id="7c36f-264">Service code can measure and report all hello metrics it knows how to, and operators can specify hello metric configuration toouse without having toochange hello service code.</span></span> 

### <a name="updating-a-services-metric-configuration"></a><span data-ttu-id="7c36f-265">A szolgáltatási metrika-konfigurációjának frissítése</span><span class="sxs-lookup"><span data-stu-id="7c36f-265">Updating a service's metric configuration</span></span>
<span data-ttu-id="7c36f-266">hello szolgáltatással kapcsolatos metrikákat hello listáját, és ezek metrikák hello tulajdonságainak frissíthető dinamikusan élő hello szolgáltatás pedig.</span><span class="sxs-lookup"><span data-stu-id="7c36f-266">hello list of metrics associated with hello service, and hello properties of those metrics can be updated dynamically while hello service is live.</span></span> <span data-ttu-id="7c36f-267">Ez lehetővé teszi, hogy kísérletezhet és rugalmasságot.</span><span class="sxs-lookup"><span data-stu-id="7c36f-267">This allows for experimentation and flexibility.</span></span> <span data-ttu-id="7c36f-268">Néhány példa, ha ez akkor hasznos, amelyek:</span><span class="sxs-lookup"><span data-stu-id="7c36f-268">Some examples of when this is useful are:</span></span>

  - <span data-ttu-id="7c36f-269">a metrika egy adott szolgáltatáshoz buggy jelentést letiltása</span><span class="sxs-lookup"><span data-stu-id="7c36f-269">disabling a metric with a buggy report for a particular service</span></span>
  - <span data-ttu-id="7c36f-270">a kívánt viselkedés alapján metrikák hello súlyozását újrakonfigurálása</span><span class="sxs-lookup"><span data-stu-id="7c36f-270">reconfiguring hello weights of metrics based on desired behavior</span></span>
  - <span data-ttu-id="7c36f-271">csak azután hello kódot már telepítve és érvényesítve, más mechanizmusok használatával, amely lehetővé teszi, hogy egy új metrika</span><span class="sxs-lookup"><span data-stu-id="7c36f-271">enabling a new metric only after hello code has already been deployed and validated via other mechanisms</span></span>
  - <span data-ttu-id="7c36f-272">hello alapértelmezett betöltési megfigyelt viselkedést és fogyasztás alapján szolgáltatás módosítása</span><span class="sxs-lookup"><span data-stu-id="7c36f-272">changing hello default load for a service based on observed behavior and consumption</span></span>

<span data-ttu-id="7c36f-273">hello fő API-k konfigurációja módosítására van `FabricClient.ServiceManagementClient.UpdateServiceAsync` C# és `Update-ServiceFabricService` a PowerShellben.</span><span class="sxs-lookup"><span data-stu-id="7c36f-273">hello main APIs for changing metric configuration are `FabricClient.ServiceManagementClient.UpdateServiceAsync` in C# and `Update-ServiceFabricService` in PowerShell.</span></span> <span data-ttu-id="7c36f-274">Bármilyen ezen API-k a megadott információ azonnal lecseréli a meglévő metrika adatainak hello hello szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="7c36f-274">Whatever information you specify with these APIs replaces hello existing metric information for hello service immediately.</span></span> 

## <a name="mixing-default-load-values-and-dynamic-load-reports"></a><span data-ttu-id="7c36f-275">Alapértelmezett betöltése értékeket és a dinamikus terheléselosztó jelentések keverése</span><span class="sxs-lookup"><span data-stu-id="7c36f-275">Mixing default load values and dynamic load reports</span></span>
<span data-ttu-id="7c36f-276">Alapértelmezett betöltési és dinamikus terhelések használható hello ugyanazt a szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="7c36f-276">Default load and dynamic loads can be used for hello same service.</span></span> <span data-ttu-id="7c36f-277">Egy szolgáltatás használja az alapértelmezett betöltési és a dinamikus terheléselosztó jelentések, amikor alapértelmezett betöltési lesz becsült csak dinamikus jelentéseket jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="7c36f-277">When a service utilizes both default load and dynamic load reports, default load serves as an estimate until dynamic reports show up.</span></span> <span data-ttu-id="7c36f-278">Alapértelmezett betöltési nem megfelelő, mert biztosít hello fürt erőforrás-kezelő valamit a toowork.</span><span class="sxs-lookup"><span data-stu-id="7c36f-278">Default load is good because it gives hello Cluster Resource Manager something toowork with.</span></span> <span data-ttu-id="7c36f-279">hello alapértelmezett betöltési lehetővé teszi, hogy hello fürt erőforrás-kezelő tooplace jó helyeken hello szolgáltatás objektumok azok létrehozásakor.</span><span class="sxs-lookup"><span data-stu-id="7c36f-279">hello default load allows hello Cluster Resource Manager tooplace hello service objects in good locations when they are created.</span></span> <span data-ttu-id="7c36f-280">Ha nem alapértelmezett betöltési információ áll rendelkezésre, hatékonyan véletlenszerű szolgáltatások elhelyezését.</span><span class="sxs-lookup"><span data-stu-id="7c36f-280">If no default load information is provided, placement of services is effectively random.</span></span> <span data-ttu-id="7c36f-281">Betöltési jelentések érkezésekor később hello kezdeti véletlenszerű elhelyezési gyakran nem megfelelő, és hello fürt erőforrás-kezelő rendelkezik toomove szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="7c36f-281">When load reports arrive later hello initial random placement is often wrong and hello Cluster Resource Manager has toomove services.</span></span>

<span data-ttu-id="7c36f-282">Most eltarthat korábbi példában, és tekintse meg, mi történik, ha jelenleg az egyes egyéni metrikák és a dinamikus terheléselosztó jelentéskészítési felvenni.</span><span class="sxs-lookup"><span data-stu-id="7c36f-282">Let’s take our previous example and see what happens when we add some custom metrics and dynamic load reporting.</span></span> <span data-ttu-id="7c36f-283">Ebben a példában a "MemoryInMb", egy példa a metrika használjuk.</span><span class="sxs-lookup"><span data-stu-id="7c36f-283">In this example, we use “MemoryInMb” as an example metric.</span></span>

> [!NOTE]
> <span data-ttu-id="7c36f-284">Memória egyike, amelyek a Service Fabric hello rendszer metrikák [erőforrás szabályozására](service-fabric-resource-governance.md), és a saját kezűleg reporting általában nehéz.</span><span class="sxs-lookup"><span data-stu-id="7c36f-284">Memory is one of hello system metrics that Service Fabric can [resource govern](service-fabric-resource-governance.md), and reporting it yourself is typically difficult.</span></span> <span data-ttu-id="7c36f-285">Nem ténylegesen várhatóan meg tooreport a memória-felhasználás; Felhasznált memória egy az erőforrás-kezelő fürt hello hello képességekre vonatkozó támogatási toolearning-ként.</span><span class="sxs-lookup"><span data-stu-id="7c36f-285">We don't actually expect you tooreport on Memory consumption; Memory is used here as an aid toolearning about hello capabilities of hello Cluster Resource Manager.</span></span>
>

<span data-ttu-id="7c36f-286">Most feltételezik, eredetileg létrehozott hello állapotalapú szolgáltatás a hello a következő parancsot:</span><span class="sxs-lookup"><span data-stu-id="7c36f-286">Let’s presume that we initially created hello stateful service with hello following command:</span></span>

<span data-ttu-id="7c36f-287">PowerShell:</span><span class="sxs-lookup"><span data-stu-id="7c36f-287">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("MemoryInMb,High,21,11”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

<span data-ttu-id="7c36f-288">Ne feledje a szintaxisa ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span><span class="sxs-lookup"><span data-stu-id="7c36f-288">As a reminder, this syntax is ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span></span>

<span data-ttu-id="7c36f-289">Nézzük meg, milyen egyik lehetséges fürt elrendezés nézhet:</span><span class="sxs-lookup"><span data-stu-id="7c36f-289">Let's see what one possible cluster layout could look like:</span></span>

<span data-ttu-id="7c36f-290"><center>
![Az alapértelmezett és egyéni metrikák fürt kiegyensúlyozott][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="7c36f-290"><center>
![Cluster Balanced with both Default and Custom metrics][Image2]
</center></span></span>

<span data-ttu-id="7c36f-291">Bizonyos tényezőket érdemes megjegyezni vannak:</span><span class="sxs-lookup"><span data-stu-id="7c36f-291">Some things that are worth noting:</span></span>

* <span data-ttu-id="7c36f-292">Másodlagos replikák a partíción belüli egyes rendelkezhet saját betöltése</span><span class="sxs-lookup"><span data-stu-id="7c36f-292">Secondary replicas within a partition can each have their own load</span></span>
* <span data-ttu-id="7c36f-293">A teljes hello metrikák hely kiegyensúlyozott.</span><span class="sxs-lookup"><span data-stu-id="7c36f-293">Overall hello metrics look balanced.</span></span> <span data-ttu-id="7c36f-294">Memória, a hello maximális hello aránya, és minimális terhelés 1,75 összeget (hello csomópont hello a legtöbb terhelés N3, hello legalább N2 és 28/16 = 1,75 összeget).</span><span class="sxs-lookup"><span data-stu-id="7c36f-294">For Memory, hello ratio between hello maximum and minimum load is 1.75 (hello node with hello most load is N3, hello least is N2, and 28/16 = 1.75).</span></span>

<span data-ttu-id="7c36f-295">Néhány dolgot, hogy továbbra is kell tooexplain:</span><span class="sxs-lookup"><span data-stu-id="7c36f-295">There are some things that we still need tooexplain:</span></span>

* <span data-ttu-id="7c36f-296">Mi határozza meg, hogy 1,75 összeget arányú logikus volt-e vagy sem?</span><span class="sxs-lookup"><span data-stu-id="7c36f-296">What determined whether a ratio of 1.75 was reasonable or not?</span></span> <span data-ttu-id="7c36f-297">Honnan, a fürt erőforrás-kezelő hello a esetén is, hogy elég helyes, vagy ha nincs a további munkahelyi toodo?</span><span class="sxs-lookup"><span data-stu-id="7c36f-297">How does hello Cluster Resource Manager know if that’s good enough or if there is more work toodo?</span></span>
* <span data-ttu-id="7c36f-298">Ha nem terheléselosztás fordulhat elő?</span><span class="sxs-lookup"><span data-stu-id="7c36f-298">When does balancing happen?</span></span>
* <span data-ttu-id="7c36f-299">Mit jelent, hogy memória "Magas" súlyozott-e?</span><span class="sxs-lookup"><span data-stu-id="7c36f-299">What does it mean that Memory was weighted “High”?</span></span>

## <a name="metric-weights"></a><span data-ttu-id="7c36f-300">Metrika súlyozás</span><span class="sxs-lookup"><span data-stu-id="7c36f-300">Metric weights</span></span>
<span data-ttu-id="7c36f-301">Nyomkövetési hello azonos fontos metrikák különböző szolgáltatásban.</span><span class="sxs-lookup"><span data-stu-id="7c36f-301">Tracking hello same metrics across different services is important.</span></span> <span data-ttu-id="7c36f-302">Globális nézet fogja hello fürt erőforrás-kezelő tootrack fogyasztás hello fürt, fogyasztás egyensúlyba csomópontok, és győződjön meg arról, hogy a csomópontok nem ismerteti a kapacitás lehetővé teszi.</span><span class="sxs-lookup"><span data-stu-id="7c36f-302">That global view is what allows hello Cluster Resource Manager tootrack consumption in hello cluster, balance consumption across nodes, and ensure that nodes don’t go over capacity.</span></span> <span data-ttu-id="7c36f-303">Azonban szolgáltatások lehet különböző nézeteket hello toohello fontosságát azonos metrikát.</span><span class="sxs-lookup"><span data-stu-id="7c36f-303">However, services may have different views as toohello importance of hello same metric.</span></span> <span data-ttu-id="7c36f-304">Is számos metrikák és szolgáltatásokat nagyszámú a fürtben, tökéletesen kiegyensúlyozott megoldások nem létezik az összes metrikát.</span><span class="sxs-lookup"><span data-stu-id="7c36f-304">Also, in a cluster with many metrics and lots of services, perfectly balanced solutions may not exist for all metrics.</span></span> <span data-ttu-id="7c36f-305">Hogyan kezelje a fürt erőforrás-kezelő hello ezekben a helyzetekben?</span><span class="sxs-lookup"><span data-stu-id="7c36f-305">How should hello Cluster Resource Manager handle these situations?</span></span>

<span data-ttu-id="7c36f-306">Metrika súlyok hello hogyan toobalance hello fürtön, amikor nincs tökéletes válasz fürt erőforrás-kezelő toodecide engedélyezése.</span><span class="sxs-lookup"><span data-stu-id="7c36f-306">Metric weights allow hello Cluster Resource Manager toodecide how toobalance hello cluster when there’s no perfect answer.</span></span> <span data-ttu-id="7c36f-307">Metrika súlyok is hello fürt erőforrás-kezelő toobalance adott szolgáltatások engedélyezése másképp.</span><span class="sxs-lookup"><span data-stu-id="7c36f-307">Metric weights also allow hello Cluster Resource Manager toobalance specific services differently.</span></span> <span data-ttu-id="7c36f-308">Metrikák rendelkezhet négy különböző súly szint: nulla, alacsony, közepes és magas.</span><span class="sxs-lookup"><span data-stu-id="7c36f-308">Metrics can have four different weight levels: Zero, Low, Medium, and High.</span></span> <span data-ttu-id="7c36f-309">Az egyik súlya nulla metrika hozzájárul semmi annak eldöntéséhez, hogy e dolgok vagy nem elosztott terhelésű.</span><span class="sxs-lookup"><span data-stu-id="7c36f-309">A metric with a weight of Zero contributes nothing when considering whether things are balanced or not.</span></span> <span data-ttu-id="7c36f-310">A betöltési azonban továbbra is közreműködhet toocapacity felügyeleti.</span><span class="sxs-lookup"><span data-stu-id="7c36f-310">However, its load does still contribute toocapacity management.</span></span> <span data-ttu-id="7c36f-311">Nulla súly metrikák továbbra is hasznosak, és gyakran használják a szolgáltatás-viselkedéshez és a teljesítmény figyelése részeként.</span><span class="sxs-lookup"><span data-stu-id="7c36f-311">Metrics with Zero weight are still useful and are frequently used as a part of service behavior and performance monitoring.</span></span> <span data-ttu-id="7c36f-312">[Ez a cikk](service-fabric-diagnostics-event-generation-infra.md) figyelés metrikák hello használata, és a szolgáltatások diagnosztikai nyújt részletesebb információt.</span><span class="sxs-lookup"><span data-stu-id="7c36f-312">[This article](service-fabric-diagnostics-event-generation-infra.md) provides more information on hello use of metrics for monitoring and diagnostics of your services.</span></span> 

<span data-ttu-id="7c36f-313">hello fürt különböző metrika súlya hello valós hatása, a fürt erőforrás-kezelő hello különböző megoldások állít elő.</span><span class="sxs-lookup"><span data-stu-id="7c36f-313">hello real impact of different metric weights in hello cluster is that hello Cluster Resource Manager generates different solutions.</span></span> <span data-ttu-id="7c36f-314">Metrika súlyok mondja el hello fürt erőforrás-kezelő, hogy bizonyos metrikák fontosabbak, mint mások.</span><span class="sxs-lookup"><span data-stu-id="7c36f-314">Metric weights tell hello Cluster Resource Manager that certain metrics are more important than others.</span></span> <span data-ttu-id="7c36f-315">Nincs tökéletes megoldás hello esetén a fürt erőforrás-kezelő is előnyben részesítik a megoldást, amely hello magasabb súlyozott metrikák jobb elosztása.</span><span class="sxs-lookup"><span data-stu-id="7c36f-315">When there's no perfect solution hello Cluster Resource Manager can prefer solutions which balance hello higher weighted metrics better.</span></span> <span data-ttu-id="7c36f-316">Ha a szolgáltatás úgy értelmezi, egy adott metrika nem lényeges, csak, akkor imbalanced tapasztalhatja, hogy a metrika használatát.</span><span class="sxs-lookup"><span data-stu-id="7c36f-316">If a service thinks a particular metric is unimportant, it may find their use of that metric imbalanced.</span></span> <span data-ttu-id="7c36f-317">Ez lehetővé teszi egy másik szolgáltatás tooget az egyes mérőszám, amely fontos tooit még akkor is, terjesztési.</span><span class="sxs-lookup"><span data-stu-id="7c36f-317">This allows another service tooget an even distribution of some metric that is important tooit.</span></span>

<span data-ttu-id="7c36f-318">Példa néhány terhelés jelentések és a különböző metrika nézzük súlyozza hello fürt különböző azonosítóból eredményez.</span><span class="sxs-lookup"><span data-stu-id="7c36f-318">Let’s look at an example of some load reports and how different metric weights results in different allocations in hello cluster.</span></span> <span data-ttu-id="7c36f-319">Ebben a példában látható, hogy hello relatív súly hello mérőszámokat váltás hatására hello fürt erőforrás-kezelő toocreate szolgáltatások különböző szabályok.</span><span class="sxs-lookup"><span data-stu-id="7c36f-319">In this example, we see that switching hello relative weight of hello metrics causes hello Cluster Resource Manager toocreate different arrangements of services.</span></span>

<span data-ttu-id="7c36f-320"><center>
![Metrika súlyának példa és a hatása a terheléselosztási megoldások][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="7c36f-320"><center>
![Metric Weight Example and Its Impact on Balancing Solutions][Image3]
</center></span></span>

<span data-ttu-id="7c36f-321">Ebben a példában nincsenek négy különböző szolgáltatások, a két különböző metrika, MetricA és MetricB összes jelentéskészítési eltérő értékeket.</span><span class="sxs-lookup"><span data-stu-id="7c36f-321">In this example, there are four different services, all reporting different values for two different metrics, MetricA and MetricB.</span></span> <span data-ttu-id="7c36f-322">Egy esetben minden hello szolgáltatás MetricA határozza meg, hello legfontosabb egy (súly = kiváló) és MetricB, mint a lényeges, csak (súly = alacsony).</span><span class="sxs-lookup"><span data-stu-id="7c36f-322">In one case, all hello services define MetricA is hello most important one (Weight = High) and MetricB as unimportant (Weight = Low).</span></span> <span data-ttu-id="7c36f-323">Ennek eredményeképpen látható, hogy hello fürt erőforrás-kezelő hello szolgáltatások helyezi el, hogy MetricA nagyobb mint MetricB kiegyensúlyozott.</span><span class="sxs-lookup"><span data-stu-id="7c36f-323">As a result, we see that hello Cluster Resource Manager places hello services so that MetricA is better balanced than MetricB.</span></span> <span data-ttu-id="7c36f-324">"Jobban kiegyensúlyozott" azt jelenti, hogy rendelkezik-e alsó MetricA a alacsonyabb, mint MetricB szórás rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-324">"Better balanced" means that MetricA has a lower has a lower standard deviation than MetricB.</span></span> <span data-ttu-id="7c36f-325">Hello második esetben azt hello metrika súlyok fordított irányú.</span><span class="sxs-lookup"><span data-stu-id="7c36f-325">In hello second case, we reverse hello metric weights.</span></span> <span data-ttu-id="7c36f-326">Ennek eredményeképpen hello fürt erőforrás-kezelő cseréje szolgáltatások A és B toocome fel, ahol jobban az elosztott terhelésű mint MetricA MetricB hozzárendelését.</span><span class="sxs-lookup"><span data-stu-id="7c36f-326">As a result, hello Cluster Resource Manager swaps services A and B toocome up with an allocation where MetricB is better balanced than MetricA.</span></span>

> [!NOTE]
> <span data-ttu-id="7c36f-327">Metrika súlyok határozza meg, hogyan kell terheléselosztást hello fürt erőforrás-kezelő, de nem amikor terheléselosztás történjen.</span><span class="sxs-lookup"><span data-stu-id="7c36f-327">Metric weights determine how hello Cluster Resource Manager should balance, but not when balancing should happen.</span></span> <span data-ttu-id="7c36f-328">A terheléselosztás további információkért tekintse meg [Ez a cikk](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="7c36f-328">For more information on balancing, check out [this article](service-fabric-cluster-resource-manager-balancing.md)</span></span>
>

### <a name="global-metric-weights"></a><span data-ttu-id="7c36f-329">Globális metrika súlyozás</span><span class="sxs-lookup"><span data-stu-id="7c36f-329">Global metric weights</span></span>
<span data-ttu-id="7c36f-330">Tegyük fel, ServiceA meghatározása szerint nagy súlyozási MetricA, és ServiceB beállítja hello súlya MetricA tooLow vagy nulla.</span><span class="sxs-lookup"><span data-stu-id="7c36f-330">Let's say ServiceA defines MetricA as weight High, and ServiceB sets hello weight for MetricA tooLow or Zero.</span></span> <span data-ttu-id="7c36f-331">Mi az a hello tényleges súly említi használnak?</span><span class="sxs-lookup"><span data-stu-id="7c36f-331">What’s hello actual weight that ends up getting used?</span></span>

<span data-ttu-id="7c36f-332">Nincsenek minden mérőszám nyomon követett több súlyt.</span><span class="sxs-lookup"><span data-stu-id="7c36f-332">There are multiple weights that are tracked for every metric.</span></span> <span data-ttu-id="7c36f-333">hello első súly hello több hello szolgáltatás létrehozásakor hello metrika definiálva.</span><span class="sxs-lookup"><span data-stu-id="7c36f-333">hello first weight is hello one defined for hello metric when hello service is created.</span></span> <span data-ttu-id="7c36f-334">hello más súly a globális weight kiszámítása automatikusan történik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-334">hello other weight is a global weight, which is computed automatically.</span></span> <span data-ttu-id="7c36f-335">hello fürt erőforrás-kezelő mindkét e súlyok használja, ha a megoldások pontozási.</span><span class="sxs-lookup"><span data-stu-id="7c36f-335">hello Cluster Resource Manager uses both these weights when scoring solutions.</span></span> <span data-ttu-id="7c36f-336">Fontos, mindkét súlyok figyelembe véve.</span><span class="sxs-lookup"><span data-stu-id="7c36f-336">Taking both weights into account is important.</span></span> <span data-ttu-id="7c36f-337">Ez lehetővé teszi hello fürt erőforrás-kezelő toobalance minden szolgáltatással, függően tooits prioritások saját, és gondoskodjon arról is hello fürthöz, a teljes megfelelően van lefoglalva.</span><span class="sxs-lookup"><span data-stu-id="7c36f-337">This allows hello Cluster Resource Manager toobalance each service according tooits own priorities, and also ensure that hello cluster as a whole is allocated correctly.</span></span>

<span data-ttu-id="7c36f-338">Mi történne hello fürt erőforrás-kezelő nem érdeklik a globális és a helyi egyenleg?</span><span class="sxs-lookup"><span data-stu-id="7c36f-338">What would happen if hello Cluster Resource Manager didn’t care about both global and local balance?</span></span> <span data-ttu-id="7c36f-339">Jól könnyen tooconstruct megoldásokat, amely globálisan elosztott terhelésű, de az erőforrások egyensúlyára az egyes szolgáltatások eredményező.</span><span class="sxs-lookup"><span data-stu-id="7c36f-339">Well, it’s easy tooconstruct solutions that are globally balanced, but which result in poor resource balance for individual services.</span></span> <span data-ttu-id="7c36f-340">A következő példa hello most nézze meg a szolgáltatás csak a hello alapértelmezett metrikák konfigurálva, és mi történik, ha csak globális egyenleg tekinthető. lásd:</span><span class="sxs-lookup"><span data-stu-id="7c36f-340">In hello following example, let’s look at a service configured with just hello default metrics, and see what happens when only global balance is considered:</span></span>

<span data-ttu-id="7c36f-341"><center>
![hello globális csak megoldást hatása][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="7c36f-341"><center>
![hello Impact of a Global Only Solution][Image4]
</center></span></span>

<span data-ttu-id="7c36f-342">Hello felső példában csak a globális elosztás alapján hello fürt egészére valóban átgondolni.</span><span class="sxs-lookup"><span data-stu-id="7c36f-342">In hello top example based only on global balance, hello cluster as a whole is indeed balanced.</span></span> <span data-ttu-id="7c36f-343">Összes számítógépen legyen ugyanaz az elsődleges számolja, és azonos hello hello teljes replikák száma.</span><span class="sxs-lookup"><span data-stu-id="7c36f-343">All nodes have hello same count of primaries and hello same number total replicas.</span></span> <span data-ttu-id="7c36f-344">Azonban ha megnézi a foglalási hello tényleges hatása nincs így jó: hello adatvesztés minden csomópont befolyásolja egy adott munkaterhelés aránytalanul, mert az elsődleges kijelentkezik vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="7c36f-344">However, if you look at hello actual impact of this allocation it’s not so good: hello loss of any node impacts a particular workload disproportionately, because it takes out all of its primaries.</span></span> <span data-ttu-id="7c36f-345">Például hello első csomópont meghibásodásakor hello három elsődleges hello három különböző partíciók hello kör szolgáltatás az összes lenne elveszett.</span><span class="sxs-lookup"><span data-stu-id="7c36f-345">For example, if hello first node fails hello three primaries for hello three different partitions of hello Circle service would all be lost.</span></span> <span data-ttu-id="7c36f-346">Ezzel ellentétben az hello háromszög és hatszög szolgáltatások az a replika elveszítik partíciókkal rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="7c36f-346">Conversely, hello Triangle and Hexagon services have their partitions lose a replica.</span></span> <span data-ttu-id="7c36f-347">Ez azt eredményezi, hogy nincs megszűnésének eltérő toorecover hello replika le kellene.</span><span class="sxs-lookup"><span data-stu-id="7c36f-347">This causes no disruption, other than having toorecover hello down replica.</span></span>

<span data-ttu-id="7c36f-348">Hello alsó példában hello fürt erőforrás-kezelő hello replikák mindkét hello globális és a szolgáltatás elosztás alapján van osztva.</span><span class="sxs-lookup"><span data-stu-id="7c36f-348">In hello bottom example, hello Cluster Resource Manager has distributed hello replicas based on both hello global and per-service balance.</span></span> <span data-ttu-id="7c36f-349">Hello megoldás hello pontszám kiszámítása során legtöbb hello súly toohello globális megoldást, és egy (konfigurálható) rész tooindividual szolgáltatásokat biztosít.</span><span class="sxs-lookup"><span data-stu-id="7c36f-349">When calculating hello score of hello solution it gives most of hello weight toohello global solution, and a (configurable) portion tooindividual services.</span></span> <span data-ttu-id="7c36f-350">Metrika globális elosztás alapján van kiszámítva hello átlagos hello metrika súlyok minden szolgáltatásból.</span><span class="sxs-lookup"><span data-stu-id="7c36f-350">Global balance for a metric is calculated based on hello average of hello metric weights from each service.</span></span> <span data-ttu-id="7c36f-351">Minden szolgáltatás kiegyensúlyozott függően tooits meghatározott saját metrika súlyt.</span><span class="sxs-lookup"><span data-stu-id="7c36f-351">Each service is balanced according tooits own defined metric weights.</span></span> <span data-ttu-id="7c36f-352">Ez biztosítja, hogy hello szolgáltatások elosztását belül maguk tootheir saját igényeinek megfelelően.</span><span class="sxs-lookup"><span data-stu-id="7c36f-352">This ensures that hello services are balanced within themselves according tootheir own needs.</span></span> <span data-ttu-id="7c36f-353">Ennek eredményeképpen ha hello azonos első csomópont meghibásodik hello hiba oszlik el az összes olyan szolgáltatás összes partíció.</span><span class="sxs-lookup"><span data-stu-id="7c36f-353">As a result, if hello same first node fails hello failure is distributed across all partitions of all services.</span></span> <span data-ttu-id="7c36f-354">hello hatás tooeach van hello azonos.</span><span class="sxs-lookup"><span data-stu-id="7c36f-354">hello impact tooeach is hello same.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7c36f-355">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="7c36f-355">Next steps</span></span>
- <span data-ttu-id="7c36f-356">A szolgáltatások konfigurálásáról [szolgáltatások konfigurálásával kapcsolatos tudnivalók](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span><span class="sxs-lookup"><span data-stu-id="7c36f-356">For more information on configuring services, [Learn about configuring Services](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span></span>
- <span data-ttu-id="7c36f-357">Töredezettségmentesítés metrikák meghatározása a csomópont helyett ezzel az egyirányú tooconsolidate terhelése. toolearn hogyan tooconfigure töredezettségmentesítés, tekintse meg a túl[Ez a cikk](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="7c36f-357">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
- <span data-ttu-id="7c36f-358">toofind meg arról, hogyan hello fürt erőforrás-kezelő felügyeli, és elosztja a terhelést hello fürtben, tekintse meg hello a cikk a [terheléselosztás](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="7c36f-358">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>
- <span data-ttu-id="7c36f-359">Indítsa el a hello elejétől és [egy bevezető toohello Service Fabric fürt erőforrás-kezelő beolvasása](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="7c36f-359">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
- <span data-ttu-id="7c36f-360">A mozgás költsége az egyik módja az, hogy egyes szolgáltatások-e többinél drágább toomove toohello fürt erőforrás-kezelő jelzés.</span><span class="sxs-lookup"><span data-stu-id="7c36f-360">Movement Cost is one way of signaling toohello Cluster Resource Manager that certain services are more expensive toomove than others.</span></span> <span data-ttu-id="7c36f-361">További információ a mozgás költsége toolearn tekintse meg a túl[Ez a cikk](service-fabric-cluster-resource-manager-movement-cost.md)</span><span class="sxs-lookup"><span data-stu-id="7c36f-361">toolearn more about movement cost, refer too[this article](service-fabric-cluster-resource-manager-movement-cost.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-cluster-layout-with-default-metrics.png
[Image2]:./media/service-fabric-cluster-resource-manager-metrics/Service-Fabric-Resource-Manager-Dynamic-Load-Reports.png
[Image3]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-metric-weights-impact.png
[Image4]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-global-vs-local-balancing.png
