---
title: "az Azure Service Fabric a metrikák aaaDefragmentation |} Microsoft Docs"
description: "Lemeztöredezettség-mentesítés használatával, vagy a Service Fabric metrikák stratégiáját, csomagolási áttekintése"
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: e5ebfae5-c8f7-4d6c-9173-3e22a9730552
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: d09045a6cf196d2771f1a0794637f4579d3eb96b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="defragmentation-of-metrics-and-load-in-service-fabric"></a><span data-ttu-id="a9ff8-103">A metrikák és a Service Fabric terheléselosztási töredezettségmentesítését</span><span class="sxs-lookup"><span data-stu-id="a9ff8-103">Defragmentation of metrics and load in Service Fabric</span></span>
<span data-ttu-id="a9ff8-104">hello Service Fabric fürt erőforrás-kezelő alapértelmezett stratégia terhelés metrikák hello fürt kezeléséhez toodistribute hello terhelés.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-104">hello Service Fabric Cluster Resource Manager's default strategy for managing load metrics in hello cluster is toodistribute hello load.</span></span> <span data-ttu-id="a9ff8-105">Győződjön meg arról, hogy a csomópontok egyenletesen felhasználtuk elkerülhető és meleg tesztüzeméhez tooboth versenyt és feleslegesen erőforrások vezet.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-105">Ensuring that nodes are evenly utilized avoids hot and cold spots that lead tooboth contention and wasted resources.</span></span> <span data-ttu-id="a9ff8-106">Hello fürt terhelésének elosztása egyben hello legbiztonságosabb tekintetében a még működő sikertelen, mert biztosítja, hogy a hibát az egy adott munkaterhelés nagy része, nem veszi.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-106">Distributing workloads in hello cluster is also hello safest in terms of surviving failures since it ensures that a failure doesn’t take out a large percentage of a given workload.</span></span> 

<span data-ttu-id="a9ff8-107">Service Fabric fürt erőforrás-kezelő hello egy másik stratégia támogatása terhelés, amely töredezettségmentesítés kezelése.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-107">hello Service Fabric Cluster Resource Manager does support a different strategy for managing load, which is defragmentation.</span></span> <span data-ttu-id="a9ff8-108">Lemeztöredezettség-mentesítés azt jelenti, hogy nem próbálja toodistribute hello kihasználtságot metrika hello fürtön, hogy konszolidált.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-108">Defragmentation means that instead of trying toodistribute hello utilization of a metric across hello cluster, it is consolidated.</span></span> <span data-ttu-id="a9ff8-109">Összevonás csak egy terheléselosztási stratégia – minimalizálja a hello metrika terhelés átlagos szórás helyett hello alapértelmezett invertálásának, a fürt erőforrás-kezelő hello megpróbál tooincrease azt.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-109">Consolidation is just an inversion of hello default balancing strategy – instead of minimizing hello average standard deviation of metric load, hello Cluster Resource Manager tries tooincrease it.</span></span>

## <a name="when-toouse-defragmentation"></a><span data-ttu-id="a9ff8-110">Amikor toouse töredezettségmentesítés</span><span class="sxs-lookup"><span data-stu-id="a9ff8-110">When toouse defragmentation</span></span>
<span data-ttu-id="a9ff8-111">Hello fürt a terhelés elosztása igényel minden egyes csomóponton hello forrásokhoz.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-111">Distributing load in hello cluster consumes some of hello resources on each node.</span></span> <span data-ttu-id="a9ff8-112">Bizonyos alkalmazások és szolgáltatások létrehozása szolgáltatásokról, amelyek rendkívül nagy, és felhasználhatják a legtöbb vagy az összes csomópont.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-112">Some workloads create services that are exceptionally large and consume most or all of a node.</span></span> <span data-ttu-id="a9ff8-113">Ebben az esetben is lehet, hogy ha nincsenek a nagy munkaterheléseket első létrehozása, amely nem áll rendelkezésre elegendő lemezterület a minden csomópont toorun őket.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-113">In these cases, it's possible that when there are large workloads getting created that there isn't enough space on any node toorun them.</span></span> <span data-ttu-id="a9ff8-114">Nagy munkaterhelések nem egy problémát a Service Fabric; az alábbi esetekben hello fürt erőforrás-kezelő határozza meg, hogy kell-e tooreorganize hello fürt toomake hely a nagy terhelés.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-114">Large workloads aren't a problem in Service Fabric; in these cases hello Cluster Resource Manager determines that it needs tooreorganize hello cluster toomake room for this large workload.</span></span> <span data-ttu-id="a9ff8-115">Azonban a hello addig munkaterhelés rendelkezik toowait toobe hello fürt ütemezve.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-115">However, in hello meantime that workload has toowait toobe scheduled in hello cluster.</span></span>

<span data-ttu-id="a9ff8-116">Ha sok szolgáltatás és állapot toomove körül, majd eltarthat hello nagy munkaterhelést toobe hello fürt helyezett hosszú ideig.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-116">If there are many services and state toomove around, then it could take a long time for hello large workload toobe placed in hello cluster.</span></span> <span data-ttu-id="a9ff8-117">Ez az nagyobb a valószínűsége, ha más munkaterheléseket hello fürt is nagy, és ezért a hosszabb tooreorganize tegye.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-117">This is more likely if other workloads in hello cluster are also large and so take longer tooreorganize.</span></span> <span data-ttu-id="a9ff8-118">hello Service Fabric-csoport létrehozása az ebben a forgatókönyvben szimulációja alkalommal mérése történik.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-118">hello Service Fabric team measured creation times in simulations of this scenario.</span></span> <span data-ttu-id="a9ff8-119">Észleltünk, hogy nagy szolgáltatások létrehozása sokkal több időt vesz igénybe, amint 50 %-a 30 % feletti kapott fürtkihasználtság.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-119">We found that creating large services took much longer as soon as cluster utilization got above between 30% and 50%.</span></span> <span data-ttu-id="a9ff8-120">toohandle ebben a forgatókönyvben azt bevezetett mint stratégiáról terheléselosztási töredezettségmentesítés.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-120">toohandle this scenario, we introduced defragmentation as a balancing strategy.</span></span> <span data-ttu-id="a9ff8-121">Észleltünk, hogy nagy munkaterhelések esetén, főleg azokat, ahol létrehozásának ideje volt fontos töredezettségmentesítés valóban segített azokat a munkaterheléseket ütemezhetők hello fürtben.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-121">We found that for large workloads, especially ones where creation time was important, defragmentation really helped those new workloads get scheduled in hello cluster.</span></span>

<span data-ttu-id="a9ff8-122">Lemeztöredezettség-mentesítés metrikák toohave hello fürt erőforrás-kezelő tooproactively próbálja toocondense hello terhelés hello szolgáltatások kevesebb csomópontot az konfigurálhatja.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-122">You can configure defragmentation metrics toohave hello Cluster Resource Manager tooproactively try toocondense hello load of hello services into fewer nodes.</span></span> <span data-ttu-id="a9ff8-123">Ezzel biztosíthatja, hogy van-e szinte mindig hely nagy szolgáltatások hello fürt átrendezése nélkül.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-123">This helps ensure that there is almost always room for large services without reorganizing hello cluster.</span></span> <span data-ttu-id="a9ff8-124">Nem rendelkezik tooreorganize hello fürt lehetővé teszi a nagy munkaterheléseket gyors létrehozása.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-124">Not having tooreorganize hello cluster allows creating large workloads quickly.</span></span>

<span data-ttu-id="a9ff8-125">A legtöbben töredezettségmentesítés nem szükséges.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-125">Most people don’t need defragmentation.</span></span> <span data-ttu-id="a9ff8-126">Szolgáltatások vannak általában kicsi legyen, így nem rögzített toofind hely számukra hello fürt.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-126">Services are usually be small, so it’s not hard toofind room for them in hello cluster.</span></span> <span data-ttu-id="a9ff8-127">Ha átszervezési lehetséges, a tartományvezérlő végrehajtja gyorsan, újra, mert a legtöbb szolgáltatások kicsi, és gyorsan és párhuzamosan lehet áthelyezni.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-127">When reorganization is possible, it goes quickly, again because most services are small and can be moved quickly and in parallel.</span></span> <span data-ttu-id="a9ff8-128">Azonban ha használatával nagy szolgáltatások és szüksége van rájuk gyorsan létre hello töredezettségmentesítés stratégia van meg.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-128">However, if you have large services and need them created quickly then hello defragmentation strategy is for you.</span></span> <span data-ttu-id="a9ff8-129">A lemeztöredezettség-mentesítés mellett hello mellékhatásokkal mutatjuk be.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-129">We'll discuss hello tradeoffs of using defragmentation next.</span></span> 

## <a name="defragmentation-tradeoffs"></a><span data-ttu-id="a9ff8-130">Lemeztöredezettség-mentesítés mellékhatásokkal</span><span class="sxs-lookup"><span data-stu-id="a9ff8-130">Defragmentation tradeoffs</span></span>
<span data-ttu-id="a9ff8-131">Lemeztöredezettség-mentesítés növelheti impactfulness sikertelen, mivel több szolgáltatás eleget nem tevő csomópontokon futnak.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-131">Defragmentation can increase impactfulness of failures, since more services are running on nodes that fail.</span></span> <span data-ttu-id="a9ff8-132">Lemeztöredezettség-mentesítés növelje költségek, mivel hello fürterőforrások kell tárolható tartalék értékét, a nagy munkaterheléseket hello létrehozására vár.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-132">Defragmentation can also increase costs, since resources in hello cluster must be held in reserve, waiting for hello creation of large workloads.</span></span>

<span data-ttu-id="a9ff8-133">hello következő diagram átfogó két fürt vizuális ábrázolását, egy, a rendszer töredezettségmentesíteni, a másik nem.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-133">hello following diagram gives a visual representation of two clusters, one that is defragmented and one that is not.</span></span> 

<span data-ttu-id="a9ff8-134"><center>
![Elosztott terhelésű, és fürtök töredezettségmentesíteni összehasonlítása][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="a9ff8-134"><center>
![Comparing Balanced and Defragmented Clusters][Image1]
</center></span></span>

<span data-ttu-id="a9ff8-135">Elosztott terhelésű hello esetben fontolja meg, amely egy hello legnagyobb szolgáltatás objektum szükséges tooplace lenne áthelyezések száma hello.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-135">In hello balanced case, consider hello number of movements that would be necessary tooplace one of hello largest service objects.</span></span> <span data-ttu-id="a9ff8-136">Hello töredezettségmentesített fürtben hello nagy terhelés sikerült elhelyezni a csomópontok négy vagy öt anélkül, hogy az egyéb szolgáltatások toomove toowait.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-136">In hello defragmented cluster, hello large workload could be placed on nodes four or five without having toowait for any other services toomove.</span></span>

## <a name="defragmentation-pros-and-cons"></a><span data-ttu-id="a9ff8-137">Lemeztöredezettség-mentesítés előnyei és hátrányai</span><span class="sxs-lookup"><span data-stu-id="a9ff8-137">Defragmentation pros and cons</span></span>
<span data-ttu-id="a9ff8-138">Ezért Mik ezek más fogalmi mellékhatásokkal?</span><span class="sxs-lookup"><span data-stu-id="a9ff8-138">So what are those other conceptual tradeoffs?</span></span> <span data-ttu-id="a9ff8-139">Itt tárgya dolgot toothink gyors táblázatát:</span><span class="sxs-lookup"><span data-stu-id="a9ff8-139">Here’s a quick table of things toothink about:</span></span>

| <span data-ttu-id="a9ff8-140">Lemeztöredezettség-mentesítés szakemberek számára</span><span class="sxs-lookup"><span data-stu-id="a9ff8-140">Defragmentation Pros</span></span> | <span data-ttu-id="a9ff8-141">Lemeztöredezettség-mentesítés hátrányait</span><span class="sxs-lookup"><span data-stu-id="a9ff8-141">Defragmentation Cons</span></span> |
| --- | --- |
| <span data-ttu-id="a9ff8-142">Lehetővé teszi, hogy a nagy szolgáltatások gyorsabb létrehozása</span><span class="sxs-lookup"><span data-stu-id="a9ff8-142">Allows faster creation of large services</span></span> |<span data-ttu-id="a9ff8-143">Koncentrátumok betöltése alakzatot kevesebb csomópontot versengés növelése</span><span class="sxs-lookup"><span data-stu-id="a9ff8-143">Concentrates load onto fewer nodes, increasing contention</span></span> |
| <span data-ttu-id="a9ff8-144">Lehetővé teszi, hogy alacsonyabb adatmozgás létrehozása során</span><span class="sxs-lookup"><span data-stu-id="a9ff8-144">Enables lower data movement during creation</span></span> |<span data-ttu-id="a9ff8-145">Hibák hatással lehet a további szolgáltatásokat, és további forgalom miatt</span><span class="sxs-lookup"><span data-stu-id="a9ff8-145">Failures can impact more services and cause more churn</span></span> |
| <span data-ttu-id="a9ff8-146">Lehetővé teszi, hogy a követelmények részletes leírását és a hely visszanyerése</span><span class="sxs-lookup"><span data-stu-id="a9ff8-146">Allows rich description of requirements and reclamation of space</span></span> |<span data-ttu-id="a9ff8-147">Összetettebb teljes erőforrás-kezelés konfigurálása</span><span class="sxs-lookup"><span data-stu-id="a9ff8-147">More complex overall Resource Management configuration</span></span> |

<span data-ttu-id="a9ff8-148">Töredezettségmentesített kombinálhatja, és a normál metrikák hello ugyanabban a fürtben.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-148">You can mix defragmented and normal metrics in hello same cluster.</span></span> <span data-ttu-id="a9ff8-149">hello fürt erőforrás-kezelő záma tooconsolidate hello töredezettségmentesítés metrikák terjednek, miközben lehetőség szerint hello másoknak.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-149">hello Cluster Resource Manager tries tooconsolidate hello defragmentation metrics as much as possible while spreading out hello others.</span></span> <span data-ttu-id="a9ff8-150">hello eredmények töredezettségmentesítés és terheléselosztási stratégiák számos tényezőtől függ:</span><span class="sxs-lookup"><span data-stu-id="a9ff8-150">hello results of mixing defragmentation and balancing strategies depends on several factors, including:</span></span>
  - <span data-ttu-id="a9ff8-151">terheléselosztás töredezettségmentesítés metrikák hello száma és metrikákat hello száma</span><span class="sxs-lookup"><span data-stu-id="a9ff8-151">hello number of balancing metrics vs. hello number of defragmentation metrics</span></span>
  - <span data-ttu-id="a9ff8-152">E bármely szolgáltatás használ a metrikák mindkét típusú</span><span class="sxs-lookup"><span data-stu-id="a9ff8-152">Whether any service uses both types of metrics</span></span> 
  - <span data-ttu-id="a9ff8-153">hello metrika súlyozás</span><span class="sxs-lookup"><span data-stu-id="a9ff8-153">hello metric weights</span></span>
  - <span data-ttu-id="a9ff8-154">aktuális metrika tölt be</span><span class="sxs-lookup"><span data-stu-id="a9ff8-154">current metric loads</span></span>
  
<span data-ttu-id="a9ff8-155">Kísérletezhet a szükséges toodetermine hello pontos konfiguráció szükséges.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-155">Experimentation is required toodetermine hello exact configuration necessary.</span></span> <span data-ttu-id="a9ff8-156">A munkaterhelések alapos mérése azt javasoljuk, mielőtt engedélyezné a lemeztöredezettség-mentesítés metrikák éles környezetben.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-156">We recommend thorough measurement of your workloads before you enable defragmentation metrics in production.</span></span> <span data-ttu-id="a9ff8-157">Ez akkor különösen igaz olyan esetben, ha keverése töredezettségmentesítése és az elosztott terhelésű metrikák hello belül ugyanazt a szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-157">This is especially true when mixing defragmentation and balanced metrics within hello same service.</span></span> 

## <a name="configuring-defragmentation-metrics"></a><span data-ttu-id="a9ff8-158">Lemeztöredezettség-mentesítés metrikák konfigurálása</span><span class="sxs-lookup"><span data-stu-id="a9ff8-158">Configuring defragmentation metrics</span></span>
<span data-ttu-id="a9ff8-159">Lemeztöredezettség-mentesítés metrikák konfigurálása hello fürt globális döntést, és egyéni metrikák töredezettségmentesítés választhatók.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-159">Configuring defragmentation metrics is a global decision in hello cluster, and individual metrics can be selected for defragmentation.</span></span> <span data-ttu-id="a9ff8-160">a következő konfigurációs részletek hello megjelenítése, hogyan tooconfigure metrikáját töredezettségmentesítés.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-160">hello following config snippets show how tooconfigure metrics for defragmentation.</span></span> <span data-ttu-id="a9ff8-161">Ebben az esetben "Metric1" van konfigurálva egy töredezettségmentesítési metrika, amíg a "Metric2" toobe elosztott terhelésű a szokásos módon folytatódik.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-161">In this case, "Metric1" is configured as a defragmentation metric, while "Metric2" will continue toobe balanced normally.</span></span> 

<span data-ttu-id="a9ff8-162">ClusterManifest.xml:</span><span class="sxs-lookup"><span data-stu-id="a9ff8-162">ClusterManifest.xml:</span></span>

```xml
<Section Name="DefragmentationMetrics">
    <Parameter Name="Metric1" Value="true" />
    <Parameter Name="Metric2" Value="false" />
</Section>
```

<span data-ttu-id="a9ff8-163">az önálló verziója telepítéseinek művelet vagy az Azure-Template.json üzemeltetett fürtök:</span><span class="sxs-lookup"><span data-stu-id="a9ff8-163">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "DefragmentationMetrics",
    "parameters": [
      {
          "name": "Metric1",
          "value": "true"
      },
      {
          "name": "Metric2",
          "value": "false"
      }
    ]
  }
]
```


## <a name="next-steps"></a><span data-ttu-id="a9ff8-164">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="a9ff8-164">Next steps</span></span>
- <span data-ttu-id="a9ff8-165">hello fürt erőforrás-kezelő program man hello fürt leíró.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-165">hello Cluster Resource Manager has man options for describing hello cluster.</span></span> <span data-ttu-id="a9ff8-166">toofind további információk a őket, tekintse meg a cikk a [leíró a Service Fabric-fürt](service-fabric-cluster-resource-manager-cluster-description.md)</span><span class="sxs-lookup"><span data-stu-id="a9ff8-166">toofind out more about them, check out this article on [describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
- <span data-ttu-id="a9ff8-167">Adatok gyűjtése le hogyan kezeli a Service Fabric fürt erőforrás-kezelő hello használat és a kapacitás hello fürtben.</span><span class="sxs-lookup"><span data-stu-id="a9ff8-167">Metrics are how hello Service Fabric Cluster Resource Manger manages consumption and capacity in hello cluster.</span></span> <span data-ttu-id="a9ff8-168">További információk a metrikák toolearn, valamint hogyan tooconfigure őket, [Ez a cikk](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="a9ff8-168">toolearn more about metrics and how tooconfigure them, check out [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-defragmentation-metrics/balancing-defrag-compared.png
