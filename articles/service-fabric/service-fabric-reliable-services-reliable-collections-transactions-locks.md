---
title: "az Azure Service Fabric megbízható gyűjtemények és zárolási mód aaaTransactions |} Microsoft Docs"
description: "Az Azure Fabric megbízható állapot szolgáltatáskezelő és megbízható gyűjtemények tranzakciók és zárolása."
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/1/2017
ms.author: mcoskun
ms.openlocfilehash: 340e029aa98f43ad6e46b48f687dad01f9d96f69
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="transactions-and-lock-modes-in-azure-service-fabric-reliable-collections"></a><span data-ttu-id="ad624-103">Tranzakciók és az Azure Service Fabric megbízható gyűjtemények zárolási mód</span><span class="sxs-lookup"><span data-stu-id="ad624-103">Transactions and lock modes in Azure Service Fabric Reliable Collections</span></span>

## <a name="transaction"></a><span data-ttu-id="ad624-104">Tranzakció</span><span class="sxs-lookup"><span data-stu-id="ad624-104">Transaction</span></span>
<span data-ttu-id="ad624-105">Egy tranzakció a munka egyetlen logikai egységként végrehajtott műveletek sorozata.</span><span class="sxs-lookup"><span data-stu-id="ad624-105">A transaction is a sequence of operations performed as a single logical unit of work.</span></span>
<span data-ttu-id="ad624-106">Egy tranzakció kell virágot hello következő ACID tulajdonságai.</span><span class="sxs-lookup"><span data-stu-id="ad624-106">A transaction must exhibit hello following ACID properties.</span></span> <span data-ttu-id="ad624-107">(lásd: https://technet.microsoft.com/en-us/library/ms190612)</span><span class="sxs-lookup"><span data-stu-id="ad624-107">(see: https://technet.microsoft.com/en-us/library/ms190612)</span></span>
* <span data-ttu-id="ad624-108">**Atomicity**: egy tranzakciót egy atomi munkaegység kell lennie.</span><span class="sxs-lookup"><span data-stu-id="ad624-108">**Atomicity**: A transaction must be an atomic unit of work.</span></span> <span data-ttu-id="ad624-109">Más szóval vagy az adatok változtatás történik, vagy egyikük sem történik.</span><span class="sxs-lookup"><span data-stu-id="ad624-109">In other words, either all its data modifications are performed, or none of them is performed.</span></span>
* <span data-ttu-id="ad624-110">**Konzisztencia**: befejezése után egy tranzakció konzisztens állapotban kell hagynia minden adat.</span><span class="sxs-lookup"><span data-stu-id="ad624-110">**Consistency**: When completed, a transaction must leave all data in a consistent state.</span></span> <span data-ttu-id="ad624-111">Az összes belső adatszerkezetek megfelelő hello tranzakció hello végén kell lennie.</span><span class="sxs-lookup"><span data-stu-id="ad624-111">All internal data structures must be correct at hello end of hello transaction.</span></span>
* <span data-ttu-id="ad624-112">**Elkülönítési**: párhuzamos tranzakciók által végrehajtott módosítások el kell különíteni a párhuzamos tranzakciók hello módosítások.</span><span class="sxs-lookup"><span data-stu-id="ad624-112">**Isolation**: Modifications made by concurrent transactions must be isolated from hello modifications made by any other concurrent transactions.</span></span> <span data-ttu-id="ad624-113">egy művelet egy ITransaction belül használt hello elkülönítési szint hello IReliableState teljesítő hello művelet határozza meg.</span><span class="sxs-lookup"><span data-stu-id="ad624-113">hello isolation level used for an operation within an ITransaction is determined by hello IReliableState performing hello operation.</span></span>
* <span data-ttu-id="ad624-114">**Tartóssági**: amikor egy tranzakció véget ért, hatásai vannak, ha véglegesen hello rendszerben.</span><span class="sxs-lookup"><span data-stu-id="ad624-114">**Durability**: After a transaction has completed, its effects are permanently in place in hello system.</span></span> <span data-ttu-id="ad624-115">hello a módosításokat továbbra is fennáll, még akkor is, a rendszer hibák hello esemény.</span><span class="sxs-lookup"><span data-stu-id="ad624-115">hello modifications persist even in hello event of a system failure.</span></span>

### <a name="isolation-levels"></a><span data-ttu-id="ad624-116">Elkülönítési szinten</span><span class="sxs-lookup"><span data-stu-id="ad624-116">Isolation levels</span></span>
<span data-ttu-id="ad624-117">Elkülönítési szint meghatározása hello mértékben toowhich hello tranzakció legyen különítve a többi tranzakciók által végzett módosításokat.</span><span class="sxs-lookup"><span data-stu-id="ad624-117">Isolation level defines hello degree toowhich hello transaction must be isolated from modifications made by other transactions.</span></span>
<span data-ttu-id="ad624-118">Két, a megbízható gyűjtemények támogatott elkülönítési szinten van:</span><span class="sxs-lookup"><span data-stu-id="ad624-118">There are two isolation levels that are supported in Reliable Collections:</span></span>

* <span data-ttu-id="ad624-119">**Ismételhető olvasás**: meghatározza, hogy utasítás nem tudja olvasni a módosított, de más tranzakciók által még nem véglegesített adatokat, és, hogy más tranzakciók módosíthatja, hogy az aktuális tranzakció hello aktuális hello csak olvasásra került adatok tranzakció befejezését.</span><span class="sxs-lookup"><span data-stu-id="ad624-119">**Repeatable Read**: Specifies that statements cannot read data that has been modified but not yet committed by other transactions and that no other transactions can modify data that has been read by hello current transaction until hello current transaction finishes.</span></span> <span data-ttu-id="ad624-120">További részletekért lásd: [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span><span class="sxs-lookup"><span data-stu-id="ad624-120">For more details, see [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span></span>
* <span data-ttu-id="ad624-121">**Pillanatkép**: Megadja, hogy egy tranzakció utasítás által beolvasott adatok hello tranzakciós úton konzisztens hello tranzakció hello kezdetén meglévő hello adatok verzióját.</span><span class="sxs-lookup"><span data-stu-id="ad624-121">**Snapshot**: Specifies that data read by any statement in a transaction is hello transactionally consistent version of hello data that existed at hello start of hello transaction.</span></span>
  <span data-ttu-id="ad624-122">hello tranzakció fel tudja ismerni csak adatok adtainak hello hello tranzakció elindítása előtt véglegesítése volt.</span><span class="sxs-lookup"><span data-stu-id="ad624-122">hello transaction can recognize only data modifications that were committed before hello start of hello transaction.</span></span>
  <span data-ttu-id="ad624-123">Adatok módosítások más tranzakciók hello hello aktuális tranzakció elindítása után nem látható toostatements hello aktuális tranzakció végrehajtása.</span><span class="sxs-lookup"><span data-stu-id="ad624-123">Data modifications made by other transactions after hello start of hello current transaction are not visible toostatements executing in hello current transaction.</span></span>
  <span data-ttu-id="ad624-124">hello hatással, mintha hello utasítás szerepel egy tranzakcióban elkövetett hello adatok pillanatképe beolvasása, adott hello tranzakció hello kezdetén verzióját.</span><span class="sxs-lookup"><span data-stu-id="ad624-124">hello effect is as if hello statements in a transaction get a snapshot of hello committed data as it existed at hello start of hello transaction.</span></span>
  <span data-ttu-id="ad624-125">A pillanatképek egységesek megbízható gyűjtemények.</span><span class="sxs-lookup"><span data-stu-id="ad624-125">Snapshots are consistent across Reliable Collections.</span></span>
  <span data-ttu-id="ad624-126">További részletekért lásd: [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span><span class="sxs-lookup"><span data-stu-id="ad624-126">For more details, see [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span></span>

<span data-ttu-id="ad624-127">Megbízható gyűjtemények automatikusan válasszon hello elkülönítési szint toouse adott olvasási művelet attól függően, hogy hello művelet és hello replika szerepkörét az hello hello tranzakció létrehozása során.</span><span class="sxs-lookup"><span data-stu-id="ad624-127">Reliable Collections automatically choose hello isolation level toouse for a given read operation depending on hello operation and hello role of hello replica at hello time of transaction's creation.</span></span>
<span data-ttu-id="ad624-128">Az alábbiakban az elkülönítési szint alapértelmezett megbízható szótár és várólista műveletekhez ábrázol hello tábla.</span><span class="sxs-lookup"><span data-stu-id="ad624-128">Following is hello table that depicts isolation level defaults for Reliable Dictionary and Queue operations.</span></span>

| <span data-ttu-id="ad624-129">A művelet \ szerepkör</span><span class="sxs-lookup"><span data-stu-id="ad624-129">Operation \ Role</span></span> | <span data-ttu-id="ad624-130">Elsődleges</span><span class="sxs-lookup"><span data-stu-id="ad624-130">Primary</span></span> | <span data-ttu-id="ad624-131">Másodlagos</span><span class="sxs-lookup"><span data-stu-id="ad624-131">Secondary</span></span> |
| --- |:--- |:--- |
| <span data-ttu-id="ad624-132">Egyetlen entitás olvasása</span><span class="sxs-lookup"><span data-stu-id="ad624-132">Single Entity Read</span></span> |<span data-ttu-id="ad624-133">Ismételhető olvasás</span><span class="sxs-lookup"><span data-stu-id="ad624-133">Repeatable Read</span></span> |<span data-ttu-id="ad624-134">Pillanatkép</span><span class="sxs-lookup"><span data-stu-id="ad624-134">Snapshot</span></span> |
| <span data-ttu-id="ad624-135">Számbavételi, száma</span><span class="sxs-lookup"><span data-stu-id="ad624-135">Enumeration, Count</span></span> |<span data-ttu-id="ad624-136">Pillanatkép</span><span class="sxs-lookup"><span data-stu-id="ad624-136">Snapshot</span></span> |<span data-ttu-id="ad624-137">Pillanatkép</span><span class="sxs-lookup"><span data-stu-id="ad624-137">Snapshot</span></span> |

> [!NOTE]
> <span data-ttu-id="ad624-138">Gyakori példák egyetlen entitás műveletekhez `IReliableDictionary.TryGetValueAsync`, `IReliableQueue.TryPeekAsync`.</span><span class="sxs-lookup"><span data-stu-id="ad624-138">Common examples for Single Entity Operations are `IReliableDictionary.TryGetValueAsync`, `IReliableQueue.TryPeekAsync`.</span></span>
> 

<span data-ttu-id="ad624-139">Hello megbízható szótár és a megbízható várólista hello támogatja, olvassa el a ír.</span><span class="sxs-lookup"><span data-stu-id="ad624-139">Both hello Reliable Dictionary and hello Reliable Queue support Read Your Writes.</span></span>
<span data-ttu-id="ad624-140">Más szóval bármely írási tranzakción belül kell látható tooa következő olvassák toohello tartozik, amely ugyanabban a tranzakcióban.</span><span class="sxs-lookup"><span data-stu-id="ad624-140">In other words, any write within a transaction will be visible tooa following read that belongs toohello same transaction.</span></span>

## <a name="locks"></a><span data-ttu-id="ad624-141">Zárolások</span><span class="sxs-lookup"><span data-stu-id="ad624-141">Locks</span></span>
<span data-ttu-id="ad624-142">A megbízható gyűjtemények szigorú tranzakciók megvalósítása két fázis zárolás: a tranzakció nem zárolások hello amíg hello tranzakció véget nem ér egy megszakítás vagy egy véglegesítési szerzett.</span><span class="sxs-lookup"><span data-stu-id="ad624-142">In Reliable Collections, all transactions implement rigorous two phase locking: a transaction does not release hello locks it has acquired until hello transaction terminates with either an abort or a commit.</span></span>

<span data-ttu-id="ad624-143">Megbízható szótár minden egyetlen entitás műveleteihez zárolás sor szintet használja.</span><span class="sxs-lookup"><span data-stu-id="ad624-143">Reliable Dictionary uses row level locking for all single entity operations.</span></span>
<span data-ttu-id="ad624-144">Megbízható várólista lefolytathassa szigorú tranzakciós FIFO tulajdonság egyidejű ki.</span><span class="sxs-lookup"><span data-stu-id="ad624-144">Reliable Queue trades off concurrency for strict transactional FIFO property.</span></span>
<span data-ttu-id="ad624-145">Megbízható várólista művelet szintű zárolások engedélyezése egy tranzakciót használ `TryPeekAsync` és/vagy `TryDequeueAsync` és egy tranzakciót `EnqueueAsync` egyszerre.</span><span class="sxs-lookup"><span data-stu-id="ad624-145">Reliable Queue uses operation level locks allowing one transaction with `TryPeekAsync` and/or `TryDequeueAsync` and one transaction with `EnqueueAsync` at a time.</span></span>
<span data-ttu-id="ad624-146">Ne feledje, hogy toopreserve FIFO, ha egy `TryPeekAsync` vagy `TryDequeueAsync` valaha is figyelembe veszi, hogy megbízható várólista hello üres, akkor azok is zárolják `EnqueueAsync`.</span><span class="sxs-lookup"><span data-stu-id="ad624-146">Note that toopreserve FIFO, if a `TryPeekAsync` or `TryDequeueAsync` ever observes that hello Reliable Queue is empty, they will also lock `EnqueueAsync`.</span></span>

<span data-ttu-id="ad624-147">Az írási műveletek mindig egy kizárólagos zárolást.</span><span class="sxs-lookup"><span data-stu-id="ad624-147">Write operations always take Exclusive locks.</span></span>
<span data-ttu-id="ad624-148">Az olvasási műveleteknél a hello zárolás szolgáltatás tényezők néhány függ.</span><span class="sxs-lookup"><span data-stu-id="ad624-148">For read operations, hello locking depends on a couple of factors.</span></span>
<span data-ttu-id="ad624-149">Bármely olvasási művelet történik pillanatkép-elkülönítés használatával szabad zárolás.</span><span class="sxs-lookup"><span data-stu-id="ad624-149">Any read operation done using Snapshot isolation is lock free.</span></span>
<span data-ttu-id="ad624-150">Alapértelmezés szerint minden ismételhető olvasása a közös zárolás vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="ad624-150">Any Repeatable Read operation by default takes Shared locks.</span></span>
<span data-ttu-id="ad624-151">Azonban bármely olvasási művelet, amely támogatja a ismételhető Olvasás, hello felhasználói kérje meg a módosítási zárolást hello a közös zárolás helyett.</span><span class="sxs-lookup"><span data-stu-id="ad624-151">However, for any read operation that supports Repeatable Read, hello user can ask for an Update lock instead of hello Shared lock.</span></span>
<span data-ttu-id="ad624-152">Módosítási zárolást, az aszimmetrikus zár használt tooprevent közös formája, amely akkor fordul elő, amikor több tranzakció egy későbbi időpontban lehetséges frissítések erőforrások zárolása holtpont.</span><span class="sxs-lookup"><span data-stu-id="ad624-152">An Update lock is an asymmetric lock used tooprevent a common form of deadlock that occurs when multiple transactions lock resources for potential updates at a later time.</span></span>

<span data-ttu-id="ad624-153">hello zárolási kompatibilitási mátrix hello a következő táblázatban találhatók:</span><span class="sxs-lookup"><span data-stu-id="ad624-153">hello lock compatibility matrix can be found in hello following table:</span></span>

| <span data-ttu-id="ad624-154">Kérelem \ kap</span><span class="sxs-lookup"><span data-stu-id="ad624-154">Request \ Granted</span></span> | <span data-ttu-id="ad624-155">None</span><span class="sxs-lookup"><span data-stu-id="ad624-155">None</span></span> | <span data-ttu-id="ad624-156">Közös</span><span class="sxs-lookup"><span data-stu-id="ad624-156">Shared</span></span> | <span data-ttu-id="ad624-157">Frissítés</span><span class="sxs-lookup"><span data-stu-id="ad624-157">Update</span></span> | <span data-ttu-id="ad624-158">Kizárólagos</span><span class="sxs-lookup"><span data-stu-id="ad624-158">Exclusive</span></span> |
| --- |:--- |:--- |:--- |:--- |
| <span data-ttu-id="ad624-159">Közös</span><span class="sxs-lookup"><span data-stu-id="ad624-159">Shared</span></span> |<span data-ttu-id="ad624-160">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-160">No conflict</span></span> |<span data-ttu-id="ad624-161">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-161">No conflict</span></span> |<span data-ttu-id="ad624-162">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-162">Conflict</span></span> |<span data-ttu-id="ad624-163">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-163">Conflict</span></span> |
| <span data-ttu-id="ad624-164">Frissítés</span><span class="sxs-lookup"><span data-stu-id="ad624-164">Update</span></span> |<span data-ttu-id="ad624-165">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-165">No conflict</span></span> |<span data-ttu-id="ad624-166">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-166">No conflict</span></span> |<span data-ttu-id="ad624-167">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-167">Conflict</span></span> |<span data-ttu-id="ad624-168">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-168">Conflict</span></span> |
| <span data-ttu-id="ad624-169">Kizárólagos</span><span class="sxs-lookup"><span data-stu-id="ad624-169">Exclusive</span></span> |<span data-ttu-id="ad624-170">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-170">No conflict</span></span> |<span data-ttu-id="ad624-171">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-171">Conflict</span></span> |<span data-ttu-id="ad624-172">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-172">Conflict</span></span> |<span data-ttu-id="ad624-173">Ütközés</span><span class="sxs-lookup"><span data-stu-id="ad624-173">Conflict</span></span> |

<span data-ttu-id="ad624-174">Hello megbízható gyűjtemények API-k időtúllépési argumentumának holtpont észlelési szolgál.</span><span class="sxs-lookup"><span data-stu-id="ad624-174">Time-out argument in hello Reliable Collections APIs is used for deadlock detection.</span></span>
<span data-ttu-id="ad624-175">Például két tranzakció (T1 és T2) próbál tooread és K1 frissítése.</span><span class="sxs-lookup"><span data-stu-id="ad624-175">For example, two transactions (T1 and T2) are trying tooread and update K1.</span></span>
<span data-ttu-id="ad624-176">Lehetséges, hogy azok toodeadlock, mert azok mindkét hello rendelkező megosztott zárolása.</span><span class="sxs-lookup"><span data-stu-id="ad624-176">It is possible for them toodeadlock, because they both end up having hello Shared lock.</span></span>
<span data-ttu-id="ad624-177">Egyik vagy mindkét hello műveletek ebben az esetben, amelynek az időkorlátja.</span><span class="sxs-lookup"><span data-stu-id="ad624-177">In this case, one or both of hello operations will time out.</span></span>

<span data-ttu-id="ad624-178">Ebben a forgatókönyvben holtpont példája egy nagyszerű hogyan módosítási zárolást előfordulhat, hogy holtpont.</span><span class="sxs-lookup"><span data-stu-id="ad624-178">This deadlock scenario is a great example of how an Update lock can prevent deadlocks.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ad624-179">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="ad624-179">Next steps</span></span>
* [<span data-ttu-id="ad624-180">A Reliable Collections használata</span><span class="sxs-lookup"><span data-stu-id="ad624-180">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="ad624-181">Megbízható szolgáltatások értesítések</span><span class="sxs-lookup"><span data-stu-id="ad624-181">Reliable Services notifications</span></span>](service-fabric-reliable-services-notifications.md)
* [<span data-ttu-id="ad624-182">Megbízható szolgáltatások biztonsági mentése és visszaállítása (katasztrófa utáni helyreállítás)</span><span class="sxs-lookup"><span data-stu-id="ad624-182">Reliable Services backup and restore (disaster recovery)</span></span>](service-fabric-reliable-services-backup-restore.md)
* [<span data-ttu-id="ad624-183">Megbízható állapot Manager konfigurálása</span><span class="sxs-lookup"><span data-stu-id="ad624-183">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* [<span data-ttu-id="ad624-184">Fejlesztői leírás megbízható gyűjtemények</span><span class="sxs-lookup"><span data-stu-id="ad624-184">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)

