---
title: "a Service Fabric-alkalmazás nyomkövetési tároló Elasticsearch aaaUsing |} Microsoft Docs"
description: "Ismerteti a Service Fabric-alkalmazások használatát Elasticsearch és Kibana toostore, Tárgymutató és kereső alkalmazás nyomkövetési adatokat (naplókat) keresztül"
services: service-fabric
documentationcenter: .net
author: karolz-ms
manager: adegeo
editor: 
ms.assetid: e59b0c39-e468-4d9e-b453-d5f2a8ad20d8
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/07/2017
ms.author: karolz@microsoft.com
redirect_url: /azure/service-fabric/service-fabric-diagnostics-event-aggregation-eventflow
ms.openlocfilehash: b5977c54e69319e3caa376e44a02f971b66a3254
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="use-elasticsearch-as-a-service-fabric-application-trace-store"></a><span data-ttu-id="c0f47-103">Használjon Elasticsearch, mint a Service Fabric-alkalmazás nyomkövetési tárolásához</span><span class="sxs-lookup"><span data-stu-id="c0f47-103">Use Elasticsearch as a Service Fabric application trace store</span></span>
## <a name="introduction"></a><span data-ttu-id="c0f47-104">Bevezetés</span><span class="sxs-lookup"><span data-stu-id="c0f47-104">Introduction</span></span>
<span data-ttu-id="c0f47-105">Ez a cikk ismerteti, hogyan [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) alkalmazások **Elasticsearch** és **Kibana** nyomkövetési alkalmazástárolót, indexelő és keresési.</span><span class="sxs-lookup"><span data-stu-id="c0f47-105">This article describes how [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) applications can use **Elasticsearch** and **Kibana** for application trace storage, indexing, and search.</span></span> <span data-ttu-id="c0f47-106">[Elasticsearch](https://www.elastic.co/guide/index.html) egy nyílt forráskódú, elosztott és méretezhető valós idejű keresési és az elemzések motor, amely jól használható a feladathoz.</span><span class="sxs-lookup"><span data-stu-id="c0f47-106">[Elasticsearch](https://www.elastic.co/guide/index.html) is an open-source, distributed, and scalable real-time search and analytics engine that is well-suited for this task.</span></span> <span data-ttu-id="c0f47-107">Microsoft Azure-ban futó Windows és Linux rendszerű virtuális gépekre telepíthető.</span><span class="sxs-lookup"><span data-stu-id="c0f47-107">It can be installed on Windows and Linux virtual machines running in Microsoft Azure.</span></span> <span data-ttu-id="c0f47-108">Elasticsearch hatékonyan tud feldolgozni *strukturált* technológiák használatával például előállított nyomkövetési **esemény Windows (nyomkövetés)**.</span><span class="sxs-lookup"><span data-stu-id="c0f47-108">Elasticsearch can efficiently process *structured* traces produced using technologies such as **Event Tracing for Windows (ETW)**.</span></span>

<span data-ttu-id="c0f47-109">A Service Fabric futásidejű toosource diagnosztikai adatok (nyomkövetés készíthet) ETW használja.</span><span class="sxs-lookup"><span data-stu-id="c0f47-109">ETW is used by Service Fabric runtime toosource diagnostic information (traces).</span></span> <span data-ttu-id="c0f47-110">Hello ajánlott módszer a Service Fabric-alkalmazások toosource a diagnosztikai adatokat túl.</span><span class="sxs-lookup"><span data-stu-id="c0f47-110">It is hello recommended method for Service Fabric applications toosource their diagnostic information, too.</span></span> <span data-ttu-id="c0f47-111">Ugyanazt a mechanizmust lehetővé teszi, hogy a futtatókörnyezet által biztosított és az alkalmazás által átadott nyomkövetéseket és hibaelhárítást teszi közötti összefüggést hello segítségével.</span><span class="sxs-lookup"><span data-stu-id="c0f47-111">Using hello same mechanism allows for correlation between runtime-supplied and application-supplied traces and makes troubleshooting easier.</span></span> <span data-ttu-id="c0f47-112">Service Fabric a Visual Studio projektsablonjai közé tartozik a naplózás alkalmazásprogramozási Felületet (hello .NET alapján **EventSource** osztály), amely ETW-nyomkövetési bocsát ki alapértelmezés szerint.</span><span class="sxs-lookup"><span data-stu-id="c0f47-112">Service Fabric project templates in Visual Studio include a logging API (based on hello .NET **EventSource** class) that emits ETW traces by default.</span></span> <span data-ttu-id="c0f47-113">Service Fabric-alkalmazás általános áttekintést nyomkövetés használatával ETW, lásd: [figyelése és diagnosztizálása szolgáltatásai a helyi számítógép fejlesztési telepítő](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span><span class="sxs-lookup"><span data-stu-id="c0f47-113">For a general overview of Service Fabric application tracing using ETW, see [Monitoring and diagnosing services in a local machine development setup](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span></span>

<span data-ttu-id="c0f47-114">Hello nyomkövetések tooshow fel a Elasticsearch, a szükséges toobe rögzített hello Service Fabric fürt csomópontjai valós időben (közben hello alkalmazás fut), és elküldi a tooan Elasticsearch végpont.</span><span class="sxs-lookup"><span data-stu-id="c0f47-114">For hello traces tooshow up in Elasticsearch, they need toobe captured at hello Service Fabric cluster nodes in real time (while hello application is running) and sent tooan Elasticsearch endpoint.</span></span> <span data-ttu-id="c0f47-115">Nyomkövetés rögzítésének két fő lehetőség áll rendelkezésre:</span><span class="sxs-lookup"><span data-stu-id="c0f47-115">There are two major options for trace capturing:</span></span>

* <span data-ttu-id="c0f47-116">**A folyamaton belüli nyomkövetés rögzítése**</span><span class="sxs-lookup"><span data-stu-id="c0f47-116">**In-process trace capturing**</span></span>  
  <span data-ttu-id="c0f47-117">hello alkalmazás vagy szolgáltatás folyamattal, pontosabban, kimenő hello diagnosztikai toohello nyomkövetési adattár (Elasticsearch) küldéséért felelős.</span><span class="sxs-lookup"><span data-stu-id="c0f47-117">hello application, or more precisely, service process, is responsible for sending out hello diagnostic data toohello trace store (Elasticsearch).</span></span>
* <span data-ttu-id="c0f47-118">**Folyamaton-nyomkövetés rögzítése**</span><span class="sxs-lookup"><span data-stu-id="c0f47-118">**Out-of-process trace capturing**</span></span>  
  <span data-ttu-id="c0f47-119">Egy különálló ügynök hello szolgáltatás folyamat vagy folyamatok nyomok rögzítését, és elküldi őket toohello nyomkövetési tároló.</span><span class="sxs-lookup"><span data-stu-id="c0f47-119">A separate agent is capturing traces from hello service process or processes and sending them toohello trace store.</span></span>

<span data-ttu-id="c0f47-120">Az alábbiakban, azt hogyan tooset be a Azure-ban Elasticsearch tárgyalják hello informatikai szakemberek és leírása mindkét hátrányait beállítások rögzítése, és azt ismertetik, hogyan tooconfigure a Service Fabric szolgáltatás toosend adatok tooElasticsearch</span><span class="sxs-lookup"><span data-stu-id="c0f47-120">Below, we describe how tooset up Elasticsearch on Azure, discuss hello pros and cons for both capture options, and explain how tooconfigure a Service Fabric service toosend data tooElasticsearch.</span></span>

## <a name="set-up-elasticsearch-on-azure"></a><span data-ttu-id="c0f47-121">Az Azure-on Elasticsearch beállítása</span><span class="sxs-lookup"><span data-stu-id="c0f47-121">Set up Elasticsearch on Azure</span></span>
<span data-ttu-id="c0f47-122">hello legegyszerűbb módja tooset hello Elasticsearch szolgáltatás az Azure-on keresztül történik [ **Azure Resource Manager-sablonok**](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c0f47-122">hello most straightforward way tooset up hello Elasticsearch service on Azure is through [**Azure Resource Manager templates**](../azure-resource-manager/resource-group-overview.md).</span></span> <span data-ttu-id="c0f47-123">Egy átfogó [Elasticsearch gyors üzembe helyezés Azure Resource Manager sablon](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) érhető el az Azure gyors üzembe helyezési sablonok tárházba.</span><span class="sxs-lookup"><span data-stu-id="c0f47-123">A comprehensive [Quickstart Azure Resource Manager template for Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) is available from Azure Quickstart templates repository.</span></span> <span data-ttu-id="c0f47-124">Ez a sablon külön tárfiókok használja a méretezési egységeket (csomópontok csoportokat).</span><span class="sxs-lookup"><span data-stu-id="c0f47-124">This template uses separate storage accounts for scale units (groups of nodes).</span></span> <span data-ttu-id="c0f47-125">Is kiépíthetők külön ügyfél és kiszolgáló-csomópontokat a különböző konfigurációt és különböző számú adatlemezt csatolni.</span><span class="sxs-lookup"><span data-stu-id="c0f47-125">It can also provision separate client and server nodes with different configurations and various numbers of data disks attached.</span></span>

<span data-ttu-id="c0f47-126">Itt egy másik sablont, úgynevezett használjuk **ES-MultiNode** a hello [Azure diagnosztikai eszközök tárház](https://github.com/Azure/azure-diagnostics-tools).</span><span class="sxs-lookup"><span data-stu-id="c0f47-126">Here, we use another template, called **ES-MultiNode** from hello [Azure diagnostic tools repository](https://github.com/Azure/azure-diagnostics-tools).</span></span> <span data-ttu-id="c0f47-127">Ez a sablon könnyebb toouse, és az alapvető HTTP-hitelesítés által védett Elasticsearch fürtöt hoz létre.</span><span class="sxs-lookup"><span data-stu-id="c0f47-127">This template is easier toouse, and it creates an Elasticsearch cluster protected by HTTP basic authentication.</span></span> <span data-ttu-id="c0f47-128">Mielőtt továbblépne, töltik le a hello tárház GitHub tooyour gépről (hello tárház klónozása, vagy egy zip-fájl letöltése).</span><span class="sxs-lookup"><span data-stu-id="c0f47-128">Before you proceed, download hello repository from GitHub tooyour machine (by either cloning hello repository or downloading a zip file).</span></span> <span data-ttu-id="c0f47-129">ES-MultiNode hello sablon hello hello mappában található ugyanazzal a névvel.</span><span class="sxs-lookup"><span data-stu-id="c0f47-129">hello ES-MultiNode template is located in hello folder with hello same name.</span></span>

### <a name="prepare-a-machine-toorun-elasticsearch-installation-scripts"></a><span data-ttu-id="c0f47-130">Készítse elő a gép toorun Elasticsearch telepítési parancsfájlokat</span><span class="sxs-lookup"><span data-stu-id="c0f47-130">Prepare a machine toorun Elasticsearch installation scripts</span></span>
<span data-ttu-id="c0f47-131">hello legegyszerűbb módja toouse hello ES-MultiNode sablon van keresztül nevű megadott Azure PowerShell parancsfájl `CreateElasticSearchCluster`.</span><span class="sxs-lookup"><span data-stu-id="c0f47-131">hello easiest way toouse hello ES-MultiNode template is through a provided Azure PowerShell script called `CreateElasticSearchCluster`.</span></span> <span data-ttu-id="c0f47-132">toouse ezt a parancsfájlt, és van szükség tooinstall PowerShell-modulok nevű eszköz **openssl**.</span><span class="sxs-lookup"><span data-stu-id="c0f47-132">toouse this script, you need tooinstall PowerShell modules and a tool called **openssl**.</span></span> <span data-ttu-id="c0f47-133">Ez utóbbi hello fürtöt hoz létre, amely használt tooadminister SSH-kulcs a Elasticsearch távolról van szükség.</span><span class="sxs-lookup"><span data-stu-id="c0f47-133">hello latter is needed for creating an SSH key that can be used tooadminister your Elasticsearch cluster remotely.</span></span>

<span data-ttu-id="c0f47-134">`CreateElasticSearchCluster`Könnyű használat hello ES-MultiNode sablon a Windows-gépről készült parancsfájl.</span><span class="sxs-lookup"><span data-stu-id="c0f47-134">`CreateElasticSearchCluster` script is designed for ease of use with hello ES-MultiNode template from a Windows machine.</span></span> <span data-ttu-id="c0f47-135">Lehetséges toouse hello sablon egy-Windows számítógépen, de a forgatókönyv nem ez a cikk hello terjed.</span><span class="sxs-lookup"><span data-stu-id="c0f47-135">It is possible toouse hello template on a non-Windows machine, but that scenario is beyond hello scope of this article.</span></span>

1. <span data-ttu-id="c0f47-136">Ha még nem telepítette őket már, telepítse [ **Azure PowerShell-modulok**](http://aka.ms/webpi-azps).</span><span class="sxs-lookup"><span data-stu-id="c0f47-136">If you haven't installed them already, install [**Azure PowerShell modules**](http://aka.ms/webpi-azps).</span></span> <span data-ttu-id="c0f47-137">Amikor a rendszer kéri, kattintson a **futtatása**, majd **telepítése**.</span><span class="sxs-lookup"><span data-stu-id="c0f47-137">When prompted, click **Run**, then **Install**.</span></span> <span data-ttu-id="c0f47-138">Az Azure PowerShell 1.3-as vagy újabb rendszer szükséges.</span><span class="sxs-lookup"><span data-stu-id="c0f47-138">Azure PowerShell 1.3 or newer is required.</span></span>
2. <span data-ttu-id="c0f47-139">Hello **openssl** eszköz megtalálható a hello terjesztési [ **Git for Windows**](http://www.git-scm.com/downloads).</span><span class="sxs-lookup"><span data-stu-id="c0f47-139">hello **openssl** tool is included in hello distribution of [**Git for Windows**](http://www.git-scm.com/downloads).</span></span> <span data-ttu-id="c0f47-140">Ha még nem tette meg, telepítse [Git for Windows](http://www.git-scm.com/downloads) most.</span><span class="sxs-lookup"><span data-stu-id="c0f47-140">If you have not done so already, install [Git for Windows](http://www.git-scm.com/downloads) now.</span></span> <span data-ttu-id="c0f47-141">(hello alapértelmezett telepítési beállítások: OK gombra.)</span><span class="sxs-lookup"><span data-stu-id="c0f47-141">(hello default installation options are OK.)</span></span>
3. <span data-ttu-id="c0f47-142">Feltételezve, hogy a Git telepítve, de a hello elérési útja nem szerepel, nyissa meg a Microsoft Azure PowerShell ablakot, és futtassa a következő parancsok hello:</span><span class="sxs-lookup"><span data-stu-id="c0f47-142">Assuming that Git has been installed but not included in hello system path, open a Microsoft Azure PowerShell window and run hello following commands:</span></span>
   
    ```powershell
    $ENV:PATH += ";<Git installation folder>\usr\bin"
    $ENV:OPENSSL_CONF = "<Git installation folder>\usr\ssl\openssl.cnf"
    ```
   
    <span data-ttu-id="c0f47-143">Cserélje le a hello `<Git installation folder>` hello Git a számítógépen; helyen lévő hello alapértelmezett érték a **"C:\Program Files\Git"**.</span><span class="sxs-lookup"><span data-stu-id="c0f47-143">Replace hello `<Git installation folder>` with hello Git location on your machine; hello default is **"C:\Program Files\Git"**.</span></span> <span data-ttu-id="c0f47-144">Vegye figyelembe a hello pontosvesszővel hello első elérési hello elején.</span><span class="sxs-lookup"><span data-stu-id="c0f47-144">Note hello semicolon character at hello beginning of hello first path.</span></span>
4. <span data-ttu-id="c0f47-145">Győződjön meg arról, hogy van-e bejelentkezve tooAzure (keresztül [ `Add-AzureRmAccount` ](https://msdn.microsoft.com/library/mt619267.aspx) parancsmag) és, hogy megadta-e, amelyeket hello előfizetés használt toocreate a rugalmas keresési fürt.</span><span class="sxs-lookup"><span data-stu-id="c0f47-145">Ensure that you are logged on tooAzure (via [`Add-AzureRmAccount`](https://msdn.microsoft.com/library/mt619267.aspx) cmdlet) and that you have selected hello subscription that should be used toocreate your Elastic Search cluster.</span></span> <span data-ttu-id="c0f47-146">Ellenőrizheti, hogy megfelelő előfizetés van kiválasztva, használatával `Get-AzureRmContext` és `Get-AzureRmSubscription` parancsmagok.</span><span class="sxs-lookup"><span data-stu-id="c0f47-146">You can verify that correct subscription is selected using `Get-AzureRmContext` and `Get-AzureRmSubscription` cmdlets.</span></span>
5. <span data-ttu-id="c0f47-147">Ha még nem tette meg, módosíthatja a hello aktuális directory toohello ES-MultiNode mappát.</span><span class="sxs-lookup"><span data-stu-id="c0f47-147">If you haven't done so already, change hello current directory toohello ES-MultiNode folder.</span></span>

### <a name="run-hello-createelasticsearchcluster-script"></a><span data-ttu-id="c0f47-148">Hello CreateElasticSearchCluster parancsfájl futtatása</span><span class="sxs-lookup"><span data-stu-id="c0f47-148">Run hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="c0f47-149">Hello parancsfájl futtatása előtt nyissa meg a hello `azuredeploy-parameters.json` fájlt, és győződjön meg arról, vagy hello parancsfájl paraméterek értékének megadására.</span><span class="sxs-lookup"><span data-stu-id="c0f47-149">Before you run hello script, open hello `azuredeploy-parameters.json` file and verify or provide values for hello script parameters.</span></span> <span data-ttu-id="c0f47-150">a következő paraméterek hello itt találhatók:</span><span class="sxs-lookup"><span data-stu-id="c0f47-150">hello following parameters are provided:</span></span>

| <span data-ttu-id="c0f47-151">Paraméter neve</span><span class="sxs-lookup"><span data-stu-id="c0f47-151">Parameter Name</span></span> | <span data-ttu-id="c0f47-152">Leírás</span><span class="sxs-lookup"><span data-stu-id="c0f47-152">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c0f47-153">dnsNameForLoadBalancerIP</span><span class="sxs-lookup"><span data-stu-id="c0f47-153">dnsNameForLoadBalancerIP</span></span> |<span data-ttu-id="c0f47-154">hello nevet használt toocreate hello nyilvánosan láthatóvá DNS-nevét hello rugalmas keresési fürt (hello Azure-régiót toohello megadott tartománynév hozzáfűzésével).</span><span class="sxs-lookup"><span data-stu-id="c0f47-154">hello name that is used toocreate hello publicly visible DNS name for hello Elastic Search cluster (by appending hello Azure region domain toohello provided name).</span></span> <span data-ttu-id="c0f47-155">Például ha a paraméter értéke "myBigCluster", és a kiválasztott hello Azure-régió az USA nyugati régiója, hello eredményül kapott DNS-neve hello fürt myBigCluster.westus.cloudapp.azure.com:.</span><span class="sxs-lookup"><span data-stu-id="c0f47-155">For example, if this parameter value is "myBigCluster" and hello chosen Azure region is West US, hello resulting DNS name for hello cluster is myBigCluster.westus.cloudapp.azure.com.</span></span> <br /><br /><span data-ttu-id="c0f47-156">Ez a név is szolgál az hello rugalmas keresési fürtben, mint az adatok csomópontnevek társított sok összetevők legfelső szintű nevét.</span><span class="sxs-lookup"><span data-stu-id="c0f47-156">This name also serves as a root name for many artifacts associated with hello Elastic Search cluster, such as data node names.</span></span> |
| <span data-ttu-id="c0f47-157">adminUsername</span><span class="sxs-lookup"><span data-stu-id="c0f47-157">adminUsername</span></span> |<span data-ttu-id="c0f47-158">hello rugalmas keresési fürt kezeléséhez hello hello rendszergazdai fiók nevét (a megfelelő SSH-kulcsok automatikusan jönnek létre).</span><span class="sxs-lookup"><span data-stu-id="c0f47-158">hello name of hello administrator account for managing hello Elastic Search cluster (corresponding SSH keys are generated automatically).</span></span> |
| <span data-ttu-id="c0f47-159">dataNodeCount</span><span class="sxs-lookup"><span data-stu-id="c0f47-159">dataNodeCount</span></span> |<span data-ttu-id="c0f47-160">hello hello rugalmas keresési fürtben található csomópontok számát.</span><span class="sxs-lookup"><span data-stu-id="c0f47-160">hello number of nodes in hello Elastic Search cluster.</span></span> <span data-ttu-id="c0f47-161">hello hello parancsfájl jelenlegi verziója nem különbözteti meg adatokat és a lekérdezés csomópontok; minden csomópont mindkét szerepet.</span><span class="sxs-lookup"><span data-stu-id="c0f47-161">hello current version of hello script does not distinguish between data and query nodes; all nodes play both roles.</span></span> <span data-ttu-id="c0f47-162">Alapértelmezett too3 csomópontok.</span><span class="sxs-lookup"><span data-stu-id="c0f47-162">Defaults too3 nodes.</span></span> |
| <span data-ttu-id="c0f47-163">dataDiskSize</span><span class="sxs-lookup"><span data-stu-id="c0f47-163">dataDiskSize</span></span> |<span data-ttu-id="c0f47-164">hello mérete (GB) adatlemezek az egyes adatcsomóponton lefoglalt.</span><span class="sxs-lookup"><span data-stu-id="c0f47-164">hello size of data disks (in GB) that is allocated for each data node.</span></span> <span data-ttu-id="c0f47-165">Minden csomópont kap 4 adatlemezek, kizárólag dedikált tooElastic keresési szolgáltatást.</span><span class="sxs-lookup"><span data-stu-id="c0f47-165">Each node receives 4 data disks, exclusively dedicated tooElastic Search service.</span></span> |
| <span data-ttu-id="c0f47-166">Régió</span><span class="sxs-lookup"><span data-stu-id="c0f47-166">region</span></span> |<span data-ttu-id="c0f47-167">Azure-régió, ahol kell lennie a hello rugalmas keresési fürt hello neve.</span><span class="sxs-lookup"><span data-stu-id="c0f47-167">hello name of Azure region where hello Elastic Search cluster should be located.</span></span> |
| <span data-ttu-id="c0f47-168">esUserName</span><span class="sxs-lookup"><span data-stu-id="c0f47-168">esUserName</span></span> |<span data-ttu-id="c0f47-169">hello felhasználónév, amely hello felhasználó konfigurálva toohave hozzáférés tooES fürt (tulajdonos tooHTTP egyszerű hitelesítés).</span><span class="sxs-lookup"><span data-stu-id="c0f47-169">hello user name of hello user that is configured toohave access tooES cluster (subject tooHTTP basic authentication).</span></span> <span data-ttu-id="c0f47-170">hello jelszó paraméterfájl nem része, és meg kell adni, ha `CreateElasticSearchCluster` parancsfájl hívják.</span><span class="sxs-lookup"><span data-stu-id="c0f47-170">hello password is not part of parameters file and must be provided when `CreateElasticSearchCluster` script is invoked.</span></span> |
| <span data-ttu-id="c0f47-171">vmSizeDataNodes</span><span class="sxs-lookup"><span data-stu-id="c0f47-171">vmSizeDataNodes</span></span> |<span data-ttu-id="c0f47-172">hello rugalmas keresési fürtcsomópontok esetén, az Azure virtuális gép méretét.</span><span class="sxs-lookup"><span data-stu-id="c0f47-172">hello Azure virtual machine size for Elastic Search cluster nodes.</span></span> <span data-ttu-id="c0f47-173">Alapértelmezett tooStandard_D2.</span><span class="sxs-lookup"><span data-stu-id="c0f47-173">Defaults tooStandard_D2.</span></span> |

<span data-ttu-id="c0f47-174">Most már készen áll a toorun hello parancsfájl áll.</span><span class="sxs-lookup"><span data-stu-id="c0f47-174">Now you are ready toorun hello script.</span></span> <span data-ttu-id="c0f47-175">A probléma hello a következő parancsot:</span><span class="sxs-lookup"><span data-stu-id="c0f47-175">Issue hello following command:</span></span>

```powershell
CreateElasticSearchCluster -ResourceGroupName <es-group-name> -Region <azure-region> -EsPassword <es-password>
```

<span data-ttu-id="c0f47-176">Ha</span><span class="sxs-lookup"><span data-stu-id="c0f47-176">where</span></span> 

| <span data-ttu-id="c0f47-177">Parancsfájl-paraméter neve</span><span class="sxs-lookup"><span data-stu-id="c0f47-177">Script Parameter Name</span></span> | <span data-ttu-id="c0f47-178">Leírás</span><span class="sxs-lookup"><span data-stu-id="c0f47-178">Description</span></span> |
| --- | --- |
| `<es-group-name>` |<span data-ttu-id="c0f47-179">hello összes rugalmas keresési fürterőforrás tartalmazó hello Azure erőforráscsoport nevét.</span><span class="sxs-lookup"><span data-stu-id="c0f47-179">hello name of hello Azure resource group that will contain all Elastic Search cluster resources.</span></span> |
| `<azure-region>` |<span data-ttu-id="c0f47-180">hello neve hello Azure-régió, ahol hello rugalmas keresési fürt kell létrehozni.</span><span class="sxs-lookup"><span data-stu-id="c0f47-180">hello name of hello Azure region where hello Elastic Search cluster should be created.</span></span> |
| `<es-password>` |<span data-ttu-id="c0f47-181">hello hello rugalmas keresési felhasználó jelszavát.</span><span class="sxs-lookup"><span data-stu-id="c0f47-181">hello password for hello Elastic Search user.</span></span> |

> [!NOTE]
> <span data-ttu-id="c0f47-182">Ha egy NullReferenceException hello teszt-használják parancsmag, a tooAzure toolog elfelejtette (`Add-AzureRmAccount`).</span><span class="sxs-lookup"><span data-stu-id="c0f47-182">If you get a NullReferenceException from hello Test-AzureResourceGroup cmdlet, you have forgotten toolog on tooAzure (`Add-AzureRmAccount`).</span></span>
> 
> 

<span data-ttu-id="c0f47-183">Ha hibaüzenetet kap hello parancsfájl futtatását, és annak meghatározását, hogy hello hiba okozta-e a megfelelő sablon paraméter értékét, hello paraméterfájl javítsa ki, és futtassa újra hello parancsfájl másik erőforráscsoport-nevet.</span><span class="sxs-lookup"><span data-stu-id="c0f47-183">If you get an error from running hello script and you determine that hello error was caused by a wrong template parameter value, correct hello parameter file and run hello script again with a different resource group name.</span></span> <span data-ttu-id="c0f47-184">Is felhasználhatja hello ugyanazt az erőforráscsoport neve és karbantartása hello régi hello parancsfájl rendelkezik hello hozzáadásával `-RemoveExistingResourceGroup` paraméter toohello parancsfájl hívása.</span><span class="sxs-lookup"><span data-stu-id="c0f47-184">You can also reuse hello same resource group name and have hello script clean up hello old one by adding hello `-RemoveExistingResourceGroup` parameter toohello script invocation.</span></span>

### <a name="result-of-running-hello-createelasticsearchcluster-script"></a><span data-ttu-id="c0f47-185">Hello CreateElasticSearchCluster parancsprogram futtatása eredménye</span><span class="sxs-lookup"><span data-stu-id="c0f47-185">Result of running hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="c0f47-186">Miután lefuttatta a hello `CreateElasticSearchCluster` parancsfájl, a következő fő összetevők hello jön létre.</span><span class="sxs-lookup"><span data-stu-id="c0f47-186">After you run hello `CreateElasticSearchCluster` script, hello following main artifacts will be created.</span></span> <span data-ttu-id="c0f47-187">Az ebben a példában feltételezzük, hogy használja a "myBigCluster" hello hello értékeként `dnsNameForLoadBalancerIP` paraméter adott hello régióban, amelyben létrehozta hello fürt pedig USA nyugati régiója.</span><span class="sxs-lookup"><span data-stu-id="c0f47-187">For this example we assume that you have used "myBigCluster" as hello value of hello `dnsNameForLoadBalancerIP` parameter and that hello region where you created hello cluster is West US.</span></span>

| <span data-ttu-id="c0f47-188">Összetevő</span><span class="sxs-lookup"><span data-stu-id="c0f47-188">Artifact</span></span> | <span data-ttu-id="c0f47-189">Nevét, helyét és megjegyzések</span><span class="sxs-lookup"><span data-stu-id="c0f47-189">Name, location, and remarks</span></span> |
| --- | --- |
| <span data-ttu-id="c0f47-190">SSH-kulcs Távfelügyelet</span><span class="sxs-lookup"><span data-stu-id="c0f47-190">SSH key for remote administration</span></span> |<span data-ttu-id="c0f47-191">myBigCluster.key fájl (hello CreateElasticSearchCluster lett futtassa mely hello).</span><span class="sxs-lookup"><span data-stu-id="c0f47-191">myBigCluster.key file (in hello directory from which hello CreateElasticSearchCluster was run).</span></span> <br /><br /><span data-ttu-id="c0f47-192">A kulcsfájl lehet használt tooconnect toohello admin csomópont és (keresztül hello admin csomópont) toodata hello fürt csomópontja.</span><span class="sxs-lookup"><span data-stu-id="c0f47-192">This key file can be used tooconnect toohello admin node and (through hello admin node) toodata nodes in hello cluster.</span></span> |
| <span data-ttu-id="c0f47-193">Felügyelet munkaterület</span><span class="sxs-lookup"><span data-stu-id="c0f47-193">Admin node</span></span> |<span data-ttu-id="c0f47-194">myBigCluster-admin.westus.cloudapp.azure.com</span><span class="sxs-lookup"><span data-stu-id="c0f47-194">myBigCluster-admin.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="c0f47-195">A dedikált virtuális gépek Elasticsearch fürt Távfelügyelet – hello csak egyet, amely lehetővé teszi, hogy a külső SSH-kapcsolatokhoz.</span><span class="sxs-lookup"><span data-stu-id="c0f47-195">A dedicated VM for remote Elasticsearch cluster administration--hello only one that allows external SSH connections.</span></span> <span data-ttu-id="c0f47-196">Az összes hello Elasticsearch fürtcsomópontok, de az azonos virtuális hálózaton does hello Elasticsearch szolgáltatások futtassa fut.</span><span class="sxs-lookup"><span data-stu-id="c0f47-196">It runs on hello same virtual network as all hello Elasticsearch cluster nodes, but it does not run any Elasticsearch services.</span></span> |
| <span data-ttu-id="c0f47-197">Adatok csomópontok</span><span class="sxs-lookup"><span data-stu-id="c0f47-197">Data nodes</span></span> |<span data-ttu-id="c0f47-198">myBigCluster1...</span><span class="sxs-lookup"><span data-stu-id="c0f47-198">myBigCluster1 …</span></span> <span data-ttu-id="c0f47-199">myBigCluster*N*</span><span class="sxs-lookup"><span data-stu-id="c0f47-199">myBigCluster*N*</span></span> <br /><br /><span data-ttu-id="c0f47-200">Adatok csomópontok Elasticsearch és Kibana szolgáltatások futnak.</span><span class="sxs-lookup"><span data-stu-id="c0f47-200">Data nodes that are running Elasticsearch and Kibana services.</span></span> <span data-ttu-id="c0f47-201">SSH tooeach csomópont keresztül, de csak hello admin csomópont keresztül is elérheti.</span><span class="sxs-lookup"><span data-stu-id="c0f47-201">You can connect via SSH tooeach node, but only via hello admin node.</span></span> |
| <span data-ttu-id="c0f47-202">Elasticsearch fürt</span><span class="sxs-lookup"><span data-stu-id="c0f47-202">Elasticsearch cluster</span></span> |<span data-ttu-id="c0f47-203">http://myBigCluster.westus.cloudapp.Azure.com/es/</span><span class="sxs-lookup"><span data-stu-id="c0f47-203">http://myBigCluster.westus.cloudapp.azure.com/es/</span></span> <br /><br /><span data-ttu-id="c0f47-204">hello elsődleges végpont hello Elasticsearch fürthöz (Megjegyzés: hello /es utótag).</span><span class="sxs-lookup"><span data-stu-id="c0f47-204">hello primary endpoint for hello Elasticsearch cluster (note hello /es suffix).</span></span> <span data-ttu-id="c0f47-205">Alapszintű HTTP-hitelesítés védi (volt hello megadott esUserName/esPassword paraméterek hello ES-MultiNode sablon hello hitelesítő adatok).</span><span class="sxs-lookup"><span data-stu-id="c0f47-205">It is protected by basic HTTP authentication (hello credentials were hello specified esUserName/esPassword parameters of hello ES-MultiNode template).</span></span> <span data-ttu-id="c0f47-206">hello fürt rendelkezik is hello head beépülő modul telepítve (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) alapvető Fürtfelügyelet.</span><span class="sxs-lookup"><span data-stu-id="c0f47-206">hello cluster has also hello head plug-in installed (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) for basic cluster administration.</span></span> |
| <span data-ttu-id="c0f47-207">Kibana szolgáltatás</span><span class="sxs-lookup"><span data-stu-id="c0f47-207">Kibana service</span></span> |<span data-ttu-id="c0f47-208">http://myBigCluster.westus.cloudapp.Azure.com</span><span class="sxs-lookup"><span data-stu-id="c0f47-208">http://myBigCluster.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="c0f47-209">hello Kibana szolgáltatás tooshow adatok beállítása a hello Elasticsearch fürtöt létrehozni.</span><span class="sxs-lookup"><span data-stu-id="c0f47-209">hello Kibana service is set up tooshow data from hello created Elasticsearch cluster.</span></span> <span data-ttu-id="c0f47-210">Hello védi, hello ugyanazon hitelesítő fürt magát.</span><span class="sxs-lookup"><span data-stu-id="c0f47-210">It is protected by hello same authentication credentials as hello cluster itself.</span></span> |

## <a name="in-process-versus-out-of-process-trace-capturing"></a><span data-ttu-id="c0f47-211">A folyamat és a folyamaton a nyomkövetés rögzítése</span><span class="sxs-lookup"><span data-stu-id="c0f47-211">In-process versus out-of-process trace capturing</span></span>
<span data-ttu-id="c0f47-212">Hello bevezetésben azt említett két alapvető módokat diagnosztikai adatok gyűjtése: a folyamat és a folyamaton.</span><span class="sxs-lookup"><span data-stu-id="c0f47-212">In hello introduction, we mentioned two fundamental ways of collecting diagnostic data: in-process and out-of-process.</span></span> <span data-ttu-id="c0f47-213">Mindegyik rendelkezik-e előnyeiről és hátrányairól.</span><span class="sxs-lookup"><span data-stu-id="c0f47-213">Each has strengths and weaknesses.</span></span>

<span data-ttu-id="c0f47-214">Hello előnyei **folyamaton belüli nyomkövetés rögzítése** tartalmazza:</span><span class="sxs-lookup"><span data-stu-id="c0f47-214">Advantages of hello **in-process trace capturing** include:</span></span>

1. <span data-ttu-id="c0f47-215">*Egyszerű konfiguráció és a központi telepítés*</span><span class="sxs-lookup"><span data-stu-id="c0f47-215">*Easy configuration and deployment*</span></span>
   
   * <span data-ttu-id="c0f47-216">diagnosztikai adatok gyűjtésének hello konfigurálása most nem része az hello alkalmazás konfigurációja.</span><span class="sxs-lookup"><span data-stu-id="c0f47-216">hello configuration of diagnostic data collection is just part of hello application configuration.</span></span> <span data-ttu-id="c0f47-217">Egyszerű tooalways megőrzése "szinkronizálva" hello, rest-hello alkalmazás is.</span><span class="sxs-lookup"><span data-stu-id="c0f47-217">It is easy tooalways keep it "in sync" with hello rest of hello application.</span></span>
   * <span data-ttu-id="c0f47-218">Alkalmazás vagy a szolgáltatás konfigurációja, könnyen elérhető.</span><span class="sxs-lookup"><span data-stu-id="c0f47-218">Per-application or per-service configuration is easily achievable.</span></span>
   * <span data-ttu-id="c0f47-219">Folyamaton-nyomkövetés rögzítése általában külön telepítési és a szükséges konfigurációs hello diagnosztikai ügynök, amely extra felügyeleti feladatot, és a hibák lehetséges forrását.</span><span class="sxs-lookup"><span data-stu-id="c0f47-219">Out-of-process trace capturing usually requires a separate deployment and configuration of hello diagnostic agent, which is an extra administrative task and a potential source of errors.</span></span> <span data-ttu-id="c0f47-220">hello adott ügynök technológia gyakran lehetővé teszi, hogy a virtuális gépenként (csomópont) hello ügynök csak egy példánya.</span><span class="sxs-lookup"><span data-stu-id="c0f47-220">hello particular agent technology often allows only one instance of hello agent per virtual machine (node).</span></span> <span data-ttu-id="c0f47-221">Ez azt jelenti, hogy a konfigurálás hello diagnosztikai konfiguráció hello gyűjtemény összes alkalmazás által közösen, és ezen a csomóponton futó szolgáltatásokat.</span><span class="sxs-lookup"><span data-stu-id="c0f47-221">This means that configuration for hello collection of hello diagnostic configuration is shared among all applications and services running on that node.</span></span>
2. <span data-ttu-id="c0f47-222">*Rugalmasság*</span><span class="sxs-lookup"><span data-stu-id="c0f47-222">*Flexibility*</span></span>
   
   * <span data-ttu-id="c0f47-223">hello alkalmazás adatküldés hello bárhol toogo, kell, amíg nincs egy ügyféloldali kódtár megcélzott hello adatok tárolórendszer támogató.</span><span class="sxs-lookup"><span data-stu-id="c0f47-223">hello application can send hello data wherever it needs toogo, as long as there is a client library that supports hello targeted data storage system.</span></span> <span data-ttu-id="c0f47-224">Új mosdók felveheti igény szerint.</span><span class="sxs-lookup"><span data-stu-id="c0f47-224">New sinks can be added as desired.</span></span>
   * <span data-ttu-id="c0f47-225">Összetett rögzítési, szűrési és adatösszesítés szabályok kétféleképpen valósítható meg.</span><span class="sxs-lookup"><span data-stu-id="c0f47-225">Complex capture, filtering, and data-aggregation rules can be implemented.</span></span>
   * <span data-ttu-id="c0f47-226">Egy folyamaton-nyomkövetés rögzítése gyakran korlátozott általi hello adatok, amelyek hello ügynök támogatja.</span><span class="sxs-lookup"><span data-stu-id="c0f47-226">An out-of-process trace capturing is often limited by hello data sinks that hello agent supports.</span></span> <span data-ttu-id="c0f47-227">Néhány ügynökök olyan bővíthető.</span><span class="sxs-lookup"><span data-stu-id="c0f47-227">Some agents are extensible.</span></span>
3. <span data-ttu-id="c0f47-228">*Hozzáférés toointernal alkalmazásadatok és a környezetben*</span><span class="sxs-lookup"><span data-stu-id="c0f47-228">*Access toointernal application data and context*</span></span>
   
   * <span data-ttu-id="c0f47-229">hello diagnosztikai alrendszer hello alkalmazás/kiszolgáló folyamat belül futó könnyen is kiegészítheti hello nyomkövetések környezetfüggő adatokkal.</span><span class="sxs-lookup"><span data-stu-id="c0f47-229">hello diagnostic subsystem running inside hello application/service process can easily augment hello traces with contextual information.</span></span>
   * <span data-ttu-id="c0f47-230">Hello-folyamaton kívüli módszert használja, a hello adatokat kell elküldeni tooan ügynök keresztül bizonyos folyamatok közti kommunikációs mechanizmus, például a Windows esemény-nyomkövetése.</span><span class="sxs-lookup"><span data-stu-id="c0f47-230">In hello out-of-process approach, hello data must be sent tooan agent via some inter-process communication mechanism, such as Event Tracing for Windows.</span></span> <span data-ttu-id="c0f47-231">Ez az eljárás további sikerült korlátozható.</span><span class="sxs-lookup"><span data-stu-id="c0f47-231">This mechanism could impose additional limitations.</span></span>

<span data-ttu-id="c0f47-232">Hello előnyei **folyamaton-nyomkövetés rögzítése** tartalmazza:</span><span class="sxs-lookup"><span data-stu-id="c0f47-232">Advantages of hello **out-of-process trace capturing** include:</span></span>

1. <span data-ttu-id="c0f47-233">*képes toomonitor hello alkalmazás hello és összeomlási memóriaképek összegyűjtése*</span><span class="sxs-lookup"><span data-stu-id="c0f47-233">*hello ability toomonitor hello application and collect crash dumps*</span></span>
   
   * <span data-ttu-id="c0f47-234">A folyamaton belüli nyomkövetés rögzítése sikertelen lehet, ha hello alkalmazás toostart meghibásodik, vagy összeomlik.</span><span class="sxs-lookup"><span data-stu-id="c0f47-234">In-process trace capturing may be unsuccessful if hello application fails toostart or crashes.</span></span> <span data-ttu-id="c0f47-235">Független ügynök sokkal nagyobb lehetséges, hogy a kritikus fontosságú hibaelhárítási információkat tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="c0f47-235">An independent agent has a much better chance of capturing crucial troubleshooting information.</span></span><br /><br />
2. <span data-ttu-id="c0f47-236">*Lejárat robusztusság és bevált teljesítmény*</span><span class="sxs-lookup"><span data-stu-id="c0f47-236">*Maturity, robustness, and proven performance*</span></span>
   
   * <span data-ttu-id="c0f47-237">Az ügynök (például egy Microsoft Azure diagnosztikai ügynök) platform szállító által fejlesztett tulajdonos toorigorous tesztelése és túlélésért folyó-korlátozási lett.</span><span class="sxs-lookup"><span data-stu-id="c0f47-237">An agent developed by a platform vendor (such as a Microsoft Azure Diagnostics agent) has been subject toorigorous testing and battle-hardening.</span></span>
   * <span data-ttu-id="c0f47-238">A folyamaton belüli nyomkövetési rögzítését, a gondot kell fordítani a tooensure, hogy elküldi a diagnosztikai adatokat az alkalmazás folyamatának hello tevékenység nem hello alkalmazás fő feladatok megzavarhatja vagy időzítés vagy a teljesítmény problémák bevezetni.</span><span class="sxs-lookup"><span data-stu-id="c0f47-238">With in-process trace capturing, care must be taken tooensure that hello activity of sending diagnostic data from an application process does not interfere with hello application's main tasks or introduce timing or performance problems.</span></span> <span data-ttu-id="c0f47-239">Egymástól függetlenül futó ügynök kevesebb a hibalehetőség toothese problémák és tervezett toolimit kifejezetten a hello rendszer kifejtett hatását.</span><span class="sxs-lookup"><span data-stu-id="c0f47-239">An independently running agent is less prone toothese issues and is specifically designed toolimit its impact on hello system.</span></span>

<span data-ttu-id="c0f47-240">Ez nem lehetséges toocombine és mindkét megközelítés hasznos.</span><span class="sxs-lookup"><span data-stu-id="c0f47-240">It is possible toocombine and benefit from both approaches.</span></span> <span data-ttu-id="c0f47-241">Ezenkívül előfordulhat, hogy számos alkalmazás hello legjobb megoldást.</span><span class="sxs-lookup"><span data-stu-id="c0f47-241">Indeed, it might be hello best solution for many applications.</span></span>

<span data-ttu-id="c0f47-242">Itt használjuk hello **Microsoft.Diagnostic.Listeners könyvtár** és hello folyamaton belüli követéséhez fürtről a Service Fabric application tooan Elasticsearch toosend adatok rögzítéséhez.</span><span class="sxs-lookup"><span data-stu-id="c0f47-242">Here, we use hello **Microsoft.Diagnostic.Listeners library** and hello in-process trace capturing toosend data from a Service Fabric application tooan Elasticsearch cluster.</span></span>

## <a name="use-hello-listeners-library-toosend-diagnostic-data-tooelasticsearch"></a><span data-ttu-id="c0f47-243">Hello figyelői könyvtár toosend diagnosztikai adatok tooElasticsearch használata</span><span class="sxs-lookup"><span data-stu-id="c0f47-243">Use hello Listeners library toosend diagnostic data tooElasticsearch</span></span>
<span data-ttu-id="c0f47-244">hello Microsoft.Diagnostic.Listeners könyvtár PartyCluster minta Service Fabric-alkalmazás részét képezi.</span><span class="sxs-lookup"><span data-stu-id="c0f47-244">hello Microsoft.Diagnostic.Listeners library is part of PartyCluster sample Service Fabric application.</span></span> <span data-ttu-id="c0f47-245">toouse azt:</span><span class="sxs-lookup"><span data-stu-id="c0f47-245">toouse it:</span></span>

1. <span data-ttu-id="c0f47-246">Töltse le [hello PartyCluster minta](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) a Githubról.</span><span class="sxs-lookup"><span data-stu-id="c0f47-246">Download [hello PartyCluster sample](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) from GitHub.</span></span>
2. <span data-ttu-id="c0f47-247">Hello Microsoft.Diagnostics.Listeners és Microsoft.Diagnostics.Listeners.Fabric projektek (teljes mappák) másolása hello PartyCluster minta toohello megoldás könyvtármappát toosend hello adatok tooElasticsearch kellene hello-alkalmazás .</span><span class="sxs-lookup"><span data-stu-id="c0f47-247">Copy hello Microsoft.Diagnostics.Listeners and Microsoft.Diagnostics.Listeners.Fabric projects (whole folders) from hello PartyCluster sample directory toohello solution folder of hello application that is supposed toosend hello data tooElasticsearch.</span></span>
3. <span data-ttu-id="c0f47-248">Nyissa meg hello cél megoldást, kattintson a jobb gombbal a Megoldáskezelőben hello hello megoldás csomópontja, és válassza **létező projekt hozzáadása**.</span><span class="sxs-lookup"><span data-stu-id="c0f47-248">Open hello target solution, right-click hello solution node in hello Solution Explorer, and choose **Add Existing Project**.</span></span> <span data-ttu-id="c0f47-249">Adja hozzá a hello Microsoft.Diagnostics.Listeners projekt toohello megoldás.</span><span class="sxs-lookup"><span data-stu-id="c0f47-249">Add hello Microsoft.Diagnostics.Listeners project toohello solution.</span></span> <span data-ttu-id="c0f47-250">Az ismételt hello azonos hello Microsoft.Diagnostics.Listeners.Fabric projekt.</span><span class="sxs-lookup"><span data-stu-id="c0f47-250">Repeat hello same for hello Microsoft.Diagnostics.Listeners.Fabric project.</span></span>
4. <span data-ttu-id="c0f47-251">Vegye fel a projektbe egy hivatkozást a szolgáltatás projekt(ek) toohello két hozzáadott projektek.</span><span class="sxs-lookup"><span data-stu-id="c0f47-251">Add a project reference from your service project(s) toohello two added projects.</span></span> <span data-ttu-id="c0f47-252">(Minden egyes szolgáltatás toosend adatok tooElasticsearch kellene hivatkoznia kell Microsoft.Diagnostics.EventListeners és Microsoft.Diagnostics.EventListeners.Fabric).</span><span class="sxs-lookup"><span data-stu-id="c0f47-252">(Each service that is supposed toosend data tooElasticsearch should reference Microsoft.Diagnostics.EventListeners and Microsoft.Diagnostics.EventListeners.Fabric).</span></span>
   
    ![Projekt hivatkozik tooMicrosoft.Diagnostics.EventListeners és Microsoft.Diagnostics.EventListeners.Fabric könyvtárak][1]

### <a name="service-fabric-general-availability-release-and-microsoftdiagnosticstracing-nuget-package"></a><span data-ttu-id="c0f47-254">Service Fabric általános rendelkezésre állási kiadás és Microsoft.Diagnostics.Tracing Nuget-csomag</span><span class="sxs-lookup"><span data-stu-id="c0f47-254">Service Fabric General Availability release and Microsoft.Diagnostics.Tracing Nuget package</span></span>
<span data-ttu-id="c0f47-255">Service Fabric általános rendelkezésre állási kiadásban (2.0.135, 2016. március 31-én kiadott) készült alkalmazások cél **.NET-keretrendszer 4.5.2-es**.</span><span class="sxs-lookup"><span data-stu-id="c0f47-255">Applications built with Service Fabric General Availability release (2.0.135, released March 31, 2016) target **.NET Framework 4.5.2**.</span></span> <span data-ttu-id="c0f47-256">Ezen verziója hello legmagasabb hello hello GA kiadás hello időben Azure által támogatott .NET-keretrendszer verzióját.</span><span class="sxs-lookup"><span data-stu-id="c0f47-256">This version is hello highest version of hello .NET Framework supported by Azure at hello time of hello GA release.</span></span> <span data-ttu-id="c0f47-257">Sajnos hello keretrendszer ezen verziója nem rendelkezik bizonyos eseményfigyelő Visszahívásán API-k, hogy hello Microsoft.Diagnostics.Listeners könyvtárban van szüksége.</span><span class="sxs-lookup"><span data-stu-id="c0f47-257">Unfortunately, this version of hello framework lacks certain EventListener APIs that hello Microsoft.Diagnostics.Listeners library needs.</span></span> <span data-ttu-id="c0f47-258">(A háló alkalmazások API-k naplózás hello alapját képező hello összetevő) EventSource és eseményfigyelő Visszahívásán szorosan összekapcsolt, mert minden olyan projekthez, hello Microsoft.Diagnostics.Listeners függvénytár kell használnia egy alternatív implementáció a EventSource.</span><span class="sxs-lookup"><span data-stu-id="c0f47-258">Because EventSource (hello component that forms hello basis of logging APIs in Fabric applications) and EventListener are tightly coupled, every project that uses hello Microsoft.Diagnostics.Listeners library must use an alternative implementation of EventSource.</span></span> <span data-ttu-id="c0f47-259">Ez a megvalósítás hello által biztosított **Microsoft.Diagnostics.Tracing Nuget-csomag**, Microsoft által fejlesztett.</span><span class="sxs-lookup"><span data-stu-id="c0f47-259">This implementation is provided by hello **Microsoft.Diagnostics.Tracing Nuget package**, authored by Microsoft.</span></span> <span data-ttu-id="c0f47-260">hello csomag teljesen visszamenőlegesen kompatibilis EventSource szerepel hello framework, ezért nem kódmódosításokat szükséges hivatkozott névtér végrehajtott kell lennie.</span><span class="sxs-lookup"><span data-stu-id="c0f47-260">hello package is fully backward-compatible with EventSource included in hello framework, so no code changes should be necessary other than referenced namespace changes.</span></span>

<span data-ttu-id="c0f47-261">toostart hello Microsoft.Diagnostics.Tracing megvalósításával hello EventSource osztályból, kövesse az alábbi lépéseket kell toosend adatok tooElasticsearch minden szolgáltatás projekt esetében:</span><span class="sxs-lookup"><span data-stu-id="c0f47-261">toostart using hello Microsoft.Diagnostics.Tracing implementation of hello EventSource class, follow these steps for each service project that needs toosend data tooElasticsearch:</span></span>

1. <span data-ttu-id="c0f47-262">Kattintson jobb gombbal a hello projektet, és válassza a **Nuget-csomagok kezelése**.</span><span class="sxs-lookup"><span data-stu-id="c0f47-262">Right-click on hello service project and choose **Manage Nuget Packages**.</span></span>
2. <span data-ttu-id="c0f47-263">Váltás toohello nuget.org csomag forrása (Ha még nincs kiválasztva), és keressen a "**Microsoft.Diagnostics.Tracing**".</span><span class="sxs-lookup"><span data-stu-id="c0f47-263">Switch toohello nuget.org package source (if it is not already selected) and search for "**Microsoft.Diagnostics.Tracing**".</span></span>
3. <span data-ttu-id="c0f47-264">Telepítse a hello `Microsoft.Diagnostics.Tracing.EventSource` csomagot (és függőségeinek).</span><span class="sxs-lookup"><span data-stu-id="c0f47-264">Install hello `Microsoft.Diagnostics.Tracing.EventSource` package (and its dependencies).</span></span>
4. <span data-ttu-id="c0f47-265">Nyissa meg hello **ServiceEventSource.cs** vagy **ActorEventSource.cs** szolgáltatásprojektre fájlt, és cserélje le a hello `using System.Diagnostics.Tracing` irányelv fölött hello hello fájl `using Microsoft.Diagnostics.Tracing` direktíva.</span><span class="sxs-lookup"><span data-stu-id="c0f47-265">Open hello **ServiceEventSource.cs** or **ActorEventSource.cs** file in your service project and replace hello `using System.Diagnostics.Tracing` directive on top of hello file with hello `using Microsoft.Diagnostics.Tracing` directive.</span></span>

<span data-ttu-id="c0f47-266">Ezeket a lépéseket csak akkor szükséges egyszer hello **.NET-keretrendszer 4.6** Microsoft Azure támogatja.</span><span class="sxs-lookup"><span data-stu-id="c0f47-266">These steps will not be necessary once hello **.NET Framework 4.6** is supported by Microsoft Azure.</span></span>

### <a name="elasticsearch-listener-instantiation-and-configuration"></a><span data-ttu-id="c0f47-267">Elasticsearch figyelő által okozott és konfigurálása</span><span class="sxs-lookup"><span data-stu-id="c0f47-267">Elasticsearch listener instantiation and configuration</span></span>
<span data-ttu-id="c0f47-268">hello tooElasticsearch diagnosztikai adatok küldése az utolsó lépés példánya toocreate: `ElasticSearchListener` konfigurálása Elasticsearch kapcsolati adatait.</span><span class="sxs-lookup"><span data-stu-id="c0f47-268">hello final step for sending diagnostic data tooElasticsearch is toocreate an instance of `ElasticSearchListener` and configure it with Elasticsearch connection data.</span></span> <span data-ttu-id="c0f47-269">hello figyelő automatikusan a hello szolgáltatás projektben EventSource osztályba keresztül kiváltott összes eseményeket rögzíti.</span><span class="sxs-lookup"><span data-stu-id="c0f47-269">hello listener automatically captures all events raised via EventSource classes defined in hello service project.</span></span> <span data-ttu-id="c0f47-270">Jogcímadatokat toobe hello szolgáltatás hello élettartama során, ajánlott hello helyezze toocreate hello szolgáltatás inicializálása kódban van.</span><span class="sxs-lookup"><span data-stu-id="c0f47-270">It needs toobe alive during hello lifetime of hello service, so hello best place toocreate it is in hello service initialization code.</span></span> <span data-ttu-id="c0f47-271">Ez az állapotmentes szolgáltatások hello inicializálási kód sikerült megjelenését hello szükséges módosítása után (kiegészítéseket jelölt kezdve megjegyzések `****`):</span><span class="sxs-lookup"><span data-stu-id="c0f47-271">Here is how hello initialization code for a stateless service could look after hello necessary changes (additions pointed out in comments starting with `****`):</span></span>

```csharp
using System;
using System.Diagnostics;
using System.Fabric;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.ServiceFabric.Services.Runtime;

// **** Add hello following directives
using Microsoft.Diagnostics.EventListeners;
using Microsoft.Diagnostics.EventListeners.Fabric;

namespace Stateless1
{
    internal static class Program
    {
        /// <summary>
        /// This is hello entry point of hello service host process.
        /// </summary>        
        private static void Main()
        {
            try
            {
                // **** Instantiate ElasticSearchListener
                var configProvider = new FabricConfigurationProvider("ElasticSearchEventListener");
                ElasticSearchListener esListener = null;
                if (configProvider.HasConfiguration)
                {
                    esListener = new ElasticSearchListener(configProvider, new FabricHealthReporter("ElasticSearchEventListener"));
                }

                // hello ServiceManifest.XML file defines one or more service type names.
                // Registering a service maps a service type name tooa .NET type.
                // When Service Fabric creates an instance of this service type,
                // an instance of hello class is created in this host process.

                ServiceRuntime.RegisterServiceAsync("Stateless1Type", 
                    context => new Stateless1(context)).GetAwaiter().GetResult();

                ServiceEventSource.Current.ServiceTypeRegistered(Process.GetCurrentProcess().Id, typeof(Stateless1).Name);

                // Prevents this host process from terminating so services keep running.
                Thread.Sleep(Timeout.Infinite);

                // **** Ensure that hello ElasticSearchListner instance is not garbage-collected prematurely
                GC.KeepAlive(esListener);
            }
            catch (Exception e)
            {
                ServiceEventSource.Current.ServiceHostInitializationFailed(e);
                throw;
            }
        }
    }
}
```

<span data-ttu-id="c0f47-272">Elasticsearch kapcsolati adatait kell rendezni egy külön szakaszban hello szolgáltatás konfigurációs fájljában (**PackageRoot\Config\Settings.xml**).</span><span class="sxs-lookup"><span data-stu-id="c0f47-272">Elasticsearch connection data should be put in a separate section in hello service configuration file (**PackageRoot\Config\Settings.xml**).</span></span> <span data-ttu-id="c0f47-273">hello szakasz hello nevét meg kell felelnie a toohello átadott toohello érték `FabricConfigurationProvider` konstruktor, például:</span><span class="sxs-lookup"><span data-stu-id="c0f47-273">hello name of hello section must correspond toohello value passed toohello `FabricConfigurationProvider` constructor, for example:</span></span>

```xml
<Section Name="ElasticSearchEventListener">
  <Parameter Name="serviceUri" Value="http://myBigCluster.westus.cloudapp.azure.com/es/" />
  <Parameter Name="userName" Value="(ES user name)" />
  <Parameter Name="password" Value="(ES user password)" />
  <Parameter Name="indexNamePrefix" Value="myapp" />
</Section>
```
<span data-ttu-id="c0f47-274">az értékek hello `serviceUri`, `userName` és `password` paraméterek megfelelnek toohello Elasticsearch fürt végpontcím Elasticsearch felhasználónevet és jelszót, illetve.</span><span class="sxs-lookup"><span data-stu-id="c0f47-274">hello values of `serviceUri`, `userName` and `password` parameters correspond toohello Elasticsearch cluster endpoint address, Elasticsearch user name, and password, respectively.</span></span> <span data-ttu-id="c0f47-275">`indexNamePrefix`hello előtag Elasticsearch indexek; hello Microsoft.Diagnostics.Listeners library naponta a saját adataikhoz új index létrehozása.</span><span class="sxs-lookup"><span data-stu-id="c0f47-275">`indexNamePrefix` is hello prefix for Elasticsearch indexes; hello Microsoft.Diagnostics.Listeners library creates a new index for its data daily.</span></span>

### <a name="verification"></a><span data-ttu-id="c0f47-276">Ellenőrzés</span><span class="sxs-lookup"><span data-stu-id="c0f47-276">Verification</span></span>
<span data-ttu-id="c0f47-277">Ennyi az egész!</span><span class="sxs-lookup"><span data-stu-id="c0f47-277">That's it!</span></span> <span data-ttu-id="c0f47-278">Most hello szolgáltatás fut, amikor elindítja nyomkövetések toohello Elasticsearch szolgáltatás hello konfigurációjában megadott küldésekor.</span><span class="sxs-lookup"><span data-stu-id="c0f47-278">Now, whenever hello service is run, it starts sending traces toohello Elasticsearch service specified in hello configuration.</span></span> <span data-ttu-id="c0f47-279">Ellenőrizheti a nyitó hello hello cél Elasticsearch példányához tartozó Kibana felhasználói felület.</span><span class="sxs-lookup"><span data-stu-id="c0f47-279">You can verify this by opening hello Kibana UI associated with hello target Elasticsearch instance.</span></span> <span data-ttu-id="c0f47-280">A jelen példában hello lap címe http://myBigCluster.westus.cloudapp.azure.com/.</span><span class="sxs-lookup"><span data-stu-id="c0f47-280">In our example, hello page address is http://myBigCluster.westus.cloudapp.azure.com/.</span></span> <span data-ttu-id="c0f47-281">Ellenőrizze, hogy az hello választott hello neve előtaggal indexeli `ElasticSearchListener` példány valóban létrehozott és adatokkal feltöltve.</span><span class="sxs-lookup"><span data-stu-id="c0f47-281">Check that indexes with hello name prefix chosen for hello `ElasticSearchListener` instance have indeed been created and populated with data.</span></span>

![Kibana ábrázoló PartyCluster alkalmazásesemények][2]

## <a name="next-steps"></a><span data-ttu-id="c0f47-283">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="c0f47-283">Next steps</span></span>
* [<span data-ttu-id="c0f47-284">További információk felderítésére, és a Service Fabric-szolgáltatás figyelése</span><span class="sxs-lookup"><span data-stu-id="c0f47-284">Learn more about diagnosing and monitoring a Service Fabric service</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

<!--Image references-->
[1]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/listener-lib-references.png
[2]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/kibana.png
