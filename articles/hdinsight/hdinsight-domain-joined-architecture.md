---
title: "Tartományhoz csatlakozó Azure HDInsight-architektúra |} Microsoft Docs"
description: "Útmutató a tartományhoz csatlakoztatott HDInsight tervezéséhez."
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 7e34f47f09466a40993b4cc797ff1cad2bdaeafe
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="1654c-103">Azure-tartományhoz csatlakoztatott Hadoop-fürtök tervezése a HDInsightban</span><span class="sxs-lookup"><span data-stu-id="1654c-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="1654c-104">A hagyományos Hadoop egy egyfelhasználós fürt.</span><span class="sxs-lookup"><span data-stu-id="1654c-104">The traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="1654c-105">Ez megfelel a legtöbb olyan cégnek, amelyekben kisebb alkalmazásfejlesztő csapatok dolgoznak a nagy adatszámítási feladatok kiépítésén.</span><span class="sxs-lookup"><span data-stu-id="1654c-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="1654c-106">A Hadoop növekvő népszerűségével, sok vállalat vált olyan modellre, ahol a fürtöket az informatikai csapatok felügyelik, és több alkalmazásfejlesztő csapat is dolgozik ugyanazokon a fürtökön.</span><span class="sxs-lookup"><span data-stu-id="1654c-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="1654c-107">Így a többfelhasználós fürtöket használó funkció az egyik legtöbbet kért funkció a HDInsightban.</span><span class="sxs-lookup"><span data-stu-id="1654c-107">Thus, functionalities involving multiuser clusters are among the most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="1654c-108">Helyett a saját többfelhasználós hitelesítési és engedélyezési készítéséhez, a HDInsight legnépszerűbb identitásszolgáltató – Active Directory (AD) alapul.</span><span class="sxs-lookup"><span data-stu-id="1654c-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on the most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="1654c-109">A hatékony biztonsági funkciókat AD hdinsight többfelhasználós engedélyezési kezelésére használható.</span><span class="sxs-lookup"><span data-stu-id="1654c-109">The powerful security functionality in AD can be used to manage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="1654c-110">Az ad-val a HDInsight integrálásával kommunikálhat a fürtök AD hitelesítő adataival.</span><span class="sxs-lookup"><span data-stu-id="1654c-110">By integrating HDInsight with AD, you can communicate with the clusters by using your AD credentials.</span></span> <span data-ttu-id="1654c-111">HDInsight van leképezve egy AD-felhasználó a helyi Hadoop-felhasználó, így a szolgáltatás HDInsight (Ambari, kiszolgáló, idejére Spark thrift Hive server és a mások) munkahelyi zökkenőmentesen a hitelesített felhasználó számára.</span><span class="sxs-lookup"><span data-stu-id="1654c-111">HDInsight maps an AD user to a local Hadoop user, so all the services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for the authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="1654c-112">HDInsight integrálása AD és az AD IaaS virtuális gépen</span><span class="sxs-lookup"><span data-stu-id="1654c-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="1654c-113">HDInsight integrálása az Azure AD vagy AD Iaas virtuális gépen, a HDInsight-fürtcsomóponton található, a tartományhoz csatlakoztatott egy tartományhoz.</span><span class="sxs-lookup"><span data-stu-id="1654c-113">By integrating HDInsight with Azure AD or AD on Iaas VM, the HDInsight cluster nodes are domain-joined to a domain.</span></span> <span data-ttu-id="1654c-114">HDInsight a Hadoop-szolgáltatások, a fürtben futó szolgáltatásnevekről hoz létre, és az Azure AD vagy ad szolgáltatásokba, az infrastruktúra-szolgáltatási virtuális gép egy adott szervezeti egység (OU) belül helyezi azokat.</span><span class="sxs-lookup"><span data-stu-id="1654c-114">HDInsight creates service principals for the Hadoop services running on the cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="1654c-115">HDInsight címfeloldási DNS-hozzárendelések is létrehoz a tartomány az IP-címekhez tartozó csomópontot csatlakoznak a tartományhoz.</span><span class="sxs-lookup"><span data-stu-id="1654c-115">HDInsight also creates reverse DNS mappings in the domain for the IP addresses of the nodes that are joined to the domain.</span></span>

<span data-ttu-id="1654c-116">Ezt a beállítást többféle architektúra használatával érheti el.</span><span class="sxs-lookup"><span data-stu-id="1654c-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="1654c-117">Az alábbi architektúrák közül választhat.</span><span class="sxs-lookup"><span data-stu-id="1654c-117">You can choose from the following architectures.</span></span>

<span data-ttu-id="1654c-118">**A HDInsight az Azure infrastruktúra-szolgáltatáson futó AD-vel integrált**</span><span class="sxs-lookup"><span data-stu-id="1654c-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="1654c-119">Ez a legegyszerűbb architektúra a HDInsight és az Active Directory integrálásához.</span><span class="sxs-lookup"><span data-stu-id="1654c-119">This is the simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="1654c-120">Az AD-tartományvezérlő egy (vagy több) virtuális gépek (VM) az Azure-ban futó.</span><span class="sxs-lookup"><span data-stu-id="1654c-120">The AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="1654c-121">Ezek a virtuális gépek általában egy virtuális hálózatot alkotnak.</span><span class="sxs-lookup"><span data-stu-id="1654c-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="1654c-122">Konfigurálni kell egy másik virtuális hálózatot is a HDInsight-fürt számára.</span><span class="sxs-lookup"><span data-stu-id="1654c-122">You set up another virtual network for the HDInsight cluster.</span></span> <span data-ttu-id="1654c-123">HDInsight kell rendelkeznie az Active Directory egy sor a láthatáron, van szüksége a virtuális hálózatok használatával egyenrangú [VNet – VNet társviszony-létesítés](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="1654c-123">For HDInsight to have a line of sight to Active Directory, you need to peer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="1654c-124">Ha az ARM ESZKÖZBEN az Active Directory hoz létre, majd hozhat létre az Active Directory és a HDInsight ugyanazon virtuális, és nem kell tennie társviszony-létesítés.</span><span class="sxs-lookup"><span data-stu-id="1654c-124">If you create the Active Directory in ARM, then you can create the Active Directory and HDInsight in the same VNet and you don't need to do peering.</span></span> 

![Tartományhoz csatlakoztatott HDInsight-fürtök topológiája](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="1654c-126">Ebben az architektúrában az Azure Data Lake Store és a HDInsight-fürt nem használható együtt.</span><span class="sxs-lookup"><span data-stu-id="1654c-126">In this architecture, you cannot use Azure Data Lake Store with the HDInsight cluster.</span></span>


<span data-ttu-id="1654c-127">Az Active Directory előfeltételei:</span><span class="sxs-lookup"><span data-stu-id="1654c-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="1654c-128">Létre kell hoznia egy [szervezeti egységet](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md), amelyben a HDInsight-fürt virtuális gépeit és a fürt által használt egyszerű szolgáltatásokat helyezi el.</span><span class="sxs-lookup"><span data-stu-id="1654c-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place the HDInsight cluster VMs and the service principals used by the cluster.</span></span>
* <span data-ttu-id="1654c-129">[Lightweight Directory Access protokollok](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) be kell állítani a az ad-vel való kommunikációhoz.</span><span class="sxs-lookup"><span data-stu-id="1654c-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="1654c-130">Az LDAPS konfigurálásához használt tanúsítványnak valódi (nem önaláírt) tanúsítványnak kell lennie.</span><span class="sxs-lookup"><span data-stu-id="1654c-130">The certificate used to set up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="1654c-131">Fordított irányú DNS-zónákat kell létrehoznia a tartományon a HDInsight-alhálózat IP-címtartománya számára (például 10.2.0.0/24 az előző képen).</span><span class="sxs-lookup"><span data-stu-id="1654c-131">Reverse DNS zones must be created on the domain for the IP address range of the HDInsight subnet (for example, 10.2.0.0/24 in the previous picture).</span></span>
* <span data-ttu-id="1654c-132">Szükséges egy szolgáltatásfiók vagy egy felhasználói fiók is.</span><span class="sxs-lookup"><span data-stu-id="1654c-132">A service account or a user account is needed.</span></span> <span data-ttu-id="1654c-133">Ezt a fiókot a HDInsight-fürt létrehozására használhatja.</span><span class="sxs-lookup"><span data-stu-id="1654c-133">Use this account to create the HDInsight cluster.</span></span> <span data-ttu-id="1654c-134">A fióknak az alábbi engedélyekkel kell rendelkeznie:</span><span class="sxs-lookup"><span data-stu-id="1654c-134">This account must have the following permissions:</span></span>

    - <span data-ttu-id="1654c-135">A szervezeti egységben lévő egyszerű szolgáltatásobjektumok és gépobjektumok létrehozásához szükséges engedélyek</span><span class="sxs-lookup"><span data-stu-id="1654c-135">Permissions to create service principal objects and machine objects within the organizational unit</span></span>
    - <span data-ttu-id="1654c-136">A fordított irányú DNS-proxyszabályok létrehozásához szükséges engedélyek;</span><span class="sxs-lookup"><span data-stu-id="1654c-136">Permissions to create reverse DNS proxy rules</span></span>
    - <span data-ttu-id="1654c-137">A gépeknek az Active Directory-tartományhoz történő csatlakoztatásához szükséges engedélyek</span><span class="sxs-lookup"><span data-stu-id="1654c-137">Permissions to join machines to the Active Directory domain</span></span>

<span data-ttu-id="1654c-138">**Kizárólag felhőalapú Azure AD-vel integrált HDInsight**</span><span class="sxs-lookup"><span data-stu-id="1654c-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="1654c-139">A kizárólag felhőalapú Azure AD esetében konfiguráljon egy tartományvezérlőt, hogy a HDInsight integrálható legyen az Azure AD-vel.</span><span class="sxs-lookup"><span data-stu-id="1654c-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="1654c-140">Ehhez a [Azure Active Directory tartományi szolgáltatások](../active-directory-domain-services/active-directory-ds-overview.md) (az Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="1654c-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="1654c-141">Az Azure AD DS tartományvezérlő gépeket hoz létre a felhőben, és megadja az IP-címeiket.</span><span class="sxs-lookup"><span data-stu-id="1654c-141">Azure AD DS creates domain controller machines on the cloud and provides IP addresses for them.</span></span> <span data-ttu-id="1654c-142">Két tartományvezérlőt hoz létre a magas rendelkezésre állás érdekében.</span><span class="sxs-lookup"><span data-stu-id="1654c-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="1654c-143">Az Azure AD DS jelenleg kizárólag klasszikus virtuális hálózatokon létezik.</span><span class="sxs-lookup"><span data-stu-id="1654c-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="1654c-144">Csak a klasszikus Azure-portálon keresztül érhető el.</span><span class="sxs-lookup"><span data-stu-id="1654c-144">It is only accessible by using the Azure classic portal.</span></span> <span data-ttu-id="1654c-145">A HDInsight virtuális hálózat az Azure Portalon létezik, amelyet a virtuális hálózatok közötti társviszony-létesítéssel társítani kell a klasszikus virtuális hálózattal.</span><span class="sxs-lookup"><span data-stu-id="1654c-145">The HDInsight virtual network exists in the Azure portal, which needs to be peered with the classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="1654c-146">Egy klasszikus virtuális hálózat és egy Azure Resource Managerbeli virtuális hálózat társításához a két virtuális hálózatnak ugyanabban a régióban kell lennie, és ugyanazon Azure-előfizetés alá kell tartoznia.</span><span class="sxs-lookup"><span data-stu-id="1654c-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in the same region and under the same Azure subscription.</span></span>

![Tartományhoz csatlakoztatott HDInsight-fürtök topológiája](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="1654c-148">Az Azure AD előfeltételei:</span><span class="sxs-lookup"><span data-stu-id="1654c-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="1654c-149">Létre kell hoznia egy [szervezeti egységet](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md), amelyben a HDInsight-fürt virtuális gépeit és a fürt által használt egyszerű szolgáltatásokat helyezi el.</span><span class="sxs-lookup"><span data-stu-id="1654c-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place the HDInsight cluster VMs and the service principals used by the cluster.</span></span>
* <span data-ttu-id="1654c-150">Az [LDAPS-t](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) is konfigurálni kell az Azure AD DS konfigurálásakor.</span><span class="sxs-lookup"><span data-stu-id="1654c-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="1654c-151">Az LDAPS konfigurálásához használt tanúsítványnak valódi (nem önaláírt) tanúsítványnak kell lennie.</span><span class="sxs-lookup"><span data-stu-id="1654c-151">The certificate used to set up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="1654c-152">Fordított irányú DNS-zónákat kell létrehoznia a tartományon a HDInsight-alhálózat IP-címtartománya számára (például 10.2.0.0/24 az előző képen).</span><span class="sxs-lookup"><span data-stu-id="1654c-152">Reverse DNS zones must be created on the domain for the IP address range of the HDInsight subnet (for example, 10.2.0.0/24 in the previous picture).</span></span>
* <span data-ttu-id="1654c-153">A [jelszókivonatokat](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) szinkronizálnia kell az Azure AD-ről az Azure AD DS-re.</span><span class="sxs-lookup"><span data-stu-id="1654c-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD to Azure AD DS.</span></span>
* <span data-ttu-id="1654c-154">Szükséges egy szolgáltatásfiók vagy egy felhasználói fiók is.</span><span class="sxs-lookup"><span data-stu-id="1654c-154">A service account or a user account is needed.</span></span> <span data-ttu-id="1654c-155">Ezt a fiókot a HDInsight-fürt létrehozására használhatja.</span><span class="sxs-lookup"><span data-stu-id="1654c-155">Use this account to create the HDInsight cluster.</span></span> <span data-ttu-id="1654c-156">A fióknak az alábbi engedélyekkel kell rendelkeznie:</span><span class="sxs-lookup"><span data-stu-id="1654c-156">This account must have the following permissions:</span></span>

    - <span data-ttu-id="1654c-157">A szervezeti egységben lévő egyszerű szolgáltatásobjektumok és gépobjektumok létrehozásához szükséges engedélyek</span><span class="sxs-lookup"><span data-stu-id="1654c-157">Permissions to create service principal objects and machine objects within the organizational unit</span></span>
    - <span data-ttu-id="1654c-158">A fordított irányú DNS-proxyszabályok létrehozásához szükséges engedélyek;</span><span class="sxs-lookup"><span data-stu-id="1654c-158">Permissions to create reverse DNS proxy rules</span></span>
    - <span data-ttu-id="1654c-159">A gépeknek az Azure AD-tartományhoz történő csatlakoztatásához szükséges engedélyek</span><span class="sxs-lookup"><span data-stu-id="1654c-159">Permissions to join machines to the Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="1654c-160">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="1654c-160">Next steps</span></span>
* <span data-ttu-id="1654c-161">A tartományhoz csatlakoztatott HDInsight-fürtök konfigurálásához lásd: [Tartományhoz csatlakoztatott HDInsight-fürtök konfigurálása](hdinsight-domain-joined-configure.md).</span><span class="sxs-lookup"><span data-stu-id="1654c-161">To configure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="1654c-162">A tartományhoz csatlakoztatott HDInsight-fürtök kezeléséhez lásd: [Tartományhoz csatlakoztatott HDInsight-fürtök kezelése](hdinsight-domain-joined-manage.md).</span><span class="sxs-lookup"><span data-stu-id="1654c-162">To manage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="1654c-163">A Hive-házirendek konfigurálásához és a Hive-lekérdezések futtatásához lásd: [Hive-házirendek konfigurálása a tartományhoz csatlakoztatott HDInsight-fürtökben](hdinsight-domain-joined-run-hive.md).</span><span class="sxs-lookup"><span data-stu-id="1654c-163">To configure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="1654c-164">Hive-lekérdezések futtatása HDInsight-fürtök tartományhoz az ssh protokoll használatával, lásd: [az SSH a Hdinsighttal](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="1654c-164">To run Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
