---
title: Linux Cassandra futtassa az Azure-on |} Microsoft Docs
description: "Hogyan Linux Azure Virtual Machines Cassandra fürt futtassa a Node.js-alkalmazás"
services: virtual-machines-linux
documentationcenter: nodejs
author: tomarcher
manager: routlaw
editor: 
tags: azure-service-management
ms.assetid: 30de1f29-e97d-492f-ae34-41ec83488de0
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: 1ff3d77ced6c9d90029b251490c05e52d9b43515
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/29/2017
---
# <a name="running-cassandra-with-linux-on-azure-and-accessing-it-from-nodejs"></a><span data-ttu-id="3c44a-103">A linuxos Cassandra futtatása az Azure-ban és az alkalmazás Node.js-ből való elérése</span><span class="sxs-lookup"><span data-stu-id="3c44a-103">Running Cassandra with Linux on Azure and Accessing it from Node.js</span></span>
> [!IMPORTANT] 
> <span data-ttu-id="3c44a-104">Azure az erőforrások létrehozására és kezelésére két különböző üzembe helyezési modellel rendelkezik: [Resource Manager és klasszikus](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="3c44a-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="3c44a-105">Ez a cikk a klasszikus telepítési modell használatát bemutatja.</span><span class="sxs-lookup"><span data-stu-id="3c44a-105">This article covers using the Classic deployment model.</span></span> <span data-ttu-id="3c44a-106">A Microsoft azt javasolja, hogy az új telepítések esetén a Resource Manager modellt használja.</span><span class="sxs-lookup"><span data-stu-id="3c44a-106">Microsoft recommends that most new deployments use the Resource Manager model.</span></span> <span data-ttu-id="3c44a-107">Tekintse meg a Resource Manager-sablonok [alapszintű Datastax vállalati](https://azure.microsoft.com/documentation/templates/datastax) és [Spark-fürt és Cassandra a CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span><span class="sxs-lookup"><span data-stu-id="3c44a-107">See Resource Manager templates for [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) and [Spark cluster and Cassandra on CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span></span>

## <a name="overview"></a><span data-ttu-id="3c44a-108">Áttekintés</span><span class="sxs-lookup"><span data-stu-id="3c44a-108">Overview</span></span>
<span data-ttu-id="3c44a-109">Microsoft Azure a egy megnyitott felhőalapú platform, amely a Microsoft fut, és a nem Microsoft szoftvert, amely operációs rendszerek, alkalmazás-kiszolgálókat, üzenetküldési köztes, valamint SQL és a NoSQL-adatbázisok mindkét kereskedelmi és nyissa meg a forrás-modellek.</span><span class="sxs-lookup"><span data-stu-id="3c44a-109">Microsoft Azure is an open cloud platform that runs both Microsoft as well as non-Microsoft software which  includes operating systems, application servers, messaging middleware as well as SQL and NoSQL databases from both commercial and open source models.</span></span> <span data-ttu-id="3c44a-110">A nyilvános felhők, beleértve az Azure rugalmas szolgáltatások igényel gondos tervezéssel és szándékos architektúra mindkét alkalmazáskiszolgálók jól tárolási rétegek.</span><span class="sxs-lookup"><span data-stu-id="3c44a-110">Building resilient services on public clouds including Azure requires careful planning and deliberate architecture for both applications servers as well storage layers.</span></span> <span data-ttu-id="3c44a-111">Cassandra által elosztott tároló-architektúra természetes segítségével magas rendelkezésre állású rendszerek, amelyek a fürt hibák hibatűrő fejlesztése során.</span><span class="sxs-lookup"><span data-stu-id="3c44a-111">Cassandra’s distributed storage architecture naturally helps in building highly available systems that are fault tolerant for cluster failures.</span></span> <span data-ttu-id="3c44a-112">Cassandra egy felhőhöz méretezett NoSQL-adatbázis által Apache szoftver Foundation költséget cassandra.apache.org; Cassandra Java nyelven van megírva, és ezért mind a Windows, Linux futtatja platformokon.</span><span class="sxs-lookup"><span data-stu-id="3c44a-112">Cassandra is a cloud scale NoSQL database maintained by Apache Software Foundation at cassandra.apache.org; Cassandra is written in Java and hence runs on both on Windows as well as Linux platforms.</span></span>

<span data-ttu-id="3c44a-113">Ez a cikk célja Cassandra telepítési megjelenítése Ubuntu a Microsoft Azure virtuális gépek és virtuális hálózatok egyetlen és több data center fürtként.</span><span class="sxs-lookup"><span data-stu-id="3c44a-113">The focus of this article is to show Cassandra deployment on Ubuntu as a single and multi-data center cluster leveraging Microsoft Azure Virtual Machines and Virtual Networks.</span></span> <span data-ttu-id="3c44a-114">A fürtöt tartalmazó környezetben optimalizált termelési számítási feladatokhoz nem ez a cikk érhető el, mivel az több lemez a csomópont-konfiguráció, megfelelő körgyűrűs topológia tervezési és a szükséges replikációs, a adatkonzisztenciát, az átviteli sebesség és a magas támogatásához modellezési adatok rendelkezésre állási követelményeinek.</span><span class="sxs-lookup"><span data-stu-id="3c44a-114">The cluster deployment for production optimized workloads is out of scope of this article as it requires multi-disk node configuration, appropriate ring topology design and data modeling to support the needed replication, data consistency, throughput and high availability requirements.</span></span>

<span data-ttu-id="3c44a-115">A cikk vesz részt vesz egy alapvető megközelítés jeleníthető meg, mi a Cassandra fürt építése Docker, Chef vagy Puppet, amely megkönnyítheti az infrastruktúra telepítése sokkal képest.</span><span class="sxs-lookup"><span data-stu-id="3c44a-115">This article takes a fundamental approach to show what is involved in building the Cassandra cluster compared Docker, Chef or Puppet which can make the infrastructure deployment a lot easier.</span></span>  

## <a name="the-deployment-models"></a><span data-ttu-id="3c44a-116">Az üzembe helyezési modellek</span><span class="sxs-lookup"><span data-stu-id="3c44a-116">The Deployment Models</span></span>
<span data-ttu-id="3c44a-117">A Microsoft Azure hálózatkezelés lehetővé teszi, hogy a telepítése elkülönített titkos fürtök esetén, amelyek a hozzáférés korlátozható részletes hálózati biztonság eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="3c44a-117">Microsoft Azure networking allows the deployment of isolated private clusters, the access of which can be restricted to attain fine grained network security.</span></span>  <span data-ttu-id="3c44a-118">Mivel ez a cikk a Cassandra telepítési alapvető szinten megjelenítésével kapcsolatos, nem tárgyaljuk a konzisztenciaszint és átviteli sebesség eléréséhez optimális tároló-kialakításában.</span><span class="sxs-lookup"><span data-stu-id="3c44a-118">Since this article is about showing the Cassandra deployment at a fundamental level, we will not focus on the consistency level and the optimal storage design for throughput.</span></span> <span data-ttu-id="3c44a-119">A hálózati követelményei a elméleti fürt listája itt található:</span><span class="sxs-lookup"><span data-stu-id="3c44a-119">Here is the list of networking requirements for our hypothetical cluster:</span></span>

* <span data-ttu-id="3c44a-120">Külső rendszerek Cassandra adatbázis belül vagy kívül Azure nem tud hozzáférni.</span><span class="sxs-lookup"><span data-stu-id="3c44a-120">External systems can’t access Cassandra database from within or outside Azure</span></span>
* <span data-ttu-id="3c44a-121">Cassandra fürt-nak kell lennie a thrift-forgalmat egy terheléselosztó mögött</span><span class="sxs-lookup"><span data-stu-id="3c44a-121">Cassandra cluster has to be behind a load balancer for thrift traffic</span></span>
* <span data-ttu-id="3c44a-122">Minden adatközpontot továbbfejlesztett fürt rendelkezésre állási csoportok két csomópontja Cassandra telepítése</span><span class="sxs-lookup"><span data-stu-id="3c44a-122">Deploy Cassandra nodes in two groups in each data center for an enhanced cluster availability</span></span>
* <span data-ttu-id="3c44a-123">Zárolását, a fürt úgy, hogy csak az alkalmazás kiszolgálófarm közvetlenül rendelkezik hozzáféréssel az adatbázishoz</span><span class="sxs-lookup"><span data-stu-id="3c44a-123">Lock down the cluster so that only application server farm has access to the database directly</span></span>
* <span data-ttu-id="3c44a-124">Eltérő SSH nyilvános hálózati végpontok</span><span class="sxs-lookup"><span data-stu-id="3c44a-124">No public networking endpoints other than SSH</span></span>
* <span data-ttu-id="3c44a-125">Minden egyes Cassandra csomópont kell egy rögzített belső IP-cím</span><span class="sxs-lookup"><span data-stu-id="3c44a-125">Each Cassandra node needs a fixed internal IP address</span></span>

<span data-ttu-id="3c44a-126">Cassandra egyetlen Azure-régió, vagy a munkaterhelés elosztott jellege alapján több régióba telepíthető.</span><span class="sxs-lookup"><span data-stu-id="3c44a-126">Cassandra can be deployed to a single Azure region or to multiple regions based on the distributed nature of the workload.</span></span> <span data-ttu-id="3c44a-127">Több régióban üzembe helyezési modellel is javítható kiszolgálni a végfelhasználók számára közelebb, hogy egy adott földrajzi Cassandra ugyanazon az infrastruktúrán keresztül.</span><span class="sxs-lookup"><span data-stu-id="3c44a-127">Multi-region deployment model can be leveraged to serve end users closer to a particular geography through the same Cassandra infrastructure.</span></span> <span data-ttu-id="3c44a-128">Cassandra meg beépített csomópont replikációs vesz igénybe a szinkronizálás többszörös főkiszolgáló több különböző adatközponthoz származó ír és megadja az adatok az alkalmazások konzisztens nézetét.</span><span class="sxs-lookup"><span data-stu-id="3c44a-128">Cassandra’s built-in node replication takes care of the synchronization of multi-master writes originating from multiple data centers and presents a consistent view of the data to applications.</span></span> <span data-ttu-id="3c44a-129">Több területi központi telepítés is segíthetnek a a kockázatcsökkentés a szélesebb körű Azure szolgáltatás-kimaradások számát.</span><span class="sxs-lookup"><span data-stu-id="3c44a-129">Multi-region deployment can also help with the risk mitigation of the broader Azure service outages.</span></span> <span data-ttu-id="3c44a-130">Cassandra tartozó hangolható konzisztencia és a replikációs topológia segít az alkalmazások különböző Helyreállítási igényeket.</span><span class="sxs-lookup"><span data-stu-id="3c44a-130">Cassandra’s tunable consistency and replication topology will help in meeting diverse RPO needs of applications.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="3c44a-131">Egyetlen régión központi telepítés</span><span class="sxs-lookup"><span data-stu-id="3c44a-131">Single Region Deployment</span></span>
<span data-ttu-id="3c44a-132">Rendszer egy régió telepítés elindításához és nem kér be adatokat az learnings több területi modell létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="3c44a-132">We will start with a single region deployment and harvest the learnings in creating a multi-region model.</span></span> <span data-ttu-id="3c44a-133">Az Azure virtuális hálózat használandó elkülönített alhálózatokat létre úgy, hogy a fent említett hálózatbiztonsági követelményei érheti el.</span><span class="sxs-lookup"><span data-stu-id="3c44a-133">Azure virtual networking will be used to create isolated subnets so that the network security requirements mentioned above can be met.</span></span>  <span data-ttu-id="3c44a-134">A régió egyetlen központi telepítés létrehozása ismertetett folyamatot használ Ubuntu 14.04 LTS és Cassandra 2.08; azonban a folyamat is könnyen elfogadni Linux Variant adattípusban.</span><span class="sxs-lookup"><span data-stu-id="3c44a-134">The process described in creating the single region deployment uses Ubuntu 14.04 LTS and Cassandra 2.08; however, the process can easily be adopted to the other Linux variants.</span></span> <span data-ttu-id="3c44a-135">Az alábbiakban a egyetlen régión telepítési rendszeres jellemzőit.</span><span class="sxs-lookup"><span data-stu-id="3c44a-135">The following are some of the systemic characteristics of the single region deployment.</span></span>  

<span data-ttu-id="3c44a-136">**Magas rendelkezésre állás:** az 1. ábráján látható Cassandra csomópont két rendelkezésre állási csoportokra vannak telepítve, úgy, hogy a csomópont a magas rendelkezésre állású több tartalék tartományok között van elosztva.</span><span class="sxs-lookup"><span data-stu-id="3c44a-136">**High Availability:** The Cassandra nodes shown in the Figure 1 are deployed to two availability sets so that the nodes are spread between multiple fault domains for high availability.</span></span> <span data-ttu-id="3c44a-137">Virtuális gépek minden egyes rendelkezésre állási csoport attribútummal 2 tartalék tartományok van leképezve.</span><span class="sxs-lookup"><span data-stu-id="3c44a-137">VMs annotated with each availability set is mapped to 2 fault domains.</span></span>  <span data-ttu-id="3c44a-138">A Microsoft Azure által használt tartalék tartomány le nem tervezett idő (pl. a hardver- vagy hibák) közben (pl. gazdagép vagy vendég operációs rendszer javítás vagy frissítés, alkalmazásfrissítések) frissítési tartomány fogalma kezelésére fogalma állásidő ütemezett kezelésére használt.</span><span class="sxs-lookup"><span data-stu-id="3c44a-138">Microsoft Azure uses the concept of fault domain to manage unplanned down time (e.g. hardware or software failures) while the concept of upgrade domain (e.g. host or guest OS patching/upgrades, application upgrades) is used for managing scheduled down time.</span></span> <span data-ttu-id="3c44a-139">Ellenőrizze a [vész-helyreállítási és magas rendelkezésre állás, az Azure-alkalmazások](http://msdn.microsoft.com/library/dn251004.aspx) hiba és a frissítési tartományok magas rendelkezésre állás elérése a szerepkörhöz.</span><span class="sxs-lookup"><span data-stu-id="3c44a-139">Please see [Disaster Recovery and High Availability for Azure Applications](http://msdn.microsoft.com/library/dn251004.aspx) for the role of fault and upgrade domains in attaining high availability.</span></span>

![Egyetlen régión központi telepítés](./media/cassandra-nodejs/cassandra-linux1.png)

<span data-ttu-id="3c44a-141">1. ábra: Egy régiót központi telepítés</span><span class="sxs-lookup"><span data-stu-id="3c44a-141">Figure 1: Single region deployment</span></span>

<span data-ttu-id="3c44a-142">Vegye figyelembe, hogy a cikk írásának időpontjában Azure nem engedélyezi egy csoportján az adott tartalék tartomány; explicit leképezése ezért még a üzembe helyezési modellel, 1. ábrán látható, a valószínű statisztikailag, hogy a virtuális gépek két tartalék tartományok helyett négy lehet rendelni.</span><span class="sxs-lookup"><span data-stu-id="3c44a-142">Note that at the time of this writing, Azure doesn’t allow the explicit mapping of a group of VMs to a specific fault domain; consequently, even with the deployment model shown in Figure 1, it is statistically probable that all the virtual machines may be mapped to two fault domains instead of four.</span></span>

<span data-ttu-id="3c44a-143">**Terheléselosztás Thrift forgalmi betöltése:** Thrift ügyfél függvénytárainak belül a webalkalmazás-kiszolgáló csatlakozzon a fürthöz, a belső terheléselosztók használatával.</span><span class="sxs-lookup"><span data-stu-id="3c44a-143">**Load Balancing Thrift Traffic:** Thrift client libraries inside the web server connect to the cluster through an internal load balancer.</span></span> <span data-ttu-id="3c44a-144">Ehhez szükséges, hogy a belső terheléselosztó hozzáadása a "data" alhálózathoz (lásd az 1. ábra) keretén belül a felhőalapú szolgáltatás, a Cassandra fürtöt.</span><span class="sxs-lookup"><span data-stu-id="3c44a-144">This requires the process of adding the internal load balancer to the “data” subnet (refer Figure 1) in the context of the cloud service hosting the Cassandra cluster.</span></span> <span data-ttu-id="3c44a-145">A belső terheléselosztó van definiálva, miután minden csomópont szükséges az elosztott terhelésű végpont a Megjegyzések a korábban meghatározott terheléselosztó neve az elosztott terhelésű készlet lehet hozzáadni.</span><span class="sxs-lookup"><span data-stu-id="3c44a-145">Once the internal load balancer is defined, each node requires the load balanced endpoint to be added with the annotations of a load balanced set with previously defined load balancer name.</span></span> <span data-ttu-id="3c44a-146">Lásd: [Azure belső terheléselosztás ](../../../load-balancer/load-balancer-internal-overview.md)további részleteket.</span><span class="sxs-lookup"><span data-stu-id="3c44a-146">See [Azure Internal Load Balancing ](../../../load-balancer/load-balancer-internal-overview.md)for more details.</span></span>

<span data-ttu-id="3c44a-147">**Fürt magok:** fontos, hogy válassza ki a legtöbb magas rendelkezésre állású csomópontok beállítása mag, mert a kezdőérték csomópontok feltérképezi a fürt kommunikál az új csomópontok.</span><span class="sxs-lookup"><span data-stu-id="3c44a-147">**Cluster Seeds:** It is important to select the most highly available nodes for seeds as the new nodes will communicate with seed nodes to discover the topology of the cluster.</span></span> <span data-ttu-id="3c44a-148">Egyes rendelkezésre állási csoport egy csomópont kezdőérték csomópontként kijelölt kerülje a hibaérzékeny pontok kialakulását.</span><span class="sxs-lookup"><span data-stu-id="3c44a-148">One node from each availability set is designated as seed nodes to avoid single point of failure.</span></span>

<span data-ttu-id="3c44a-149">**Replikációs tényező és Konzisztenciaszint:** Cassandra a beépített magas rendelkezésre állású és az adatok tartóssága jellemzőek a replikációs tényező (RF - példányszámot az egyes sorok, a fürtön tárolt), és a Konzisztenciaszint (replikák száma kell olvasása/írása az eredmény a hívó való visszatérés előtt).</span><span class="sxs-lookup"><span data-stu-id="3c44a-149">**Replication Factor and Consistency Level:** Cassandra’s build-in high-availability and data durability is characterized by the Replication Factor (RF - number of copies of each row stored on the cluster) and Consistency Level (number of replicas to be read/written before returning the result to the caller).</span></span> <span data-ttu-id="3c44a-150">Replikációs tényező kulcstérértesítések használatával (hasonlóan egy relációs adatbázisban) létrehozása közben megadott, mivel a konzisztenciaszint van megadva a CRUD-lekérdezés elküldése során.</span><span class="sxs-lookup"><span data-stu-id="3c44a-150">Replication factor is specified during the KEYSPACE (similar to a relational database) creation whereas the consistency level is specified while issuing the CRUD query.</span></span> <span data-ttu-id="3c44a-151">Lásd a Cassandra dokumentációját a [konfigurálásával konzisztenciájának](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) konzisztencia részletek és a képlet kvórum számításhoz.</span><span class="sxs-lookup"><span data-stu-id="3c44a-151">See Cassandra documentation at [Configuring for Consistency](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) for consistency details and the formula for quorum computation.</span></span>

<span data-ttu-id="3c44a-152">Cassandra kétféle adatok integritásának modellek – konzisztencia és a végleges konzisztencia; a replikációs tényező és Konzisztenciaszint együtt meghatározzák, ha az adatok lesz konzisztens, amint egy írási művelet befejeződik, vagy idővel konzisztenssé lesz.</span><span class="sxs-lookup"><span data-stu-id="3c44a-152">Cassandra supports two types of data integrity models – Consistency and Eventual Consistency; the Replication Factor and Consistency Level will together determine if the data will be consistent as soon as a write operation is complete or it will be eventually consistent.</span></span> <span data-ttu-id="3c44a-153">Például KVÓRUM megadását, mint a Konzisztenciaszint fognak mindig biztosítja az adatok konzisztenciájának során bármely konzisztenciaszint, eléréséhez szükség szerint írandó replikák száma alatt (pl. egy) KVÓRUM eredményezi, hogy idővel konzisztenssé adatok.</span><span class="sxs-lookup"><span data-stu-id="3c44a-153">For example, specifying QUORUM as the Consistency Level will always ensures data Consistency while any consistency level, below the number of replicas to be written as needed to attain QUORUM (e.g. ONE) results in data being eventually consistent.</span></span>

<span data-ttu-id="3c44a-154">A fentiek, egy replikációs tényező 3-KVÓRUM 8 csomópontos fürt (2 csomópontok vannak olvasása vagy írása konzisztencia) olvasási/írási konzisztenciaszint, az elméleti elvész az egyes replikációs csoportok legfeljebb 1 csomópont hibatűrését előtt az alkalmazás indítása előtt tartva a Hiba történt.</span><span class="sxs-lookup"><span data-stu-id="3c44a-154">The 8-node cluster shown above, with a replication factor of 3 and QUORUM (2 nodes are read or written for consistency) read/write consistency level, can survive the theoretical loss of at the most 1 node per replication group before the application start noticing the failure.</span></span> <span data-ttu-id="3c44a-155">A parancs feltételezi, hogy a kulcs szóközöket jól kiegyensúlyozott rendelkezik az összes olvasási/írási kérések.</span><span class="sxs-lookup"><span data-stu-id="3c44a-155">This assumes that all the key spaces have well balanced read/write requests.</span></span>  <span data-ttu-id="3c44a-156">A telepített fürt használjuk a paraméterek a következők:</span><span class="sxs-lookup"><span data-stu-id="3c44a-156">The following are the parameters we will use for the deployed cluster:</span></span>

<span data-ttu-id="3c44a-157">Egyetlen régión Cassandra fürtkonfiguráció:</span><span class="sxs-lookup"><span data-stu-id="3c44a-157">Single region Cassandra cluster configuration:</span></span>

| <span data-ttu-id="3c44a-158">Fürt paraméter</span><span class="sxs-lookup"><span data-stu-id="3c44a-158">Cluster Parameter</span></span> | <span data-ttu-id="3c44a-159">Érték</span><span class="sxs-lookup"><span data-stu-id="3c44a-159">Value</span></span> | <span data-ttu-id="3c44a-160">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-160">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3c44a-161">(N) csomópontok száma</span><span class="sxs-lookup"><span data-stu-id="3c44a-161">Number of Nodes (N)</span></span> |<span data-ttu-id="3c44a-162">8</span><span class="sxs-lookup"><span data-stu-id="3c44a-162">8</span></span> |<span data-ttu-id="3c44a-163">A fürtben található csomópontok száma</span><span class="sxs-lookup"><span data-stu-id="3c44a-163">Total number of nodes in the cluster</span></span> |
| <span data-ttu-id="3c44a-164">Replikációs tényező (RF)</span><span class="sxs-lookup"><span data-stu-id="3c44a-164">Replication Factor (RF)</span></span> |<span data-ttu-id="3c44a-165">3</span><span class="sxs-lookup"><span data-stu-id="3c44a-165">3</span></span> |<span data-ttu-id="3c44a-166">Adott sor replikák száma</span><span class="sxs-lookup"><span data-stu-id="3c44a-166">Number of replicas of a given row</span></span> |
| <span data-ttu-id="3c44a-167">Konzisztenciaszint (írás)</span><span class="sxs-lookup"><span data-stu-id="3c44a-167">Consistency Level (Write)</span></span> |<span data-ttu-id="3c44a-168">QUORUM[(RF/2) +1) = 2] az eredmény a képlet lefelé kerekíti</span><span class="sxs-lookup"><span data-stu-id="3c44a-168">QUORUM[(RF/2) +1) = 2] The result of the formula is rounded down</span></span> |<span data-ttu-id="3c44a-169">Legfeljebb 2 replikával ír a hívónak; a válasz elküldése előtt 3. a replika idővel konzisztenssé módon írása.</span><span class="sxs-lookup"><span data-stu-id="3c44a-169">Writes at the most 2 replicas before the response is sent to the caller; 3rd replica is written in an eventually consistent manner.</span></span> |
| <span data-ttu-id="3c44a-170">Konzisztenciaszint (olvasás)</span><span class="sxs-lookup"><span data-stu-id="3c44a-170">Consistency Level (Read)</span></span> |<span data-ttu-id="3c44a-171">KVÓRUM [(RF/2) + 1 = 2] kerekíti a képlet eredménye</span><span class="sxs-lookup"><span data-stu-id="3c44a-171">QUORUM [(RF/2) +1= 2] The result of the formula is rounded down</span></span> |<span data-ttu-id="3c44a-172">2 replikával beolvassa a hívónak elküldése előtt.</span><span class="sxs-lookup"><span data-stu-id="3c44a-172">Reads 2 replicas before sending response to the caller.</span></span> |
| <span data-ttu-id="3c44a-173">Replikációs stratégia</span><span class="sxs-lookup"><span data-stu-id="3c44a-173">Replication Strategy</span></span> |<span data-ttu-id="3c44a-174">NetworkTopologyStrategy lásd [adatreplikáció](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) Cassandra dokumentációjában talál további információt a</span><span class="sxs-lookup"><span data-stu-id="3c44a-174">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="3c44a-175">A telepítési topológia megértette és replikák csomóponton helyezi el, hogy minden replika az azonos állványra a nem végződhet</span><span class="sxs-lookup"><span data-stu-id="3c44a-175">Understands the deployment topology and places replicas on nodes so that all the replicas don’t end up on the same rack</span></span> |
| <span data-ttu-id="3c44a-176">Snitch</span><span class="sxs-lookup"><span data-stu-id="3c44a-176">Snitch</span></span> |<span data-ttu-id="3c44a-177">Lásd a GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) Cassandra dokumentációjában talál további információt a</span><span class="sxs-lookup"><span data-stu-id="3c44a-177">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="3c44a-178">NetworkTopologyStrategy snitch egy fogalom megértéséhez a topológia használja.</span><span class="sxs-lookup"><span data-stu-id="3c44a-178">NetworkTopologyStrategy uses a concept of snitch to understand the topology.</span></span> <span data-ttu-id="3c44a-179">GossipingPropertyFileSnitch az egyes csomópontok leképezése a adatközpont és állvány nagyobb ellenőrzést biztosít.</span><span class="sxs-lookup"><span data-stu-id="3c44a-179">GossipingPropertyFileSnitch gives better control in mapping each node to data center and rack.</span></span> <span data-ttu-id="3c44a-180">A fürt pletykákat használja fel ezeket az információkat terjesztése.</span><span class="sxs-lookup"><span data-stu-id="3c44a-180">The cluster then uses gossip to propagate this information.</span></span> <span data-ttu-id="3c44a-181">Ez az jóval egyszerűbb, a dinamikus IP-beállítása PropertyFileSnitch viszonyítva</span><span class="sxs-lookup"><span data-stu-id="3c44a-181">This is much simpler in dynamic IP setting relative to PropertyFileSnitch</span></span> |

<span data-ttu-id="3c44a-182">**Cassandra fürt Azure szempontjai:** Microsoft Azure virtuális gépek funkció Azure Blob Storage tárolót használja a lemez megőrzéséhez; Az Azure Storage minden lemez a magas tartósság 3 replikák menti.</span><span class="sxs-lookup"><span data-stu-id="3c44a-182">**Azure Considerations for Cassandra Cluster:** Microsoft Azure Virtual Machines capability uses Azure Blob storage for disk persistence; Azure Storage saves 3 replicas of each disk for high durability.</span></span> <span data-ttu-id="3c44a-183">Ez azt jelenti, hogy minden egyes soraiban levő adatok, a Cassandra táblába 3 replikák már tárolja, és ezért adatkonzisztencia van már hozott megvagyunk akkor is, ha a replikációs tényező (RF) 1.</span><span class="sxs-lookup"><span data-stu-id="3c44a-183">That means each row of data inserted into a Cassandra table is already stored in 3 replicas and hence data consistency is already taken care of even if the Replication Factor (RF) is 1.</span></span> <span data-ttu-id="3c44a-184">A fő replikációs tényező alatt 1 probléma, hogy az az alkalmazás leállás következik, még akkor is, ha egy önálló Cassandra csomópont meghibásodik.</span><span class="sxs-lookup"><span data-stu-id="3c44a-184">The main problem with Replication Factor being 1 is that the application will experience downtime even if a single Cassandra node fails.</span></span> <span data-ttu-id="3c44a-185">Azonban ha egy csomópont le a Azure Fabric Controller által felismert problémákat (például a hardver, a szoftver rendszerhibák), akkor kiépíti a azonos tárolási-meghajtókat használ helyette egy új csomópont.</span><span class="sxs-lookup"><span data-stu-id="3c44a-185">However, if a node is down for the problems (e.g. hardware, system software failures) recognized by Azure Fabric Controller, it will provision a new node in its place using the same storage drives.</span></span> <span data-ttu-id="3c44a-186">Lecseréli a régi egy olyan új csomópont kiépítés néhány percet is igénybe vehet.</span><span class="sxs-lookup"><span data-stu-id="3c44a-186">Provisioning a new node to replace the old one may take a few minutes.</span></span>  <span data-ttu-id="3c44a-187">Tervezett karbantartás tevékenységek, például a vendég operációs rendszer módosításokat, hasonlóképpen Cassandra frissíti, és a alkalmazás Azure Fabric Controller hajtja végre a működés közbeni frissítés a csomópontok a fürtben.</span><span class="sxs-lookup"><span data-stu-id="3c44a-187">Similarly for planned maintenance activities like guest OS changes, Cassandra upgrades and application changes Azure Fabric Controller performs rolling upgrades of the nodes in the cluster.</span></span>  <span data-ttu-id="3c44a-188">Működés közbeni frissítés is is igénybe vehet néhány csomópont le egyszerre, és ezért a fürt rövid idejű leállást néhány partíciók problémákat tapasztalhat.</span><span class="sxs-lookup"><span data-stu-id="3c44a-188">Rolling upgrades also may take down a few nodes at a time and hence the cluster may experience brief downtime for a few partitions.</span></span> <span data-ttu-id="3c44a-189">Azonban az adatok nem elvesznek a beépített Azure adattároló redundanciája, amely miatt.</span><span class="sxs-lookup"><span data-stu-id="3c44a-189">However, the data will not be lost due to the built-in Azure Storage redundancy.</span></span>  

<span data-ttu-id="3c44a-190">A telepített Azure-ba, amelyek nem igényelnek magas rendelkezésre állású rendszerek (pl. körülbelül 99,9 amely egyenértékű 8.76 óra/év; lásd: [magas rendelkezésre állású](http://en.wikipedia.org/wiki/High_availability) részletes) esetleg RF futtatásához = 1 és Konzisztenciaszint = egyik.</span><span class="sxs-lookup"><span data-stu-id="3c44a-190">For systems deployed to Azure that doesn’t require high availability (e.g. around 99.9 which is equivalent to 8.76 hrs/year; see [High Availability](http://en.wikipedia.org/wiki/High_availability) for details) you may be able to run with RF=1 and Consistency Level=ONE.</span></span>  <span data-ttu-id="3c44a-191">A magas rendelkezésre állású KÖVETELMÉNYŰ RF alkalmazások = 3 és Konzisztenciaszint = KVÓRUM egyik csomópontján egy a replikák lefelé idején fog működését.</span><span class="sxs-lookup"><span data-stu-id="3c44a-191">For applications with high availability requirements, RF=3 and Consistency Level=QUORUM will tolerate the down time of one of the nodes one of the replicas.</span></span> <span data-ttu-id="3c44a-192">RF = 1, a hagyományos telepítések (pl. a helyszíni) a problémák, mint például a lemezek meghibásodása eredő esetleges adatvesztés miatt nem használható.</span><span class="sxs-lookup"><span data-stu-id="3c44a-192">RF=1 in traditional deployments (e.g. on-premises) can’t be used due to the possible data loss resulting from problems like disk failures.</span></span>   

## <a name="multi-region-deployment"></a><span data-ttu-id="3c44a-193">Több területi központi telepítés</span><span class="sxs-lookup"><span data-stu-id="3c44a-193">Multi-region Deployment</span></span>
<span data-ttu-id="3c44a-194">Cassandra tartozó adatok-center-kompatibilis replikációs és konzisztencia modell a fent leírt segít a több területi telepítés kívül a lista bármely külső tooling szükségessége nélkül.</span><span class="sxs-lookup"><span data-stu-id="3c44a-194">Cassandra’s data-center-aware replication and consistency model described above helps with the multi-region deployment out of the box without the need for any external tooling.</span></span> <span data-ttu-id="3c44a-195">Ez eltér elég a hagyományos, relációs adatbázisok ahol adatbázis-tükrözés a több főkiszolgálós írások telepítőprogramja elég bonyolult lehet.</span><span class="sxs-lookup"><span data-stu-id="3c44a-195">This is quite different from the traditional relational databases where the setup for database mirroring for multi-master writes can be quite complex.</span></span> <span data-ttu-id="3c44a-196">Állítson be több régióban Cassandra is segítséget nyújt a használati forgatókönyvei többek között a következőket:</span><span class="sxs-lookup"><span data-stu-id="3c44a-196">Cassandra in a multi-region set up can help with the usage scenarios including the following:</span></span>

<span data-ttu-id="3c44a-197">**Közelségi kapcsolat alapú központi telepítés:** több-bérlős alkalmazásokhoz, és törölje a jelet a bérlő felhasználók-az-régió, is származott, a több területi fürt alacsony késleltetésű által.</span><span class="sxs-lookup"><span data-stu-id="3c44a-197">**Proximity based deployment:** Multi-tenant applications, with clear mapping of tenant users -to-region, can be benefited by the multi-region cluster’s low latencies.</span></span> <span data-ttu-id="3c44a-198">Például egy tanulási felügyeleti rendszerek oktatási intézményeknél a megfelelő kampuszok kiszolgálására USA keleti régiója, és az USA nyugati régiója régiókban a elosztott fürtök telepítése tranzakciós, továbbá az elemzés.</span><span class="sxs-lookup"><span data-stu-id="3c44a-198">For example a learning management systems for educational institutions can deploy a distributed cluster in East US and West US regions to serve the respective campuses for transactional as well as analytics.</span></span> <span data-ttu-id="3c44a-199">Az adatok lehetnek helyileg egységes idő olvasási és írási műveletek és idővel konzisztenssé mindkét a régiók között.</span><span class="sxs-lookup"><span data-stu-id="3c44a-199">The data can be locally consistent at the time reads and writes and can be eventually consistent across both the regions.</span></span> <span data-ttu-id="3c44a-200">További példák mint az adathordozó terjesztési, elektronikus kereskedelmi és semmit, és koncentrált földrajzi felhasználói alap látja, hogy egy megfelelő használati eset a központi telepítési modell.</span><span class="sxs-lookup"><span data-stu-id="3c44a-200">There are other examples like media distribution, e-commerce and anything and everything that serves geo concentrated user base is a good use case for this deployment model.</span></span>

<span data-ttu-id="3c44a-201">**Magas rendelkezésre állás:** redundancia szoftverek és hardverek magas rendelkezésre állás elérése kulcsfontosságú tényező; a részleteket lásd a Microsoft Azure épület megbízható a felhőalapú rendszerek.</span><span class="sxs-lookup"><span data-stu-id="3c44a-201">**High Availability:** Redundancy is a key factor in attaining high availability of software and hardware; see Building Reliable Cloud Systems on Microsoft Azure for details.</span></span> <span data-ttu-id="3c44a-202">A Microsoft Azure-ban a csak megbízható igaz redundancia elérésének módja több területi fürt üzembe helyezésével.</span><span class="sxs-lookup"><span data-stu-id="3c44a-202">On Microsoft Azure, the only reliable way of achieving true redundancy is by deploying a multi-region cluster.</span></span> <span data-ttu-id="3c44a-203">Alkalmazások is telepíthető egy aktív-aktív vagy aktív-passzív módban, és ha a régiók egyikéhez sem működik, Azure Traffic Manager forgalom irányíthatja át az aktív terület.</span><span class="sxs-lookup"><span data-stu-id="3c44a-203">Applications can be deployed in an active-active or active-passive mode and if one of the regions is down, Azure Traffic Manager can redirect traffic to the active region.</span></span>  <span data-ttu-id="3c44a-204">Az egyetlen régión üzemelő példányhoz, ha a rendelkezésre állás 99,9, a két-régió központi telepítés el tud érni a képlettel kiszámított 99.9999 a rendelkezésre állási: (1-(1-0.999) * (1-0.999)) * 100); olvassa el a fenti részleteiről.</span><span class="sxs-lookup"><span data-stu-id="3c44a-204">With the single region deployment, if the availability is 99.9, a two-region deployment can attain an availability of 99.9999 computed by the formula: (1-(1-0.999) * (1-0.999))*100); see the above paper for details.</span></span>

<span data-ttu-id="3c44a-205">**Vész-helyreállítási:** több területi Cassandra fürt, ha megfelelően, is képes elviselni katasztrofális data center kimaradások esetén.</span><span class="sxs-lookup"><span data-stu-id="3c44a-205">**Disaster Recovery:** Multi-region Cassandra cluster, if properly designed, can withstand catastrophic data center outages.</span></span> <span data-ttu-id="3c44a-206">Ha egy régió nem működik, más régiókban központi telepítésű alkalmazás indításához szolgál a végfelhasználók számára.</span><span class="sxs-lookup"><span data-stu-id="3c44a-206">If one region is down, the application deployed to other regions can start serving the end users.</span></span> <span data-ttu-id="3c44a-207">Bármely más üzleti folytonossági megvalósításokhoz, például az alkalmazás nem lehet az adatokat a aszinkron feldolgozási eredő adatvesztést a hibatűrő.</span><span class="sxs-lookup"><span data-stu-id="3c44a-207">Like any other business continuity implementations, the application has to be tolerant for some data loss resulting from the data in the asynchronous pipeline.</span></span> <span data-ttu-id="3c44a-208">Cassandra azonban a helyreállítási sokkal zavartalanabbá, mint a hagyományos adatbázis helyreállítási folyamatok által igénybe vett idő.</span><span class="sxs-lookup"><span data-stu-id="3c44a-208">However, Cassandra makes the recovery much swifter than the time taken by traditional database recovery processes.</span></span> <span data-ttu-id="3c44a-209">A 2. ábrán minden régióban nyolc csomópontokkal tipikus több területi telepítési modelljét mutatja.</span><span class="sxs-lookup"><span data-stu-id="3c44a-209">Figure 2 shows the typical multi-region deployment model with eight nodes in each region.</span></span> <span data-ttu-id="3c44a-210">Mindkét régiók a következők tükör képek minden más ugyanazon szimmetriasíkjához; valós tervek munkaterhelésének típusát (pl. tranzakciós vagy analitikai), a helyreállítási Időkorlát, RTO, adatkonzisztenciát és rendelkezésre állási követelmények függ.</span><span class="sxs-lookup"><span data-stu-id="3c44a-210">Both regions are mirror images of each other for the same of symmetry; real world designs depend on the workload type (e.g. transactional or analytical), RPO, RTO, data consistency and availability requirements.</span></span>

![Több régióban központi telepítés](./media/cassandra-nodejs/cassandra-linux2.png)

<span data-ttu-id="3c44a-212">2. ábra: Több területi Cassandra központi telepítés</span><span class="sxs-lookup"><span data-stu-id="3c44a-212">Figure 2: Multi-region Cassandra deployment</span></span>

### <a name="network-integration"></a><span data-ttu-id="3c44a-213">Hálózati integráció</span><span class="sxs-lookup"><span data-stu-id="3c44a-213">Network Integration</span></span>
<span data-ttu-id="3c44a-214">Készlet két régiókban található magánhálózatokhoz telepített virtuális gépek egymástól a VPN-alagút segítségével kommunikál.</span><span class="sxs-lookup"><span data-stu-id="3c44a-214">Sets of virtual machines deployed to private networks located on two regions communicates with each other using a VPN tunnel.</span></span> <span data-ttu-id="3c44a-215">A VPN-alagút két szoftver átjárók a hálózati telepítési folyamat során létesített kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="3c44a-215">The VPN tunnel connects two software gateways provisioned during the network deployment process.</span></span> <span data-ttu-id="3c44a-216">Mindkét memóriaterületnél hasonló hálózati architektúra szempontjából "web" és "data" alhálózat; Az Azure hálózatkezelés lehetővé teszi, hogy a lehető legtöbb alhálózatok igény szerint létrehozása, és alkalmazni a hozzáférés-vezérlési listákat, igényei szerint hálózati biztonság.</span><span class="sxs-lookup"><span data-stu-id="3c44a-216">Both regions have similar network architecture in terms of “web” and “data” subnets; Azure networking allows the creation of as many subnets as needed and apply ACLs as needed by network security.</span></span> <span data-ttu-id="3c44a-217">A fürt topológia tervezése során többek data center kommunikációs késés és a hálózati forgalmat kell figyelembe kell venni a gazdasági hatását.</span><span class="sxs-lookup"><span data-stu-id="3c44a-217">While designing the cluster topology inter data center communication latency and the economic impact of the network traffic need to be considered.</span></span>

### <a name="data-consistency-for-multi-data-center-deployment"></a><span data-ttu-id="3c44a-218">Adatok konzisztenciájának több adatközpont központi telepítéshez</span><span class="sxs-lookup"><span data-stu-id="3c44a-218">Data Consistency for Multi-Data Center Deployment</span></span>
<span data-ttu-id="3c44a-219">Az elosztott központi telepítések kell figyelembe vennie átviteli sebesség és a magas rendelkezésre állású fürt topológia hatását.</span><span class="sxs-lookup"><span data-stu-id="3c44a-219">Distributed deployments need to be aware of the cluster topology impact on throughput and high availability.</span></span> <span data-ttu-id="3c44a-220">A RF és Konzisztenciaszint kell megadni, hogy a kvórum sem függ a adatközpontok rendelkezésre állását módon.</span><span class="sxs-lookup"><span data-stu-id="3c44a-220">The RF and Consistency Level need to be selected in such way that the quorum doesn’t depend on the availability of all the data centers.</span></span>
<span data-ttu-id="3c44a-221">A rendszer, amelyet a magas konzisztencia egy LOCAL_QUORUM konzisztencia szint (az olvasási és írási) fog győződjön meg arról, hogy a helyi olvasási és írási teljesülnek a helyi csomópontjáról adatok aszinkron módon replikálja a távoli adatközpontokban.</span><span class="sxs-lookup"><span data-stu-id="3c44a-221">For a system that needs high consistency, a LOCAL_QUORUM for consistency level (for reads and writes) will make sure that the local reads and writes are satisfied from the local nodes while data is replicated asynchronously to the remote data centers.</span></span>  <span data-ttu-id="3c44a-222">2. táblázat összefoglalja a több területi fürt be az írás leírt konfigurációs részleteit.</span><span class="sxs-lookup"><span data-stu-id="3c44a-222">Table 2 summarizes the configuration details for the multi-region cluster outlined later in the write up.</span></span>

<span data-ttu-id="3c44a-223">**A két-régió Cassandra fürtkonfiguráció**</span><span class="sxs-lookup"><span data-stu-id="3c44a-223">**Two-region Cassandra cluster configuration**</span></span>

| <span data-ttu-id="3c44a-224">Fürt paraméter</span><span class="sxs-lookup"><span data-stu-id="3c44a-224">Cluster Parameter</span></span> | <span data-ttu-id="3c44a-225">Érték</span><span class="sxs-lookup"><span data-stu-id="3c44a-225">Value</span></span> | <span data-ttu-id="3c44a-226">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-226">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3c44a-227">(N) csomópontok száma</span><span class="sxs-lookup"><span data-stu-id="3c44a-227">Number of Nodes (N)</span></span> |<span data-ttu-id="3c44a-228">8 + 8</span><span class="sxs-lookup"><span data-stu-id="3c44a-228">8 + 8</span></span> |<span data-ttu-id="3c44a-229">A fürtben található csomópontok száma</span><span class="sxs-lookup"><span data-stu-id="3c44a-229">Total number of nodes in the cluster</span></span> |
| <span data-ttu-id="3c44a-230">Replikációs tényező (RF)</span><span class="sxs-lookup"><span data-stu-id="3c44a-230">Replication Factor (RF)</span></span> |<span data-ttu-id="3c44a-231">3</span><span class="sxs-lookup"><span data-stu-id="3c44a-231">3</span></span> |<span data-ttu-id="3c44a-232">Adott sor replikák száma</span><span class="sxs-lookup"><span data-stu-id="3c44a-232">Number of replicas of a given row</span></span> |
| <span data-ttu-id="3c44a-233">Konzisztenciaszint (írás)</span><span class="sxs-lookup"><span data-stu-id="3c44a-233">Consistency Level (Write)</span></span> |<span data-ttu-id="3c44a-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] kerekíti a képlet eredménye</span><span class="sxs-lookup"><span data-stu-id="3c44a-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] The result of the formula is rounded down</span></span> |<span data-ttu-id="3c44a-235">2 csomópontok rendszer úgy tünteti fel az első adatközpont szinkron módon történik; a kvórum szükséges további 2 csomópontok aszinkron módon történik a 2. az Adatközpont fog szerepelni.</span><span class="sxs-lookup"><span data-stu-id="3c44a-235">2 nodes will be written to the first data center synchronously; the additional 2 nodes needed for quorum will be written asynchronously to the 2nd data center.</span></span> |
| <span data-ttu-id="3c44a-236">Konzisztenciaszint (olvasás)</span><span class="sxs-lookup"><span data-stu-id="3c44a-236">Consistency Level (Read)</span></span> |<span data-ttu-id="3c44a-237">LOCAL_QUORUM ((RF/2) + 1) a képlet eredménye lefelé kerekíti 2 =</span><span class="sxs-lookup"><span data-stu-id="3c44a-237">LOCAL_QUORUM ((RF/2) +1) = 2 The result of the formula is rounded down</span></span> |<span data-ttu-id="3c44a-238">Olvasási kérések teljesülnek a csak egy régió tartozik; 2 csomópontok olvasható az ügyfélnek a válasz elküldése előtt.</span><span class="sxs-lookup"><span data-stu-id="3c44a-238">Read requests are satisfied from only one region; 2 nodes are read before the response is sent back to the client.</span></span> |
| <span data-ttu-id="3c44a-239">Replikációs stratégia</span><span class="sxs-lookup"><span data-stu-id="3c44a-239">Replication Strategy</span></span> |<span data-ttu-id="3c44a-240">NetworkTopologyStrategy lásd [adatreplikáció](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) Cassandra dokumentációjában talál további információt a</span><span class="sxs-lookup"><span data-stu-id="3c44a-240">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="3c44a-241">A telepítési topológia megértette és replikák csomóponton helyezi el, hogy minden replika az azonos állványra a nem végződhet</span><span class="sxs-lookup"><span data-stu-id="3c44a-241">Understands the deployment topology and places replicas on nodes so that all the replicas don’t end up on the same rack</span></span> |
| <span data-ttu-id="3c44a-242">Snitch</span><span class="sxs-lookup"><span data-stu-id="3c44a-242">Snitch</span></span> |<span data-ttu-id="3c44a-243">Lásd a GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) Cassandra dokumentációjában talál további információt a</span><span class="sxs-lookup"><span data-stu-id="3c44a-243">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="3c44a-244">NetworkTopologyStrategy snitch egy fogalom megértéséhez a topológia használja.</span><span class="sxs-lookup"><span data-stu-id="3c44a-244">NetworkTopologyStrategy uses a concept of snitch to understand the topology.</span></span> <span data-ttu-id="3c44a-245">GossipingPropertyFileSnitch az egyes csomópontok leképezése a adatközpont és állvány nagyobb ellenőrzést biztosít.</span><span class="sxs-lookup"><span data-stu-id="3c44a-245">GossipingPropertyFileSnitch gives better control in mapping each node to data center and rack.</span></span> <span data-ttu-id="3c44a-246">A fürt pletykákat használja fel ezeket az információkat terjesztése.</span><span class="sxs-lookup"><span data-stu-id="3c44a-246">The cluster then uses gossip to propagate this information.</span></span> <span data-ttu-id="3c44a-247">Ez az jóval egyszerűbb, a dinamikus IP-beállítása PropertyFileSnitch viszonyítva</span><span class="sxs-lookup"><span data-stu-id="3c44a-247">This is much simpler in dynamic IP setting relative to PropertyFileSnitch</span></span> |

## <a name="the-software-configuration"></a><span data-ttu-id="3c44a-248">A SZOFTVERKONFIGURÁCIÓJÁNAK ÖSSZEÁLLÍTÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-248">THE SOFTWARE CONFIGURATION</span></span>
<span data-ttu-id="3c44a-249">Az alábbi szoftververziók a telepítés során használt:</span><span class="sxs-lookup"><span data-stu-id="3c44a-249">The following software versions are used during the deployment:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-250">Szoftver</span><span class="sxs-lookup"><span data-stu-id="3c44a-250">Software</span></span></th><th><span data-ttu-id="3c44a-251">Forrás</span><span class="sxs-lookup"><span data-stu-id="3c44a-251">Source</span></span></th><th><span data-ttu-id="3c44a-252">Verzió</span><span class="sxs-lookup"><span data-stu-id="3c44a-252">Version</span></span></th></tr>
<tr><td><span data-ttu-id="3c44a-253">JRE</span><span class="sxs-lookup"><span data-stu-id="3c44a-253">JRE</span></span>    </td><td><span data-ttu-id="3c44a-254">[8 JRE](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span><span class="sxs-lookup"><span data-stu-id="3c44a-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span></span></td><td><span data-ttu-id="3c44a-255">8U5</span><span class="sxs-lookup"><span data-stu-id="3c44a-255">8U5</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-256">JNA</span><span class="sxs-lookup"><span data-stu-id="3c44a-256">JNA</span></span>    </td><td><span data-ttu-id="3c44a-257">[JNA](https://github.com/twall/jna) </span><span class="sxs-lookup"><span data-stu-id="3c44a-257">[JNA](https://github.com/twall/jna) </span></span></td><td> <span data-ttu-id="3c44a-258">3.2.7</span><span class="sxs-lookup"><span data-stu-id="3c44a-258">3.2.7</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-259">Cassandra</span><span class="sxs-lookup"><span data-stu-id="3c44a-259">Cassandra</span></span></td><td>[<span data-ttu-id="3c44a-260">Apache Cassandra 2.0.8</span><span class="sxs-lookup"><span data-stu-id="3c44a-260">Apache Cassandra 2.0.8</span></span>](http://www.apache.org/dist/cassandra/2.0.8/apache-cassandra-2.0.8-bin.tar.gz)</td><td> <span data-ttu-id="3c44a-261">2.0.8</span><span class="sxs-lookup"><span data-stu-id="3c44a-261">2.0.8</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-262">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="3c44a-262">Ubuntu</span></span>    </td><td><span data-ttu-id="3c44a-263">[A Microsoft Azure](https://azure.microsoft.com/) </span><span class="sxs-lookup"><span data-stu-id="3c44a-263">[Microsoft Azure](https://azure.microsoft.com/) </span></span></td><td><span data-ttu-id="3c44a-264">14.04 LTS</span><span class="sxs-lookup"><span data-stu-id="3c44a-264">14.04 LTS</span></span></td></tr>
</table>

<span data-ttu-id="3c44a-265">Az Oracle licencfeltételeinek elfogadását manuális JRE letöltése szükséges, egyszerűbbé teheti a központi telepítést, töltse le a szükséges szoftverek később feltöltése a Ubuntu sablon lemezképpel azt létrehozni a fürtöt tartalmazó környezetben való előanyagát, az asztalon.</span><span class="sxs-lookup"><span data-stu-id="3c44a-265">Since downloading of JRE requires manual acceptance of Oracle license, to simplify the deployment, download all the required software to the desktop for later uploading into the Ubuntu template image we will be creating as a precursor to the cluster deployment.</span></span>

<span data-ttu-id="3c44a-266">A fenti szoftverek letöltési könyvtárba, amely egy jól ismert letöltési (pl. Windows %TEMP%/downloads vagy ~/Downloads legtöbb Linux terjesztésekről vagy Mac) a helyi számítógépen.</span><span class="sxs-lookup"><span data-stu-id="3c44a-266">Download the above software into a well-known download directory (e.g. %TEMP%/downloads on Windows or ~/Downloads on most Linux distributions or Mac) on the local computer.</span></span>

### <a name="create-ubuntu-vm"></a><span data-ttu-id="3c44a-267">UBUNTU VIRTUÁLIS GÉP LÉTREHOZÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-267">CREATE UBUNTU VM</span></span>
<span data-ttu-id="3c44a-268">Ebben a lépésben a folyamat létrehozunk Ubuntu kép az előfeltételt jelentő szoftvereket az, hogy a kép felhasználhatók számos Cassandra csomópont történő üzembe helyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="3c44a-268">In this step of the process we will create Ubuntu image with the pre-requisite software so that the image can be reused for provisioning several Cassandra nodes.</span></span>  

#### <a name="step-1-generate-ssh-key-pair"></a><span data-ttu-id="3c44a-269">1. lépés: Az SSH-kulcspárral létrehozása</span><span class="sxs-lookup"><span data-stu-id="3c44a-269">STEP 1: Generate SSH key pair</span></span>
<span data-ttu-id="3c44a-270">Azure egy nyilvános kulcsot, amely PEM vagy DER kódolású létesítési időpontjában X509 kér.</span><span class="sxs-lookup"><span data-stu-id="3c44a-270">Azure needs an X509 public key that is either PEM or DER encoded at the provisioning time.</span></span> <span data-ttu-id="3c44a-271">A el az SSH Linux Azure-on található utasításokat követve nyilvános/titkos kulcspárt létre.</span><span class="sxs-lookup"><span data-stu-id="3c44a-271">Generate a public/private key pair using the instructions located at How to Use SSH with Linux on Azure.</span></span> <span data-ttu-id="3c44a-272">Ha tervezi putty.exe Windows vagy Linux SSH-ügyfélként, hogy alakítsa át a PEM-kódolású RSA titkos kulcs PPK formátum használatával puttygen.exe; Ehhez útmutatást a fenti weblapon találhatók.</span><span class="sxs-lookup"><span data-stu-id="3c44a-272">If you plan to use putty.exe as an SSH client either on Windows or Linux, you have to convert the PEM encoded RSA private key to PPK format using puttygen.exe; the instructions for this can be found in the above web page.</span></span>

#### <a name="step-2-create-ubuntu-template-vm"></a><span data-ttu-id="3c44a-273">2. lépés: Sablon Ubuntu virtuális gép</span><span class="sxs-lookup"><span data-stu-id="3c44a-273">STEP 2: Create Ubuntu template VM</span></span>
<span data-ttu-id="3c44a-274">A Virtuálisgép-sablon létrehozásához jelentkezzen be a klasszikus Azure portálra, és kövesse az alábbi eljárást: új, számítási, virtuális gép, FROM GYŰJTEMÉNYE, UBUNTU, Ubuntu Server 14.04 LTS kattintson, majd a jobbra mutató nyílra.</span><span class="sxs-lookup"><span data-stu-id="3c44a-274">To create the template VM, log into the Azure classic portal and use the following sequence: Click NEW, COMPUTE, VIRTUAL MACHINE, FROM GALLERY, UBUNTU, Ubuntu Server 14.04 LTS, and then click the right arrow.</span></span> <span data-ttu-id="3c44a-275">Ez az oktatóanyag ismerteti, hogyan hozzon létre egy Linux virtuális Gépet hozzon létre egy virtuális gép futó Linux talál.</span><span class="sxs-lookup"><span data-stu-id="3c44a-275">For a tutorial that describes how to create a Linux VM, see Create a Virtual Machine Running Linux.</span></span>

<span data-ttu-id="3c44a-276">Adja meg a következő információkat a "virtuálisgép-konfiguráció" képernyőn #1:</span><span class="sxs-lookup"><span data-stu-id="3c44a-276">Enter the following information on the “Virtual machine configuration” screen #1:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-277">MEZŐ NEVE</span><span class="sxs-lookup"><span data-stu-id="3c44a-277">FIELD NAME</span></span>              </td><td>       <span data-ttu-id="3c44a-278">MEZŐÉRTÉK</span><span class="sxs-lookup"><span data-stu-id="3c44a-278">FIELD VALUE</span></span>               </td><td>         <span data-ttu-id="3c44a-279">MEGJEGYZÉSEK</span><span class="sxs-lookup"><span data-stu-id="3c44a-279">REMARKS</span></span>                </td><tr>
<tr><td><span data-ttu-id="3c44a-280">VERZIÓ KIADÁSI DÁTUM</span><span class="sxs-lookup"><span data-stu-id="3c44a-280">VERSION RELEASE DATE</span></span>    </td><td> <span data-ttu-id="3c44a-281">Egy dátumot a legördülő menüből válassza le</span><span class="sxs-lookup"><span data-stu-id="3c44a-281">Select a date from the drop down</span></span></td><td></td><tr>
<tr><td><span data-ttu-id="3c44a-282">VIRTUÁLIS GÉP NEVE</span><span class="sxs-lookup"><span data-stu-id="3c44a-282">VIRTUAL MACHINE NAME</span></span>    </td><td> <span data-ttu-id="3c44a-283">esetén-sablon</span><span class="sxs-lookup"><span data-stu-id="3c44a-283">cass-template</span></span>                   </td><td> <span data-ttu-id="3c44a-284">Ez az a virtuális gép állomásnevét</span><span class="sxs-lookup"><span data-stu-id="3c44a-284">This is the hostname of the VM</span></span> </td><tr>
<tr><td><span data-ttu-id="3c44a-285">RÉTEG</span><span class="sxs-lookup"><span data-stu-id="3c44a-285">TIER</span></span>                     </td><td> <span data-ttu-id="3c44a-286">STANDARD</span><span class="sxs-lookup"><span data-stu-id="3c44a-286">STANDARD</span></span>                           </td><td> <span data-ttu-id="3c44a-287">Hagyja meg az alapértelmezett</span><span class="sxs-lookup"><span data-stu-id="3c44a-287">Leave the default</span></span>              </td><tr>
<tr><td><span data-ttu-id="3c44a-288">MÉRET</span><span class="sxs-lookup"><span data-stu-id="3c44a-288">SIZE</span></span>                     </td><td> <span data-ttu-id="3c44a-289">A1</span><span class="sxs-lookup"><span data-stu-id="3c44a-289">A1</span></span>                              </td><td><span data-ttu-id="3c44a-290">Válassza ki a virtuális Gépet a IO igényeinek megfelelően; erre a célra hagyja meg az alapértelmezett</span><span class="sxs-lookup"><span data-stu-id="3c44a-290">Select the VM based on the IO needs; for this purpose leave the default</span></span> </td><tr>
<tr><td> <span data-ttu-id="3c44a-291">ÚJ FELHASZNÁLÓ NEVE</span><span class="sxs-lookup"><span data-stu-id="3c44a-291">NEW USER NAME</span></span>             </td><td> <span data-ttu-id="3c44a-292">localadmin</span><span class="sxs-lookup"><span data-stu-id="3c44a-292">localadmin</span></span>                       </td><td> <span data-ttu-id="3c44a-293">"rendszergazda" az egyetlen foglalt felhasználónévvel Ubuntu 12. xx és után</span><span class="sxs-lookup"><span data-stu-id="3c44a-293">"admin" is a reserved user name in Ubuntu 12.xx and after</span></span></td><tr>
<tr><td> <span data-ttu-id="3c44a-294">HITELESÍTÉS</span><span class="sxs-lookup"><span data-stu-id="3c44a-294">AUTHENTICATION</span></span>         </td><td> <span data-ttu-id="3c44a-295">Jelölje be jelölőnégyzetet</span><span class="sxs-lookup"><span data-stu-id="3c44a-295">Click check box</span></span>                 </td><td><span data-ttu-id="3c44a-296">Ellenőrizze, hogy szeretné-e az SSH-kulcs biztonságos</span><span class="sxs-lookup"><span data-stu-id="3c44a-296">Check if you want to secure with an SSH key</span></span> </td><tr>
<tr><td> <span data-ttu-id="3c44a-297">TANÚSÍTVÁNY</span><span class="sxs-lookup"><span data-stu-id="3c44a-297">CERTIFICATE</span></span>             </td><td> <span data-ttu-id="3c44a-298">a nyilvános kulcsú tanúsítvány fájlneve</span><span class="sxs-lookup"><span data-stu-id="3c44a-298">file name of the public key certificate</span></span> </td><td> <span data-ttu-id="3c44a-299">A korábban létrehozott nyilvános kulcs</span><span class="sxs-lookup"><span data-stu-id="3c44a-299">Use the public key generated previously</span></span></td><tr>
<tr><td> <span data-ttu-id="3c44a-300">Új jelszó</span><span class="sxs-lookup"><span data-stu-id="3c44a-300">New Password</span></span>    </td><td> <span data-ttu-id="3c44a-301">erős jelszó</span><span class="sxs-lookup"><span data-stu-id="3c44a-301">strong password</span></span> </td><td> </td><tr>
<tr><td> <span data-ttu-id="3c44a-302">Jelszó megerősítése</span><span class="sxs-lookup"><span data-stu-id="3c44a-302">Confirm Password</span></span>    </td><td> <span data-ttu-id="3c44a-303">erős jelszó</span><span class="sxs-lookup"><span data-stu-id="3c44a-303">strong password</span></span> </td><td></td><tr>
</table>

<span data-ttu-id="3c44a-304">Adja meg a következő információkat a "virtuálisgép-konfiguráció" képernyőn #2:</span><span class="sxs-lookup"><span data-stu-id="3c44a-304">Enter the following information on the “Virtual machine configuration” screen #2:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-305">MEZŐ NEVE</span><span class="sxs-lookup"><span data-stu-id="3c44a-305">FIELD NAME</span></span>             </th><th> <span data-ttu-id="3c44a-306">MEZŐÉRTÉK</span><span class="sxs-lookup"><span data-stu-id="3c44a-306">FIELD VALUE</span></span>                       </th><th> <span data-ttu-id="3c44a-307">MEGJEGYZÉSEK</span><span class="sxs-lookup"><span data-stu-id="3c44a-307">REMARKS</span></span>                                 </th></tr>
<tr><td> <span data-ttu-id="3c44a-308">A FELHŐALAPÚ SZOLGÁLTATÁS</span><span class="sxs-lookup"><span data-stu-id="3c44a-308">CLOUD SERVICE</span></span>    </td><td> <span data-ttu-id="3c44a-309">Új felhőalapú szolgáltatás létrehozása</span><span class="sxs-lookup"><span data-stu-id="3c44a-309">Create a new cloud service</span></span>    </td><td><span data-ttu-id="3c44a-310">Felhőszolgáltatás egy tároló számítási erőforrásokhoz, mint a virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="3c44a-310">Cloud service is a container compute resources like virtual machines</span></span></td></tr>
<tr><td> <span data-ttu-id="3c44a-311">FELHŐALAPÚ SZOLGÁLTATÁS DNS-NÉV</span><span class="sxs-lookup"><span data-stu-id="3c44a-311">CLOUD SERVICE DNS NAME</span></span>    </td><td><span data-ttu-id="3c44a-312">ubuntu-template.cloudapp.net</span><span class="sxs-lookup"><span data-stu-id="3c44a-312">ubuntu-template.cloudapp.net</span></span>    </td><td><span data-ttu-id="3c44a-313">Adjon meg egy gép független terheléselosztó neve</span><span class="sxs-lookup"><span data-stu-id="3c44a-313">Give a machine agnostic load balancer name</span></span></td></tr>
<tr><td> <span data-ttu-id="3c44a-314">RÉGIÓ/AFFINITÁSCSOPORT/VIRTUÁLIS HÁLÓZAT</span><span class="sxs-lookup"><span data-stu-id="3c44a-314">REGION/AFFINITY GROUP/VIRTUAL NETWORK</span></span> </td><td>    <span data-ttu-id="3c44a-315">USA nyugati régiója</span><span class="sxs-lookup"><span data-stu-id="3c44a-315">West US</span></span>    </td><td> <span data-ttu-id="3c44a-316">Válasszon ki egy régiót, ahol a webalkalmazások érje el a Cassandra</span><span class="sxs-lookup"><span data-stu-id="3c44a-316">Select a region from which your web applications access the Cassandra cluster</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-317">TÁRFIÓK</span><span class="sxs-lookup"><span data-stu-id="3c44a-317">STORAGE ACCOUNT</span></span> </td><td>    <span data-ttu-id="3c44a-318">Használhatja az alapértelmezettet</span><span class="sxs-lookup"><span data-stu-id="3c44a-318">Use default</span></span>    </td><td><span data-ttu-id="3c44a-319">Az alapértelmezett tárfiók vagy egy korábban létrehozott tárfiókot használja az adott</span><span class="sxs-lookup"><span data-stu-id="3c44a-319">Use the default storage account  or a pre-created storage account in a particular region</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-320">A RENDELKEZÉSRE ÁLLÁSI CSOPORT</span><span class="sxs-lookup"><span data-stu-id="3c44a-320">AVAILABILITY SET</span></span> </td><td>    <span data-ttu-id="3c44a-321">None</span><span class="sxs-lookup"><span data-stu-id="3c44a-321">None</span></span> </td><td>    <span data-ttu-id="3c44a-322">Hagyja üresen</span><span class="sxs-lookup"><span data-stu-id="3c44a-322">Leave it blank</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-323">VÉGPONTOK</span><span class="sxs-lookup"><span data-stu-id="3c44a-323">ENDPOINTS</span></span>    </td><td><span data-ttu-id="3c44a-324">Használhatja az alapértelmezettet</span><span class="sxs-lookup"><span data-stu-id="3c44a-324">Use default</span></span> </td><td>    <span data-ttu-id="3c44a-325">Az alapértelmezett SSH-konfigurációt használja.</span><span class="sxs-lookup"><span data-stu-id="3c44a-325">Use the default SSH configuration</span></span> </td></tr>
</table>

<span data-ttu-id="3c44a-326">Kattintson a jobbra mutató nyílra, a #3 képernyőn hagyja meg az alapértelmezett beállításokat, és kattintson az "ellenőrzés" gombra a Virtuálisgép-létrehozásnál folyamat befejezéséhez.</span><span class="sxs-lookup"><span data-stu-id="3c44a-326">Click right arrow, leave the defaults on the screen #3 and click the “check” button to complete the VM provisioning process.</span></span> <span data-ttu-id="3c44a-327">Néhány perc múlva a virtuális Géphez a neve "ubuntu-template" a "fut" állapotú kell lennie.</span><span class="sxs-lookup"><span data-stu-id="3c44a-327">After a few minutes, the VM with the name “ubuntu-template” should be in a “running” status.</span></span>

### <a name="install-the-necessary-software"></a><span data-ttu-id="3c44a-328">A SZÜKSÉGES SZOFTVER TELEPÍTÉSÉHEZ</span><span class="sxs-lookup"><span data-stu-id="3c44a-328">INSTALL THE NECESSARY SOFTWARE</span></span>
#### <a name="step-1-upload-tarballs"></a><span data-ttu-id="3c44a-329">1. lépés: Feltöltés tarballs</span><span class="sxs-lookup"><span data-stu-id="3c44a-329">STEP 1: Upload tarballs</span></span>
<span data-ttu-id="3c44a-330">A következő parancs formátumban ~/downloads directory scp vagy pscp használ, másolja a korábban letöltött szoftverfrissítések:</span><span class="sxs-lookup"><span data-stu-id="3c44a-330">Using scp or pscp, copy the previously downloaded software to ~/downloads directory using the following command format:</span></span>

##### <a name="pscp-server-jre-8u5-linux-x64targz-localadminhk-cas-templatecloudappnethomelocaladmindownloadsserver-jre-8u5-linux-x64targz"></a><span data-ttu-id="3c44a-331">pscp kiszolgáló-jre-8u5-linux-x64.tar.gzlocaladmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span><span class="sxs-lookup"><span data-stu-id="3c44a-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span></span>
<span data-ttu-id="3c44a-332">Ismételje meg a fenti parancs JRE, valamint a Cassandra bits esetében.</span><span class="sxs-lookup"><span data-stu-id="3c44a-332">Repeat the above command for JRE as well as for the Cassandra bits.</span></span>

#### <a name="step-2-prepare-the-directory-structure-and-extract-the-archives"></a><span data-ttu-id="3c44a-333">2. lépés: Készítse elő a könyvtárstruktúra, és bontsa ki az archívumban</span><span class="sxs-lookup"><span data-stu-id="3c44a-333">STEP 2: Prepare the directory structure and extract the archives</span></span>
<span data-ttu-id="3c44a-334">Jelentkezzen be a virtuális gép és a könyvtárstruktúra létrehozása, és bontsa ki a szoftver felügyelőként a bash az alábbi parancsfájlt:</span><span class="sxs-lookup"><span data-stu-id="3c44a-334">Log into the VM and create the directory structure and extract software as a super user using the bash script below:</span></span>

    #!/bin/bash
    CASS_INSTALL_DIR="/opt/cassandra"
    JRE_INSTALL_DIR="/opt/java"
    CASS_DATA_DIR="/var/lib/cassandra"
    CASS_LOG_DIR="/var/log/cassandra"
    DOWNLOADS_DIR="~/downloads"
    JRE_TARBALL="server-jre-8u5-linux-x64.tar.gz"
    CASS_TARBALL="apache-cassandra-2.0.8-bin.tar.gz"
    SVC_USER="localadmin"

    RESET_ERROR=1
    MKDIR_ERROR=2

    reset_installation ()
    {
       rm -rf $CASS_INSTALL_DIR 2> /dev/null
       rm -rf $JRE_INSTALL_DIR 2> /dev/null
       rm -rf $CASS_DATA_DIR 2> /dev/null
       rm -rf $CASS_LOG_DIR 2> /dev/null
    }
    make_dir ()
    {
       if [ -z "$1" ]
       then
          echo "make_dir: invalid directory name"
          exit $MKDIR_ERROR
       fi

       if [ -d "$1" ]
       then
          echo "make_dir: directory already exists"
          exit $MKDIR_ERROR
       fi

       mkdir $1 2>/dev/null
       if [ $? != 0 ]
       then
          echo "directory creation failed"
          exit $MKDIR_ERROR
       fi
    }

    unzip()
    {
       if [ $# == 2 ]
       then
          tar xzf $1 -C $2
       else
          echo "archive error"
       fi

    }

    if [ -n "$1" ]
    then
       SVC_USER=$1
    fi

    reset_installation
    make_dir $CASS_INSTALL_DIR
    make_dir $JRE_INSTALL_DIR
    make_dir $CASS_DATA_DIR
    make_dir $CASS_LOG_DIR

    #unzip JRE and Cassandra
    unzip $HOME/downloads/$JRE_TARBALL $JRE_INSTALL_DIR
    unzip $HOME/downloads/$CASS_TARBALL $CASS_INSTALL_DIR

    #Change the ownership to the service credentials

    chown -R $SVC_USER:$GROUP $CASS_DATA_DIR
    chown -R $SVC_USER:$GROUP $CASS_LOG_DIR
    echo "edit /etc/profile to add JRE to the PATH"
    echo "installation is complete"


<span data-ttu-id="3c44a-335">Ha vim ablakba be ezt a parancsfájlt, ügyeljen arra, hogy távolítsa el a kocsivissza ("\r") a következő parancsot:</span><span class="sxs-lookup"><span data-stu-id="3c44a-335">If you paste this script into vim window, make sure to remove the carriage return (‘\r”) using the following command:</span></span>

    tr -d '\r' <infile.sh >outfile.sh

#### <a name="step-3-edit-etcprofile"></a><span data-ttu-id="3c44a-336">3. lépés: Stb/profil szerkesztése</span><span class="sxs-lookup"><span data-stu-id="3c44a-336">Step 3: Edit etc/profile</span></span>
<span data-ttu-id="3c44a-337">A következő végén hozzáfűzése:</span><span class="sxs-lookup"><span data-stu-id="3c44a-337">Append the following at the end:</span></span>

    JAVA_HOME=/opt/java/jdk1.8.0_05
    CASS_HOME= /opt/cassandra/apache-cassandra-2.0.8
    PATH=$PATH:$HOME/bin:$JAVA_HOME/bin:$CASS_HOME/bin
    export JAVA_HOME
    export CASS_HOME
    export PATH

#### <a name="step-4-install-jna-for-production-systems"></a><span data-ttu-id="3c44a-338">4. lépés: Telepítse JNA éles rendszerek esetén</span><span class="sxs-lookup"><span data-stu-id="3c44a-338">Step 4: Install JNA for production systems</span></span>
<span data-ttu-id="3c44a-339">A következő parancssort használja: A következő parancsot a jna-3.2.7.jar és jna-platform-3.2.7.jar /usr/share.java könyvtárba sudo apt-get libjna-java</span><span class="sxs-lookup"><span data-stu-id="3c44a-339">Use the following command sequence: The following command will install jna-3.2.7.jar and jna-platform-3.2.7.jar to /usr/share.java directory sudo apt-get install libjna-java</span></span>

<span data-ttu-id="3c44a-340">Hozza létre a szimbolikus csatolást $CASS_HOME/lib könyvtárban, hogy Cassandra indítási parancsfájl megtalálhassa a JAR-fájlok kivételével:</span><span class="sxs-lookup"><span data-stu-id="3c44a-340">Create symbolic links in $CASS_HOME/lib directory so that Cassandra startup script can find these jars:</span></span>

    ln -s /usr/share/java/jna-3.2.7.jar $CASS_HOME/lib/jna.jar

    ln -s /usr/share/java/jna-platform-3.2.7.jar $CASS_HOME/lib/jna-platform.jar

#### <a name="step-5-configure-cassandrayaml"></a><span data-ttu-id="3c44a-341">5. lépés: Cassandra.yaml konfigurálása</span><span class="sxs-lookup"><span data-stu-id="3c44a-341">Step 5: Configure cassandra.yaml</span></span>
<span data-ttu-id="3c44a-342">Az egyes virtuális gépek megfelelően [azt fogja tudjon végezni ezzel a tényleges kiépítése során] összes virtuális gép által igényelt konfigurációs cassandra.yaml szerkesztése:</span><span class="sxs-lookup"><span data-stu-id="3c44a-342">Edit cassandra.yaml on each VM to reflect configuration needed by all the virtual machines [we will tweak this during the actual provisioning]:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-343">Mező neve</span><span class="sxs-lookup"><span data-stu-id="3c44a-343">Field Name</span></span>   </th><th> <span data-ttu-id="3c44a-344">Érték</span><span class="sxs-lookup"><span data-stu-id="3c44a-344">Value</span></span>  </th><th>    <span data-ttu-id="3c44a-345">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-345">Remarks</span></span> </th></tr>
<tr><td><span data-ttu-id="3c44a-346">fürtnév</span><span class="sxs-lookup"><span data-stu-id="3c44a-346">cluster_name</span></span> </td><td>    <span data-ttu-id="3c44a-347">"CustomerService"</span><span class="sxs-lookup"><span data-stu-id="3c44a-347">“CustomerService”</span></span>    </td><td> <span data-ttu-id="3c44a-348">A nevet válasszon, amely tükrözi a központi telepítés</span><span class="sxs-lookup"><span data-stu-id="3c44a-348">Use the name that reflects your deployment</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-349">listen_address</span><span class="sxs-lookup"><span data-stu-id="3c44a-349">listen_address</span></span>    </td><td><span data-ttu-id="3c44a-350">[hagyja üresen a mezőt]</span><span class="sxs-lookup"><span data-stu-id="3c44a-350">[leave it blank]</span></span>    </td><td> <span data-ttu-id="3c44a-351">Törölje a "localhost"</span><span class="sxs-lookup"><span data-stu-id="3c44a-351">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="3c44a-352">rpc_addres</span><span class="sxs-lookup"><span data-stu-id="3c44a-352">rpc_addres</span></span>   </td><td><span data-ttu-id="3c44a-353">[hagyja üresen a mezőt]</span><span class="sxs-lookup"><span data-stu-id="3c44a-353">[leave it blank]</span></span>    </td><td> <span data-ttu-id="3c44a-354">Törölje a "localhost"</span><span class="sxs-lookup"><span data-stu-id="3c44a-354">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="3c44a-355">magok</span><span class="sxs-lookup"><span data-stu-id="3c44a-355">seeds</span></span>    </td><td><span data-ttu-id="3c44a-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span><span class="sxs-lookup"><span data-stu-id="3c44a-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span></span>    </td><td><span data-ttu-id="3c44a-357">Minden a magok jelöli a rendszer IP-címek listáját.</span><span class="sxs-lookup"><span data-stu-id="3c44a-357">List of  all the IP addresses which are designated as seeds.</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-358">endpoint_snitch</span><span class="sxs-lookup"><span data-stu-id="3c44a-358">endpoint_snitch</span></span> </td><td> <span data-ttu-id="3c44a-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="3c44a-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span></span> </td><td> <span data-ttu-id="3c44a-360">A NetworkTopologyStrateg által szolgál az adatközpontban és a virtuális gép állvány behívásakor</span><span class="sxs-lookup"><span data-stu-id="3c44a-360">This is used by the NetworkTopologyStrateg for inferring the data center and the rack of the VM</span></span></td></tr>
</table>

#### <a name="step-6-capture-the-vm-image"></a><span data-ttu-id="3c44a-361">6. lépés: A virtuális gép lemezképének rögzítése</span><span class="sxs-lookup"><span data-stu-id="3c44a-361">Step 6: Capture the VM image</span></span>
<span data-ttu-id="3c44a-362">Jelentkezzen be a virtuális gépet az állomásnév (hk-cas-template.cloudapp.net) és a korábban létrehozott titkos SSH-kulcs használatával.</span><span class="sxs-lookup"><span data-stu-id="3c44a-362">Log into the virtual machine using the hostname (hk-cas-template.cloudapp.net) and the SSH private key previously created.</span></span> <span data-ttu-id="3c44a-363">Tekintse meg az SSH használata az Azure-ral való bejelentkezéshez használja a parancsot ssh vagy putty.exe Linux hogyan.</span><span class="sxs-lookup"><span data-stu-id="3c44a-363">See How to Use SSH with Linux on Azure for details on how to log in using the command ssh or putty.exe.</span></span>

<span data-ttu-id="3c44a-364">A következő feladatütemezési lépéssel a lemezkép rögzítése hajtható végre:</span><span class="sxs-lookup"><span data-stu-id="3c44a-364">Execute the following sequence of actions to capture the image:</span></span>

##### <a name="1-deprovision"></a><span data-ttu-id="3c44a-365">1. Deprovision</span><span class="sxs-lookup"><span data-stu-id="3c44a-365">1. Deprovision</span></span>
<span data-ttu-id="3c44a-366">A paranccsal "sudo waagent-deprovision + felhasználói" virtuálisgép-példányt adott adatok eltávolítása.</span><span class="sxs-lookup"><span data-stu-id="3c44a-366">Use the command “sudo waagent –deprovision+user” to remove Virtual Machine instance specific information.</span></span> <span data-ttu-id="3c44a-367">Tekintse át a vonatkozó [egy Linux virtuális gép rögzítése](capture-image.md) sablonként használatára további részleteket a lemezkép rögzítését.</span><span class="sxs-lookup"><span data-stu-id="3c44a-367">See for [How to Capture a Linux Virtual Machine](capture-image.md) to Use as a Template more details on the image capture process.</span></span>

##### <a name="2-shutdown-the-vm"></a><span data-ttu-id="3c44a-368">2: a virtuális gép leállítása</span><span class="sxs-lookup"><span data-stu-id="3c44a-368">2: Shutdown the VM</span></span>
<span data-ttu-id="3c44a-369">Győződjön meg arról, hogy a virtuális gép ki van jelölve, és kattintson a LEÁLLÍTÁS hivatkozásra az alsó parancs segítségével.</span><span class="sxs-lookup"><span data-stu-id="3c44a-369">Make sure that the virtual machine is highlighted and click the SHUTDOWN link from the bottom command bar.</span></span>

##### <a name="3-capture-the-image"></a><span data-ttu-id="3c44a-370">3: a lemezképének rögzítése</span><span class="sxs-lookup"><span data-stu-id="3c44a-370">3: Capture the image</span></span>
<span data-ttu-id="3c44a-371">Győződjön meg arról, hogy a virtuális gép ki van jelölve, és az utolsó parancs segítségével a rögzítési hivatkozásra.</span><span class="sxs-lookup"><span data-stu-id="3c44a-371">Make sure that the virtual machine is highlighted and click the CAPTURE link from the bottom command bar.</span></span> <span data-ttu-id="3c44a-372">A következő képernyőn nevezze el egy kép (pl. hk-cas-2-08-ub-14-04-2014071), a megfelelő RENDSZERKÉP leírása, és kattintson az "ellenőrzés" jelre a rögzítési folyamat befejezéséhez.</span><span class="sxs-lookup"><span data-stu-id="3c44a-372">In the next screen, give an IMAGE NAME (e.g. hk-cas-2-08-ub-14-04-2014071), appropriate IMAGE DESCRIPTION, and click the “check” mark to finish the CAPTURE process.</span></span>

<span data-ttu-id="3c44a-373">Ez eltarthat néhány másodpercig, és a lemezkép elérhetőnek kell lennie a kép tár a saját LEMEZKÉPEK szakaszban.</span><span class="sxs-lookup"><span data-stu-id="3c44a-373">This will take a few seconds and the image should be available in MY IMAGES section of the image gallery.</span></span> <span data-ttu-id="3c44a-374">A forrás virtuális gép automatikusan után törlődni fognak a lemezkép rögzítése sikerült.</span><span class="sxs-lookup"><span data-stu-id="3c44a-374">The source VM will be automatically deleted after the image is successfully captured.</span></span> 

## <a name="single-region-deployment-process"></a><span data-ttu-id="3c44a-375">Egyetlen régión telepítési folyamata</span><span class="sxs-lookup"><span data-stu-id="3c44a-375">Single Region Deployment Process</span></span>
<span data-ttu-id="3c44a-376">**1. lépés: A virtuális hálózat létrehozása** jelentkezzen be az Azure portálon, és hozzon létre egy virtuális hálózat (klasszikus) az alábbi táblázatban szereplő attribútumait.</span><span class="sxs-lookup"><span data-stu-id="3c44a-376">**Step 1: Create the Virtual Network** Log into the Azure portal and create a virtual network (classic) with the attributes shown in the following table.</span></span> <span data-ttu-id="3c44a-377">Lásd: [virtuális hálózat létrehozása (klasszikus) Azure-portálon](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) a részletes lépéseket a folyamat.</span><span class="sxs-lookup"><span data-stu-id="3c44a-377">See [Create a virtual network (classic) using the Azure portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of the process.</span></span>      

<table>
<tr><th><span data-ttu-id="3c44a-378">VM-attribútum neve</span><span class="sxs-lookup"><span data-stu-id="3c44a-378">VM Attribute Name</span></span></th><th><span data-ttu-id="3c44a-379">Érték</span><span class="sxs-lookup"><span data-stu-id="3c44a-379">Value</span></span></th><th><span data-ttu-id="3c44a-380">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-380">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="3c44a-381">Név</span><span class="sxs-lookup"><span data-stu-id="3c44a-381">Name</span></span></td><td><span data-ttu-id="3c44a-382">vnet-esetén-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-382">vnet-cass-west-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="3c44a-383">Régió</span><span class="sxs-lookup"><span data-stu-id="3c44a-383">Region</span></span></td><td><span data-ttu-id="3c44a-384">USA nyugati régiója</span><span class="sxs-lookup"><span data-stu-id="3c44a-384">West US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="3c44a-385">DNS-kiszolgálók</span><span class="sxs-lookup"><span data-stu-id="3c44a-385">DNS Servers</span></span></td><td><span data-ttu-id="3c44a-386">None</span><span class="sxs-lookup"><span data-stu-id="3c44a-386">None</span></span></td><td><span data-ttu-id="3c44a-387">Figyelmen kívül hagyja ezt a DNS-kiszolgáló nem használjuk</span><span class="sxs-lookup"><span data-stu-id="3c44a-387">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-388">Címterület</span><span class="sxs-lookup"><span data-stu-id="3c44a-388">Address Space</span></span></td><td><span data-ttu-id="3c44a-389">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="3c44a-389">10.1.0.0/16</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="3c44a-390">Kezdő IP-Címét</span><span class="sxs-lookup"><span data-stu-id="3c44a-390">Starting IP</span></span></td><td><span data-ttu-id="3c44a-391">10.1.0.0</span><span class="sxs-lookup"><span data-stu-id="3c44a-391">10.1.0.0</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="3c44a-392">CIDR</span><span class="sxs-lookup"><span data-stu-id="3c44a-392">CIDR</span></span> </td><td><span data-ttu-id="3c44a-393">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="3c44a-393">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="3c44a-394">Adja hozzá a következő alhálózatok:</span><span class="sxs-lookup"><span data-stu-id="3c44a-394">Add the following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-395">Név</span><span class="sxs-lookup"><span data-stu-id="3c44a-395">Name</span></span></th><th><span data-ttu-id="3c44a-396">Kezdő IP-Címét</span><span class="sxs-lookup"><span data-stu-id="3c44a-396">Starting IP</span></span></th><th><span data-ttu-id="3c44a-397">CIDR</span><span class="sxs-lookup"><span data-stu-id="3c44a-397">CIDR</span></span></th><th><span data-ttu-id="3c44a-398">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-398">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="3c44a-399">webalkalmazás</span><span class="sxs-lookup"><span data-stu-id="3c44a-399">web</span></span></td><td><span data-ttu-id="3c44a-400">10.1.1.0</span><span class="sxs-lookup"><span data-stu-id="3c44a-400">10.1.1.0</span></span></td><td><span data-ttu-id="3c44a-401">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="3c44a-401">/24 (251)</span></span></td><td><span data-ttu-id="3c44a-402">A webfarm-alhálózatot</span><span class="sxs-lookup"><span data-stu-id="3c44a-402">Subnet for the web farm</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-403">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-403">data</span></span></td><td><span data-ttu-id="3c44a-404">10.1.2.0</span><span class="sxs-lookup"><span data-stu-id="3c44a-404">10.1.2.0</span></span></td><td><span data-ttu-id="3c44a-405">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="3c44a-405">/24 (251)</span></span></td><td><span data-ttu-id="3c44a-406">Az adatbázis-csomópont-alhálózatot</span><span class="sxs-lookup"><span data-stu-id="3c44a-406">Subnet for the database nodes</span></span></td></tr>
</table>

<span data-ttu-id="3c44a-407">Adatok és a webes alhálózatok hálózati biztonsági csoportokkal, ez a cikk a hatókörén kívül esik a körét, amelyek védhetők.</span><span class="sxs-lookup"><span data-stu-id="3c44a-407">Data and Web subnets can be protected through network security groups the coverage of which is out of scope for this article.</span></span>  

<span data-ttu-id="3c44a-408">**2. lépés: Kiépítése virtuális gépek** a korábban létrehozott rendszerkép használatával, rendszer a következő virtuális gépek létrehozása a felhő kiszolgálón "hk-c-svc-nyugati" és a megfelelő alhálózatokban alább látható módon köthető:</span><span class="sxs-lookup"><span data-stu-id="3c44a-408">**Step 2: Provision Virtual Machines** Using the image created previously, we will create the following virtual machines in the cloud server “hk-c-svc-west” and bind them to the respective subnets as shown below:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-409">Számítógép neve</span><span class="sxs-lookup"><span data-stu-id="3c44a-409">Machine Name</span></span>    </th><th><span data-ttu-id="3c44a-410">Alhálózat</span><span class="sxs-lookup"><span data-stu-id="3c44a-410">Subnet</span></span>    </th><th><span data-ttu-id="3c44a-411">IP-cím</span><span class="sxs-lookup"><span data-stu-id="3c44a-411">IP Address</span></span>    </th><th><span data-ttu-id="3c44a-412">Rendelkezésre állási csoport</span><span class="sxs-lookup"><span data-stu-id="3c44a-412">Availability set</span></span></th><th><span data-ttu-id="3c44a-413">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="3c44a-413">DC/Rack</span></span></th><th><span data-ttu-id="3c44a-414">Kezdőérték?</span><span class="sxs-lookup"><span data-stu-id="3c44a-414">Seed?</span></span></th></tr>
<tr><td><span data-ttu-id="3c44a-415">HK-c1-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-415">hk-c1-west-us</span></span>    </td><td><span data-ttu-id="3c44a-416">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-416">data</span></span>    </td><td><span data-ttu-id="3c44a-417">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="3c44a-417">10.1.2.4</span></span>    </td><td><span data-ttu-id="3c44a-418">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-418">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="3c44a-419">DC = WESTUS állvány = rack1</span><span class="sxs-lookup"><span data-stu-id="3c44a-419">dc =WESTUS rack =rack1</span></span> </td><td><span data-ttu-id="3c44a-420">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-420">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-421">HK-c2-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-421">hk-c2-west-us</span></span>    </td><td><span data-ttu-id="3c44a-422">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-422">data</span></span>    </td><td><span data-ttu-id="3c44a-423">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="3c44a-423">10.1.2.5</span></span>    </td><td><span data-ttu-id="3c44a-424">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-424">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="3c44a-425">DC = WESTUS állvány = rack1</span><span class="sxs-lookup"><span data-stu-id="3c44a-425">dc =WESTUS rack =rack1</span></span>    </td><td><span data-ttu-id="3c44a-426">Nem</span><span class="sxs-lookup"><span data-stu-id="3c44a-426">No</span></span> </td></tr>
<tr><td><span data-ttu-id="3c44a-427">HK-c3-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-427">hk-c3-west-us</span></span>    </td><td><span data-ttu-id="3c44a-428">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-428">data</span></span>    </td><td><span data-ttu-id="3c44a-429">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="3c44a-429">10.1.2.6</span></span>    </td><td><span data-ttu-id="3c44a-430">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-430">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="3c44a-431">DC = WESTUS állvány = rack2</span><span class="sxs-lookup"><span data-stu-id="3c44a-431">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="3c44a-432">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-432">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-433">HK-c4-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-433">hk-c4-west-us</span></span>    </td><td><span data-ttu-id="3c44a-434">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-434">data</span></span>    </td><td><span data-ttu-id="3c44a-435">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="3c44a-435">10.1.2.7</span></span>    </td><td><span data-ttu-id="3c44a-436">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-436">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="3c44a-437">DC = WESTUS állvány = rack2</span><span class="sxs-lookup"><span data-stu-id="3c44a-437">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="3c44a-438">Nem</span><span class="sxs-lookup"><span data-stu-id="3c44a-438">No</span></span> </td></tr>
<tr><td><span data-ttu-id="3c44a-439">HK-c5-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-439">hk-c5-west-us</span></span>    </td><td><span data-ttu-id="3c44a-440">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-440">data</span></span>    </td><td><span data-ttu-id="3c44a-441">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="3c44a-441">10.1.2.8</span></span>    </td><td><span data-ttu-id="3c44a-442">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-442">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="3c44a-443">DC = WESTUS állvány = rack3</span><span class="sxs-lookup"><span data-stu-id="3c44a-443">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="3c44a-444">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-444">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-445">HK-c6-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-445">hk-c6-west-us</span></span>    </td><td><span data-ttu-id="3c44a-446">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-446">data</span></span>    </td><td><span data-ttu-id="3c44a-447">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="3c44a-447">10.1.2.9</span></span>    </td><td><span data-ttu-id="3c44a-448">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-448">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="3c44a-449">DC = WESTUS állvány = rack3</span><span class="sxs-lookup"><span data-stu-id="3c44a-449">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="3c44a-450">Nem</span><span class="sxs-lookup"><span data-stu-id="3c44a-450">No</span></span> </td></tr>
<tr><td><span data-ttu-id="3c44a-451">HK-c7-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-451">hk-c7-west-us</span></span>    </td><td><span data-ttu-id="3c44a-452">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-452">data</span></span>    </td><td><span data-ttu-id="3c44a-453">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="3c44a-453">10.1.2.10</span></span>    </td><td><span data-ttu-id="3c44a-454">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-454">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="3c44a-455">DC = WESTUS állvány = rack4</span><span class="sxs-lookup"><span data-stu-id="3c44a-455">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="3c44a-456">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-456">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-457">HK-c8-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-457">hk-c8-west-us</span></span>    </td><td><span data-ttu-id="3c44a-458">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-458">data</span></span>    </td><td><span data-ttu-id="3c44a-459">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="3c44a-459">10.1.2.11</span></span>    </td><td><span data-ttu-id="3c44a-460">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-460">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="3c44a-461">DC = WESTUS állvány = rack4</span><span class="sxs-lookup"><span data-stu-id="3c44a-461">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="3c44a-462">Nem</span><span class="sxs-lookup"><span data-stu-id="3c44a-462">No</span></span> </td></tr>
<tr><td><span data-ttu-id="3c44a-463">HK-F1-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-463">hk-w1-west-us</span></span>    </td><td><span data-ttu-id="3c44a-464">webalkalmazás</span><span class="sxs-lookup"><span data-stu-id="3c44a-464">web</span></span>    </td><td><span data-ttu-id="3c44a-465">10.1.1.4</span><span class="sxs-lookup"><span data-stu-id="3c44a-465">10.1.1.4</span></span>    </td><td><span data-ttu-id="3c44a-466">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-466">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="3c44a-467">N/A</span><span class="sxs-lookup"><span data-stu-id="3c44a-467">N/A</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-468">HK-w2-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-468">hk-w2-west-us</span></span>    </td><td><span data-ttu-id="3c44a-469">webalkalmazás</span><span class="sxs-lookup"><span data-stu-id="3c44a-469">web</span></span>    </td><td><span data-ttu-id="3c44a-470">10.1.1.5</span><span class="sxs-lookup"><span data-stu-id="3c44a-470">10.1.1.5</span></span>    </td><td><span data-ttu-id="3c44a-471">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-471">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="3c44a-472">N/A</span><span class="sxs-lookup"><span data-stu-id="3c44a-472">N/A</span></span></td></tr>
</table>

<span data-ttu-id="3c44a-473">A fenti listában található virtuális gépek létrehozásához a következő folyamat van szükség:</span><span class="sxs-lookup"><span data-stu-id="3c44a-473">Creation of the above list of VMs requires the following process:</span></span>

1. <span data-ttu-id="3c44a-474">Az adott üres felhőalapú szolgáltatás létrehozása</span><span class="sxs-lookup"><span data-stu-id="3c44a-474">Create an empty cloud service in a particular region</span></span>
2. <span data-ttu-id="3c44a-475">Hozzon létre egy virtuális Gépet a korábban rögzített lemezképből, és csatlakoztassa a virtuális hálózat létrehozása korábban; Ismételje meg ezt a virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="3c44a-475">Create a VM from the previously captured image and attach it to the virtual network created previously; repeat this for all the VMs</span></span>
3. <span data-ttu-id="3c44a-476">A belső terheléselosztók hozzáadása a felhőalapú szolgáltatás, és a "data" alhálózati csatlakoztatása</span><span class="sxs-lookup"><span data-stu-id="3c44a-476">Add an internal load balancer to the cloud service and attach it to the “data” subnet</span></span>
4. <span data-ttu-id="3c44a-477">A korábban létrehozott virtuális gépek hozzáadása egy elosztott terhelésű végpont keresztül csatlakozik a korábban létrehozott belső terheléselosztóhoz elosztott terhelésű készlet thrift-forgalom</span><span class="sxs-lookup"><span data-stu-id="3c44a-477">For each VM created previously, add a load balanced endpoint for thrift traffic through a load balanced set connected to the previously created internal load balancer</span></span>

<span data-ttu-id="3c44a-478">A fenti folyamatot használja a klasszikus Azure portálon; hajtható végre egy Windows-számítógép (használja a virtuális gép Azure, ha nem rendelkezik hozzáféréssel a Windows-számítógép), használja a következő PowerShell-parancsfájl segítségével minden 8 virtuális gépek automatikus kiépítéséhez.</span><span class="sxs-lookup"><span data-stu-id="3c44a-478">The above process can be executed using Azure classic portal; use a Windows machine (use a VM on Azure if you don't have access to a Windows machine), use the following PowerShell script to provision all 8 VMs automatically.</span></span>

<span data-ttu-id="3c44a-479">**Lista 1: Virtuális gépek rendszerbe állításához PowerShell-parancsfájl**</span><span class="sxs-lookup"><span data-stu-id="3c44a-479">**List 1: PowerShell script for provisioning virtual machines**</span></span>

        #Tested with Azure Powershell - November 2014
        #This powershell script deployes a number of VMs from an existing image inside an Azure region
        #Import your Azure subscription into the current Powershell session before proceeding
        #The process: 1. create Azure Storage account, 2. create virtual network, 3.create the VM template, 2. crate a list of VMs from the template

        #fundamental variables - change these to reflect your subscription
        $country="us"; $region="west"; $vnetName = "your_vnet_name";$storageAccount="your_storage_account"
        $numVMs=8;$prefix = "hk-cass";$ilbIP="your_ilb_ip"
        $subscriptionName = "Azure_subscription_name";
        $vmSize="ExtraSmall"; $imageName="your_linux_image_name"
        $ilbName="ThriftInternalLB"; $thriftEndPoint="ThriftEndPoint"

        #generated variables
        $serviceName = "$prefix-svc-$region-$country"; $azureRegion = "$region $country"

        $vmNames = @()
        for ($i=0; $i -lt $numVMs; $i++)
        {
           $vmNames+=("$prefix-vm"+($i+1) + "-$region-$country" );
        }

        #select an Azure subscription already imported into Powershell session
        Select-AzureSubscription -SubscriptionName $subscriptionName -Current
        Set-AzureSubscription -SubscriptionName $subscriptionName -CurrentStorageAccountName $storageAccount

        #create an empty cloud service
        New-AzureService -ServiceName $serviceName -Label "hkcass$region" -Location $azureRegion
        Write-Host "Created $serviceName"

        $VMList= @()   # stores the list of azure vm configuration objects
        #create the list of VMs
        foreach($vmName in $vmNames)
        {
           $VMList += New-AzureVMConfig -Name $vmName -InstanceSize ExtraSmall -ImageName $imageName |
           Add-AzureProvisioningConfig -Linux -LinuxUser "localadmin" -Password "Local123" |
           Set-AzureSubnet "data"
        }

        New-AzureVM -ServiceName $serviceName -VNetName $vnetName -VMs $VMList

        #Create internal load balancer
        Add-AzureInternalLoadBalancer -ServiceName $serviceName -InternalLoadBalancerName $ilbName -SubnetName "data" -StaticVNetIPAddress "$ilbIP"
        Write-Host "Created $ilbName"
        #Add add the thrift endpoint to the internal load balancer for all the VMs
        foreach($vmName in $vmNames)
        {
            Get-AzureVM -ServiceName $serviceName -Name $vmName |
                Add-AzureEndpoint -Name $thriftEndPoint -LBSetName "ThriftLBSet" -Protocol tcp -LocalPort 9160 -PublicPort 9160 -ProbePort 9160 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 -InternalLoadBalancerName $ilbName |
                Update-AzureVM

            Write-Host "created $vmName"     
        }

<span data-ttu-id="3c44a-480">**3. lépés: Cassandra konfigurálása az egyes virtuális gépek**</span><span class="sxs-lookup"><span data-stu-id="3c44a-480">**Step 3: Configure Cassandra on each VM**</span></span>

<span data-ttu-id="3c44a-481">Jelentkezzen be a virtuális Gépet, és hajtsa végre a következő:</span><span class="sxs-lookup"><span data-stu-id="3c44a-481">Log into the VM and perform the following:</span></span>

* <span data-ttu-id="3c44a-482">A data center és állvány tulajdonságainak $CASS_HOME/conf/cassandra-rackdc.properties szerkesztése:</span><span class="sxs-lookup"><span data-stu-id="3c44a-482">Edit $CASS_HOME/conf/cassandra-rackdc.properties to specify the data center and rack properties:</span></span>
  
       dc =EASTUS, rack =rack1
* <span data-ttu-id="3c44a-483">Kezdőérték csomópontok beállítása az alábbi cassandra.yaml szerkesztése:</span><span class="sxs-lookup"><span data-stu-id="3c44a-483">Edit cassandra.yaml to configure seed nodes as below:</span></span>
  
       Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10"

<span data-ttu-id="3c44a-484">**4. lépés: Indítsa el a virtuális gépek és a fürt tesztelése**</span><span class="sxs-lookup"><span data-stu-id="3c44a-484">**Step 4: Start the VMs and test the cluster**</span></span>

<span data-ttu-id="3c44a-485">Jelentkezzen be az egyik csomóponton (pl. hk-c1-nyugati-us), és a fürt állapotának megtekintéséhez a következő parancsot:</span><span class="sxs-lookup"><span data-stu-id="3c44a-485">Log into one of the nodes (e.g. hk-c1-west-us) and run the following command to see the status of the cluster:</span></span>

       nodetool –h 10.1.2.4 –p 7199 status

<span data-ttu-id="3c44a-486">A képernyőt a hasonló alatt a 8 csomópontos fürtök kell megjelennie:</span><span class="sxs-lookup"><span data-stu-id="3c44a-486">You should see the display similar to the one below for an 8-node cluster:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-487">status</span><span class="sxs-lookup"><span data-stu-id="3c44a-487">Status</span></span></th><th><span data-ttu-id="3c44a-488">Cím</span><span class="sxs-lookup"><span data-stu-id="3c44a-488">Address</span></span>    </th><th><span data-ttu-id="3c44a-489">Betöltés</span><span class="sxs-lookup"><span data-stu-id="3c44a-489">Load</span></span>    </th><th><span data-ttu-id="3c44a-490">Tokenek</span><span class="sxs-lookup"><span data-stu-id="3c44a-490">Tokens</span></span>    </th><th><span data-ttu-id="3c44a-491">Tulajdonos</span><span class="sxs-lookup"><span data-stu-id="3c44a-491">Owns</span></span> </th><th><span data-ttu-id="3c44a-492">Állomás azonosítója</span><span class="sxs-lookup"><span data-stu-id="3c44a-492">Host ID</span></span>    </th><th><span data-ttu-id="3c44a-493">Állvány</span><span class="sxs-lookup"><span data-stu-id="3c44a-493">Rack</span></span></th></tr>
<tr><th><span data-ttu-id="3c44a-494">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-494">UN</span></span>    </td><td><span data-ttu-id="3c44a-495">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="3c44a-495">10.1.2.4</span></span>     </td><td><span data-ttu-id="3c44a-496">87.81 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-496">87.81 KB</span></span>    </td><td><span data-ttu-id="3c44a-497">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-497">256</span></span>    </td><td><span data-ttu-id="3c44a-498">38.0%</span><span class="sxs-lookup"><span data-stu-id="3c44a-498">38.0%</span></span>    </td><td><span data-ttu-id="3c44a-499">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-499">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-500">rack1</span><span class="sxs-lookup"><span data-stu-id="3c44a-500">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="3c44a-501">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-501">UN</span></span>    </td><td><span data-ttu-id="3c44a-502">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="3c44a-502">10.1.2.5</span></span>     </td><td><span data-ttu-id="3c44a-503">41.08 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-503">41.08 KB</span></span>    </td><td><span data-ttu-id="3c44a-504">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-504">256</span></span>    </td><td><span data-ttu-id="3c44a-505">68.9%</span><span class="sxs-lookup"><span data-stu-id="3c44a-505">68.9%</span></span>    </td><td><span data-ttu-id="3c44a-506">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-506">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-507">rack1</span><span class="sxs-lookup"><span data-stu-id="3c44a-507">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="3c44a-508">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-508">UN</span></span>    </td><td><span data-ttu-id="3c44a-509">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="3c44a-509">10.1.2.6</span></span>     </td><td><span data-ttu-id="3c44a-510">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-510">55.29 KB</span></span>    </td><td><span data-ttu-id="3c44a-511">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-511">256</span></span>    </td><td><span data-ttu-id="3c44a-512">68.8%</span><span class="sxs-lookup"><span data-stu-id="3c44a-512">68.8%</span></span>    </td><td><span data-ttu-id="3c44a-513">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-513">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-514">rack2</span><span class="sxs-lookup"><span data-stu-id="3c44a-514">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="3c44a-515">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-515">UN</span></span>    </td><td><span data-ttu-id="3c44a-516">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="3c44a-516">10.1.2.7</span></span>     </td><td><span data-ttu-id="3c44a-517">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-517">55.29 KB</span></span>    </td><td><span data-ttu-id="3c44a-518">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-518">256</span></span>    </td><td><span data-ttu-id="3c44a-519">68.8%</span><span class="sxs-lookup"><span data-stu-id="3c44a-519">68.8%</span></span>    </td><td><span data-ttu-id="3c44a-520">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-520">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-521">rack2</span><span class="sxs-lookup"><span data-stu-id="3c44a-521">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="3c44a-522">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-522">UN</span></span>    </td><td><span data-ttu-id="3c44a-523">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="3c44a-523">10.1.2.8</span></span>     </td><td><span data-ttu-id="3c44a-524">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-524">55.29 KB</span></span>    </td><td><span data-ttu-id="3c44a-525">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-525">256</span></span>    </td><td><span data-ttu-id="3c44a-526">68.8%</span><span class="sxs-lookup"><span data-stu-id="3c44a-526">68.8%</span></span>    </td><td><span data-ttu-id="3c44a-527">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-527">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-528">rack3</span><span class="sxs-lookup"><span data-stu-id="3c44a-528">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="3c44a-529">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-529">UN</span></span>    </td><td><span data-ttu-id="3c44a-530">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="3c44a-530">10.1.2.9</span></span>     </td><td><span data-ttu-id="3c44a-531">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-531">55.29 KB</span></span>    </td><td><span data-ttu-id="3c44a-532">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-532">256</span></span>    </td><td><span data-ttu-id="3c44a-533">68.8%</span><span class="sxs-lookup"><span data-stu-id="3c44a-533">68.8%</span></span>    </td><td><span data-ttu-id="3c44a-534">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-534">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-535">rack3</span><span class="sxs-lookup"><span data-stu-id="3c44a-535">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="3c44a-536">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-536">UN</span></span>    </td><td><span data-ttu-id="3c44a-537">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="3c44a-537">10.1.2.10</span></span>     </td><td><span data-ttu-id="3c44a-538">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-538">55.29 KB</span></span>    </td><td><span data-ttu-id="3c44a-539">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-539">256</span></span>    </td><td><span data-ttu-id="3c44a-540">68.8%</span><span class="sxs-lookup"><span data-stu-id="3c44a-540">68.8%</span></span>    </td><td><span data-ttu-id="3c44a-541">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-541">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-542">rack4</span><span class="sxs-lookup"><span data-stu-id="3c44a-542">rack4</span></span></td></tr>
<tr><th><span data-ttu-id="3c44a-543">VISSZAVONÁSA</span><span class="sxs-lookup"><span data-stu-id="3c44a-543">UN</span></span>    </td><td><span data-ttu-id="3c44a-544">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="3c44a-544">10.1.2.11</span></span>     </td><td><span data-ttu-id="3c44a-545">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="3c44a-545">55.29 KB</span></span>    </td><td><span data-ttu-id="3c44a-546">256</span><span class="sxs-lookup"><span data-stu-id="3c44a-546">256</span></span>    </td><td><span data-ttu-id="3c44a-547">68.8%</span><span class="sxs-lookup"><span data-stu-id="3c44a-547">68.8%</span></span>    </td><td><span data-ttu-id="3c44a-548">GUID (eltávolítani)</span><span class="sxs-lookup"><span data-stu-id="3c44a-548">Guid (removed)</span></span></td><td><span data-ttu-id="3c44a-549">rack4</span><span class="sxs-lookup"><span data-stu-id="3c44a-549">rack4</span></span></td></tr>
</table>

## <a name="test-the-single-region-cluster"></a><span data-ttu-id="3c44a-550">Az egyetlen régión fürt tesztelése</span><span class="sxs-lookup"><span data-stu-id="3c44a-550">Test the Single Region Cluster</span></span>
<span data-ttu-id="3c44a-551">A fürt ellenőrzéséhez tegye a következőket:</span><span class="sxs-lookup"><span data-stu-id="3c44a-551">Use the following steps to test the cluster:</span></span>

1. <span data-ttu-id="3c44a-552">(Pl. a Powershell-parancs Get-AzureInternalLoadbalancer parancsmag segítségével használja, szerezze be a belső terheléselosztó IP-címe  10.1.2.101).</span><span class="sxs-lookup"><span data-stu-id="3c44a-552">Using the Powershell command Get-AzureInternalLoadbalancer commandlet, obtain the IP address of the internal load balancer (e.g.  10.1.2.101).</span></span> <span data-ttu-id="3c44a-553">A parancs szintaxisa alább látható: Get-AzureLoadbalancer – szolgáltatásnév "hk-c-svc-nyugati-us" [megjeleníti a részletek a belső terheléselosztó mellett az IP-címe]</span><span class="sxs-lookup"><span data-stu-id="3c44a-553">The syntax of the command is shown below: Get-AzureLoadbalancer –ServiceName "hk-c-svc-west-us” [displays the details of the internal load balancer along with its IP address]</span></span>
2. <span data-ttu-id="3c44a-554">Jelentkezzen be a virtuális gép (pl. hk-F1-nyugati-us) webfarm a Putty használatával vagy ssh</span><span class="sxs-lookup"><span data-stu-id="3c44a-554">Log into the web farm VM (e.g. hk-w1-west-us) using Putty or ssh</span></span>
3. <span data-ttu-id="3c44a-555">Végrehajtás $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="3c44a-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
4. <span data-ttu-id="3c44a-556">A következő CQL parancsokkal ellenőrizheti, hogy működik-e a fürt:</span><span class="sxs-lookup"><span data-stu-id="3c44a-556">Use the following CQL commands to verify if the cluster is working:</span></span>
   
     <span data-ttu-id="3c44a-557">Kulcstérértesítések használatával hozzon létre customers_ks rendelkező replikációs = {"class": "SimpleStrategy", "replication_factor": 3};   HASZNÁLJA a customers_ks;   Hozzon létre a tábla Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Helyezze be a Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Helyezze be a Customers(customer_id, firstname, lastname) értékek (2, "Jane", "Doe").</span><span class="sxs-lookup"><span data-stu-id="3c44a-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span></span>
   
     <span data-ttu-id="3c44a-558">Válassza ki * ügyfelek;</span><span class="sxs-lookup"><span data-stu-id="3c44a-558">SELECT * FROM Customers;</span></span>

<span data-ttu-id="3c44a-559">Például az alábbi megjelenítésre kell megjelennie:</span><span class="sxs-lookup"><span data-stu-id="3c44a-559">You should see a display like the one below:</span></span>

<table>
  <tr><th> <span data-ttu-id="3c44a-560">customer_id</span><span class="sxs-lookup"><span data-stu-id="3c44a-560">customer_id</span></span> </th><th> <span data-ttu-id="3c44a-561">Utónév</span><span class="sxs-lookup"><span data-stu-id="3c44a-561">firstname</span></span> </th><th> <span data-ttu-id="3c44a-562">Vezetéknév</span><span class="sxs-lookup"><span data-stu-id="3c44a-562">lastname</span></span> </th></tr>
  <tr><td> <span data-ttu-id="3c44a-563">1</span><span class="sxs-lookup"><span data-stu-id="3c44a-563">1</span></span> </td><td> <span data-ttu-id="3c44a-564">John</span><span class="sxs-lookup"><span data-stu-id="3c44a-564">John</span></span> </td><td> <span data-ttu-id="3c44a-565">DOE</span><span class="sxs-lookup"><span data-stu-id="3c44a-565">Doe</span></span> </td></tr>
  <tr><td> <span data-ttu-id="3c44a-566">2</span><span class="sxs-lookup"><span data-stu-id="3c44a-566">2</span></span> </td><td> <span data-ttu-id="3c44a-567">Jane</span><span class="sxs-lookup"><span data-stu-id="3c44a-567">Jane</span></span> </td><td> <span data-ttu-id="3c44a-568">DOE</span><span class="sxs-lookup"><span data-stu-id="3c44a-568">Doe</span></span> </td></tr>
</table>

<span data-ttu-id="3c44a-569">Vegye figyelembe, hogy a 4. lépésében létrehozott kulcstérértesítések használatával egy replication_factor 3 SimpleStrategy használ.</span><span class="sxs-lookup"><span data-stu-id="3c44a-569">Please note that the keyspace created in step 4 uses SimpleStrategy with a  replication_factor of 3.</span></span> <span data-ttu-id="3c44a-570">SimpleStrategy ajánlott egyetlen data center központi telepítések mivel több adatok NetworkTopologyStrategy center központi telepítések.</span><span class="sxs-lookup"><span data-stu-id="3c44a-570">SimpleStrategy is recommended for single data center deployments whereas NetworkTopologyStrategy for multi-data center deployments.</span></span> <span data-ttu-id="3c44a-571">A / 3 replication_factor csomópont hibák tolerancia rendszerében.</span><span class="sxs-lookup"><span data-stu-id="3c44a-571">A replication_factor of 3 will give tolerance for node failures.</span></span>

## <span data-ttu-id="3c44a-572"><a id="tworegion"></a>Több területi telepítési folyamata</span><span class="sxs-lookup"><span data-stu-id="3c44a-572"><a id="tworegion"> </a>Multi-Region Deployment Process</span></span>
<span data-ttu-id="3c44a-573">A rendszer használja ki a egyetlen régión telepítése befejeződött, és ugyanezt az eljárást ismételje meg a második régió telepítése.</span><span class="sxs-lookup"><span data-stu-id="3c44a-573">Will leverage the single region deployment completed and repeat the same process for installing the second region.</span></span> <span data-ttu-id="3c44a-574">Az egyetlen és több régió telepítési közötti fő különbség a VPN-alagút beállítást régió közti kommunikációhoz; rendszer a hálózati telepítéssel, a virtuális gépek telepítéséhez és konfigurálásához Cassandra.</span><span class="sxs-lookup"><span data-stu-id="3c44a-574">The key difference between the single and multiple region deployment is the VPN tunnel setup for inter-region communication; we will start with the network installation, provision the VMs and configure Cassandra.</span></span>

### <a name="step-1-create-the-virtual-network-at-the-2nd-region"></a><span data-ttu-id="3c44a-575">1. lépés: A virtuális hálózat létrehozása a 2. terület:</span><span class="sxs-lookup"><span data-stu-id="3c44a-575">Step 1: Create the Virtual Network at the 2nd Region</span></span>
<span data-ttu-id="3c44a-576">Jelentkezzen be a klasszikus Azure portálra, és hozzon létre egy virtuális hálózatot az attribútumok megjelenítése a táblában.</span><span class="sxs-lookup"><span data-stu-id="3c44a-576">Log into the Azure classic portal and create a Virtual Network with the attributes show in the table.</span></span> <span data-ttu-id="3c44a-577">Lásd: [Cloud-Only virtuális hálózat konfigurálása a klasszikus Azure portálon](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) a részletes lépéseket a folyamat.</span><span class="sxs-lookup"><span data-stu-id="3c44a-577">See [Configure a Cloud-Only Virtual Network in the Azure classic portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of the process.</span></span>      

<table>
<tr><th><span data-ttu-id="3c44a-578">Attribútum neve</span><span class="sxs-lookup"><span data-stu-id="3c44a-578">Attribute Name</span></span>    </th><th><span data-ttu-id="3c44a-579">Érték</span><span class="sxs-lookup"><span data-stu-id="3c44a-579">Value</span></span>    </th><th><span data-ttu-id="3c44a-580">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-580">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="3c44a-581">Név</span><span class="sxs-lookup"><span data-stu-id="3c44a-581">Name</span></span>    </td><td><span data-ttu-id="3c44a-582">vnet-esetén-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-582">vnet-cass-east-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="3c44a-583">Régió</span><span class="sxs-lookup"><span data-stu-id="3c44a-583">Region</span></span>    </td><td><span data-ttu-id="3c44a-584">USA keleti régiója</span><span class="sxs-lookup"><span data-stu-id="3c44a-584">East US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="3c44a-585">DNS-kiszolgálók</span><span class="sxs-lookup"><span data-stu-id="3c44a-585">DNS Servers</span></span>        </td><td></td><td><span data-ttu-id="3c44a-586">Figyelmen kívül hagyja ezt a DNS-kiszolgáló nem használjuk</span><span class="sxs-lookup"><span data-stu-id="3c44a-586">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-587">A pont-pont VPN konfigurálása</span><span class="sxs-lookup"><span data-stu-id="3c44a-587">Configure a point-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="3c44a-588">Figyelmen kívül hagyja ezt</span><span class="sxs-lookup"><span data-stu-id="3c44a-588">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-589">Webhelyek közötti virtuális magánhálózat konfigurálása</span><span class="sxs-lookup"><span data-stu-id="3c44a-589">Configure a site-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="3c44a-590">Figyelmen kívül hagyja ezt</span><span class="sxs-lookup"><span data-stu-id="3c44a-590">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-591">Címterület</span><span class="sxs-lookup"><span data-stu-id="3c44a-591">Address Space</span></span>    </td><td><span data-ttu-id="3c44a-592">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="3c44a-592">10.2.0.0/16</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="3c44a-593">Kezdő IP-Címét</span><span class="sxs-lookup"><span data-stu-id="3c44a-593">Starting IP</span></span>    </td><td><span data-ttu-id="3c44a-594">10.2.0.0</span><span class="sxs-lookup"><span data-stu-id="3c44a-594">10.2.0.0</span></span>    </td><td></td></tr>
<tr><td><span data-ttu-id="3c44a-595">CIDR</span><span class="sxs-lookup"><span data-stu-id="3c44a-595">CIDR</span></span>    </td><td><span data-ttu-id="3c44a-596">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="3c44a-596">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="3c44a-597">Adja hozzá a következő alhálózatok:</span><span class="sxs-lookup"><span data-stu-id="3c44a-597">Add the following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-598">Név</span><span class="sxs-lookup"><span data-stu-id="3c44a-598">Name</span></span>    </th><th><span data-ttu-id="3c44a-599">Kezdő IP-Címét</span><span class="sxs-lookup"><span data-stu-id="3c44a-599">Starting IP</span></span>    </th><th><span data-ttu-id="3c44a-600">CIDR</span><span class="sxs-lookup"><span data-stu-id="3c44a-600">CIDR</span></span>    </th><th><span data-ttu-id="3c44a-601">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-601">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="3c44a-602">webalkalmazás</span><span class="sxs-lookup"><span data-stu-id="3c44a-602">web</span></span>    </td><td><span data-ttu-id="3c44a-603">10.2.1.0</span><span class="sxs-lookup"><span data-stu-id="3c44a-603">10.2.1.0</span></span>    </td><td><span data-ttu-id="3c44a-604">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="3c44a-604">/24 (251)</span></span>    </td><td><span data-ttu-id="3c44a-605">A webfarm-alhálózatot</span><span class="sxs-lookup"><span data-stu-id="3c44a-605">Subnet for the web farm</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-606">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-606">data</span></span>    </td><td><span data-ttu-id="3c44a-607">10.2.2.0</span><span class="sxs-lookup"><span data-stu-id="3c44a-607">10.2.2.0</span></span>    </td><td><span data-ttu-id="3c44a-608">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="3c44a-608">/24 (251)</span></span>    </td><td><span data-ttu-id="3c44a-609">Az adatbázis-csomópont-alhálózatot</span><span class="sxs-lookup"><span data-stu-id="3c44a-609">Subnet for the database nodes</span></span></td></tr>
</table>


### <a name="step-2-create-local-networks"></a><span data-ttu-id="3c44a-610">2. lépés: A helyi hálózatok létrehozása</span><span class="sxs-lookup"><span data-stu-id="3c44a-610">Step 2: Create Local Networks</span></span>
<span data-ttu-id="3c44a-611">Az Azure virtuális hálózatban egy helyi hálózaton, egy proxy címtartományt, amely egy magánfelhőbe vagy egy másik Azure-régió, beleértve egy távoli helyre van leképezve.</span><span class="sxs-lookup"><span data-stu-id="3c44a-611">A Local Network in Azure virtual networking is a proxy address space that maps to a remote site including a private cloud or another Azure region.</span></span> <span data-ttu-id="3c44a-612">A proxy címtartomány a megfelelő hálózati helyre egy távoli átjáró útválasztási hálózathoz van kötve.</span><span class="sxs-lookup"><span data-stu-id="3c44a-612">This proxy address space is bound to a remote gateway for routing network to the right networking destinations.</span></span> <span data-ttu-id="3c44a-613">Lásd: [konfigurálása egy VNet és Kapcsolatcsoporttal](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) kapcsolatos utasításokat a VNET – VNET-kapcsolatot létesít.</span><span class="sxs-lookup"><span data-stu-id="3c44a-613">See [Configure a VNet to VNet Connection](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) for the instructions on establishing VNET-to-VNET connection.</span></span>

<span data-ttu-id="3c44a-614">Hozzon létre két helyi hálózatok száma a következő adatokat:</span><span class="sxs-lookup"><span data-stu-id="3c44a-614">Create two local networks per the following details:</span></span>

| <span data-ttu-id="3c44a-615">Hálózati név</span><span class="sxs-lookup"><span data-stu-id="3c44a-615">Network Name</span></span> | <span data-ttu-id="3c44a-616">VPN-átjáró címét</span><span class="sxs-lookup"><span data-stu-id="3c44a-616">VPN Gateway Address</span></span> | <span data-ttu-id="3c44a-617">Címterület</span><span class="sxs-lookup"><span data-stu-id="3c44a-617">Address Space</span></span> | <span data-ttu-id="3c44a-618">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="3c44a-618">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="3c44a-619">HK-lnet-Map-to-East-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-619">hk-lnet-map-to-east-us</span></span> |<span data-ttu-id="3c44a-620">23.1.1.1</span><span class="sxs-lookup"><span data-stu-id="3c44a-620">23.1.1.1</span></span> |<span data-ttu-id="3c44a-621">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="3c44a-621">10.2.0.0/16</span></span> |<span data-ttu-id="3c44a-622">A helyi hálózat létrehozásakor adjon címet az átjáró egy helyőrző.</span><span class="sxs-lookup"><span data-stu-id="3c44a-622">While creating the Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="3c44a-623">Az átjáró létrehozása után a tényleges átjárócím ki van töltve.</span><span class="sxs-lookup"><span data-stu-id="3c44a-623">The real gateway address is filled once the gateway is created.</span></span> <span data-ttu-id="3c44a-624">Győződjön meg arról, hogy a címtartomány pontosan egyezik a megfelelő távoli virtuális hálózat; Ebben az esetben a virtuális hálózat létrehozása az USA keleti régiójában.</span><span class="sxs-lookup"><span data-stu-id="3c44a-624">Make sure the address space exactly matches the respective remote VNET; in this case the VNET created in the East US region.</span></span> |
| <span data-ttu-id="3c44a-625">HK-lnet-Map-to-West-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-625">hk-lnet-map-to-west-us</span></span> |<span data-ttu-id="3c44a-626">23.2.2.2</span><span class="sxs-lookup"><span data-stu-id="3c44a-626">23.2.2.2</span></span> |<span data-ttu-id="3c44a-627">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="3c44a-627">10.1.0.0/16</span></span> |<span data-ttu-id="3c44a-628">A helyi hálózat létrehozásakor adjon címet az átjáró egy helyőrző.</span><span class="sxs-lookup"><span data-stu-id="3c44a-628">While creating the Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="3c44a-629">Az átjáró létrehozása után a tényleges átjárócím ki van töltve.</span><span class="sxs-lookup"><span data-stu-id="3c44a-629">The real gateway address is filled once the gateway is created.</span></span> <span data-ttu-id="3c44a-630">Győződjön meg arról, hogy a címtartomány pontosan egyezik a megfelelő távoli virtuális hálózat; Ebben az esetben a virtuális hálózat az USA nyugati régiója régióban létrehozott.</span><span class="sxs-lookup"><span data-stu-id="3c44a-630">Make sure the address space exactly matches the respective remote VNET; in this case the VNET created in the West US region.</span></span> |

### <a name="step-3-map-local-network-to-the-respective-vnets"></a><span data-ttu-id="3c44a-631">3. lépés: Térkép "Helyi" hálózat a megfelelő Vnetek</span><span class="sxs-lookup"><span data-stu-id="3c44a-631">Step 3: Map “Local” network to the respective VNETs</span></span>
<span data-ttu-id="3c44a-632">A klasszikus Azure portálon minden egyes virtuális hálózat kiválasztása, kattintson a "Beállítása", ellenőrizze a "Csatlakozás a helyi hálózatra", majd a következő adatok egy helyi hálózatok kiválasztása:</span><span class="sxs-lookup"><span data-stu-id="3c44a-632">From the Azure classic portal, select each vnet, click “Configure”, check “Connect to the local network”, and select the Local Networks per the following details:</span></span>

| <span data-ttu-id="3c44a-633">Virtual Network</span><span class="sxs-lookup"><span data-stu-id="3c44a-633">Virtual Network</span></span> | <span data-ttu-id="3c44a-634">Helyi hálózati</span><span class="sxs-lookup"><span data-stu-id="3c44a-634">Local Network</span></span> |
| --- | --- |
| <span data-ttu-id="3c44a-635">HK-vnet-nyugati-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-635">hk-vnet-west-us</span></span> |<span data-ttu-id="3c44a-636">HK-lnet-Map-to-East-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-636">hk-lnet-map-to-east-us</span></span> |
| <span data-ttu-id="3c44a-637">HK-vnet-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-637">hk-vnet-east-us</span></span> |<span data-ttu-id="3c44a-638">HK-lnet-Map-to-West-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-638">hk-lnet-map-to-west-us</span></span> |

### <a name="step-4-create-gateways-on-vnet1-and-vnet2"></a><span data-ttu-id="3c44a-639">4. lépés: A VNET1 és VNET2 átjárók létrehozása</span><span class="sxs-lookup"><span data-stu-id="3c44a-639">Step 4: Create Gateways on VNET1 and VNET2</span></span>
<span data-ttu-id="3c44a-640">A virtuális hálózatok az irányítópultról kattintson a létrehozása ÁTJÁRÓN, amely akkor indul el, a VPN-átjáró létesítésének folyamatát kell használnia.</span><span class="sxs-lookup"><span data-stu-id="3c44a-640">From the dashboard of both the virtual networks, click CREATE GATEWAY which will trigger the VPN gateway provisioning process.</span></span> <span data-ttu-id="3c44a-641">Néhány perc elteltével az irányítópult az összes virtuális hálózat megjelenjen-e a tényleges átjárócímet.</span><span class="sxs-lookup"><span data-stu-id="3c44a-641">After a few minutes the dashboard of each virtual network should display the actual gateway address.</span></span>

### <a name="step-5-update-local-networks-with-the-respective-gateway-addresses"></a><span data-ttu-id="3c44a-642">5. lépés: Frissítés "Helyi" hálózatok a megfelelő "Gateway" címek</span><span class="sxs-lookup"><span data-stu-id="3c44a-642">Step 5: Update “Local” networks with the respective “Gateway” addresses</span></span>
<span data-ttu-id="3c44a-643">Mindkét a helyi hálózat a helyőrző átjáró IP-címet lecseréli az imént telepített átjárók valós IP-címének szerkesztése.</span><span class="sxs-lookup"><span data-stu-id="3c44a-643">Edit both the local networks to replace the placeholder gateway IP address with the real IP address of the just provisioned gateways.</span></span> <span data-ttu-id="3c44a-644">Az alábbi megfeleltetést a használja:</span><span class="sxs-lookup"><span data-stu-id="3c44a-644">Use the following mapping:</span></span>

<table>
<tr><th><span data-ttu-id="3c44a-645">Helyi hálózati</span><span class="sxs-lookup"><span data-stu-id="3c44a-645">Local Network</span></span>    </th><th><span data-ttu-id="3c44a-646">Virtuális hálózati átjáró</span><span class="sxs-lookup"><span data-stu-id="3c44a-646">Virtual Network Gateway</span></span></th></tr>
<tr><td><span data-ttu-id="3c44a-647">HK-lnet-Map-to-East-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-647">hk-lnet-map-to-east-us</span></span> </td><td><span data-ttu-id="3c44a-648">A hk-vnet-nyugati-us átjáró</span><span class="sxs-lookup"><span data-stu-id="3c44a-648">Gateway of hk-vnet-west-us</span></span></td></tr>
<tr><td><span data-ttu-id="3c44a-649">HK-lnet-Map-to-West-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-649">hk-lnet-map-to-west-us</span></span> </td><td><span data-ttu-id="3c44a-650">A hk-vnet-keleti-us átjáró</span><span class="sxs-lookup"><span data-stu-id="3c44a-650">Gateway of hk-vnet-east-us</span></span></td></tr>
</table>

### <a name="step-6-update-the-shared-key"></a><span data-ttu-id="3c44a-651">6. lépés: A megosztott kulcs frissítése</span><span class="sxs-lookup"><span data-stu-id="3c44a-651">Step 6: Update the shared key</span></span>
<span data-ttu-id="3c44a-652">A következő Powershell-parancsfájl segítségével frissíteni az IPSec-kulcsot minden egyes VPN-átjáró [használatát mindkét átjáró szakét kulcsa]: Set-AzureVNetGatewayKey - VNetName hk-vnet-keleti-us - LocalNetworkSiteName hk-lnet-map-to-west-us - SharedKey D9E76BKK Set-AzureVNetGatewayKey - VNetName hk-vnet-nyugati-us - LocalNetworkSiteName hk-lnet-map-to-east-us - SharedKey D9E76BKK</span><span class="sxs-lookup"><span data-stu-id="3c44a-652">Use the following Powershell script to update the IPSec key of each VPN gateway [use the sake key for both the gateways]: Set-AzureVNetGatewayKey -VNetName hk-vnet-east-us -LocalNetworkSiteName hk-lnet-map-to-west-us -SharedKey D9E76BKK Set-AzureVNetGatewayKey -VNetName hk-vnet-west-us -LocalNetworkSiteName hk-lnet-map-to-east-us -SharedKey D9E76BKK</span></span>

### <a name="step-7-establish-the-vnet-to-vnet-connection"></a><span data-ttu-id="3c44a-653">7. lépés: A VNET – VNET-kapcsolatot létrehozni.</span><span class="sxs-lookup"><span data-stu-id="3c44a-653">Step 7: Establish the VNET-to-VNET connection</span></span>
<span data-ttu-id="3c44a-654">A klasszikus Azure portálon az "IRÁNYÍTÓPULT" menü, mind a virtuális hálózatok használatával átjárók közötti kapcsolat létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="3c44a-654">From the Azure classic portal, use the “DASHBOARD” menu of both the virtual networks to establish gateway-to-gateway connection.</span></span> <span data-ttu-id="3c44a-655">Az alsó eszköztár használja a "Csatlakozás" menü menüpontjai.</span><span class="sxs-lookup"><span data-stu-id="3c44a-655">Use the “CONNECT” menu items in the bottom toolbar.</span></span> <span data-ttu-id="3c44a-656">Néhány perc elteltével az irányítópult megjelenjen-e a kapcsolat adatai grafikusan.</span><span class="sxs-lookup"><span data-stu-id="3c44a-656">After a few minutes the dashboard should display the connection details graphically.</span></span>

### <a name="step-8-create-the-virtual-machines-in-region-2"></a><span data-ttu-id="3c44a-657">8. lépés: A virtuális gépek létrehozása régióban #2</span><span class="sxs-lookup"><span data-stu-id="3c44a-657">Step 8: Create the virtual machines in region #2</span></span>
<span data-ttu-id="3c44a-658">Ubuntu lemezkép létrehozásához a következő ugyanazokat a lépéseket vagy másolása a kép VHD-fájlt az Azure storage-fiók a #2 régióban található #1 régió telepítési leírtak szerint, és a lemezkép létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="3c44a-658">Create the Ubuntu image as described in region #1 deployment by following the same steps or copy the image VHD file to the Azure storage account located in region #2 and create the image.</span></span> <span data-ttu-id="3c44a-659">Ezzel a lemezképpel, és hozzon létre az alábbi listán szereplő virtuális gépeket az új felhőalapú szolgáltatás hk-c-svc-keleti-us:</span><span class="sxs-lookup"><span data-stu-id="3c44a-659">Use this image and create the following list of virtual machines into a new cloud service hk-c-svc-east-us:</span></span>

| <span data-ttu-id="3c44a-660">Számítógép neve</span><span class="sxs-lookup"><span data-stu-id="3c44a-660">Machine Name</span></span> | <span data-ttu-id="3c44a-661">Alhálózat</span><span class="sxs-lookup"><span data-stu-id="3c44a-661">Subnet</span></span> | <span data-ttu-id="3c44a-662">IP-cím</span><span class="sxs-lookup"><span data-stu-id="3c44a-662">IP Address</span></span> | <span data-ttu-id="3c44a-663">Rendelkezésre állási csoport</span><span class="sxs-lookup"><span data-stu-id="3c44a-663">Availability set</span></span> | <span data-ttu-id="3c44a-664">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="3c44a-664">DC/Rack</span></span> | <span data-ttu-id="3c44a-665">Kezdőérték?</span><span class="sxs-lookup"><span data-stu-id="3c44a-665">Seed?</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="3c44a-666">HK-c1-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-666">hk-c1-east-us</span></span> |<span data-ttu-id="3c44a-667">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-667">data</span></span> |<span data-ttu-id="3c44a-668">10.2.2.4</span><span class="sxs-lookup"><span data-stu-id="3c44a-668">10.2.2.4</span></span> |<span data-ttu-id="3c44a-669">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-669">hk-c-aset-1</span></span> |<span data-ttu-id="3c44a-670">DC = EASTUS állvány = rack1</span><span class="sxs-lookup"><span data-stu-id="3c44a-670">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="3c44a-671">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-671">Yes</span></span> |
| <span data-ttu-id="3c44a-672">HK-c2-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-672">hk-c2-east-us</span></span> |<span data-ttu-id="3c44a-673">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-673">data</span></span> |<span data-ttu-id="3c44a-674">10.2.2.5</span><span class="sxs-lookup"><span data-stu-id="3c44a-674">10.2.2.5</span></span> |<span data-ttu-id="3c44a-675">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-675">hk-c-aset-1</span></span> |<span data-ttu-id="3c44a-676">DC = EASTUS állvány = rack1</span><span class="sxs-lookup"><span data-stu-id="3c44a-676">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="3c44a-677">Nem</span><span class="sxs-lookup"><span data-stu-id="3c44a-677">No</span></span> |
| <span data-ttu-id="3c44a-678">HK-c3-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-678">hk-c3-east-us</span></span> |<span data-ttu-id="3c44a-679">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-679">data</span></span> |<span data-ttu-id="3c44a-680">10.2.2.6</span><span class="sxs-lookup"><span data-stu-id="3c44a-680">10.2.2.6</span></span> |<span data-ttu-id="3c44a-681">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-681">hk-c-aset-1</span></span> |<span data-ttu-id="3c44a-682">DC = EASTUS állvány = rack2</span><span class="sxs-lookup"><span data-stu-id="3c44a-682">dc =EASTUS rack =rack2</span></span> |<span data-ttu-id="3c44a-683">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-683">Yes</span></span> |
| <span data-ttu-id="3c44a-684">HK-c5-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-684">hk-c5-east-us</span></span> |<span data-ttu-id="3c44a-685">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-685">data</span></span> |<span data-ttu-id="3c44a-686">10.2.2.8</span><span class="sxs-lookup"><span data-stu-id="3c44a-686">10.2.2.8</span></span> |<span data-ttu-id="3c44a-687">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-687">hk-c-aset-2</span></span> |<span data-ttu-id="3c44a-688">DC = EASTUS állvány = rack3</span><span class="sxs-lookup"><span data-stu-id="3c44a-688">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="3c44a-689">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-689">Yes</span></span> |
| <span data-ttu-id="3c44a-690">HK-c6-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-690">hk-c6-east-us</span></span> |<span data-ttu-id="3c44a-691">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-691">data</span></span> |<span data-ttu-id="3c44a-692">10.2.2.9</span><span class="sxs-lookup"><span data-stu-id="3c44a-692">10.2.2.9</span></span> |<span data-ttu-id="3c44a-693">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-693">hk-c-aset-2</span></span> |<span data-ttu-id="3c44a-694">DC = EASTUS állvány = rack3</span><span class="sxs-lookup"><span data-stu-id="3c44a-694">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="3c44a-695">Nem</span><span class="sxs-lookup"><span data-stu-id="3c44a-695">No</span></span> |
| <span data-ttu-id="3c44a-696">HK-c7-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-696">hk-c7-east-us</span></span> |<span data-ttu-id="3c44a-697">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-697">data</span></span> |<span data-ttu-id="3c44a-698">10.2.2.10</span><span class="sxs-lookup"><span data-stu-id="3c44a-698">10.2.2.10</span></span> |<span data-ttu-id="3c44a-699">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-699">hk-c-aset-2</span></span> |<span data-ttu-id="3c44a-700">DC = EASTUS állvány = rack4</span><span class="sxs-lookup"><span data-stu-id="3c44a-700">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="3c44a-701">Igen</span><span class="sxs-lookup"><span data-stu-id="3c44a-701">Yes</span></span> |
| <span data-ttu-id="3c44a-702">HK-c8-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-702">hk-c8-east-us</span></span> |<span data-ttu-id="3c44a-703">Adatok</span><span class="sxs-lookup"><span data-stu-id="3c44a-703">data</span></span> |<span data-ttu-id="3c44a-704">10.2.2.11</span><span class="sxs-lookup"><span data-stu-id="3c44a-704">10.2.2.11</span></span> |<span data-ttu-id="3c44a-705">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="3c44a-705">hk-c-aset-2</span></span> |<span data-ttu-id="3c44a-706">DC = EASTUS állvány = rack4</span><span class="sxs-lookup"><span data-stu-id="3c44a-706">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="3c44a-707">Nem</span><span class="sxs-lookup"><span data-stu-id="3c44a-707">No</span></span> |
| <span data-ttu-id="3c44a-708">HK-F1-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-708">hk-w1-east-us</span></span> |<span data-ttu-id="3c44a-709">webalkalmazás</span><span class="sxs-lookup"><span data-stu-id="3c44a-709">web</span></span> |<span data-ttu-id="3c44a-710">10.2.1.4</span><span class="sxs-lookup"><span data-stu-id="3c44a-710">10.2.1.4</span></span> |<span data-ttu-id="3c44a-711">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-711">hk-w-aset-1</span></span> |<span data-ttu-id="3c44a-712">N/A</span><span class="sxs-lookup"><span data-stu-id="3c44a-712">N/A</span></span> |<span data-ttu-id="3c44a-713">N/A</span><span class="sxs-lookup"><span data-stu-id="3c44a-713">N/A</span></span> |
| <span data-ttu-id="3c44a-714">HK-w2-keleti-us</span><span class="sxs-lookup"><span data-stu-id="3c44a-714">hk-w2-east-us</span></span> |<span data-ttu-id="3c44a-715">webalkalmazás</span><span class="sxs-lookup"><span data-stu-id="3c44a-715">web</span></span> |<span data-ttu-id="3c44a-716">10.2.1.5</span><span class="sxs-lookup"><span data-stu-id="3c44a-716">10.2.1.5</span></span> |<span data-ttu-id="3c44a-717">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="3c44a-717">hk-w-aset-1</span></span> |<span data-ttu-id="3c44a-718">N/A</span><span class="sxs-lookup"><span data-stu-id="3c44a-718">N/A</span></span> |<span data-ttu-id="3c44a-719">N/A</span><span class="sxs-lookup"><span data-stu-id="3c44a-719">N/A</span></span> |

<span data-ttu-id="3c44a-720">Ugyanezeket az utasításokat, mint #1 régió, de 10.2.xxx.xxx címterület használata.</span><span class="sxs-lookup"><span data-stu-id="3c44a-720">Follow the same instructions as region #1 but use 10.2.xxx.xxx address space.</span></span>

### <a name="step-9-configure-cassandra-on-each-vm"></a><span data-ttu-id="3c44a-721">9. lépés: Cassandra konfigurálása az egyes virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="3c44a-721">Step 9: Configure Cassandra on each VM</span></span>
<span data-ttu-id="3c44a-722">Jelentkezzen be a virtuális Gépet, és hajtsa végre a következő:</span><span class="sxs-lookup"><span data-stu-id="3c44a-722">Log into the VM and perform the following:</span></span>

1. <span data-ttu-id="3c44a-723">A formátumban adja meg a data center és állvány tulajdonságok $CASS_HOME/conf/cassandra-rackdc.properties szerkesztése: dc = EASTUS állvány = rack1</span><span class="sxs-lookup"><span data-stu-id="3c44a-723">Edit $CASS_HOME/conf/cassandra-rackdc.properties to specify the data center and rack properties in the format:  dc =EASTUS  rack =rack1</span></span>
2. <span data-ttu-id="3c44a-724">Cassandra.yaml konfigurálása kezdőérték csomópontok szerkesztése: magok: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span><span class="sxs-lookup"><span data-stu-id="3c44a-724">Edit cassandra.yaml to configure seed nodes:  Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span></span>

### <a name="step-10-start-cassandra"></a><span data-ttu-id="3c44a-725">10. lépés: Indítsa el a Cassandra</span><span class="sxs-lookup"><span data-stu-id="3c44a-725">Step 10: Start Cassandra</span></span>
<span data-ttu-id="3c44a-726">Jelentkezzen be minden virtuális gép, majd indítsa el a Cassandra a háttérben a következő parancs futtatásával: $CASS_HOME/bin/cassandra</span><span class="sxs-lookup"><span data-stu-id="3c44a-726">Log into each VM and start Cassandra in the background by running the following command: $CASS_HOME/bin/cassandra</span></span>

## <a name="test-the-multi-region-cluster"></a><span data-ttu-id="3c44a-727">A több területi fürt tesztelése</span><span class="sxs-lookup"><span data-stu-id="3c44a-727">Test the Multi-Region Cluster</span></span>
<span data-ttu-id="3c44a-728">Mostanra Cassandra már alkalmazva van minden Azure régióban 8 csomópontokkal 16 csomóponttal.</span><span class="sxs-lookup"><span data-stu-id="3c44a-728">By now Cassandra has been deployed to 16 nodes with 8 nodes in each Azure region.</span></span> <span data-ttu-id="3c44a-729">Ezek a csomópontok ugyanabban a fürtben, a közös fürt neve és a kezdőérték csomópont-konfiguráció szerepelnek.</span><span class="sxs-lookup"><span data-stu-id="3c44a-729">These nodes are in the same cluster by virtue of the common cluster name and the seed node configuration.</span></span> <span data-ttu-id="3c44a-730">A fürt ellenőrzéséhez tegye a következőket:</span><span class="sxs-lookup"><span data-stu-id="3c44a-730">Use the following process to test the cluster:</span></span>

### <a name="step-1-get-the-internal-load-balancer-ip-for-both-the-regions-using-powershell"></a><span data-ttu-id="3c44a-731">1. lépés: A belső terheléselosztó IP lekérése is a PowerShell használatával régiók</span><span class="sxs-lookup"><span data-stu-id="3c44a-731">Step 1: Get the internal load balancer IP for both the regions using PowerShell</span></span>
* <span data-ttu-id="3c44a-732">"Hk-c-svc-nyugati-us" Get-AzureInternalLoadbalancer - szolgáltatásnév</span><span class="sxs-lookup"><span data-stu-id="3c44a-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span></span>
* <span data-ttu-id="3c44a-733">"Hk-c-svc-keleti-us" Get-AzureInternalLoadbalancer - szolgáltatásnév</span><span class="sxs-lookup"><span data-stu-id="3c44a-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span></span>  
  
    <span data-ttu-id="3c44a-734">Vegye figyelembe az IP-címek (pl. - 10.1.2.101, kelet - nyugati 10.2.2.101) jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="3c44a-734">Note the IP addresses (e.g. west - 10.1.2.101, east - 10.2.2.101) displayed.</span></span>

### <a name="step-2-execute-the-following-in-the-west-region-after-logging-into-hk-w1-west-us"></a><span data-ttu-id="3c44a-735">2. lépés: Hajtsa végre az alábbiakat eladásait hk-F1-nyugati-us való bejelentkezés után</span><span class="sxs-lookup"><span data-stu-id="3c44a-735">Step 2: Execute the following in the west region after logging into hk-w1-west-us</span></span>
1. <span data-ttu-id="3c44a-736">Végrehajtás $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="3c44a-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
2. <span data-ttu-id="3c44a-737">A következő CQL parancsokat hajthat végre:</span><span class="sxs-lookup"><span data-stu-id="3c44a-737">Execute the following CQL commands:</span></span>
   
     <span data-ttu-id="3c44a-738">Kulcstérértesítések használatával hozzon létre customers_ks rendelkező replikációs = {"class": "NetworkToplogyStrategy", "WESTUS": 3, "EASTUS": 3};   HASZNÁLJA a customers_ks;   Hozzon létre a tábla Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Helyezze be a Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Helyezze be a Customers(customer_id, firstname, lastname) értékek (2, "Jane", "Doe").   Válassza ki * ügyfelek;</span><span class="sxs-lookup"><span data-stu-id="3c44a-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="3c44a-739">Például az alábbi megjelenítésre kell megjelennie:</span><span class="sxs-lookup"><span data-stu-id="3c44a-739">You should see a display like the one below:</span></span>

| <span data-ttu-id="3c44a-740">customer_id</span><span class="sxs-lookup"><span data-stu-id="3c44a-740">customer_id</span></span> | <span data-ttu-id="3c44a-741">Utónév</span><span class="sxs-lookup"><span data-stu-id="3c44a-741">firstname</span></span> | <span data-ttu-id="3c44a-742">Vezetéknév</span><span class="sxs-lookup"><span data-stu-id="3c44a-742">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3c44a-743">1</span><span class="sxs-lookup"><span data-stu-id="3c44a-743">1</span></span> |<span data-ttu-id="3c44a-744">John</span><span class="sxs-lookup"><span data-stu-id="3c44a-744">John</span></span> |<span data-ttu-id="3c44a-745">DOE</span><span class="sxs-lookup"><span data-stu-id="3c44a-745">Doe</span></span> |
| <span data-ttu-id="3c44a-746">2</span><span class="sxs-lookup"><span data-stu-id="3c44a-746">2</span></span> |<span data-ttu-id="3c44a-747">Jane</span><span class="sxs-lookup"><span data-stu-id="3c44a-747">Jane</span></span> |<span data-ttu-id="3c44a-748">DOE</span><span class="sxs-lookup"><span data-stu-id="3c44a-748">Doe</span></span> |

### <a name="step-3-execute-the-following-in-the-east-region-after-logging-into-hk-w1-east-us"></a><span data-ttu-id="3c44a-749">3. lépés: A következő végrehajtani a keleti terület hk-F1-keleti-us való bejelentkezés után:</span><span class="sxs-lookup"><span data-stu-id="3c44a-749">Step 3: Execute the following in the east region after logging into hk-w1-east-us:</span></span>
1. <span data-ttu-id="3c44a-750">Végrehajtás $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="3c44a-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span></span>
2. <span data-ttu-id="3c44a-751">A következő CQL parancsokat hajthat végre:</span><span class="sxs-lookup"><span data-stu-id="3c44a-751">Execute the following CQL commands:</span></span>
   
     <span data-ttu-id="3c44a-752">HASZNÁLJA a customers_ks;   Hozzon létre a tábla Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Helyezze be a Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Helyezze be a Customers(customer_id, firstname, lastname) értékek (2, "Jane", "Doe").   Válassza ki * ügyfelek;</span><span class="sxs-lookup"><span data-stu-id="3c44a-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="3c44a-753">A nyugati régiójában alapegységét az azonos megjelenítési kell megjelennie:</span><span class="sxs-lookup"><span data-stu-id="3c44a-753">You should see the same display as seen for the West region:</span></span>

| <span data-ttu-id="3c44a-754">customer_id</span><span class="sxs-lookup"><span data-stu-id="3c44a-754">customer_id</span></span> | <span data-ttu-id="3c44a-755">Utónév</span><span class="sxs-lookup"><span data-stu-id="3c44a-755">firstname</span></span> | <span data-ttu-id="3c44a-756">Vezetéknév</span><span class="sxs-lookup"><span data-stu-id="3c44a-756">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3c44a-757">1</span><span class="sxs-lookup"><span data-stu-id="3c44a-757">1</span></span> |<span data-ttu-id="3c44a-758">John</span><span class="sxs-lookup"><span data-stu-id="3c44a-758">John</span></span> |<span data-ttu-id="3c44a-759">DOE</span><span class="sxs-lookup"><span data-stu-id="3c44a-759">Doe</span></span> |
| <span data-ttu-id="3c44a-760">2</span><span class="sxs-lookup"><span data-stu-id="3c44a-760">2</span></span> |<span data-ttu-id="3c44a-761">Jane</span><span class="sxs-lookup"><span data-stu-id="3c44a-761">Jane</span></span> |<span data-ttu-id="3c44a-762">DOE</span><span class="sxs-lookup"><span data-stu-id="3c44a-762">Doe</span></span> |

<span data-ttu-id="3c44a-763">Néhány további Beszúrások hajtható végre, és tekintse meg, hogy azok replikálja nyugati-nekünk a fürt része.</span><span class="sxs-lookup"><span data-stu-id="3c44a-763">Execute a few more inserts and see that those get replicated to west-us part of the cluster.</span></span>

## <a name="test-cassandra-cluster-from-nodejs"></a><span data-ttu-id="3c44a-764">Cassandra Tesztfürthöz Node.js-ből</span><span class="sxs-lookup"><span data-stu-id="3c44a-764">Test Cassandra Cluster from Node.js</span></span>
<span data-ttu-id="3c44a-765">Egyikének használatával jön létre a "web" a Linux virtuális gépek réteg korábban, azt fogja végrehajtani egy egyszerű Node.js parancsfájl a korábban beszúrt adatokat olvasni.</span><span class="sxs-lookup"><span data-stu-id="3c44a-765">Using one of the Linux VMs crated in the "web" tier previously, we will execute a simple Node.js script to read the previously inserted data</span></span>

<span data-ttu-id="3c44a-766">**1. lépés: A Node.js és Cassandra ügyfél telepítése**</span><span class="sxs-lookup"><span data-stu-id="3c44a-766">**Step 1: Install Node.js and Cassandra Client**</span></span>

1. <span data-ttu-id="3c44a-767">Telepítse a Node.js és npm</span><span class="sxs-lookup"><span data-stu-id="3c44a-767">Install Node.js and npm</span></span>
2. <span data-ttu-id="3c44a-768">Telepítse a csomag "cassandra-ügyfél csomópont" npm segítségével</span><span class="sxs-lookup"><span data-stu-id="3c44a-768">Install node package "cassandra-client" using npm</span></span>
3. <span data-ttu-id="3c44a-769">Hajtsa végre a következő parancsfájlt a rendszerhéj-parancssorba, mely megjeleníti a json-karakterláncban a beolvasott adatok:</span><span class="sxs-lookup"><span data-stu-id="3c44a-769">Execute the following script at the shell prompt which displays the json string of the retrieved data:</span></span>
   
        var pooledCon = require('cassandra-client').PooledConnection;
        var ksName = "custsupport_ks";
        var cfName = "customers_cf";
        var hostList = ['internal_loadbalancer_ip:9160'];
        var ksConOptions = { hosts: hostList,
                             keyspace: ksName, use_bigints: false };
   
        function createKeyspace(callback){
           var cql = 'CREATE KEYSPACE ' + ksName + ' WITH strategy_class=SimpleStrategy AND strategy_options:replication_factor=1';
           var sysConOptions = { hosts: hostList,  
                                 keyspace: 'system', use_bigints: false };
           var con = new pooledCon(sysConOptions);
           con.execute(cql,[],function(err) {
           if (err) {
             console.log("Failed to create Keyspace: " + ksName);
             console.log(err);
           }
           else {
             console.log("Created Keyspace: " + ksName);
             callback(ksConOptions, populateCustomerData);
           }
           });
           con.shutdown();
        }
   
        function createColumnFamily(ksConOptions, callback){
          var params = ['customers_cf','custid','varint','custname',
                        'text','custaddress','text'];
          var cql = 'CREATE COLUMNFAMILY ? (? ? PRIMARY KEY,? ?, ? ?)';
        var con =  new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) {
                 console.log("Failed to create column family: " + params[0]);
                 console.log(err);
              }
              else {
                 console.log("Created column family: " + params[0]);
                 callback();
              }
          });
          con.shutdown();
        }
   
        //populate Data
        function populateCustomerData() {
           var params = ['John','Infinity Dr, TX', 1];
           updateCustomer(ksConOptions,params);
   
           params = ['Tom','Fermat Ln, WA', 2];
           updateCustomer(ksConOptions,params);
        }
   
        //update will also insert the record if none exists
        function updateCustomer(ksConOptions,params)
        {
          var cql = 'UPDATE customers_cf SET custname=?,custaddress=? where custid=?';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) console.log(err);
              else console.log("Inserted customer : " + params[0]);
          });
          con.shutdown();
        }
   
        //read the two rows inserted above
        function readCustomer(ksConOptions)
        {
          var cql = 'SELECT * FROM customers_cf WHERE custid IN (1,2)';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,[],function(err,rows) {
              if (err)
                 console.log(err);
              else
                 for (var i=0; i<rows.length; i++)
                    console.log(JSON.stringify(rows[i]));
            });
           con.shutdown();
        }
   
        //exectue the code
        createKeyspace(createColumnFamily);
        readCustomer(ksConOptions)

## <a name="conclusion"></a><span data-ttu-id="3c44a-770">Összegzés</span><span class="sxs-lookup"><span data-stu-id="3c44a-770">Conclusion</span></span>
<span data-ttu-id="3c44a-771">Microsoft Azure a rugalmas platform, amely lehetővé teszi a Microsoft, valamint nyílt forráskódú szoftverek futtatását, amint azt a ebben a gyakorlatban.</span><span class="sxs-lookup"><span data-stu-id="3c44a-771">Microsoft Azure is a flexible platform that allows the running of both Microsoft as well as open source software as demonstrated by this exercise.</span></span> <span data-ttu-id="3c44a-772">Magas rendelkezésre állású Cassandra fürtök telepíthetők egyetlen adatközpontba keresztül a fürt csomópontjai terjednek több tartalék tartományokban.</span><span class="sxs-lookup"><span data-stu-id="3c44a-772">Highly available Cassandra clusters can be deployed on a single data center through the spreading of the cluster nodes across multiple fault domains.</span></span> <span data-ttu-id="3c44a-773">Cassandra fürtök különféle régiókban földrajzilag távoli Azure katasztrófa igazoló rendszerekhez is telepíthető.</span><span class="sxs-lookup"><span data-stu-id="3c44a-773">Cassandra clusters can also be deployed across multiple geographically distant Azure regions for disaster proof systems.</span></span> <span data-ttu-id="3c44a-774">Azure és Cassandra együtt lehetővé teszi, hogy jól skálázható, magas rendelkezésre állású létrehozása és a vészhelyreállítás helyreállítható felhőszolgáltatások szükséges mai internet által méret szolgáltatások.</span><span class="sxs-lookup"><span data-stu-id="3c44a-774">Azure and Cassandra together enables the construction of highly scalable, highly available and disaster recoverable cloud services needed by today's internet scale services.</span></span>  

## <a name="references"></a><span data-ttu-id="3c44a-775">Referencia</span><span class="sxs-lookup"><span data-stu-id="3c44a-775">References</span></span>
* [<span data-ttu-id="3c44a-776">http://cassandra.Apache.org</span><span class="sxs-lookup"><span data-stu-id="3c44a-776">http://cassandra.apache.org</span></span>](http://cassandra.apache.org)
* [<span data-ttu-id="3c44a-777">http://www.datastax.com</span><span class="sxs-lookup"><span data-stu-id="3c44a-777">http://www.datastax.com</span></span>](http://www.datastax.com)
* [<span data-ttu-id="3c44a-778">http://www.nodejs.org</span><span class="sxs-lookup"><span data-stu-id="3c44a-778">http://www.nodejs.org</span></span>](http://www.nodejs.org)

