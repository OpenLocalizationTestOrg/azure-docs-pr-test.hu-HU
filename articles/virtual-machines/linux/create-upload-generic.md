---
title: "Létrehozása és feltöltése az Azure Linux virtuális merevlemez"
description: "Ismerje meg, hogy létrehozása és feltöltése az Azure virtuális merevlemez (VHD) a Linux operációs rendszert tartalmazó."
services: virtual-machines-linux
documentationcenter: 
author: szarkos
manager: timlt
editor: tysonn
tags: azure-resource-manager,azure-service-management
ms.assetid: d351396c-95a0-4092-b7bf-c6aae0bbd112
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 02/02/2017
ms.author: szark
ms.openlocfilehash: ccadf55c492c097ef96f25e469dbf36fc87b6102
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/03/2017
---
# <a name="information-for-non-endorsed-distributions"></a><span data-ttu-id="d0f19-103">Nem támogatott disztribúciókkal kapcsolatos tudnivalók</span><span class="sxs-lookup"><span data-stu-id="d0f19-103">Information for Non-Endorsed Distributions</span></span>
[!INCLUDE [learn-about-deployment-models](../../../includes/learn-about-deployment-models-both-include.md)]

<span data-ttu-id="d0f19-104">Az Azure platformon SLA vonatkozik a Linux operációs rendszert futtató, csak ha egy futó virtuális gépek számára, a [által támogatott disztribúciók](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) szolgál.</span><span class="sxs-lookup"><span data-stu-id="d0f19-104">The Azure platform SLA applies to virtual machines running the Linux OS only when one of the [endorsed distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) is used.</span></span> <span data-ttu-id="d0f19-105">Az összes Linux terjesztéseket, a kép: Azure-katalógus által biztosított a szükséges konfigurációval hitelesített terjesztéseket.</span><span class="sxs-lookup"><span data-stu-id="d0f19-105">All Linux distributions that are provided in the Azure image gallery are endorsed distributions with the required configuration.</span></span>

* [<span data-ttu-id="d0f19-106">Az Azure - Linux által támogatott Disztribúciók</span><span class="sxs-lookup"><span data-stu-id="d0f19-106">Linux on Azure - Endorsed Distributions</span></span>](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
* [<span data-ttu-id="d0f19-107">A Microsoft Azure Linux lemezképek támogatása</span><span class="sxs-lookup"><span data-stu-id="d0f19-107">Support for Linux images in Microsoft Azure</span></span>](https://support.microsoft.com/kb/2941892)

<span data-ttu-id="d0f19-108">Azure-on futó összes terjesztéseket kell éri el a szükséges előfeltételeket kell arra, hogy megfelelően működjön azon a platformon.</span><span class="sxs-lookup"><span data-stu-id="d0f19-108">All distributions running on Azure will need to meet a number of prerequisites to have a chance to properly run on the platform.</span></span>  <span data-ttu-id="d0f19-109">Ez a cikk célja semmiképpen sem átfogó, amelyben minden terjesztési különbözik; és üzembe helyezését lehetséges, hogy akkor is, ha az megfelel minden, az alábbi feltételek továbbra is szüksége lesz jelentősen végeznünk a Linux rendszer győződjön meg arról, hogy megfelelően fut a platformon.</span><span class="sxs-lookup"><span data-stu-id="d0f19-109">This article is by no means comprehensive as every distribution is different; and it is quite possible that even if you meet all the criteria below you will still need to significantly tweak your Linux system to ensure that it properly runs on the platform.</span></span>

<span data-ttu-id="d0f19-110">Az az oka, hogy azt javasoljuk, hogy az egyik megkezdése a [Azure támogatott Disztribúciókkal Linux](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) amikor lehetséges.</span><span class="sxs-lookup"><span data-stu-id="d0f19-110">It is for this reason that we recommend that you start with one of our [Linux on Azure Endorsed Distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) when possible.</span></span> <span data-ttu-id="d0f19-111">A következő cikkekben végigvezeti Önt a különböző hitelesített Linux terjesztéseket, az Azure által támogatott előkészítése:</span><span class="sxs-lookup"><span data-stu-id="d0f19-111">The following articles will guide you through how to prepare the various endorsed Linux distributions that are supported on Azure:</span></span>

* <span data-ttu-id="d0f19-112">**[CentOS-alapú Disztribúciók](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="d0f19-112">**[CentOS-based Distributions](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="d0f19-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="d0f19-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="d0f19-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="d0f19-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="d0f19-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="d0f19-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="d0f19-116">**[SLES & openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="d0f19-116">**[SLES & openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="d0f19-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="d0f19-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>

<span data-ttu-id="d0f19-118">Ez a cikk többi általános útmutatást a Linux-disztribúció Azure-on futó összpontosítanak.</span><span class="sxs-lookup"><span data-stu-id="d0f19-118">The rest of this article will focus on general guidance for running your Linux distribution on Azure.</span></span>

## <a name="general-linux-installation-notes"></a><span data-ttu-id="d0f19-119">Jelzi, hogy általános Linux rendszerhez – telepítés</span><span class="sxs-lookup"><span data-stu-id="d0f19-119">General Linux Installation Notes</span></span>
* <span data-ttu-id="d0f19-120">A VHDX formátum nem támogatott az Azure csak **rögzített VHD**.</span><span class="sxs-lookup"><span data-stu-id="d0f19-120">The VHDX format is not supported in Azure, only **fixed VHD**.</span></span>  <span data-ttu-id="d0f19-121">Átválthat a lemez VHD formátumú Hyper-V kezelője vagy a convert-vhd-parancsmag segítségével.</span><span class="sxs-lookup"><span data-stu-id="d0f19-121">You can convert the disk to VHD format using Hyper-V Manager or the convert-vhd cmdlet.</span></span> <span data-ttu-id="d0f19-122">VirtualBox rendszer használata esetén ez azt jelenti, hogy kiválasztásával **mérete rögzített** az alapértelmezett, a lemez létrehozásakor dinamikusan kiosztott szemben.</span><span class="sxs-lookup"><span data-stu-id="d0f19-122">If you are using VirtualBox this means selecting **Fixed size** as opposed to the default dynamically allocated when creating the disk.</span></span>
* <span data-ttu-id="d0f19-123">Azure csak az 1. generációs virtuális gépek támogatja.</span><span class="sxs-lookup"><span data-stu-id="d0f19-123">Azure only supports generation 1 virtual machines.</span></span> <span data-ttu-id="d0f19-124">1. generációs virtuális gépek VHDX-re a virtuális merevlemez formátumának és a rögzített méretű lemezekké dinamikusan bővülő válthat.</span><span class="sxs-lookup"><span data-stu-id="d0f19-124">You can convert a generation 1 virtual machine from VHDX to the VHD file format and from dynamically expanding to a fixed sized disk.</span></span> <span data-ttu-id="d0f19-125">De nem módosíthatja a virtuális gép generációját.</span><span class="sxs-lookup"><span data-stu-id="d0f19-125">But you can't change a virtual machine's generation.</span></span> <span data-ttu-id="d0f19-126">További információkért lásd: [érdemes létrehozni 1 vagy 2. generációs virtuális gépek a Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span><span class="sxs-lookup"><span data-stu-id="d0f19-126">For more information, see [Should I create a generation 1 or 2 virtual machine in Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span></span>
* <span data-ttu-id="d0f19-127">A VHD számára engedélyezett maximális mérete 1,023 GB.</span><span class="sxs-lookup"><span data-stu-id="d0f19-127">The maximum size allowed for the VHD is 1,023 GB.</span></span>
* <span data-ttu-id="d0f19-128">Ha telepíti a Linux rendszer *ajánlott* LVM (gyakran sok telepítés alapértelmezett), hanem szabványos partíciók használja.</span><span class="sxs-lookup"><span data-stu-id="d0f19-128">When installing the Linux system it is *recommended* that you use standard partitions rather than LVM (often the default for many installations).</span></span> <span data-ttu-id="d0f19-129">LVM neve ütközik a klónozott virtuális gépek, így elkerülhető, különösen akkor, ha egy operációsrendszer-lemez legalább egyszer kell hibaelhárítási egy másik, azonos virtuális géphez csatlakoztatható.</span><span class="sxs-lookup"><span data-stu-id="d0f19-129">This will avoid LVM name conflicts with cloned VMs, particularly if an OS disk ever needs to be attached to another identical VM for troubleshooting.</span></span> <span data-ttu-id="d0f19-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) vagy [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) adatlemezek használható.</span><span class="sxs-lookup"><span data-stu-id="d0f19-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) or [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) may be used on data disks.</span></span>
* <span data-ttu-id="d0f19-131">Kernel támogatása UDF fájlrendszerek csatlakoztatására szükség.</span><span class="sxs-lookup"><span data-stu-id="d0f19-131">Kernel support for mounting UDF file systems is required.</span></span> <span data-ttu-id="d0f19-132">Azure első rendszerindításkor az üzembe helyezési konfiguráció lett átadva a Linux virtuális gép keresztül UDF formátumú adathordozót, amely csatolva van a Vendég.</span><span class="sxs-lookup"><span data-stu-id="d0f19-132">At first boot on Azure the provisioning configuration is passed to the Linux VM via UDF-formatted media that is attached to the guest.</span></span> <span data-ttu-id="d0f19-133">Az Azure Linux ügynök a UDF fájlrendszerben beolvasni a konfigurációt, és helyezze üzembe a virtuális gép csatlakoztatása képesnek kell lennie.</span><span class="sxs-lookup"><span data-stu-id="d0f19-133">The Azure Linux agent must be able to mount the UDF file system to read its configuration and provision the VM.</span></span>
* <span data-ttu-id="d0f19-134">Linux kernel verziójánál régebbi 2.6.37 nem támogatott a Hyper-V nagyobb Virtuálisgép-méretek a.</span><span class="sxs-lookup"><span data-stu-id="d0f19-134">Linux kernel versions below 2.6.37 do not support NUMA on Hyper-V with larger VM sizes.</span></span> <span data-ttu-id="d0f19-135">A probléma főként hatások régebbi azokat a terjesztéseket használatával a felsőbb rétegbeli Red Hat 2.6.32 kernel és javítását a RHEL 6.6 (kernel-2.6.32-504).</span><span class="sxs-lookup"><span data-stu-id="d0f19-135">This issue primarily impacts older distributions using the upstream Red Hat 2.6.32 kernel, and was fixed in RHEL 6.6 (kernel-2.6.32-504).</span></span> <span data-ttu-id="d0f19-136">Rendszerekre egyéni kernelek régebbi, mint 2.6.37 vagy régebbi RHEL alapú kernelek 2.6.32-504 a rendszerindító paramétert kell beállítani, mint `numa=off` a parancssori grub.conf a kernel.</span><span class="sxs-lookup"><span data-stu-id="d0f19-136">Systems running custom kernels older than 2.6.37, or RHEL-based kernels older than 2.6.32-504 must set the boot parameter `numa=off` on the kernel command-line in grub.conf.</span></span> <span data-ttu-id="d0f19-137">További információ: a Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span><span class="sxs-lookup"><span data-stu-id="d0f19-137">For more information see Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span></span>
* <span data-ttu-id="d0f19-138">Ne konfiguráljon egy swap partíciót az operációsrendszer-lemezképet.</span><span class="sxs-lookup"><span data-stu-id="d0f19-138">Do not configure a swap partition on the OS disk.</span></span> <span data-ttu-id="d0f19-139">A Linux-ügynök beállítható úgy, hogy az ideiglenes erőforrás lemezen a lapozófájl létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="d0f19-139">The Linux agent can be configured to create a swap file on the temporary resource disk.</span></span>  <span data-ttu-id="d0f19-140">További információk a megtalálhatók az alábbi lépéseket.</span><span class="sxs-lookup"><span data-stu-id="d0f19-140">More information about this can be found in the steps below.</span></span>
* <span data-ttu-id="d0f19-141">Összes, a virtuális merevlemezeket kell rendelkeznie, amely többszörösei 1 MB méretű.</span><span class="sxs-lookup"><span data-stu-id="d0f19-141">All of the VHDs must have sizes that are multiples of 1 MB.</span></span>

### <a name="installing-kernel-modules-without-hyper-v"></a><span data-ttu-id="d0f19-142">Hyper-V nélkül kernel-modulok telepítése</span><span class="sxs-lookup"><span data-stu-id="d0f19-142">Installing kernel modules without Hyper-V</span></span>
<span data-ttu-id="d0f19-143">Azure fut a Hyper-V hipervizort, Linux megköveteli, hogy az egyes kernel modulok telepítve vannak-e az Azure-ban futtatásához.</span><span class="sxs-lookup"><span data-stu-id="d0f19-143">Azure runs on the Hyper-V hypervisor, so Linux requires that certain kernel modules are installed in order to run in Azure.</span></span> <span data-ttu-id="d0f19-144">Ha egy virtuális Gépet, amely a Hyper-V kívül hozták létre, a Linux-telepítők nem tartalmazhatnak az illesztőprogramokat a Hyper-V a a kezdeti ramdisk (initrd vagy initramfs) kivéve, ha azt észleli, hogy fut-e egy Hyper-V környezetben.</span><span class="sxs-lookup"><span data-stu-id="d0f19-144">If you have a VM that was created outside of Hyper-V, the Linux installers may not include the drivers for Hyper-V in the initial ramdisk (initrd or initramfs) unless it detects that it is running an a Hyper-V environment.</span></span> <span data-ttu-id="d0f19-145">Ha egy eltérő virtualizációs rendszer (azaz Virtualbox, KVM, stb.) a Linux-lemezkép előkészítése, szükség lehet, hogy a initrd annak érdekében, hogy legalább az `hv_vmbus` és `hv_storvsc` kernel modulok érhetők el a kezdeti ramdisk.</span><span class="sxs-lookup"><span data-stu-id="d0f19-145">When using a different virtualization system (i.e. Virtualbox, KVM, etc.) to prepare your Linux image, you may need to rebuild the initrd to ensure that at least the `hv_vmbus` and `hv_storvsc` kernel modules are available on the initial ramdisk.</span></span>  <span data-ttu-id="d0f19-146">Ez az egy ismert probléma, legalább a felsőbb rétegbeli Red Hat terjesztési alapú rendszereken.</span><span class="sxs-lookup"><span data-stu-id="d0f19-146">This is a known issue at least on systems based on the upstream Red Hat distribution.</span></span>

<span data-ttu-id="d0f19-147">A mechanizmus az initrd vagy initramfs kép újraépítése eltérhetnek attól függően, hogy a terjesztési.</span><span class="sxs-lookup"><span data-stu-id="d0f19-147">The mechanism for rebuilding the initrd or initramfs image may vary depending on the distribution.</span></span> <span data-ttu-id="d0f19-148">A terjesztési dokumentációt, vagy a megfelelő eljárás támogatása.</span><span class="sxs-lookup"><span data-stu-id="d0f19-148">Please consult your distribution's documentation or support for the proper procedure.</span></span>  <span data-ttu-id="d0f19-149">Íme egy példa, hogy a initrd használatával hogyan a `mkinitrd` segédprogram:</span><span class="sxs-lookup"><span data-stu-id="d0f19-149">Here is one example for how to rebuild the initrd using the `mkinitrd` utility:</span></span>

<span data-ttu-id="d0f19-150">Először készítsen biztonsági másolatot a meglévő initrd lemezkép:</span><span class="sxs-lookup"><span data-stu-id="d0f19-150">First, back up the existing initrd image:</span></span>

    # cd /boot
    # sudo cp initrd-`uname -r`.img  initrd-`uname -r`.img.bak

<span data-ttu-id="d0f19-151">Ezután építse újra a initrd a `hv_vmbus` és `hv_storvsc` kernel modulok:</span><span class="sxs-lookup"><span data-stu-id="d0f19-151">Next, rebuild the initrd with the `hv_vmbus` and `hv_storvsc` kernel modules:</span></span>

    # sudo mkinitrd --preload=hv_storvsc --preload=hv_vmbus -v -f initrd-`uname -r`.img `uname -r`


### <a name="resizing-vhds"></a><span data-ttu-id="d0f19-152">Virtuális merevlemezek átméretezése</span><span class="sxs-lookup"><span data-stu-id="d0f19-152">Resizing VHDs</span></span>
<span data-ttu-id="d0f19-153">Az Azure virtuális merevlemez képek rendelkeznie kell egy virtuális mérete 1MB igazodik.</span><span class="sxs-lookup"><span data-stu-id="d0f19-153">VHD images on Azure must have a virtual size aligned to 1MB.</span></span>  <span data-ttu-id="d0f19-154">Általában a Hyper-v-vel létrehozott virtuális merevlemezeket már igazítását megfelelően.</span><span class="sxs-lookup"><span data-stu-id="d0f19-154">Typically, VHDs created using Hyper-V should already be aligned correctly.</span></span>  <span data-ttu-id="d0f19-155">Ha a virtuális merevlemez nincs megfelelően igazítva, akkor az alábbihoz hasonló hibaüzenetet kaphat létrehozására tett kísérlet során egy *kép* a virtuális merevlemezről:</span><span class="sxs-lookup"><span data-stu-id="d0f19-155">If the VHD is not aligned correctly then you may receive an error message similar to the following when you attempt to create an *image* from your VHD:</span></span>

    "The VHD http://<mystorageaccount>.blob.core.windows.net/vhds/MyLinuxVM.vhd has an unsupported virtual size of 21475270656 bytes. The size must be a whole number (in MBs).”

<span data-ttu-id="d0f19-156">Ennek orvoslása érdekében méretezze át a virtuális gép vagy a Hyper-V Manager konzol használatával, vagy a [átméretezési-VHD](http://technet.microsoft.com/library/hh848535.aspx) Powershell-parancsmagot.</span><span class="sxs-lookup"><span data-stu-id="d0f19-156">To remedy this you can resize the VM using either the Hyper-V Manager console or the [Resize-VHD](http://technet.microsoft.com/library/hh848535.aspx) Powershell cmdlet.</span></span>  <span data-ttu-id="d0f19-157">Ha egy Windows-környezetben nem fut majd ajánlott segítségével qemu-img (ha szükséges), és a virtuális merevlemez átméretezése.</span><span class="sxs-lookup"><span data-stu-id="d0f19-157">If you are not running in a Windows environment then it is recommended to use qemu-img to convert (if needed) and resize the VHD.</span></span>

> [!NOTE]
> <span data-ttu-id="d0f19-158">Egy ismert hiba van qemu-img verzió > = 2.2.1-en, amely egy nem megfelelően formázott virtuális merevlemez eredményez.</span><span class="sxs-lookup"><span data-stu-id="d0f19-158">There is a known bug in qemu-img versions >=2.2.1 that results in an improperly formatted VHD.</span></span> <span data-ttu-id="d0f19-159">A hiba kijavítása QEMU 2.6.</span><span class="sxs-lookup"><span data-stu-id="d0f19-159">The issue has been fixed in QEMU 2.6.</span></span> <span data-ttu-id="d0f19-160">Javasoljuk, hogy használja a qemu-img 2.2.0 vagy alsó, vagy frissítse a 2.6 vagy újabb rendszerre.</span><span class="sxs-lookup"><span data-stu-id="d0f19-160">It is recommended to use either qemu-img 2.2.0 or lower, or update to 2.6 or higher.</span></span> <span data-ttu-id="d0f19-161">Hivatkozás: https://bugs.launchpad.net/qemu/+bug/1490611.</span><span class="sxs-lookup"><span data-stu-id="d0f19-161">Reference: https://bugs.launchpad.net/qemu/+bug/1490611.</span></span>
> 
> 

1. <span data-ttu-id="d0f19-162">Közvetlenül eszközökkel például a virtuális merevlemez átméretezése `qemu-img` vagy `vbox-manage` azt eredményezheti, egy indíthatatlanná VHD-t.</span><span class="sxs-lookup"><span data-stu-id="d0f19-162">Resizing the VHD directly using tools such as `qemu-img` or `vbox-manage` may result in an unbootable VHD.</span></span>  <span data-ttu-id="d0f19-163">Ezért javasoljuk, hogy első convert a VHD-fájlt nyers lemezképet.</span><span class="sxs-lookup"><span data-stu-id="d0f19-163">So it is recommended to first convert the VHD to a RAW disk image.</span></span>  <span data-ttu-id="d0f19-164">Ha a Virtuálisgép-lemezkép már létre lett hozva nyers lemezképet (az egyes Hipervizorok, például a KVM alapértelmezett), majd előfordulhat, hogy kihagyja ezt a lépést:</span><span class="sxs-lookup"><span data-stu-id="d0f19-164">If the VM image was already created as RAW disk image (the default for some Hypervisors such as KVM) then you may skip this step:</span></span>
   
       # qemu-img convert -f vpc -O raw MyLinuxVM.vhd MyLinuxVM.raw

2. <span data-ttu-id="d0f19-165">A lemezképet, győződjön meg arról, hogy a virtuális mérete 1 MB-nál igazítva van-e a szükséges méretének kiszámításához.</span><span class="sxs-lookup"><span data-stu-id="d0f19-165">Calculate the required size of the disk image to ensure that the virtual size is aligned to 1MB.</span></span>  <span data-ttu-id="d0f19-166">A következő bash héjparancsfájlt ezzel segít.</span><span class="sxs-lookup"><span data-stu-id="d0f19-166">The following bash shell script can assist with this.</span></span>  <span data-ttu-id="d0f19-167">A parancsfájl a "`qemu-img info`" határozza meg a virtuális méretet a lemezképet, majd kiszámítja a következő 1 MB méretű:</span><span class="sxs-lookup"><span data-stu-id="d0f19-167">The script uses "`qemu-img info`" to determine the virtual size of the disk image and then calculates the size to the next 1MB:</span></span>
   
       rawdisk="MyLinuxVM.raw"
       vhddisk="MyLinuxVM.vhd"
   
       MB=$((1024*1024))
       size=$(qemu-img info -f raw --output json "$rawdisk" | \
              gawk 'match($0, /"virtual-size": ([0-9]+),/, val) {print val[1]}')
   
       rounded_size=$((($size/$MB + 1)*$MB))
       echo "Rounded Size = $rounded_size"

3. <span data-ttu-id="d0f19-168">A nyers $rounded_size használja, mint a fenti szkript beállított lemez átméretezése:</span><span class="sxs-lookup"><span data-stu-id="d0f19-168">Resize the raw disk using $rounded_size as set in the above script:</span></span>
   
       # qemu-img resize MyLinuxVM.raw $rounded_size

4. <span data-ttu-id="d0f19-169">Most, a nyers lemez konvertálása vissza egy rögzített méretű virtuális merevlemez:</span><span class="sxs-lookup"><span data-stu-id="d0f19-169">Now, convert the RAW disk back to a fixed-size VHD:</span></span>
   
       # qemu-img convert -f raw -o subformat=fixed -O vpc MyLinuxVM.raw MyLinuxVM.vhd

   <span data-ttu-id="d0f19-170">Vagy a verziójával qemu **2.6 +** közé tartozik a `force_size` lehetőséget:</span><span class="sxs-lookup"><span data-stu-id="d0f19-170">Or, with qemu version **2.6+** include the `force_size` option:</span></span>

       # qemu-img convert -f raw -o subformat=fixed,force_size -O vpc MyLinuxVM.raw MyLinuxVM.vhd

## <a name="linux-kernel-requirements"></a><span data-ttu-id="d0f19-171">Linux Kernel követelmények</span><span class="sxs-lookup"><span data-stu-id="d0f19-171">Linux Kernel Requirements</span></span>
<span data-ttu-id="d0f19-172">A Linux integrációs szolgáltatások (LIS) illesztőprogramokat, a Hyper-V és az Azure közvetlenül a felsőbb rétegbeli Linux kernel vannak hozzájárult.</span><span class="sxs-lookup"><span data-stu-id="d0f19-172">The Linux Integration Services (LIS) drivers for Hyper-V and Azure are contributed directly to the upstream Linux kernel.</span></span> <span data-ttu-id="d0f19-173">A Linux kernel közelmúltban (azaz 3.x) tartalmazó terjesztések ezeket az illesztőprogramokat elérhető már rendelkezik, vagy ellenkező esetben adja meg ezeket az illesztőprogramokat backported verziói a kernelek a.</span><span class="sxs-lookup"><span data-stu-id="d0f19-173">Many distributions that include a recent Linux kernel version (i.e. 3.x) will have these drivers available already, or otherwise provide backported versions of these drivers with their kernels.</span></span>  <span data-ttu-id="d0f19-174">Ezeket az illesztőprogramokat folyamatosan változik a felsőbb rétegbeli kernel az új javításokat és szolgáltatásokat, amikor lehetséges futtatásához célszerű egy [által támogatott terjesztési](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) , amely tartalmazza ezeket a javításokat és frissítéseit.</span><span class="sxs-lookup"><span data-stu-id="d0f19-174">These drivers are constantly being updated in the upstream kernel with new fixes and features, so when possible it is recommended to run an [endorsed distribution](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) that will include these fixes and updates.</span></span>

<span data-ttu-id="d0f19-175">Ha futtatja a Red Hat Enterprise Linux-verziók variant **6.0-6.3**, akkor kell a Hyper-V legújabb LIS illesztőprogramok telepítését.</span><span class="sxs-lookup"><span data-stu-id="d0f19-175">If you are running a variant of Red Hat Enterprise Linux versions **6.0-6.3**, then you will need to install the latest LIS drivers for Hyper-V.</span></span> <span data-ttu-id="d0f19-176">Az illesztőprogramok található [ezen a helyen](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="d0f19-176">The drivers can be found [at this location](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span></span> <span data-ttu-id="d0f19-177">RHEL frissítésétől **6.4 +** (és származékai) a LIS már már tartalmazza a kernel, és ezért nincs további telepítési csomag Azure ezekhez a rendszerekhez futtatásához szükséges.</span><span class="sxs-lookup"><span data-stu-id="d0f19-177">As of RHEL **6.4+** (and derivatives) the LIS drivers are already included with the kernel and so no additional installation packages are needed to run those systems on Azure.</span></span>

<span data-ttu-id="d0f19-178">Ha egy egyéni kernel szükség, javasoljuk, hogy újabb verziójára kernel használja (azaz **3.8 +**).</span><span class="sxs-lookup"><span data-stu-id="d0f19-178">If a custom kernel is required, it is recommended to use a more recent kernel version (i.e. **3.8+**).</span></span> <span data-ttu-id="d0f19-179">Ezeket a felosztás vagy szállítók, akik a saját kernel karbantartása, néhány elérhető lesz szükséges rendszeresen backport a LIS-illesztőprogramok a felsőbb rétegbeli kernel az egyéni kernel a.</span><span class="sxs-lookup"><span data-stu-id="d0f19-179">For those distributions or vendors who maintain their own kernel, some effort will be required to regularly backport the LIS drivers from the upstream kernel to your custom kernel.</span></span>  <span data-ttu-id="d0f19-180">Akkor is, ha már viszonylag új kernel-verziót futtat, lehetőleg nyomon követéséhez a LIS illesztőprogramok és backport bármely felsőbb rétegbeli javítások azokat szükség szerint.</span><span class="sxs-lookup"><span data-stu-id="d0f19-180">Even if you are already running a relatively recent kernel version, it is highly recommended to keep track of any upstream fixes in the LIS drivers and backport those as needed.</span></span> <span data-ttu-id="d0f19-181">A LIS illesztőprogram forrásfájljainak helyét érhető el a [MAINTAINERS](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) fájlt a Linux kernel forrás fában:</span><span class="sxs-lookup"><span data-stu-id="d0f19-181">The location of the LIS driver source files is available in the [MAINTAINERS](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) file in the Linux kernel source tree:</span></span>

    F:    arch/x86/include/asm/mshyperv.h
    F:    arch/x86/include/uapi/asm/hyperv.h
    F:    arch/x86/kernel/cpu/mshyperv.c
    F:    drivers/hid/hid-hyperv.c
    F:    drivers/hv/
    F:    drivers/input/serio/hyperv-keyboard.c
    F:    drivers/net/hyperv/
    F:    drivers/scsi/storvsc_drv.c
    F:    drivers/video/fbdev/hyperv_fb.c
    F:    include/linux/hyperv.h
    F:    tools/hv/

<span data-ttu-id="d0f19-182">Egy nagyon minimális a következő javítások hiányában az előzőekben problémákat okozhat az Azure-on és így ezek szerepelnie kell a kernel.</span><span class="sxs-lookup"><span data-stu-id="d0f19-182">At a very minimum, the absence of the following patches have been known to cause problems on Azure and so these must be included in the kernel.</span></span> <span data-ttu-id="d0f19-183">Ebben a listában, de semmiképpen sem teljes körű teljes biztosít az összes disztribúciók számára:</span><span class="sxs-lookup"><span data-stu-id="d0f19-183">This list is by no means exhaustive or complete for all distributions:</span></span>

* [<span data-ttu-id="d0f19-184">ata_piix: késlelteti a lemezeket a Hyper-V illesztők alapértelmezés szerint</span><span class="sxs-lookup"><span data-stu-id="d0f19-184">ata_piix: defer disks to the Hyper-V drivers by default</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/ata/ata_piix.c?id=cd006086fa5d91414d8ff9ff2b78fbb593878e3c)
* [<span data-ttu-id="d0f19-185">storvsc: fiókot használja az átvitel közbeni csomagok a VISSZAÁLLÍTÁSI elérési úton</span><span class="sxs-lookup"><span data-stu-id="d0f19-185">storvsc: Account for in-transit packets in the RESET path</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/scsi/storvsc_drv.c?id=5c1b10ab7f93d24f29b5630286e323d1c5802d5c)
* [<span data-ttu-id="d0f19-186">storvsc: WRITE_SAME használatának elkerülése érdekében</span><span class="sxs-lookup"><span data-stu-id="d0f19-186">storvsc: avoid usage of WRITE_SAME</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=3e8f4f4065901c8dfc51407e1984495e1748c090)
* [<span data-ttu-id="d0f19-187">storvsc: RAID és virtuális állomás adapter illesztőprogramjai azonos írási letiltása</span><span class="sxs-lookup"><span data-stu-id="d0f19-187">storvsc: Disable WRITE SAME for RAID and virtual host adapter drivers</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=54b2b50c20a61b51199bedb6e5d2f8ec2568fb43)
* [<span data-ttu-id="d0f19-188">storvsc: NULL mutatót javítás kereshet vissza.</span><span class="sxs-lookup"><span data-stu-id="d0f19-188">storvsc: NULL pointer dereference fix</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=b12bb60d6c350b348a4e1460cd68f97ccae9822e)
* [<span data-ttu-id="d0f19-189">storvsc: ring pufferbe hibákat eredményezhet i/o-rögzítés</span><span class="sxs-lookup"><span data-stu-id="d0f19-189">storvsc: ring buffer failures may result in I/O freeze</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=e86fb5e8ab95f10ec5f2e9430119d5d35020c951)
* [<span data-ttu-id="d0f19-190">scsi_sysfs: __scsi_remove_device dupla végrehajtásának elleni védelem érdekében</span><span class="sxs-lookup"><span data-stu-id="d0f19-190">scsi_sysfs: protect against double execution of __scsi_remove_device</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/scsi_sysfs.c?id=be821fd8e62765de43cc4f0e2db363d0e30a7e9b)

## <a name="the-azure-linux-agent"></a><span data-ttu-id="d0f19-191">Az Azure Linux-ügynök</span><span class="sxs-lookup"><span data-stu-id="d0f19-191">The Azure Linux Agent</span></span>
<span data-ttu-id="d0f19-192">A [Azure Linux ügynök](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (waagent) szükséges megfelelően kiépítéséhez Linux virtuális gépek Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="d0f19-192">The [Azure Linux Agent](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (waagent) is required to properly provision a Linux virtual machine in Azure.</span></span> <span data-ttu-id="d0f19-193">Első a legújabb verzióra, a fájl problémákat, vagy a lekérési kérelmek elküldése a [Linux-ügynök GitHub-tárház](https://github.com/Azure/WALinuxAgent).</span><span class="sxs-lookup"><span data-stu-id="d0f19-193">You can get the latest version, file issues or submit pull requests at the [Linux Agent GitHub repo](https://github.com/Azure/WALinuxAgent).</span></span>

* <span data-ttu-id="d0f19-194">A Linux-ügynök az Apache 2.0 licence szabadul fel.</span><span class="sxs-lookup"><span data-stu-id="d0f19-194">The Linux agent is released under the Apache 2.0 license.</span></span> <span data-ttu-id="d0f19-195">Terjesztések már meg RPM vagy deb csomagok az ügynök, és így egyes esetekben ez telepíthetők és minimális erőfeszítéssel frissítése.</span><span class="sxs-lookup"><span data-stu-id="d0f19-195">Many distributions already provide RPM or deb packages for the agent, and so in some cases this can be installed and updated with little effort.</span></span>
* <span data-ttu-id="d0f19-196">Az Azure Linux ügynök szükséges Python v2.6 +.</span><span class="sxs-lookup"><span data-stu-id="d0f19-196">The Azure Linux Agent requires Python v2.6+.</span></span>
* <span data-ttu-id="d0f19-197">Az ügynök a python-pyasn1 modul is szükséges.</span><span class="sxs-lookup"><span data-stu-id="d0f19-197">The agent also requires the python-pyasn1 module.</span></span> <span data-ttu-id="d0f19-198">A legtöbb terjesztéseket adja meg, ez különálló csomagként telepíthető.</span><span class="sxs-lookup"><span data-stu-id="d0f19-198">Most distributions provide this as a separate package that can be installed.</span></span>
* <span data-ttu-id="d0f19-199">Bizonyos esetekben az Azure Linux ügynök nem lehet NetworkManager kompatibilis.</span><span class="sxs-lookup"><span data-stu-id="d0f19-199">In some cases the Azure Linux Agent may not be compatible with NetworkManager.</span></span> <span data-ttu-id="d0f19-200">A felosztás által biztosított RPM/Deb-csomagok számos NetworkManager beállítása ütközés waagent-csomagot, és így is el fogja távolítani NetworkManager telepít a Linux-ügynök csomagja.</span><span class="sxs-lookup"><span data-stu-id="d0f19-200">Many of the RPM/Deb packages provided by distributions configure NetworkManager as a conflict to the waagent package, and thus will uninstall NetworkManager when you install the Linux agent package.</span></span>

## <a name="general-linux-system-requirements"></a><span data-ttu-id="d0f19-201">Általános Linux rendszerre vonatkozó követelmények</span><span class="sxs-lookup"><span data-stu-id="d0f19-201">General Linux System Requirements</span></span>

* <span data-ttu-id="d0f19-202">A kernel rendszerindító sor LÁRVAJÁRAT vagy GRUB2 tartalmazza a következő paraméterek módosítása.</span><span class="sxs-lookup"><span data-stu-id="d0f19-202">Modify the kernel boot line in GRUB or GRUB2 to include the following parameters.</span></span> <span data-ttu-id="d0f19-203">Ez biztosítja az összes konzol küldi el az első soros port, amely segít az Azure által támogatott hibáinak feltárására:</span><span class="sxs-lookup"><span data-stu-id="d0f19-203">This will also ensure all console messages are sent to the first serial port, which can assist Azure support with debugging issues:</span></span>
  
        console=ttyS0,115200n8 earlyprintk=ttyS0,115200 rootdelay=300
  
    <span data-ttu-id="d0f19-204">Ez biztosítja az összes konzol küldi el az első soros port, amely segít az Azure által támogatott hibáinak feltárására.</span><span class="sxs-lookup"><span data-stu-id="d0f19-204">This will also ensure all console messages are sent to the first serial port, which can assist Azure support with debugging issues.</span></span>
  
    <span data-ttu-id="d0f19-205">A fentiek mellett javasoljuk, hogy *eltávolítása* ha vannak ilyenek. a következő paraméterekkel:</span><span class="sxs-lookup"><span data-stu-id="d0f19-205">In addition to the above, it is recommended to *remove* the following parameters if they exist:</span></span>
  
        rhgb quiet crashkernel=auto
  
    <span data-ttu-id="d0f19-206">Grafikus és a csendes rendszerindító egy felhőalapú környezetben, ahol azt szeretnénk, hogy minden a naplókat a soros port küldendő nem hasznosak.</span><span class="sxs-lookup"><span data-stu-id="d0f19-206">Graphical and quiet boot are not useful in a cloud environment where we want all the logs to be sent to the serial port.</span></span> <span data-ttu-id="d0f19-207">A `crashkernel` beállítás lehet, hogy szükség esetén konfigurálva balra, de vegye figyelembe, hogy ez a paraméter csökkenti a virtuális gépen legalább 128 MB, rendelkezésre álló memória mennyisége kisebb Virtuálisgép-méretek a problematikus esetleg.</span><span class="sxs-lookup"><span data-stu-id="d0f19-207">The `crashkernel` option may be left configured if desired, but note that this parameter will reduce the amount of available memory in the VM by 128MB or more, which may be problematic on the smaller VM sizes.</span></span>

* <span data-ttu-id="d0f19-208">Az Azure Linux ügynök telepítése</span><span class="sxs-lookup"><span data-stu-id="d0f19-208">Installing the Azure Linux Agent</span></span>
  
    <span data-ttu-id="d0f19-209">Az Azure Linux ügynök a Linux-lemezkép az Azure-on történő üzembe helyezéséhez szükséges.</span><span class="sxs-lookup"><span data-stu-id="d0f19-209">The Azure Linux Agent is required for provisioning a Linux image on Azure.</span></span>  <span data-ttu-id="d0f19-210">Terjesztések egy RPM vagy Deb-csomagot (a csomag neve általában "WALinuxAgent" vagy "walinuxagent"), adja meg az ügynök.</span><span class="sxs-lookup"><span data-stu-id="d0f19-210">Many distributions provide the agent as an RPM or Deb package (the package is typically called 'WALinuxAgent' or 'walinuxagent').</span></span>  <span data-ttu-id="d0f19-211">Az ügynök is telepítheti manuálisan lépéseit a [Linux-ügynök útmutató](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="d0f19-211">The agent can also be installed manually by following the steps in the [Linux Agent Guide](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

* <span data-ttu-id="d0f19-212">Győződjön meg arról, hogy az SSH-kiszolgálót telepítse és konfigurálja a rendszerindítás elindításához.</span><span class="sxs-lookup"><span data-stu-id="d0f19-212">Ensure that the SSH server is installed and configured to start at boot time.</span></span>  <span data-ttu-id="d0f19-213">Ez általában az alapértelmezett beállítás.</span><span class="sxs-lookup"><span data-stu-id="d0f19-213">This is usually the default.</span></span>

* <span data-ttu-id="d0f19-214">Ne hozzon létre lapozóterület meg az operációsrendszer-lemez</span><span class="sxs-lookup"><span data-stu-id="d0f19-214">Do not create swap space on the OS disk</span></span>
  
    <span data-ttu-id="d0f19-215">Az Azure Linux ügynök automatikusan konfigurálhatók a lapozóterület használata a helyi erőforrás lemezt a virtuális Géphez csatolt Azure kiépítése után.</span><span class="sxs-lookup"><span data-stu-id="d0f19-215">The Azure Linux Agent can automatically configure swap space using the local resource disk that is attached to the VM after provisioning on Azure.</span></span> <span data-ttu-id="d0f19-216">Vegye figyelembe, hogy a helyi erőforrás lemez egy *ideiglenes* lemezre, és előfordulhat, hogy szerepelnek, ha a virtuális gép van platformelőfizetés.</span><span class="sxs-lookup"><span data-stu-id="d0f19-216">Note that the local resource disk is a *temporary* disk, and might be emptied when the VM is deprovisioned.</span></span> <span data-ttu-id="d0f19-217">Az Azure Linux ügynök telepítése után (lásd az előző lépésben), annak megfelelően módosítsa a /etc/waagent.conf a következő paraméterekkel:</span><span class="sxs-lookup"><span data-stu-id="d0f19-217">After installing the Azure Linux Agent (see previous step), modify the following parameters in /etc/waagent.conf appropriately:</span></span>
  
        ResourceDisk.Format=y
        ResourceDisk.Filesystem=ext4
        ResourceDisk.MountPoint=/mnt/resource
        ResourceDisk.EnableSwap=y
        ResourceDisk.SwapSizeMB=2048    ## NOTE: set this to whatever you need it to be.

* <span data-ttu-id="d0f19-218">Utolsó lépésként, a virtuális gép kiosztásának megszüntetése a következő parancsok futtatásával:</span><span class="sxs-lookup"><span data-stu-id="d0f19-218">As a final step, run the following commands to deprovision the virtual machine:</span></span>
  
        # sudo waagent -force -deprovision
        # export HISTSIZE=0
        # logout
  
  > [!NOTE]
  > <span data-ttu-id="d0f19-219">A Virtualbox jelenhetnek meg a következő hiba futtatása után "waagent-force - deprovision": `[Errno 5] Input/output error`.</span><span class="sxs-lookup"><span data-stu-id="d0f19-219">On Virtualbox you may see the following error after running 'waagent -force -deprovision': `[Errno 5] Input/output error`.</span></span> <span data-ttu-id="d0f19-220">Ez a hibaüzenet nem fontos, és figyelmen kívül lesz hagyva.</span><span class="sxs-lookup"><span data-stu-id="d0f19-220">This error message is not critical and can be ignored.</span></span>
  > 
  > 

* <span data-ttu-id="d0f19-221">Szüksége lesz majd, állítsa le a virtuális gépet, és a virtuális merevlemez feltöltése az Azure-bA.</span><span class="sxs-lookup"><span data-stu-id="d0f19-221">You will then need to shut down the virtual machine and upload the VHD to Azure.</span></span>

