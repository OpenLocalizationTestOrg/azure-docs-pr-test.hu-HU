---
title: "Lemez titkosítási hibaelhárítási aaaAzure |} Microsoft Docs"
description: "Ez a cikk hibaelhárítási tippek a Microsoft Azure lemez Encryption for Windows és Linux IaaS virtuális gépeket."
services: security
documentationcenter: na
author: deventiwari
manager: avibm
editor: yuridio
ms.assetid: ce0e23bd-07eb-43af-a56c-aa1a73bdb747
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/27/2017
ms.author: devtiw
ms.openlocfilehash: 2ecb8df1fb869e3bf8f3be4be4494e6485e75695
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-disk-encryption-troubleshooting-guide"></a><span data-ttu-id="64126-103">Azure Disk Encryption hibaelhárítási útmutatója</span><span class="sxs-lookup"><span data-stu-id="64126-103">Azure Disk Encryption Troubleshooting Guide</span></span>

<span data-ttu-id="64126-104">Ez az útmutató informatikai (IT) szakemberek készült, információk biztonsági elemzőknek, és felhő rendszergazdák, amelynek a szervezet Azure disk encryption használ, és útmutatást tootroubleshoot lemez-titkosítást kell kapcsolatos hiba lépett fel.</span><span class="sxs-lookup"><span data-stu-id="64126-104">This guide is for information technology (IT) professionals, information security analysts, and cloud administrators whose organizations are using Azure disk encryption and need guidance tootroubleshoot disk-encryption related issues.</span></span>

## <a name="troubleshooting-linux-os-disk-encryption"></a><span data-ttu-id="64126-105">Hibaelhárítási Linux operációsrendszer-lemez titkosítása</span><span class="sxs-lookup"><span data-stu-id="64126-105">Troubleshooting Linux OS disk encryption</span></span>

<span data-ttu-id="64126-106">Linux operációsrendszer-lemez titkosítása operációs rendszer hello meghajtó előzetes toorunning kell választania azt a folyamatot, hello teljes lemez titkosítása.</span><span class="sxs-lookup"><span data-stu-id="64126-106">Linux OS disk encryption must unmount hello OS drive prior toorunning it through hello full disk encryption process.</span></span>   <span data-ttu-id="64126-107">Ha nem tudja, egy hibaüzenet, a "toounmount után nem sikerült..."</span><span class="sxs-lookup"><span data-stu-id="64126-107">If it cannot, an error message of "failed toounmount after…"</span></span> <span data-ttu-id="64126-108">a hibaüzenet valószínűleg toooccur.</span><span class="sxs-lookup"><span data-stu-id="64126-108">error message is likely toooccur.</span></span>

<span data-ttu-id="64126-109">Ennek az oka valószínűleg, amikor az operációs rendszer lemeztitkosítás kísérletet egy virtuális gép célkörnyezet módosított vagy a támogatott készlet gyűjtemény lemezképből megváltozott.</span><span class="sxs-lookup"><span data-stu-id="64126-109">This is most likely when OS disk encryption is attempted on a target VM environment that has been modified or changed from its supported stock gallery image.</span></span>  <span data-ttu-id="64126-110">Hello támogatott kép, amely zavarhatja a hello bővítmény képességét toounmount hello OS meghajtó eltéréseket közé:</span><span class="sxs-lookup"><span data-stu-id="64126-110">Examples of deviations from hello supported image, which can interfere with hello extension’s ability toounmount hello OS drive include:</span></span>
- <span data-ttu-id="64126-111">Testreszabott lemezképeket, amelyek már nem felel meg egy támogatott fájlrendszeren és/vagy a particionálási sémát.</span><span class="sxs-lookup"><span data-stu-id="64126-111">Customized images that no longer match a supported file system and/or partitioning scheme.</span></span>
- <span data-ttu-id="64126-112">Alkalmazások, például víruskereső, Docker, SAP, MongoDB vagy hello az operációs rendszer előzetes tooencryption futó Apache Cassandra testreszabott lemezképeket.</span><span class="sxs-lookup"><span data-stu-id="64126-112">Customized images with applications such as antivirus, Docker, SAP, MongoDB, or Apache Cassandra running in hello OS prior tooencryption.</span></span>  <span data-ttu-id="64126-113">Ezek az alkalmazások nehéz tooterminate, és nyitott fájlok kezeli az operációs rendszer toohello meghajtó megőrzését, ha a hello meghajtó nem, hibát okozó nem lehet.</span><span class="sxs-lookup"><span data-stu-id="64126-113">These applications are difficult tooterminate, and when they retain open file handles toohello OS drive, hello drive cannot be unmounted, causing failure.</span></span>
- <span data-ttu-id="64126-114">Egyéni futtatott parancsfájlok, a közelségi kapcsolat toohello titkosítási lépés zavaró, és ez a hiba miatt idő bezárásához.</span><span class="sxs-lookup"><span data-stu-id="64126-114">Custom scripts that run in close time proximity toohello encryption step can interfere and cause this failure.</span></span> <span data-ttu-id="64126-115">Ez akkor fordulhat elő, ha a Resource Manager-sablon meghatározása több bővítmények tooexecute egyszerre, vagy ha egy egyéni parancsprogramok futtatására szolgáló bővítmény vagy a másik művelet fut egyidejűleg toodisk titkosítás.</span><span class="sxs-lookup"><span data-stu-id="64126-115">This can happen when a Resource Manager template defines multiple extensions tooexecute simultaneously, or when a custom script extension or other action is run simultaneously toodisk encryption.</span></span>   <span data-ttu-id="64126-116">Szerializálása és lépéseket elkülönítése hello probléma esetleg elhárítható.</span><span class="sxs-lookup"><span data-stu-id="64126-116">Serializing and isolating such steps may resolve hello issue.</span></span>
- <span data-ttu-id="64126-117">Ha SELinux nem lett letiltva előzetes tooenabling titkosítási, hello leválasztása lépés sikertelen lesz.</span><span class="sxs-lookup"><span data-stu-id="64126-117">When SELinux has not been disabled prior tooenabling encryption, hello unmount step fails.</span></span>  <span data-ttu-id="64126-118">SELinux titkosítási befejeződését követően lehet újra engedélyezni.</span><span class="sxs-lookup"><span data-stu-id="64126-118">SELinux can be re-enabled after encryption has completed.</span></span>
- <span data-ttu-id="64126-119">Ha hello operációsrendszer-lemez egy LVM sémát használ (bár korlátozott LVM adatok támogatása nem érhető el, az operációs rendszer LVM lemez nem)</span><span class="sxs-lookup"><span data-stu-id="64126-119">When hello OS disk is using an LVM scheme (although limited LVM data disk support is available, LVM OS disk is not)</span></span>
- <span data-ttu-id="64126-120">Ha minimális memória feltételeknek nem felel meg (az operációs rendszer lemeztitkosítás 7GB ajánlott)</span><span class="sxs-lookup"><span data-stu-id="64126-120">When minimum memory requirements are not met (7GB is suggested for OS disk encryption)</span></span>
- <span data-ttu-id="64126-121">Amikor adatokat /mnt/ könyvtár, vagy egymással (például /mnt/data1 /mnt/data2, /data3 + /data3/data4, stb.) úton csatlakoztatta a rekurzív módon lett volna</span><span class="sxs-lookup"><span data-stu-id="64126-121">When data drives have been recursively mounted under /mnt/ directory, or each other (for example, /mnt/data1, /mnt/data2, /data3 + /data3/data4, etc.)</span></span>
- <span data-ttu-id="64126-122">Ha más Azure Disk Encryption [Előfeltételek](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption) Linux nem felel meg</span><span class="sxs-lookup"><span data-stu-id="64126-122">When other Azure Disk Encryption [prerequisites](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption) for Linux are not met</span></span>

## <a name="unable-tooencrypt"></a><span data-ttu-id="64126-123">Nem lehet tooencrypt</span><span class="sxs-lookup"><span data-stu-id="64126-123">Unable tooencrypt</span></span>

<span data-ttu-id="64126-124">Bizonyos esetekben hello Linux lemeztitkosítás jelenik meg a "Az operációs rendszer lemeztitkosítás lépések" Beragadt toobe és SSH le van tiltva.</span><span class="sxs-lookup"><span data-stu-id="64126-124">In some cases, hello Linux disk encryption appears toobe stuck at "OS disk encryption started" and SSH is disabled.</span></span> <span data-ttu-id="64126-125">A folyamat eltarthat egy készlet gyűjtemény rendszerképre 3-16 órás toocomplete között.</span><span class="sxs-lookup"><span data-stu-id="64126-125">This process can take between 3-16 hours toocomplete on a stock gallery image.</span></span>  <span data-ttu-id="64126-126">Ha multi-TB-os méret adatlemezt ad hozzá, hello folyamat napig is eltarthat.</span><span class="sxs-lookup"><span data-stu-id="64126-126">If multi-TB size data disks are added, hello process may take days.</span></span> <span data-ttu-id="64126-127">hello Linux operációs rendszert futtató lemez titkosítási feladatütemezési ideiglenesen leválasztja az operációs rendszer hello meghajtó, és végrehajtja blokkonként titkosítási hello teljes operációsrendszer-lemez, a titkosított állapotában tudják azt megelőzően.</span><span class="sxs-lookup"><span data-stu-id="64126-127">hello Linux OS disk encryption sequence unmounts hello OS drive temporarily, and performs block by block encryption of hello entire OS disk, before remounting it in its encrypted state.</span></span>   <span data-ttu-id="64126-128">Eltérően Azure Disk Encryption használatát a Windows, Linux lemez titkosítása nem egyidejű használatának engedélyezése hello VM amíg hello titkosítás folyamatban van.</span><span class="sxs-lookup"><span data-stu-id="64126-128">Unlike Azure Disk Encryption on Windows, Linux Disk Encryption does not allow concurrent use of hello VM while hello encryption is in progress.</span></span>  <span data-ttu-id="64126-129">hello teljesítményétől hello VM hello mérete hello lemez, és hogy hello tárfiók alapját standard vagy prémium (SSD) tárhelyre, például jelentős mértékben befolyásolhatja hello szükséges idő toocomplete titkosítás.</span><span class="sxs-lookup"><span data-stu-id="64126-129">hello performance characteristics of hello VM, including hello size of hello disk and whether hello storage account is backed by standard or premium (SSD) storage, can greatly influence hello time required toocomplete encryption.</span></span>

<span data-ttu-id="64126-130">toocheck állapot hello Feladatnézetben mező hello által visszaadott [Get-AzureRmVmDiskEncryptionStatus](https://docs.microsoft.com/powershell/module/azurerm.compute/get-azurermvmdiskencryptionstatus) parancs lekérhető.</span><span class="sxs-lookup"><span data-stu-id="64126-130">toocheck status, hello ProgressMessage field returned from hello [Get-AzureRmVmDiskEncryptionStatus](https://docs.microsoft.com/powershell/module/azurerm.compute/get-azurermvmdiskencryptionstatus) command can be polled.</span></span>   <span data-ttu-id="64126-131">Amíg az operációs rendszer hello meghajtó titkosított, hello virtuális gép egy karbantartási állapotba kerül, és SSH is letiltott tooprevent bármely megszűnésének toohello folyamatban.</span><span class="sxs-lookup"><span data-stu-id="64126-131">While hello OS drive is being encrypted, hello VM enters a servicing state, and SSH is also disabled tooprevent any disruption toohello ongoing process.</span></span>  <span data-ttu-id="64126-132">EncryptionInProgress készül hello többségének hello idő, amíg titkosítási van folyamatban, majd később több óráig arra kéri a virtuális gép toorestart hello VMRestartPending üzenetet.</span><span class="sxs-lookup"><span data-stu-id="64126-132">EncryptionInProgress will be reported for hello majority of hello time while encryption is in progress, followed several hours later with a VMRestartPending message prompting toorestart hello VM.</span></span>  <span data-ttu-id="64126-133">Példa:</span><span class="sxs-lookup"><span data-stu-id="64126-133">For example:</span></span>


```
PS > Get-AzureRmVMDiskEncryptionStatus -ResourceGroupName $resourceGroupName -VMName $vmName
OsVolumeEncrypted          : EncryptionInProgress
DataVolumesEncrypted       : EncryptionInProgress
OsVolumeEncryptionSettings : Microsoft.Azure.Management.Compute.Models.DiskEncryptionSettings
ProgressMessage            : OS disk encryption started

PS > Get-AzureRmVMDiskEncryptionStatus -ResourceGroupName $resourceGroupName -VMName $vmName
OsVolumeEncrypted          : VMRestartPending
DataVolumesEncrypted       : Encrypted
OsVolumeEncryptionSettings : Microsoft.Azure.Management.Compute.Models.DiskEncryptionSettings
ProgressMessage            : OS disk successfully encrypted, please reboot hello VM
```

<span data-ttu-id="64126-134">Egyszer kéri a tooreboot hello virtuális gép, és hello virtuális gép újraindítása, és mivel a 2-3 percet hello újraindítás és a végső lépéseket toobe hello cél végre, miután hello állapot üzenet jelzi, hogy a titkosítás végül befejeződött.</span><span class="sxs-lookup"><span data-stu-id="64126-134">Once prompted tooreboot hello VM, and after restarting hello VM, and giving 2-3 minutes for hello reboot and for final steps toobe performed on hello target, hello status message will indicate that encryption has finally completed.</span></span>   <span data-ttu-id="64126-135">Ez az üzenet nem érhető el, ha titkosított hello OS meghajtó le várt toobe készen áll, és a hello VM toobe használható újra.</span><span class="sxs-lookup"><span data-stu-id="64126-135">Once this message is available, hello encrypted OS drive is expected toobe ready for use and for hello VM toobe usable again.</span></span>

<span data-ttu-id="64126-136">Azokban az esetekben, ahol az ebben a sorozatban nem fordult elő vagy ha rendszerindítási információk, állapotüzenetet vagy egyéb hiba mutatók jelentést, hogy az operációs rendszer titkosítási hello középső (például ha a jelen útmutatóban ismertetett hello "sikertelen toounmount" hiba azért jelent meg), a folyamat sikertelen toorestore hello VM hátsó toohello pillanatkép vagy készült biztonsági másolatok közvetlenül megelőző tooencryption ajánlott.</span><span class="sxs-lookup"><span data-stu-id="64126-136">In cases where this sequence was not seen, or if boot information, progress message, or other error indicators report that OS encryption has failed in hello middle of this process (for example if you are seeing hello "failed toounmount" error described in this guide), it is recommended toorestore hello VM back toohello snapshot or backup taken immediately prior tooencryption.</span></span>  <span data-ttu-id="64126-137">Előzetes toohello következő kísérlet, akkor javasolt toore-értékelje ki a virtuális gép hello hello jellemzői, és győződjön meg arról, hogy a szükséges előfeltételek maradéktalanul teljesülnek-e.</span><span class="sxs-lookup"><span data-stu-id="64126-137">Prior toohello next attempt, it is suggested toore-evaluate hello characteristics of hello VM and ensure that all prerequisites are satisfied.</span></span>

## <a name="troubleshooting-azure-disk-encryption-behind-a-firewall"></a><span data-ttu-id="64126-138">Hibaelhárítás az Azure Disk Encryption tűzfal mögött</span><span class="sxs-lookup"><span data-stu-id="64126-138">Troubleshooting Azure Disk Encryption behind a Firewall</span></span>
<span data-ttu-id="64126-139">Ha kapcsolatot korlátozza egy tűzfal, a proxy követelmény vagy a hálózati biztonsági csoport (NSG) beállításainak hello képességét hello bővítmény tooperform szükséges feladatok is megszakad.</span><span class="sxs-lookup"><span data-stu-id="64126-139">When connectivity is restricted by a firewall, proxy requirement, or network security group (NSG) settings, hello ability of hello extension tooperform needed tasks can be disrupted.</span></span>   <span data-ttu-id="64126-140">Ez például a "Hello virtuális gép nem érhető el a bővítmény állapotát" állapotüzenetek eredményezhet és várt forgatókönyvekben toofinish sikertelenek lesznek.</span><span class="sxs-lookup"><span data-stu-id="64126-140">This can result in status messages such as "Extension status not available on hello VM" and in expected scenarios failing toofinish.</span></span>  <span data-ttu-id="64126-141">hello szakaszok rendelkezik néhány tűzfal kapcsolatos gyakori hibák, lehetséges, hogy vizsgálni.</span><span class="sxs-lookup"><span data-stu-id="64126-141">hello sections that follow has some common firewall issues that you may investigate.</span></span>

### <a name="network-security-groups"></a><span data-ttu-id="64126-142">Network security groups (Hálózati biztonsági csoportok)</span><span class="sxs-lookup"><span data-stu-id="64126-142">Network security groups</span></span>
<span data-ttu-id="64126-143">A hálózati biztonsági csoport beállításai továbbra is engedélyeznie kell a hello végpont toomeet dokumentált hello hálózati konfiguráció [Előfeltételek](https://docs.microsoft.com/azure/security/azure-security-disk-encryption#prerequisites) a lemez titkosításához.</span><span class="sxs-lookup"><span data-stu-id="64126-143">Any network security group settings applied must still allow hello endpoint toomeet hello documented network configuration [prerequisites](https://docs.microsoft.com/azure/security/azure-security-disk-encryption#prerequisites) for disk encryption.</span></span>

### <a name="azure-keyvault-behind-firewall"></a><span data-ttu-id="64126-144">Tűzfal mögött található Azure Keyvault</span><span class="sxs-lookup"><span data-stu-id="64126-144">Azure Keyvault behind firewall</span></span>
<span data-ttu-id="64126-145">hello méretű képes tooaccess kulcstároló kell lennie.</span><span class="sxs-lookup"><span data-stu-id="64126-145">hello VM must be able tooaccess key vault.</span></span> <span data-ttu-id="64126-146">Tekintse meg a hozzáférés tookey tartalék hello által kezelt tűzfal mögül tooguidance [Key Vault](https://docs.microsoft.com/azure/key-vault/key-vault-access-behind-firewall) csapatával.</span><span class="sxs-lookup"><span data-stu-id="64126-146">Refer tooguidance on access tookey fault from behind a firewall that is maintained by hello [Key Vault](https://docs.microsoft.com/azure/key-vault/key-vault-access-behind-firewall) team.</span></span>

### <a name="linux-package-management-behind-firewall"></a><span data-ttu-id="64126-147">Linux-csomag felügyeleti tűzfal mögött</span><span class="sxs-lookup"><span data-stu-id="64126-147">Linux package management behind firewall</span></span>
<span data-ttu-id="64126-148">Futási időben Azure Disk Encryption Linux hello cél terjesztési csomag felügyeleti rendszer tooinstall szükséges előfeltételként szükséges összetevők előzetes tooenabling titkosítási támaszkodik.</span><span class="sxs-lookup"><span data-stu-id="64126-148">At run time, Azure Disk Encryption for Linux relies on hello target distribution’s package management system tooinstall needed prerequisite components prior tooenabling encryption.</span></span>  <span data-ttu-id="64126-149">Ha a tűzfal beállításainak hello VM, hogy nem tud toodownload, és telepíti ezeket az összetevőket, majd további hibák várható.</span><span class="sxs-lookup"><span data-stu-id="64126-149">If firewall settings prevent hello VM from being able toodownload and install these components, then subsequent failures are expected.</span></span>    <span data-ttu-id="64126-150">hello lépéseket tooconfigure ez terjesztési változhat.</span><span class="sxs-lookup"><span data-stu-id="64126-150">hello steps tooconfigure this may vary by distribution.</span></span>  <span data-ttu-id="64126-151">A Red Hat Ha a proxy szükség, győződjön meg arról, hogy előfizetés-kezelő és yum megfelelően vannak beállítva nélkülözhetetlen.</span><span class="sxs-lookup"><span data-stu-id="64126-151">On Red Hat, when a proxy is required, ensuring that subscription-manager and yum are set up properly is vital.</span></span>  <span data-ttu-id="64126-152">Lásd: [ez](https://access.redhat.com/solutions/189533) Red Hat támogatási cikk erről a témakörről.</span><span class="sxs-lookup"><span data-stu-id="64126-152">See [this](https://access.redhat.com/solutions/189533) Red Hat support article on this topic.</span></span>  

## <a name="troubleshooting-windows-server-2016-server-core"></a><span data-ttu-id="64126-153">Windows Server 2016 Server Core hibaelhárítása</span><span class="sxs-lookup"><span data-stu-id="64126-153">Troubleshooting Windows Server 2016 Server Core</span></span>

<span data-ttu-id="64126-154">A Windows Server 2016 Server Core az hello bdehdcfg összetevő nem áll rendelkezésre, alapértelmezés szerint.</span><span class="sxs-lookup"><span data-stu-id="64126-154">On Windows Server 2016 Server Core, hello bdehdcfg component is not available by default.</span></span> <span data-ttu-id="64126-155">Ez az összetevő Azure Disk Encryption használata szükséges.</span><span class="sxs-lookup"><span data-stu-id="64126-155">This component is required by Azure Disk Encryption.</span></span>

<span data-ttu-id="64126-156">tooworkaround ezt a problémát, a következő 4 fájlok mappából egy Windows Server 2016 Data Center VM toohello c:\windows\system32 hello Server Core-lemezkép másolása hello:</span><span class="sxs-lookup"><span data-stu-id="64126-156">tooworkaround this issue, copy hello following 4 files from a Windows Server 2016 Data Center VM toohello c:\windows\system32 folder of hello Server Core image:</span></span>

```
bdehdcfg.exe
bdehdcfglib.dll
bdehdcfglib.dll.mui
bdehdcfg.exe.mui
```

<span data-ttu-id="64126-157">Ezután futtassa a következő parancs hello:</span><span class="sxs-lookup"><span data-stu-id="64126-157">Then, run hello following command:</span></span>

```
bdehdcfg.exe -target default
```

<span data-ttu-id="64126-158">Ezzel létrehoz egy 550MB rendszerpartíció, és ezután a rendszer újraindítása után a Diskpart toocheck hello köteteket használ, és a folytatáshoz.</span><span class="sxs-lookup"><span data-stu-id="64126-158">This will create a 550MB system partition and then after a reboot, you can use Diskpart toocheck hello volumes, and proceed.</span></span>  

<span data-ttu-id="64126-159">Példa:</span><span class="sxs-lookup"><span data-stu-id="64126-159">For example:</span></span>

```
DISKPART> list vol

  Volume ###  Ltr  Label        Fs     Type        Size     Status     Info
  ----------  ---  -----------  -----  ----------  -------  ---------  --------
  Volume 0     C                NTFS   Partition    126 GB  Healthy    Boot
  Volume 1                      NTFS   Partition    550 MB  Healthy    System
  Volume 2     D   Temporary S  NTFS   Partition     13 GB  Healthy    Pagefile
```
## <a name="see-also"></a><span data-ttu-id="64126-160">Lásd még:</span><span class="sxs-lookup"><span data-stu-id="64126-160">See also</span></span>
<span data-ttu-id="64126-161">Ebből a dokumentumból megismerte kapcsolatos gyakori problémákat, az Azure disk encryption használatát, és hogyan tootroubleshoot.</span><span class="sxs-lookup"><span data-stu-id="64126-161">In this document, you learned more about some common issues in Azure disk encryption, and how tootroubleshoot.</span></span> <span data-ttu-id="64126-162">Ez a szolgáltatás és a funkció kapcsolatos további információk:</span><span class="sxs-lookup"><span data-stu-id="64126-162">For more information about this service and its capability read:</span></span>

- [<span data-ttu-id="64126-163">Az Azure Security Centerben lemeztitkosítás alkalmazása</span><span class="sxs-lookup"><span data-stu-id="64126-163">Apply disk encryption in Azure Security Center</span></span>](https://docs.microsoft.com/azure/security-center/security-center-apply-disk-encryption)
- [<span data-ttu-id="64126-164">Azure virtuális gép titkosítása</span><span class="sxs-lookup"><span data-stu-id="64126-164">Encrypt an Azure Virtual Machine</span></span>](https://docs.microsoft.com/azure/security-center/security-center-disk-encryption)
- [<span data-ttu-id="64126-165">Az Azure Data Encryption nyugalmi</span><span class="sxs-lookup"><span data-stu-id="64126-165">Azure Data Encryption-at-Rest</span></span>](https://docs.microsoft.com/azure/security/azure-security-encryption-atrest)
