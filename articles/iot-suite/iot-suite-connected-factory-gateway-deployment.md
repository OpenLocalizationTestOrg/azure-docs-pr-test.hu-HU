---
title: "az Azure IoT Suite csatlakoztatott aaaDeploy gyári átjáró |} Microsoft Docs"
description: "Hogyan toodeploy Windows vagy Linux tooenable kapcsolat toohello átjáró csatlakoztatva gyári előre konfigurált megoldás."
services: 
suite: iot-suite
documentationcenter: na
author: dominicbetts
manager: timlt
editor: 
ms.service: iot-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/24/2017
ms.author: dobett
ms.openlocfilehash: 72436dec60eda0de20143f362fe740b0c4412f36
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="deploy-a-gateway-on-windows-or-linux-for-hello-connected-factory-preconfigured-solution"></a><span data-ttu-id="17116-103">Telepítsen egy átjárót a Windows vagy Linux csatlakoztatott hello előre konfigurált gyári megoldás</span><span class="sxs-lookup"><span data-stu-id="17116-103">Deploy a gateway on Windows or Linux for hello connected factory preconfigured solution</span></span>

<span data-ttu-id="17116-104">hello szükséges szoftver toodeploy egy átjáró csatlakoztatva hello előre konfigurált gyári megoldás két részből áll:</span><span class="sxs-lookup"><span data-stu-id="17116-104">hello software required toodeploy a gateway for hello connected factory preconfigured solution has two components:</span></span>

* <span data-ttu-id="17116-105">Hello *OPC Proxy* hoz létre a kapcsolat tooIoT központ.</span><span class="sxs-lookup"><span data-stu-id="17116-105">hello *OPC Proxy* establishes a connection tooIoT Hub.</span></span> <span data-ttu-id="17116-106">Hello *OPC Proxy* majd vár hello parancs és a vezérlő üzeneteit integrált hello csatlakoztatott gyári megoldás portálon futó OPC böngésző.</span><span class="sxs-lookup"><span data-stu-id="17116-106">hello *OPC Proxy* then waits for command and control messages from hello integrated OPC Browser that runs in hello connected factory solution portal.</span></span>
* <span data-ttu-id="17116-107">Hello *OPC Publisher* csatlakoztatja tooexisting helyszíni OPC EE-kiszolgálókat és telemetriai üzenetek továbbítja őket a tooIoT központ.</span><span class="sxs-lookup"><span data-stu-id="17116-107">hello *OPC Publisher* connects tooexisting on-premises OPC UA servers and forwards telemetry messages from them tooIoT Hub.</span></span>

<span data-ttu-id="17116-108">Mindkét összetevők nyílt forráskódú és érhetők el a Githubon forrásként és a Docker tárolóként:</span><span class="sxs-lookup"><span data-stu-id="17116-108">Both components are open-source and are available as source on GitHub and as Docker containers:</span></span>

| <span data-ttu-id="17116-109">GitHub</span><span class="sxs-lookup"><span data-stu-id="17116-109">GitHub</span></span> | <span data-ttu-id="17116-110">DockerHub</span><span class="sxs-lookup"><span data-stu-id="17116-110">DockerHub</span></span> |
| ------ | --------- |
| <span data-ttu-id="17116-111">[OPC-közzétevő][lnk-publisher-github]</span><span class="sxs-lookup"><span data-stu-id="17116-111">[OPC Publisher][lnk-publisher-github]</span></span> | <span data-ttu-id="17116-112">[OPC-közzétevő][lnk-publisher-docker]</span><span class="sxs-lookup"><span data-stu-id="17116-112">[OPC Publisher][lnk-publisher-docker]</span></span> |
| <span data-ttu-id="17116-113">[OPC Proxy][lnk-proxy-github]</span><span class="sxs-lookup"><span data-stu-id="17116-113">[OPC Proxy][lnk-proxy-github]</span></span> | <span data-ttu-id="17116-114">[OPC Proxy][lnk-proxy-docker]</span><span class="sxs-lookup"><span data-stu-id="17116-114">[OPC Proxy][lnk-proxy-docker]</span></span> |

<span data-ttu-id="17116-115">Nincs nyilvánosan elérhető IP-cím vagy a hello átjáró tűzfal lyuk vagy összetevőhöz szükségesek.</span><span class="sxs-lookup"><span data-stu-id="17116-115">No public-facing IP address or holes in hello gateway firewall are required for either component.</span></span> <span data-ttu-id="17116-116">hello OPC Proxy és OPC szoftvergyártó használja a 443-as, 5671 és 8883 csak kimenő portok.</span><span class="sxs-lookup"><span data-stu-id="17116-116">hello OPC Proxy and OPC Publisher use only outbound ports 443, 5671, and 8883.</span></span>

<span data-ttu-id="17116-117">hello cikkben leírt lépéseket mutatja be egy átjárót Docker akár toodeploy [Windows](#windows-deployment) vagy [Linux](#linux-deployment).</span><span class="sxs-lookup"><span data-stu-id="17116-117">hello steps in this article show you how toodeploy a gateway using Docker on either [Windows](#windows-deployment) or [Linux](#linux-deployment).</span></span> <span data-ttu-id="17116-118">hello átjáró lehetővé teszi, hogy a kapcsolat kapcsolódó toohello előre konfigurált gyári megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-118">hello gateway enables connectivity toohello connected factory preconfigured solution.</span></span>

> [!NOTE]
> <span data-ttu-id="17116-119">hello átjáró szoftver hello Docker-tároló futó [Azure IoT peremhálózati].</span><span class="sxs-lookup"><span data-stu-id="17116-119">hello gateway software that runs in hello Docker container is [Azure IoT Edge].</span></span>

## <a name="windows-deployment"></a><span data-ttu-id="17116-120">Windows központi telepítése</span><span class="sxs-lookup"><span data-stu-id="17116-120">Windows deployment</span></span>

> [!NOTE]
> <span data-ttu-id="17116-121">Ha még nem rendelkezik egy átjáróeszköz, a Microsoft azt javasolja, vásárol egy kereskedelmi átjáró partnereink egyikéből.</span><span class="sxs-lookup"><span data-stu-id="17116-121">If you don't yet have a gateway device, Microsoft recommends you buy a commercial gateway from one of our partners.</span></span> <span data-ttu-id="17116-122">A Microsoft hello [Azure IoT eszköz katalógus] átjáró eszközöket hello kompatibilis csatlakozó gyári megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-122">Visit hello [Azure IoT device catalog] for a list of gateway devices compatible with hello connected factory solution.</span></span> <span data-ttu-id="17116-123">Hajtsa végre a hello vonatkozó utasításokat hello eszköz tooset hello átjáró mentése.</span><span class="sxs-lookup"><span data-stu-id="17116-123">Follow hello instructions that come with hello device tooset up hello gateway.</span></span> <span data-ttu-id="17116-124">Másik megoldásként használhatja a következő utasításokat toomanually állítsa be a meglévő átjáró egyik hello.</span><span class="sxs-lookup"><span data-stu-id="17116-124">Alternatively, use hello following instructions toomanually set up one of your existing gateways.</span></span>

### <a name="install-docker"></a><span data-ttu-id="17116-125">Docker telepítése</span><span class="sxs-lookup"><span data-stu-id="17116-125">Install Docker</span></span>

<span data-ttu-id="17116-126">Telepítés [Docker for Windows] átjáró Windows-alapú eszközén.</span><span class="sxs-lookup"><span data-stu-id="17116-126">Install [Docker for Windows] on your Windows-based gateway device.</span></span> <span data-ttu-id="17116-127">Windows Docker a telepítés során válassza ki a gazdagép gép tooshare a Docker egyik meghajtójára.</span><span class="sxs-lookup"><span data-stu-id="17116-127">During Windows Docker setup, select a drive on your host machine tooshare with Docker.</span></span> <span data-ttu-id="17116-128">a következő képernyőkép azt mutatja be, a Windows rendszeren hello D meghajtó megosztása hello:</span><span class="sxs-lookup"><span data-stu-id="17116-128">hello following screenshot shows sharing hello D drive on your Windows system:</span></span>

![Docker telepítése][img-install-docker]

<span data-ttu-id="17116-130">Ezután hozzon létre egy nevű **docker** hello hello gyökérmappájában megosztott meghajtót.</span><span class="sxs-lookup"><span data-stu-id="17116-130">Then create a folder called **docker** in hello root of hello shared drive.</span></span>
<span data-ttu-id="17116-131">Ezt a lépést hajtsa végre a hello docker telepítése után **beállítások** menü.</span><span class="sxs-lookup"><span data-stu-id="17116-131">You can also perform this step after installing docker from hello **Settings** menu.</span></span>

### <a name="configure-hello-gateway"></a><span data-ttu-id="17116-132">Hello átjáró konfigurálása</span><span class="sxs-lookup"><span data-stu-id="17116-132">Configure hello gateway</span></span>

1. <span data-ttu-id="17116-133">Hello kell **iothubowner** kapcsolati karakterlánca a Azure IoT Suite csatlakoztatott gyári telepítési toocomplete hello átjárójának telepítéséhez.</span><span class="sxs-lookup"><span data-stu-id="17116-133">You need hello **iothubowner** connection string of your Azure IoT Suite connected factory deployment toocomplete hello gateway deployment.</span></span> <span data-ttu-id="17116-134">A hello [Azure-portálon], keresse meg az IoT-központ hello erőforráscsoportban csatlakoztatott hello gyári megoldás üzembe helyezésekor létrehozott tooyour.</span><span class="sxs-lookup"><span data-stu-id="17116-134">In hello [Azure portal], navigate tooyour IoT Hub in hello resource group created when you deployed hello connected factory solution.</span></span> <span data-ttu-id="17116-135">Kattintson a **megosztott elérési házirendek** tooaccess hello **iothubowner** kapcsolati karakterlánc:</span><span class="sxs-lookup"><span data-stu-id="17116-135">Click **Shared access policies** tooaccess hello **iothubowner** connection string:</span></span>

    ![Az IoT-központ kapcsolati karakterlánc hello keresése][img-hub-connection]

    <span data-ttu-id="17116-137">Másolás hello **kapcsolati karakterlánc – elsődleges kulcs** érték.</span><span class="sxs-lookup"><span data-stu-id="17116-137">Copy hello **Connection string--primary key** value.</span></span>

1. <span data-ttu-id="17116-138">Az IoT Hub hello két átjáró modulok futtatásával hello átjáró konfigurálása **után** a parancssorból:</span><span class="sxs-lookup"><span data-stu-id="17116-138">Configure hello gateway for your IoT Hub by running hello two gateway modules **once** from a command prompt with:</span></span>

    `docker run -it --rm -h <ApplicationName> -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v //D/docker:/root/.dotnet/corefx/cryptography/x509stores microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName> "<IoTHubOwnerConnectionString>"`

    `docker run -it --rm -v //D/docker:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -i -c "<IoTHubOwnerConnectionString>" -D /mapped/cs.db`

    * <span data-ttu-id="17116-139">**&lt;ApplicationName&gt;**  hello neve toogive tooyour OPC EE Publisher hello formátumban **publisher.&lt; a teljesen minősített tartománynevét&gt;**.</span><span class="sxs-lookup"><span data-stu-id="17116-139">**&lt;ApplicationName&gt;** is hello name toogive tooyour OPC UA Publisher in hello format **publisher.&lt;your fully qualified domain name&gt;**.</span></span> <span data-ttu-id="17116-140">Például, ha a gyári hálózati nevezik **myfactorynetwork.com**, hello **ApplicationName** értéke **publisher.myfactorynetwork.com**.</span><span class="sxs-lookup"><span data-stu-id="17116-140">For example, if your factory network is called **myfactorynetwork.com**, hello **ApplicationName** value is **publisher.myfactorynetwork.com**.</span></span>
    * <span data-ttu-id="17116-141">**&lt;IoTHubOwnerConnectionString&gt;**  hello van **iothubowner** hello előző lépésben másolt kapcsolati karakterláncot.</span><span class="sxs-lookup"><span data-stu-id="17116-141">**&lt;IoTHubOwnerConnectionString&gt;** is hello **iothubowner** connection string you copied in hello previous step.</span></span> <span data-ttu-id="17116-142">Ez a kapcsolati karakterlánc csak ebben a lépésben követően nem kell hello a következő lépéseket:</span><span class="sxs-lookup"><span data-stu-id="17116-142">This connection string is only used in this step, you don’t need it in hello following steps:</span></span>

    <span data-ttu-id="17116-143">Használhat hello leképezett D:\\docker mappa (hello `-v` argumentum) későbbi toopersist hello hello átjáró modulok használata két X.509-tanúsítványokat.</span><span class="sxs-lookup"><span data-stu-id="17116-143">You use hello mapped D:\\docker folder (hello `-v` argument) later toopersist hello two X.509 certificates that hello gateway modules use.</span></span>

### <a name="run-hello-gateway"></a><span data-ttu-id="17116-144">Hello átjáró futtatása</span><span class="sxs-lookup"><span data-stu-id="17116-144">Run hello gateway</span></span>

1. <span data-ttu-id="17116-145">Indítsa újra a hello átjárót hello a következő parancsok használatával:</span><span class="sxs-lookup"><span data-stu-id="17116-145">Restart hello gateway using hello following commands:</span></span>

    `docker run -it --rm -h <ApplicationName> --expose 62222 -p 62222:62222 -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/Logs -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v //D/docker:/shared -v //D/docker:/root/.dotnet/corefx/cryptography/x509stores -e _GW_PNFP="/shared/publishednodes.JSON" microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName>`

    `docker run -it --rm -v //D/docker:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -D /mapped/cs.db`

1. <span data-ttu-id="17116-146">Biztonsági okokból hello két X.509-tanúsítványokat a hello D: megőrzött\\docker mappát tartalmaz hello titkos kulcsot.</span><span class="sxs-lookup"><span data-stu-id="17116-146">For security reasons, hello two X.509 certificates persisted in hello D:\\docker folder contain hello private key.</span></span> <span data-ttu-id="17116-147">Korlátozza a hozzáférést toothis mappa toohello hitelesítő adatait (jellemzően **rendszergazdák**) toorun hello Docker-tároló használja.</span><span class="sxs-lookup"><span data-stu-id="17116-147">Limit access toothis folder toohello credentials (typically **Administrators**) you use toorun hello Docker container.</span></span> <span data-ttu-id="17116-148">Kattintson a jobb gombbal hello D:\\docker mappát, válassza a **tulajdonságok**, majd **biztonsági**, majd **szerkesztése**.</span><span class="sxs-lookup"><span data-stu-id="17116-148">Right-click hello D:\\docker folder, choose **Properties**, then **Security**, and then **Edit**.</span></span> <span data-ttu-id="17116-149">Adjon **rendszergazdák** teljes hozzáférés, és távolítsa el a többi felhasználó:</span><span class="sxs-lookup"><span data-stu-id="17116-149">Give **Administrators** full control and remove everyone else:</span></span>

    ![Támogatás engedélyek tooDocker megosztás][img-docker-share]

1. <span data-ttu-id="17116-151">Ellenőrizze a hálózati kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="17116-151">Verify network connectivity.</span></span> <span data-ttu-id="17116-152">A parancssorból, írja be a hello parancsot `ping publisher.<your fully qualified domain name>` tooping az átjárót.</span><span class="sxs-lookup"><span data-stu-id="17116-152">From a command prompt, enter hello command `ping publisher.<your fully qualified domain name>` tooping your gateway.</span></span> <span data-ttu-id="17116-153">Ha hello cél nem érhető el, adja hozzá a hello IP-cím és az átjáró toohello hosts fájl meg az átjáró nevét.</span><span class="sxs-lookup"><span data-stu-id="17116-153">If hello destination is unreachable, add hello IP address and name of your gateway toohello hosts file on your gateway.</span></span> <span data-ttu-id="17116-154">hello hosts fájl található hello **Windows\\System32\\illesztőprogramok\\stb** mappát.</span><span class="sxs-lookup"><span data-stu-id="17116-154">hello hosts file is located in hello **Windows\\System32\\drivers\\etc** folder.</span></span>

1. <span data-ttu-id="17116-155">Ezt követően próbálja tooconnect toohello publisher hello átjáró futó helyi OPC EE-ügyfél használatával.</span><span class="sxs-lookup"><span data-stu-id="17116-155">Next, try tooconnect toohello publisher using a local OPC UA client running on hello gateway.</span></span> <span data-ttu-id="17116-156">hello OPC EE-végpont URL-cím `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span><span class="sxs-lookup"><span data-stu-id="17116-156">hello OPC UA endpoint URL is `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span></span> <span data-ttu-id="17116-157">Ha egy OPC EE-ügyfél nincs telepítve, töltse le és használja az [nyílt forráskódú OPC EE ügyfél].</span><span class="sxs-lookup"><span data-stu-id="17116-157">If you don't have an OPC UA client, you can download and use an [open-source OPC UA client].</span></span>

1. <span data-ttu-id="17116-158">Ha ezek a helyi tesztek sikeresen befejeződött, keresse meg a toohello **csatlakoztassa a saját OPC EE kiszolgálót** lapjára hello csatlakoztatott gyári megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-158">When you have successfully completed these local tests, browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="17116-159">Adja meg a hello publisher végponti URL-cím (`tcp://publisher.<your fully qualified domain name>:62222`), majd **Connect**.</span><span class="sxs-lookup"><span data-stu-id="17116-159">Enter hello publisher endpoint URL (`tcp://publisher.<your fully qualified domain name>:62222`) and click **Connect**.</span></span> <span data-ttu-id="17116-160">Egy tanúsítvány figyelmeztetés, majd kattintson a **folytatása.**</span><span class="sxs-lookup"><span data-stu-id="17116-160">You get a certificate warning, then click **Proceed.**</span></span> <span data-ttu-id="17116-161">Ezután hibaüzenetet kap, hogy hello publisher hello EE webes ügyfél nem megbízható.</span><span class="sxs-lookup"><span data-stu-id="17116-161">Next you get an error that hello publisher doesn’t trust hello UA Web Client.</span></span> <span data-ttu-id="17116-162">tooresolve a hiba, a Másolás hello **EE-webügyfél** hello tanúsítványt **D:\\docker\\elutasított tanúsítványok\\Tanúsítványos** mappa toohello **D:\\docker\\EE-alkalmazások\\Tanúsítványos** hello átjáró mappájába.</span><span class="sxs-lookup"><span data-stu-id="17116-162">tooresolve this error, copy hello **UA Web Client** certificate from hello **D:\\docker\\Rejected Certificates\\certs** folder toohello **D:\\docker\\UA Applications\\certs** folder on hello gateway.</span></span> <span data-ttu-id="17116-163">Nem kell toorestart hello átjáró.</span><span class="sxs-lookup"><span data-stu-id="17116-163">You do not need toorestart of hello gateway.</span></span> <span data-ttu-id="17116-164">Ismételje meg ezt a lépést.</span><span class="sxs-lookup"><span data-stu-id="17116-164">Repeat this step.</span></span> <span data-ttu-id="17116-165">Csatlakoztathatja a toohello átjáró hello felhőből, és készen áll a tooadd OPC EE kiszolgálók toohello megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-165">You can now connect toohello gateway from hello cloud, and you are ready tooadd OPC UA servers toohello solution.</span></span>

### <a name="add-your-opc-ua-servers"></a><span data-ttu-id="17116-166">A OPC EE-kiszolgálók hozzáadása</span><span class="sxs-lookup"><span data-stu-id="17116-166">Add your OPC UA servers</span></span>

1. <span data-ttu-id="17116-167">Keresse meg a toohello **csatlakoztassa a saját OPC EE kiszolgálót** lapjára hello csatlakoztatott gyári megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-167">Browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="17116-168">Ugyanezek a lépések szakasz tooestablish megelőző hello hasonlóan csatlakoztatott gyári portal hello és hello OPC EE-kiszolgáló közötti megbízható hello kövesse.</span><span class="sxs-lookup"><span data-stu-id="17116-168">Follow hello same steps as in hello preceding section tooestablish trust between hello connected factory portal and hello OPC UA server.</span></span> <span data-ttu-id="17116-169">Ebben a lépésben a hello hello tanúsítványok kölcsönös megbízható gyári portal és hello OPC EE-kiszolgáló csatlakoztatva, és kapcsolatot hoz létre hoz létre.</span><span class="sxs-lookup"><span data-stu-id="17116-169">This step establishes a mutual trust of hello certificates from hello connected factory portal and hello OPC UA server and creates a connection.</span></span>

1. <span data-ttu-id="17116-170">Keresse a hello OPC EE csomópontok fájának OPC EE-kiszolgálóját, kattintson a jobb gombbal a hello OPC csomópontok, és válassza ki **közzététele**.</span><span class="sxs-lookup"><span data-stu-id="17116-170">Browse hello OPC UA nodes tree of your OPC UA server, right-click hello OPC nodes, and select **publish**.</span></span> <span data-ttu-id="17116-171">Az ilyen módon toowork közzétételi hello OPC EE-kiszolgáló és hello publisher hello kell lennie ugyanazon a hálózaton.</span><span class="sxs-lookup"><span data-stu-id="17116-171">For publishing toowork this way, hello OPC UA server and hello publisher must be on hello same network.</span></span> <span data-ttu-id="17116-172">Ez azt jelenti, ha hello teljesen minősített tartománynév hello kiadó lesz **publisher.mydomain.com** majd teljesen minősített tartománynevét hello OPC EE kiszolgálónak kell lennie, például hello **myopcuaserver.mydomain.com**. Ha a telepítő különböző, kézzel is felveheti a csomópontok toohello publishesnodes.json fájl található a hello **D:\\docker** mappa.</span><span class="sxs-lookup"><span data-stu-id="17116-172">In other words, if hello fully qualified domain name of hello publisher is **publisher.mydomain.com** then hello fully qualified domain name of hello OPC UA server must be, for example, **myopcuaserver.mydomain.com**. If your setup is different, you can manually add nodes toohello publishesnodes.json file found in hello **D:\\docker** folder.</span></span> <span data-ttu-id="17116-173">hello publishesnodes.json fájl automatikusan létrejön a hello először sikeres közzététele egy OPC-csomópont.</span><span class="sxs-lookup"><span data-stu-id="17116-173">hello publishesnodes.json file is automatically generated on hello first successful publish of an OPC node.</span></span>

1. <span data-ttu-id="17116-174">Telemetria most forgalomáramlás hello átjáró eszközről.</span><span class="sxs-lookup"><span data-stu-id="17116-174">Telemetry now flows from hello gateway device.</span></span> <span data-ttu-id="17116-175">Hello telemetriai megtekintheti a hello **gyári helyek** hello csatlakoztatott gyári portál ábrázolása **új előállító**.</span><span class="sxs-lookup"><span data-stu-id="17116-175">You can view hello telemetry in hello **Factory Locations** view of hello connected factory portal under **New Factory**.</span></span>

## <a name="linux-deployment"></a><span data-ttu-id="17116-176">Linux-telepítés</span><span class="sxs-lookup"><span data-stu-id="17116-176">Linux deployment</span></span>

> [!NOTE]
> <span data-ttu-id="17116-177">Ha még nem rendelkezik egy átjáróeszköz, a Microsoft azt javasolja, vásárol egy kereskedelmi átjáró partnereink egyikéből.</span><span class="sxs-lookup"><span data-stu-id="17116-177">If you don't yet have a gateway device, Microsoft recommends you buy a commercial gateway from one of our partners.</span></span> <span data-ttu-id="17116-178">A Microsoft hello [Azure IoT eszköz katalógus] átjáró eszközöket hello kompatibilis csatlakozó gyári megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-178">Visit hello [Azure IoT device catalog] for a list of gateway devices compatible with hello connected factory solution.</span></span> <span data-ttu-id="17116-179">Hajtsa végre a hello vonatkozó utasításokat hello eszköz tooset hello átjáró mentése.</span><span class="sxs-lookup"><span data-stu-id="17116-179">Follow hello instructions that come with hello device tooset up hello gateway.</span></span> <span data-ttu-id="17116-180">Másik megoldásként használhatja a következő utasításokat toomanually állítsa be a meglévő átjáró egyik hello.</span><span class="sxs-lookup"><span data-stu-id="17116-180">Alternatively, use hello following instructions toomanually set up one of your existing gateways.</span></span>

<span data-ttu-id="17116-181">[Telepítse a Docker] Linux átjáró eszközén.</span><span class="sxs-lookup"><span data-stu-id="17116-181">[Install Docker] on your Linux gateway device.</span></span>

### <a name="configure-hello-gateway"></a><span data-ttu-id="17116-182">Hello átjáró konfigurálása</span><span class="sxs-lookup"><span data-stu-id="17116-182">Configure hello gateway</span></span>

1. <span data-ttu-id="17116-183">Hello kell **iothubowner** kapcsolati karakterlánca a Azure IoT Suite csatlakoztatott gyári telepítési toocomplete hello átjárójának telepítéséhez.</span><span class="sxs-lookup"><span data-stu-id="17116-183">You need hello **iothubowner** connection string of your Azure IoT Suite connected factory deployment toocomplete hello gateway deployment.</span></span> <span data-ttu-id="17116-184">A hello [Azure-portálon], keresse meg az IoT-központ hello erőforráscsoportban csatlakoztatott hello gyári megoldás üzembe helyezésekor létrehozott tooyour.</span><span class="sxs-lookup"><span data-stu-id="17116-184">In hello [Azure portal], navigate tooyour IoT Hub in hello resource group created when you deployed hello connected factory solution.</span></span> <span data-ttu-id="17116-185">Kattintson a **megosztott elérési házirendek** tooaccess hello **iothubowner** kapcsolati karakterlánc:</span><span class="sxs-lookup"><span data-stu-id="17116-185">Click **Shared access policies** tooaccess hello **iothubowner** connection string:</span></span>

    ![Az IoT-központ kapcsolati karakterlánc hello keresése][img-hub-connection]

    <span data-ttu-id="17116-187">Másolás hello **kapcsolati karakterlánc – elsődleges kulcs** érték.</span><span class="sxs-lookup"><span data-stu-id="17116-187">Copy hello **Connection string--primary key** value.</span></span>

1. <span data-ttu-id="17116-188">Az IoT Hub hello két átjáró modulok futtatásával hello átjáró konfigurálása **után** egy rendszerhéjból rendelkező:</span><span class="sxs-lookup"><span data-stu-id="17116-188">Configure hello gateway for your IoT Hub by running hello two gateway modules **once** from a shell with:</span></span>

    `sudo docker run -it --rm -h <ApplicationName> -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/ -v /shared:/root/.dotnet/corefx/cryptography/x509stores microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName> "<IoTHubOwnerConnectionString>"`

    `sudo docker run --rm -it -v /shared:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -i -c "<IoTHubOwnerConnectionString>" -D /mapped/cs.db`

    * <span data-ttu-id="17116-189">**&lt;ApplicationName&gt;**  OPC EE hello Alkalmazásátjáró hello formátumú hoz létre hello hello neve **publisher.&lt; a teljesen minősített tartománynevét&gt;**.</span><span class="sxs-lookup"><span data-stu-id="17116-189">**&lt;ApplicationName&gt;** is hello name of hello OPC UA application hello gateway creates in hello format **publisher.&lt;your fully qualified domain name&gt;**.</span></span> <span data-ttu-id="17116-190">Például **publisher.microsoft.com**.</span><span class="sxs-lookup"><span data-stu-id="17116-190">For example, **publisher.microsoft.com**.</span></span>
    * <span data-ttu-id="17116-191">**&lt;IoTHubOwnerConnectionString&gt;**  hello van **iothubowner** hello előző lépésben másolt kapcsolati karakterláncot.</span><span class="sxs-lookup"><span data-stu-id="17116-191">**&lt;IoTHubOwnerConnectionString&gt;** is hello **iothubowner** connection string you copied in hello previous step.</span></span> <span data-ttu-id="17116-192">Ez a kapcsolati karakterlánc csak ebben a lépésben követően nem kell hello a következő lépéseket:</span><span class="sxs-lookup"><span data-stu-id="17116-192">This connection string is only used in this step, you don’t need it in hello following steps:</span></span>

    <span data-ttu-id="17116-193">Hello használata **/ megosztott** mappa (hello `-v` argumentum) későbbi toopersist hello hello átjáró modulok használata két X.509-tanúsítványokat.</span><span class="sxs-lookup"><span data-stu-id="17116-193">You use hello **/shared** folder (hello `-v` argument) later toopersist hello two X.509 certificates that hello gateway modules use.</span></span>

### <a name="run-hello-gateway"></a><span data-ttu-id="17116-194">Hello átjáró futtatása</span><span class="sxs-lookup"><span data-stu-id="17116-194">Run hello gateway</span></span>

1. <span data-ttu-id="17116-195">Indítsa újra a hello átjárót hello a következő parancsok használatával:</span><span class="sxs-lookup"><span data-stu-id="17116-195">Restart hello gateway using hello following commands:</span></span>

    `sudo docker run -it -h <ApplicationName> --expose 62222 -p 62222:62222 –-rm -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/Logs -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v /shared:/shared -v /shared:/root/.dotnet/corefx/cryptography/x509stores -e _GW_PNFP="/shared/publishednodes.JSON" microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName>`

    `sudo docker run -it -v /shared:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -D /mapped/cs.db`

1. <span data-ttu-id="17116-196">Biztonsági okokból hello két X.509-tanúsítványokat a hello megőrzött **/ megosztott** mappát tartalmaz hello titkos kulcsot.</span><span class="sxs-lookup"><span data-stu-id="17116-196">For security reasons, hello two X.509 certificates persisted in hello **/shared** folder contain hello private key.</span></span> <span data-ttu-id="17116-197">Korlát hozzáférés toothis mappa toohello hitelesítő adatokkal kell toorun hello Docker-tároló.</span><span class="sxs-lookup"><span data-stu-id="17116-197">Limit access toothis folder toohello credentials you use toorun hello Docker container.</span></span> <span data-ttu-id="17116-198">tooset hello engedélyeinek **legfelső szintű** csak, használja a hello `chmod` rendszerhéj-parancs hello mappára.</span><span class="sxs-lookup"><span data-stu-id="17116-198">tooset hello permissions for **root** only, use hello `chmod` shell command on hello folder.</span></span>

1. <span data-ttu-id="17116-199">Ellenőrizze a hálózati kapcsolatot.</span><span class="sxs-lookup"><span data-stu-id="17116-199">Verify network connectivity.</span></span> <span data-ttu-id="17116-200">Adja meg a rendszerhéj hello parancs `ping publisher.<your fully qualified domain name>` tooping az átjárót.</span><span class="sxs-lookup"><span data-stu-id="17116-200">From a shell, enter hello command `ping publisher.<your fully qualified domain name>` tooping your gateway.</span></span> <span data-ttu-id="17116-201">Ha hello cél nem érhető el, adja hozzá a hello IP-cím és az átjáró tooyour hosts fájl meg az átjáró nevét.</span><span class="sxs-lookup"><span data-stu-id="17116-201">If hello destination is unreachable, add hello IP address and name of your gateway tooyour hosts file on your gateway.</span></span> <span data-ttu-id="17116-202">hello hosts fájl található hello **/stb** mappát.</span><span class="sxs-lookup"><span data-stu-id="17116-202">hello hosts file is located in hello **/etc** folder.</span></span>

1. <span data-ttu-id="17116-203">Ezt követően próbálja tooconnect toohello publisher hello átjáró futó helyi OPC EE-ügyfél használatával.</span><span class="sxs-lookup"><span data-stu-id="17116-203">Next, try tooconnect toohello publisher using a local OPC UA client running on hello gateway.</span></span> <span data-ttu-id="17116-204">hello OPC EE-végpont URL-cím `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span><span class="sxs-lookup"><span data-stu-id="17116-204">hello OPC UA endpoint URL is `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span></span> <span data-ttu-id="17116-205">Ha egy OPC EE-ügyfél nincs telepítve, töltse le és használja az [nyílt forráskódú OPC EE ügyfél].</span><span class="sxs-lookup"><span data-stu-id="17116-205">If you don't have an OPC UA client, you can download and use an [open-source OPC UA client].</span></span>

1. <span data-ttu-id="17116-206">Ha ezek a helyi tesztek sikeresen befejeződött, keresse meg a toohello **csatlakoztassa a saját OPC EE kiszolgálót** lapjára hello csatlakoztatott gyári megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-206">When you have successfully completed these local tests, browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="17116-207">Adja meg a hello publisher végponti URL-cím (`tcp://publisher.<your fully qualified domain name>:62222`), majd **Connect**.</span><span class="sxs-lookup"><span data-stu-id="17116-207">Enter hello publisher endpoint URL (`tcp://publisher.<your fully qualified domain name>:62222`) and click **Connect**.</span></span> <span data-ttu-id="17116-208">Egy tanúsítvány figyelmeztetés, majd kattintson a **folytatása.**</span><span class="sxs-lookup"><span data-stu-id="17116-208">You get a certificate warning, then click **Proceed.**</span></span> <span data-ttu-id="17116-209">Ezután hibaüzenetet kap, hogy hello publisher hello EE webes ügyfél nem megbízható.</span><span class="sxs-lookup"><span data-stu-id="17116-209">Next you get an error that hello publisher doesn’t trust hello UA Web Client.</span></span> <span data-ttu-id="17116-210">tooresolve a hiba, a Másolás hello **EE-webügyfél** hello tanúsítványt **/megosztott/elutasított tanúsítványok/Tanúsítványos** mappa toohello **/shared/UA alkalmazások/Tanúsítványos** hello átjáró mappájába.</span><span class="sxs-lookup"><span data-stu-id="17116-210">tooresolve this error, copy hello **UA Web Client** certificate from hello **/shared/Rejected Certificates/certs** folder toohello **/shared/UA Applications/certs** folder on hello gateway.</span></span> <span data-ttu-id="17116-211">Nem kell toorestart hello átjáró.</span><span class="sxs-lookup"><span data-stu-id="17116-211">You do not need toorestart of hello gateway.</span></span> <span data-ttu-id="17116-212">Ismételje meg ezt a lépést.</span><span class="sxs-lookup"><span data-stu-id="17116-212">Repeat this step.</span></span> <span data-ttu-id="17116-213">Csatlakoztathatja a toohello átjáró hello felhőből, és készen áll a tooadd OPC EE kiszolgálók toohello megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-213">You can now connect toohello gateway from hello cloud, and you are ready tooadd OPC UA servers toohello solution.</span></span>

### <a name="add-your-opc-ua-servers"></a><span data-ttu-id="17116-214">A OPC EE-kiszolgálók hozzáadása</span><span class="sxs-lookup"><span data-stu-id="17116-214">Add your OPC UA servers</span></span>

1. <span data-ttu-id="17116-215">Keresse meg a toohello **csatlakoztassa a saját OPC EE kiszolgálót** lapjára hello csatlakoztatott gyári megoldás.</span><span class="sxs-lookup"><span data-stu-id="17116-215">Browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="17116-216">Ugyanezek a lépések szakasz tooestablish megelőző hello hasonlóan csatlakoztatott gyári portal hello és hello OPC EE-kiszolgáló közötti megbízható hello kövesse.</span><span class="sxs-lookup"><span data-stu-id="17116-216">Follow hello same steps as in hello preceding section tooestablish trust between hello connected factory portal and hello OPC UA server.</span></span> <span data-ttu-id="17116-217">Ebben a lépésben a hello hello tanúsítványok kölcsönös megbízható gyári portal és hello OPC EE-kiszolgáló csatlakoztatva, és kapcsolatot hoz létre hoz létre.</span><span class="sxs-lookup"><span data-stu-id="17116-217">This step establishes a mutual trust of hello certificates from hello connected factory portal and hello OPC UA server and creates a connection.</span></span>

1. <span data-ttu-id="17116-218">Keresse a hello OPC EE csomópontok fájának OPC EE-kiszolgálóját, kattintson a jobb gombbal a hello OPC csomópontok, és válassza ki **közzététele**.</span><span class="sxs-lookup"><span data-stu-id="17116-218">Browse hello OPC UA nodes tree of your OPC UA server, right-click hello OPC nodes, and select **publish**.</span></span> <span data-ttu-id="17116-219">Az ilyen módon toowork közzétételi hello OPC EE-kiszolgáló és hello publisher hello kell lennie ugyanazon a hálózaton.</span><span class="sxs-lookup"><span data-stu-id="17116-219">For publishing toowork this way, hello OPC UA server and hello publisher must be on hello same network.</span></span> <span data-ttu-id="17116-220">Ez azt jelenti, ha hello teljesen minősített tartománynév hello kiadó lesz **publisher.mydomain.com** majd teljesen minősített tartománynevét hello OPC EE kiszolgálónak kell lennie, például hello **myopcuaserver.mydomain.com**. Ha a telepítő különböző, kézzel is felveheti a csomópontok toohello publishesnodes.json fájl található a hello **/ megosztott** mappát.</span><span class="sxs-lookup"><span data-stu-id="17116-220">In other words, if hello fully qualified domain name of hello publisher is **publisher.mydomain.com** then hello fully qualified domain name of hello OPC UA server must be, for example, **myopcuaserver.mydomain.com**. If your setup is different, you can manually add nodes toohello publishesnodes.json file found in hello **/shared** folder.</span></span> <span data-ttu-id="17116-221">hello publishesnodes.json automatikusan létrejön a hello először sikeres közzététele egy OPC-csomópont.</span><span class="sxs-lookup"><span data-stu-id="17116-221">hello publishesnodes.json is automatically generated on hello first successful publish of an OPC node.</span></span>

1. <span data-ttu-id="17116-222">Telemetria most forgalomáramlás hello átjáró eszközről.</span><span class="sxs-lookup"><span data-stu-id="17116-222">Telemetry now flows from hello gateway device.</span></span> <span data-ttu-id="17116-223">Hello telemetriai megtekintheti a hello **gyári helyek** hello csatlakoztatott gyári portál ábrázolása **új előállító**.</span><span class="sxs-lookup"><span data-stu-id="17116-223">You can view hello telemetry in hello **Factory Locations** view of hello connected factory portal under **New Factory**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="17116-224">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="17116-224">Next steps</span></span>

<span data-ttu-id="17116-225">hello csatlakoztatott gyári hello architektúrájával kapcsolatos további információkért toolearn előre konfigurált megoldás című [csatlakoztatott gyári előre konfigurált megoldás forgatókönyv][lnk-walkthrough].</span><span class="sxs-lookup"><span data-stu-id="17116-225">toolearn more about hello architecture of hello connected factory preconfigured solution, see [Connected factory preconfigured solution walkthrough][lnk-walkthrough].</span></span>

[img-install-docker]: ./media/iot-suite-connected-factory-gateway-deployment/image1.png
[img-hub-connection]: ./media/iot-suite-connected-factory-gateway-deployment/image2.png
[img-docker-share]: ./media/iot-suite-connected-factory-gateway-deployment/image3.png

[Docker for Windows]: https://www.docker.com/docker-windows
[Azure IoT eszköz katalógus]: https://catalog.azureiotsuite.com/?q=opc
[Azure-portálon]: http://portal.azure.com/
[nyílt forráskódú OPC EE ügyfél]: https://github.com/OPCFoundation/UA-.NETStandardLibrary/tree/master/SampleApplications/Samples/Client.Net4
[Telepítse a Docker]: https://www.docker.com/community-edition#/download
[lnk-walkthrough]: iot-suite-connected-factory-sample-walkthrough.md
[Azure IoT peremhálózati]: https://github.com/Azure/iot-edge

[lnk-publisher-github]: https://github.com/Azure/iot-edge-opc-publisher
[lnk-publisher-docker]: https://hub.docker.com/r/microsoft/iot-gateway-opc-ua
[lnk-proxy-github]: https://github.com/Azure/iot-edge-opc-proxy
[lnk-proxy-docker]: https://hub.docker.com/r/microsoft/iot-gateway-opc-ua-proxy