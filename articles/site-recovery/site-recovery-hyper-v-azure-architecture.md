---
title: "aaaHow Hyper-V replikáció tooAzure munka a Site Recovery szolgáltatásban működik? | Microsoft Docs"
description: "Ez a cikk ismerteti, hogyan működik a Hyper-V-replikáció az Azure Site Recoveryben"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/14/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-architecture-hyper-v-to-azure
ms.openlocfilehash: e982806b4d6cdec2f71f82d8c73c17cc50ad3c33
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-hyper-v-replication-tooazure-work"></a><span data-ttu-id="daf99-104">Hogyan működik a Hyper-V replikáció tooAzure?</span><span class="sxs-lookup"><span data-stu-id="daf99-104">How does Hyper-V replication tooAzure work?</span></span>

<span data-ttu-id="daf99-105">Ez a cikk toounderstand hello architektúra és a munkafolyamatokat a hello segítségével a Hyper-V replikáció tooAzure olvasási [Azure Site Recovery](site-recovery-overview.md) szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="daf99-105">Read this article toounderstand hello architecture and workflows for Hyper-V replication tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="daf99-106">Ez a cikk vagy hello hello alsó megjegyzések utáni [Azure Recovery Services fórumon](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="daf99-106">Post any comments at hello bottom of this article, or in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="daf99-107">A következő tooAzure hello replikálhatja:</span><span class="sxs-lookup"><span data-stu-id="daf99-107">You can replicate hello following tooAzure:</span></span>
- <span data-ttu-id="daf99-108">**Hyper-V VMM-mel**: System Center Virtual Machine Manager-felhőkben (VMM-felhőkben) felügyelt helyszíni Hyper-V-gazdagépeken található virtuális gépek.</span><span class="sxs-lookup"><span data-stu-id="daf99-108">**Hyper-V with VMM**: VMs located on on-premises Hyper-V hosts managed in  System Center Virtual MAchine Manager (VMM) clouds.</span></span> <span data-ttu-id="daf99-109">A gazdagépek bármilyen [támogatott operációs rendszert](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers) futtathatnak.</span><span class="sxs-lookup"><span data-stu-id="daf99-109">Hosts can be running any [supported operating system](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span></span> <span data-ttu-id="daf99-110">A [Hyper-V és az Azure által támogatott](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows) bármilyen vendég operációs rendszert futtató Hyper-V-alapú virtuális gépet replikálhat.</span><span class="sxs-lookup"><span data-stu-id="daf99-110">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>
- <span data-ttu-id="daf99-111">**Hyper-V VMM nélkül**: VMM-felhőkben nem felügyelt Hyper-V-gazdagépeken található helyszíni virtuális gépek.</span><span class="sxs-lookup"><span data-stu-id="daf99-111">**Hyper-V without VMM**: On-premises VMs located on Hyper-V hosts that aren't managed in VMM clouds.</span></span> <span data-ttu-id="daf99-112">Gazdagépek futtatható bármely hello [támogatott operációs rendszerek](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span><span class="sxs-lookup"><span data-stu-id="daf99-112">Hosts can run any of hello [supported operating systems](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span></span> <span data-ttu-id="daf99-113">A [Hyper-V és az Azure által támogatott](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows) bármilyen vendég operációs rendszert futtató Hyper-V-alapú virtuális gépet replikálhat.</span><span class="sxs-lookup"><span data-stu-id="daf99-113">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="daf99-114">Az architektúra összetevői</span><span class="sxs-lookup"><span data-stu-id="daf99-114">Architectural components</span></span>

<span data-ttu-id="daf99-115">**Terület**</span><span class="sxs-lookup"><span data-stu-id="daf99-115">**Area**</span></span> | <span data-ttu-id="daf99-116">**Összetevő**</span><span class="sxs-lookup"><span data-stu-id="daf99-116">**Component**</span></span> | <span data-ttu-id="daf99-117">**Részletek**</span><span class="sxs-lookup"><span data-stu-id="daf99-117">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="daf99-118">**Azure**</span><span class="sxs-lookup"><span data-stu-id="daf99-118">**Azure**</span></span> | <span data-ttu-id="daf99-119">Az Azure-ban szüksége van egy Microsoft Azure-fiókra, és Azure Storage-fiókra és egy Azure-hálózatra.</span><span class="sxs-lookup"><span data-stu-id="daf99-119">In Azure you need a Microsoft Azure account, an Azure storage account, and a Azure network.</span></span> | <span data-ttu-id="daf99-120">A Storage és a hálózat lehet Resource Manager-alapú vagy klasszikus fiók.</span><span class="sxs-lookup"><span data-stu-id="daf99-120">Storage and network can be Resource Manager-based, or classic accounts.</span></span><br/><br/> <span data-ttu-id="daf99-121">Hello tárfiók tárolja a replikált adatok, és az Azure virtuális gépek replikálása hello adatokkal jönnek létre, ha a feladatátvétel a helyszíni helyről.</span><span class="sxs-lookup"><span data-stu-id="daf99-121">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span><br/><br/> <span data-ttu-id="daf99-122">hello Azure virtuális gépek Azure-beli virtuális hálózat toohello csatlakozás, ha a jönnek létre.</span><span class="sxs-lookup"><span data-stu-id="daf99-122">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="daf99-123">**VMM-kiszolgáló**</span><span class="sxs-lookup"><span data-stu-id="daf99-123">**VMM server**</span></span> | <span data-ttu-id="daf99-124">VMM-felhőkben lévő Hyper-V-gazdagépek</span><span class="sxs-lookup"><span data-stu-id="daf99-124">Hyper-V hosts located in VMM clouds</span></span> | <span data-ttu-id="daf99-125">Ha a VMM-felhőkben felügyelt Hyper-V-gazdagépek, Recovery Services-tároló hello hello VMM-kiszolgáló regisztrálása.</span><span class="sxs-lookup"><span data-stu-id="daf99-125">If Hyper-V hosts are managed in VMM clouds, you register hello VMM server in hello Recovery Services vault.</span></span><br/><br/> <span data-ttu-id="daf99-126">A VMM-kiszolgálón hello hello Site Recovery Provider tooorchestrate replikációs az Azure-ral telepítése.</span><span class="sxs-lookup"><span data-stu-id="daf99-126">On hello VMM server you install hello Site Recovery Provider tooorchestrate replication with Azure.</span></span><br/><br/> <span data-ttu-id="daf99-127">Logikai van szüksége, és a Virtuálisgép-hálózatok tooconfigure hálózatleképezés beállításához.</span><span class="sxs-lookup"><span data-stu-id="daf99-127">You need logical and VM networks set up tooconfigure network mapping.</span></span> <span data-ttu-id="daf99-128">A Virtuálisgép-hálózat hello felhőhöz társított logikai hálózati csatolt tooa kell lennie.</span><span class="sxs-lookup"><span data-stu-id="daf99-128">A VM network should be linked tooa logical network that's associated with hello cloud.</span></span>
<span data-ttu-id="daf99-129">**Hyper-V gazdagép**</span><span class="sxs-lookup"><span data-stu-id="daf99-129">**Hyper-V host**</span></span> | <span data-ttu-id="daf99-130">A Hyper-V-kiszolgálók VMM-kiszolgálóval vagy anélkül is üzembe helyezhetők.</span><span class="sxs-lookup"><span data-stu-id="daf99-130">Hyper-V servers can be deployed with or without VMM server.</span></span> | <span data-ttu-id="daf99-131">Ha nem a VMM-kiszolgáló, a Site Recovery Provider telepítve van a hello állomás tooorchestrate replikálásához a Site Recovery keresztül hello hello internet.</span><span class="sxs-lookup"><span data-stu-id="daf99-131">If there's no VMM server, hello Site Recovery Provider is installed on hello host tooorchestrate replication with Site Recovery over hello internet.</span></span> <span data-ttu-id="daf99-132">A VMM-kiszolgáló esetén hello szolgáltató telepítve van rajta, nem pedig hello állomás.</span><span class="sxs-lookup"><span data-stu-id="daf99-132">If there's a VMM server, hello Provider is installed on it, and not on hello host.</span></span><br/><br/> <span data-ttu-id="daf99-133">hello állomás toohandle adatreplikáció hello Recovery Services Agent ügynök van telepítve.</span><span class="sxs-lookup"><span data-stu-id="daf99-133">hello Recovery Services agent is installed on hello host toohandle data replication.</span></span><br/><br/> <span data-ttu-id="daf99-134">A szolgáltató hello és hello ügynök kommunikációit a biztonságos és titkosított.</span><span class="sxs-lookup"><span data-stu-id="daf99-134">Communications from both hello Provider and hello agent are secure and encrypted.</span></span> <span data-ttu-id="daf99-135">Ezenfelül az Azure-tárfiókba replikált adatok is titkosítást kapnak.</span><span class="sxs-lookup"><span data-stu-id="daf99-135">Replicated data in Azure storage is also encrypted.</span></span>
<span data-ttu-id="daf99-136">**Hyper-V virtuális gépek**</span><span class="sxs-lookup"><span data-stu-id="daf99-136">**Hyper-V VMs**</span></span> | <span data-ttu-id="daf99-137">Egy vagy több hello Hyper-V gazdakiszolgálón futó virtuális gépek van szüksége.</span><span class="sxs-lookup"><span data-stu-id="daf99-137">You need one or more VMs on hello Hyper-V host server.</span></span> | <span data-ttu-id="daf99-138">Mit kell virtuális gépekre telepített tooexplicitly</span><span class="sxs-lookup"><span data-stu-id="daf99-138">Nothing needs tooexplicitly installed on VMs</span></span>

## <a name="deployment-steps"></a><span data-ttu-id="daf99-139">A központi telepítés lépései</span><span class="sxs-lookup"><span data-stu-id="daf99-139">Deployment steps</span></span>

1. <span data-ttu-id="daf99-140">**Azure**: beállítása hello Azure összetevőket.</span><span class="sxs-lookup"><span data-stu-id="daf99-140">**Azure**: You set up hello Azure components.</span></span> <span data-ttu-id="daf99-141">Javasoljuk, hogy a Site Recovery üzembe helyezésének megkezdése előtt hozza létre a Storage- és hálózati fiókokat.</span><span class="sxs-lookup"><span data-stu-id="daf99-141">We recommend you set up storage and network accounts before you begin Site Recovery deployment.</span></span>
2. <span data-ttu-id="daf99-142">**Tároló**: Hozzon létre egy Recovery Services-tárolót a Site Recoveryhez, és konfigurálja a tároló beállításait, például konfigurálja a forrás- és célbeállításokat, állítson be egy replikációs szabályzatot és engedélyezze a replikációt.</span><span class="sxs-lookup"><span data-stu-id="daf99-142">**Vault**: You create a Recovery Services vault for Site Recovery, and configure vault settings, including configuring source and target settings, setting up a replication policy, and enabling replication.</span></span>
3. <span data-ttu-id="daf99-143">**Forrás és cél**:</span><span class="sxs-lookup"><span data-stu-id="daf99-143">**Source and target**:</span></span>
    - <span data-ttu-id="daf99-144">**Hyper-V gazdagépek a VMM-felhőkben**: az adatforrás-beállítások megadása a részeként, töltse le és hello Azure Site Recovery Provider telepítése hello VMM-kiszolgálón, és minden Hyper-V gazdagépen hello Azure Recovery Services Agent ügynököt.</span><span class="sxs-lookup"><span data-stu-id="daf99-144">**Hyper-V hosts in VMM clouds**: As part of specifying source settings, you download and install hello Azure Site Recovery Provider on hello VMM server, and hello Azure Recovery Services agent on each Hyper-V host.</span></span> <span data-ttu-id="daf99-145">hello lesznek hello VMM-kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="daf99-145">hello source will be hello VMM server.</span></span> <span data-ttu-id="daf99-146">hello Azure célja.</span><span class="sxs-lookup"><span data-stu-id="daf99-146">hello target is Azure.</span></span>
    - <span data-ttu-id="daf99-147">Hyper-V gazdagépeket VMM nélkül: az adatforrás-beállítások megadása esetén töltse le, és hello szolgáltató és az ügynök telepítése minden Hyper-V gazdagépen.</span><span class="sxs-lookup"><span data-stu-id="daf99-147">Hyper-V hosts without VMM: When you specify source settings, you download and install hello Provider and agent on each Hyper-V host.</span></span> <span data-ttu-id="daf99-148">Központi telepítése során hello állomások gyűjt be a Hyper-V hely, és adja meg a hely hello forrásaként.</span><span class="sxs-lookup"><span data-stu-id="daf99-148">During deployment you gather hello hosts into a Hyper-V site, and specify this site as hello source.</span></span> <span data-ttu-id="daf99-149">hello Azure célja.</span><span class="sxs-lookup"><span data-stu-id="daf99-149">hello target is Azure.</span></span>

    <span data-ttu-id="daf99-150">![A VMM/Hyper-V replikáció tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V hely replikációs tooAzure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span><span class="sxs-lookup"><span data-stu-id="daf99-150">![Hyper-V/VMM replication tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V site replication tooAzure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span></span>


4. <span data-ttu-id="daf99-151">**Replikációs szabályzat**: hello Hyper-V hely vagy a VMM-felhő replikációs házirend létrehozása.</span><span class="sxs-lookup"><span data-stu-id="daf99-151">**Replication policy**: You create a replication policy for hello Hyper-V site or VMM cloud.</span></span> <span data-ttu-id="daf99-152">hello házirend alkalmazott tooall virtuális gépek gazdagépén hello hely vagy a felhőben található.</span><span class="sxs-lookup"><span data-stu-id="daf99-152">hello policy is applied tooall VMs located on hosts in hello site or cloud.</span></span>
5. <span data-ttu-id="daf99-153">**Replikáció engedélyezése**: Engedélyezi a replikációt a Hyper-V-alapú virtuális gépek számára.</span><span class="sxs-lookup"><span data-stu-id="daf99-153">**Enable replication**: You enable replication for Hyper-V VMs.</span></span> <span data-ttu-id="daf99-154">Kezdeti replikáció hello replikációs házirend-beállításoknak megfelelően.</span><span class="sxs-lookup"><span data-stu-id="daf99-154">Initial replication occurs in accordance with hello replication policy settings.</span></span> <span data-ttu-id="daf99-155">Adatok változások nyomon követése, és a különbözeti módosítások tooAzure replikálása hello kezdeti replikáció befejezését követően megkezdődik.</span><span class="sxs-lookup"><span data-stu-id="daf99-155">Data changes are tracked, and replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="daf99-156">Az elemek nyomon követett módosításait a rendszer .hrl fájlokban tárolja.</span><span class="sxs-lookup"><span data-stu-id="daf99-156">Tracked changes for an item are held in a .hrl file.</span></span>
6. <span data-ttu-id="daf99-157">**Feladatátvételi teszt**: futtatja, a teszt feladatátvételi toomake meg arról, hogy minden a várt módon működik.</span><span class="sxs-lookup"><span data-stu-id="daf99-157">**Test failover**:  You run a test failover toomake sure everything's working as expected.</span></span>

<span data-ttu-id="daf99-158">További információk az üzembe helyezésről:</span><span class="sxs-lookup"><span data-stu-id="daf99-158">Learn more about deployment:</span></span>
- [<span data-ttu-id="daf99-159">Hyper-V virtuális gép replikációs tooAzure - és a VMM az első lépései</span><span class="sxs-lookup"><span data-stu-id="daf99-159">Get started with Hyper-V VM replication tooAzure - with VMM</span></span>](site-recovery-vmm-to-azure.md)
- [<span data-ttu-id="daf99-160">Ismerkedés a Hyper-V virtuális gép replikációs tooAzure - VMM nélkül</span><span class="sxs-lookup"><span data-stu-id="daf99-160">Get started with Hyper-V VM replication tooAzure - without VMM</span></span>](site-recovery-hyper-v-site-to-azure.md)

## <a name="hyper-v-replication-workflow"></a><span data-ttu-id="daf99-161">A Hyper-V replikálás munkafolyamata</span><span class="sxs-lookup"><span data-stu-id="daf99-161">Hyper-V replication workflow</span></span>

### <a name="enable-protection"></a><span data-ttu-id="daf99-162">Védelem engedélyezése</span><span class="sxs-lookup"><span data-stu-id="daf99-162">Enable protection</span></span>

1. <span data-ttu-id="daf99-163">Miután engedélyezte a Hyper-V virtuális gépek védelmét, a hello Azure-portálon vagy a helyszíni hello **engedélyezni a védelmet** kezdődik.</span><span class="sxs-lookup"><span data-stu-id="daf99-163">After you enable protection for a Hyper-V VM, in hello Azure portal or on-premises, hello **Enable protection** starts.</span></span>
2. <span data-ttu-id="daf99-164">hello feladat ellenőrzi, hogy hello a gép megfelel az előfeltételeknek, hello meghívása előtt [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset hello-beállítások konfigurálása a replikáció.</span><span class="sxs-lookup"><span data-stu-id="daf99-164">hello job checks that hello machine complies with prerequisites, before invoking hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset up replication with hello settings you've configured.</span></span>
3. <span data-ttu-id="daf99-165">hello feladat elindul a kezdeti replikáció hello figyelőn [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) metódus tooinitialize teljes Virtuálisgép-replikációt és küldési hello VM virtuális lemezek tooAzure.</span><span class="sxs-lookup"><span data-stu-id="daf99-165">hello job starts initial replication by invoking hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) method, tooinitialize a full VM replication, and send hello VM's virtual disks tooAzure.</span></span>
4. <span data-ttu-id="daf99-166">Figyelheti a feladat hello hello **feladatok** fülre.      ![Feladatok listája](media/site-recovery-hyper-v-azure-architecture/image1.png)![Védelem engedélyezésének részletei](media/site-recovery-hyper-v-azure-architecture/image2.png)</span><span class="sxs-lookup"><span data-stu-id="daf99-166">You can monitor hello job in hello **Jobs** tab.      ![Jobs list](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Enable protection drill down](media/site-recovery-hyper-v-azure-architecture/image2.png)</span></span>

### <a name="initial-replication"></a><span data-ttu-id="daf99-167">Kezdeti replikálás</span><span class="sxs-lookup"><span data-stu-id="daf99-167">Initial replication</span></span>

1. <span data-ttu-id="daf99-168">A kezdeti replikálás indításakor egy [pillanatfelvétel készül a Hyper-V-alapú virtuális gépről](https://technet.microsoft.com/library/dd560637.aspx).</span><span class="sxs-lookup"><span data-stu-id="daf99-168">A [Hyper-V VM snapshot](https://technet.microsoft.com/library/dd560637.aspx) snapshot is taken when initial replication is triggered.</span></span>
2. <span data-ttu-id="daf99-169">Virtuális merevlemezek replikálását csak az összes másolt tooAzure fontosságúak.</span><span class="sxs-lookup"><span data-stu-id="daf99-169">Virtual hard disks are replicated one by one until they're all copied tooAzure.</span></span> <span data-ttu-id="daf99-170">Sikerült az időigényes, attól függően, hogy hello Virtuálisgép-méretet, és a hálózati sávszélességre.</span><span class="sxs-lookup"><span data-stu-id="daf99-170">It could take a while, depending on hello VM size, and network bandwidth.</span></span> <span data-ttu-id="daf99-171">toooptimize a hálózat használatát, lásd: [hogyan toomanage helyszíni tooAzure védelem hálózati sávszélesség használatának](https://support.microsoft.com/kb/3056159).</span><span class="sxs-lookup"><span data-stu-id="daf99-171">toooptimize your network usage, see [How toomanage on-premises tooAzure protection network bandwidth usage](https://support.microsoft.com/kb/3056159).</span></span>
3. <span data-ttu-id="daf99-172">Ha a lemezen változások történnek, amíg a kezdeti replikáció folyamatban van, hello Hyper-V Replica Replication Tracker mint Hyper-V replikálási naplók (.hrl) nyomon követi ezeket a módosításokat.</span><span class="sxs-lookup"><span data-stu-id="daf99-172">If disk changes occur while initial replication is in progress, hello Hyper-V Replica Replication Tracker tracks those changes as Hyper-V Replication Logs (.hrl).</span></span> <span data-ttu-id="daf99-173">Ezek a fájlok találhatók hello hello lemezek ugyanabban a mappában.</span><span class="sxs-lookup"><span data-stu-id="daf99-173">These files are located in hello same folder as hello disks.</span></span> <span data-ttu-id="daf99-174">Minden lemezhez tartozik egy .hrl-fájl toosecondary tárolási elküldendő.</span><span class="sxs-lookup"><span data-stu-id="daf99-174">Each disk has an associated .hrl file that will be sent toosecondary storage.</span></span>
4. <span data-ttu-id="daf99-175">hello pillanatkép és a naplófájlok fájlok lemezerőforrásokat használnak, amíg a kezdeti replikáció folyamatban van.</span><span class="sxs-lookup"><span data-stu-id="daf99-175">hello snapshot and log files consume disk resources while initial replication is in progress.</span></span>
5. <span data-ttu-id="daf99-176">Hello kezdeti replikáció befejezése után hello VM pillanatkép törlését.</span><span class="sxs-lookup"><span data-stu-id="daf99-176">When hello initial replication finishes, hello VM snapshot is deleted.</span></span> <span data-ttu-id="daf99-177">Hello naplóban rögzített változásokat szinkronizálja, és egyesített toohello szülőlemezt.</span><span class="sxs-lookup"><span data-stu-id="daf99-177">Delta disk changes in hello log are synchronized and merged toohello parent disk.</span></span>


### <a name="finalize-protection"></a><span data-ttu-id="daf99-178">Védelem véglegesítése</span><span class="sxs-lookup"><span data-stu-id="daf99-178">Finalize protection</span></span>

1. <span data-ttu-id="daf99-179">Hello kezdeti replikáció befejezését követően, hello **védelem véglegesítése a virtuális gép hello** feladat hálózati és a replikációt követő egyéb beállításokat konfigurálja, hogy hello virtuális gép védett.</span><span class="sxs-lookup"><span data-stu-id="daf99-179">After hello initial replication finishes, hello **Finalize protection on hello virtual machine** job configures network and other post-replication settings, so that hello virtual machine is protected.</span></span>
    <span data-ttu-id="daf99-180">![Védelem véglegesítése feladat](media/site-recovery-hyper-v-azure-architecture/image3.png)</span><span class="sxs-lookup"><span data-stu-id="daf99-180">![Finalize protection job](media/site-recovery-hyper-v-azure-architecture/image3.png)</span></span>
2. <span data-ttu-id="daf99-181">Ha tooAzure replikál, akkor tootweak hello beállítások hello virtuális gép, hogy készen áll a feladatátvételt.</span><span class="sxs-lookup"><span data-stu-id="daf99-181">If you're replicating tooAzure, you might need tootweak hello settings for hello virtual machine so that it's ready for failover.</span></span> <span data-ttu-id="daf99-182">Ezen a ponton futtatása a teszt feladatátvételi toocheck minden a várt módon működik.</span><span class="sxs-lookup"><span data-stu-id="daf99-182">At this point you can run a test failover toocheck everything is working as expected.</span></span>

### <a name="delta-replication"></a><span data-ttu-id="daf99-183">Változásreplikáció</span><span class="sxs-lookup"><span data-stu-id="daf99-183">Delta replication</span></span>

1. <span data-ttu-id="daf99-184">Hello kezdeti replikálás után elindul a változások szinkronizálása replikációs beállításoknak megfelelően.</span><span class="sxs-lookup"><span data-stu-id="daf99-184">After hello initial replication, delta synchronization begins, in accordance with replication settings.</span></span>
2. <span data-ttu-id="daf99-185">Hyper-V Replica Replication Tracker hello hello módosítások tooa virtuális merevlemez .hrl-fájlok formájában követi nyomon.</span><span class="sxs-lookup"><span data-stu-id="daf99-185">hello Hyper-V Replica Replication Tracker tracks hello changes tooa virtual hard disk as .hrl files.</span></span> <span data-ttu-id="daf99-186">Minden replikációra konfigurált lemezhez tartozik egy .hrl fájl.</span><span class="sxs-lookup"><span data-stu-id="daf99-186">Each disk that's configured for replication has an associated .hrl file.</span></span> <span data-ttu-id="daf99-187">Ez a napló toohello ügyfél tárfiókjával küldött kezdeti replikáció befejezése után.</span><span class="sxs-lookup"><span data-stu-id="daf99-187">This log is sent toohello customer's storage account after initial replication is complete.</span></span> <span data-ttu-id="daf99-188">Amikor a napló az átvitel közben tooAzure, hello elsődleges lemez hello változásait követi egy másik naplófájlt, a hello ugyanabban a könyvtárban.</span><span class="sxs-lookup"><span data-stu-id="daf99-188">When a log is in transit tooAzure, hello changes in hello primary disk are tracked in another log file, in hello same directory.</span></span>
3. <span data-ttu-id="daf99-189">Kiindulási és különbözeti replikálás során hello VM hello Virtuálisgép-nézetet a figyelheti.</span><span class="sxs-lookup"><span data-stu-id="daf99-189">During initial and delta replication, you can monitor hello VM in hello VM view.</span></span> <span data-ttu-id="daf99-190">[További információk](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="daf99-190">[Learn more](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span></span>  

### <a name="replication-synchronization"></a><span data-ttu-id="daf99-191">Replikációszinkronizálás</span><span class="sxs-lookup"><span data-stu-id="daf99-191">Replication synchronization</span></span>

1. <span data-ttu-id="daf99-192">Ha nem sikerül a változások replikálása, és a teljes replikáció túl sok sávszélességet vagy időt venne igénybe, a rendszer a virtuális gépet megjelöli újraszinkronizálásra.</span><span class="sxs-lookup"><span data-stu-id="daf99-192">If delta replication fails, and a full replication would be costly in terms of bandwidth or time, then a VM is marked for resynchronization.</span></span> <span data-ttu-id="daf99-193">Például ha hello .hrl-fájlok elérnék hello lemez méretének 50 %-át, majd hello VM lesz megjelölve az újraszinkronizálás.</span><span class="sxs-lookup"><span data-stu-id="daf99-193">For example, if hello .hrl files reach 50% of hello disk size, then hello VM will be marked for resynchronization.</span></span>
2.  <span data-ttu-id="daf99-194">Az újraszinkronizálás minimálisra hello hello forrás és cél virtuális gépek ellenőrzőösszegeit, és csak a hello különbözeti adatokat küld által elküldött adatok mennyisége.</span><span class="sxs-lookup"><span data-stu-id="daf99-194">Resynchronization minimizes hello amount of data sent by computing checksums of hello source and target virtual machines, and sending only hello delta data.</span></span> <span data-ttu-id="daf99-195">Az újraszinkronizálás egy rögzített blokkméretű csonkoló algoritmust alkalmaz, amelyben a forrás- és a célfájlok rögzített méretű adattömbökre vannak osztva.</span><span class="sxs-lookup"><span data-stu-id="daf99-195">Resynchronization uses a fixed-block chunking algorithm where source and target files are divided into fixed chunks.</span></span> <span data-ttu-id="daf99-196">Az egyes adattömbök ellenőrzőösszegeket akkor jönnek létre, és összehasonlítja a toodetermine, amely megakadályozza a hello forrás kell toobe alkalmazott toohello céltól.</span><span class="sxs-lookup"><span data-stu-id="daf99-196">Checksums for each chunk are generated and then compared toodetermine which blocks from hello source need toobe applied toohello target.</span></span>
3. <span data-ttu-id="daf99-197">Az újraszinkronizálás befejezését követően folytatódik a normál változásreplikálás.</span><span class="sxs-lookup"><span data-stu-id="daf99-197">After resynchronization finishes, normal delta replication should resume.</span></span> <span data-ttu-id="daf99-198">Alapértelmezés szerint az újraszinkronizálás automatikusan munkaidőn kívüli ütemezett toorun, de egy virtuális gépet manuálisan szinkronizálja újra.</span><span class="sxs-lookup"><span data-stu-id="daf99-198">By default resynchronization is scheduled toorun automatically outside office hours, but you can resynchronize a virtual machine manually.</span></span> <span data-ttu-id="daf99-199">Például manuálisan folytathatja az újraszinkronizálást, ha hálózatkimaradás vagy egyéb kimaradás következik be.</span><span class="sxs-lookup"><span data-stu-id="daf99-199">For example, you can resume resynchronization if a network outage or another outage occurs.</span></span> <span data-ttu-id="daf99-200">toodo e, jelölje be hello VM hello portálon > **újraszinkronizálása**.</span><span class="sxs-lookup"><span data-stu-id="daf99-200">toodo this, select hello VM in hello portal > **Resynchronize**.</span></span>

    ![Manuális újraszinkronizálás](media/site-recovery-hyper-v-azure-architecture/image4.png)


### <a name="retries"></a><span data-ttu-id="daf99-202">Újrapróbálkozások</span><span class="sxs-lookup"><span data-stu-id="daf99-202">Retries</span></span>

<span data-ttu-id="daf99-203">Ha hiba lép fel a replikáció során, a rendszer automatikusan újrapróbálkozik.</span><span class="sxs-lookup"><span data-stu-id="daf99-203">If a replication error occurs, there's a built-in retry.</span></span> <span data-ttu-id="daf99-204">A vonatkozó logika két kategóriába sorolható:</span><span class="sxs-lookup"><span data-stu-id="daf99-204">This logic can be classified into two categories:</span></span>

<span data-ttu-id="daf99-205">**Kategória**</span><span class="sxs-lookup"><span data-stu-id="daf99-205">**Category**</span></span> | <span data-ttu-id="daf99-206">**Részletek**</span><span class="sxs-lookup"><span data-stu-id="daf99-206">**Details**</span></span>
--- | ---
<span data-ttu-id="daf99-207">**Helyreállíthatatlan hibák**</span><span class="sxs-lookup"><span data-stu-id="daf99-207">**Non-recoverable errors**</span></span> | <span data-ttu-id="daf99-208">A rendszer nem kísérli meg a helyreállításukat.</span><span class="sxs-lookup"><span data-stu-id="daf99-208">No retry is attempted.</span></span> <span data-ttu-id="daf99-209">A virtuális gép állapota **Kritikusra** vált, és rendszergazdai beavatkozás szükséges.</span><span class="sxs-lookup"><span data-stu-id="daf99-209">VM status will be **Critical**, and administrator intervention is required.</span></span> <span data-ttu-id="daf99-210">Ezek a hibák például:; VHD-lánc megszakadt Érvénytelen állapot hello replika virtuális gép; Hálózati hitelesítési hibák: hitelesítési hibák; Virtuális gép nem található a hibák (az önálló Hyper-V kiszolgálók)</span><span class="sxs-lookup"><span data-stu-id="daf99-210">Examples of these errors include: broken VHD chain; Invalid state for hello replica VM; Network authentication errors: authorization errors; VM not found errors (for standalone Hyper-V servers)</span></span>
<span data-ttu-id="daf99-211">**Helyreállítható hibák**</span><span class="sxs-lookup"><span data-stu-id="daf99-211">**Recoverable errors**</span></span> | <span data-ttu-id="daf99-212">A próbálkozások minden replikációs időköztől, használja az exponenciális vissza-ki, amely növeli a hello újrapróbálkozási időköz hello indítás hello első kísérlet 1, 2, 4, 8, és 10 perc.</span><span class="sxs-lookup"><span data-stu-id="daf99-212">Retries occur every replication interval, using an exponential back-off that increases hello retry interval from hello start of hello first attempt by 1, 2, 4, 8, and 10 minutes.</span></span> <span data-ttu-id="daf99-213">Ha a hiba nem szűnik meg, a rendszer 30 percenként újrapróbálkozik.</span><span class="sxs-lookup"><span data-stu-id="daf99-213">If an error persists, retry every 30 minutes.</span></span> <span data-ttu-id="daf99-214">Példák: hálózati hibák; nem elegendő lemezterületből fakadó hibák; alacsony memóriaállapot.</span><span class="sxs-lookup"><span data-stu-id="daf99-214">Examples include: network errors; low disk  errors; low memory conditions</span></span> |

## <a name="protection-and-recovery-lifecycle"></a><span data-ttu-id="daf99-215">A védelem és helyreállítás életciklusa</span><span class="sxs-lookup"><span data-stu-id="daf99-215">Protection and recovery lifecycle</span></span>

![munkafolyamat](./media/site-recovery-components/arch-hyperv-azure-workflow.png)

## <a name="next-steps"></a><span data-ttu-id="daf99-217">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="daf99-217">Next steps</span></span>

- [<span data-ttu-id="daf99-218">Üzembe helyezési előfeltételek ellenőrzése</span><span class="sxs-lookup"><span data-stu-id="daf99-218">Check deployment prerequisites</span></span>](site-recovery-prereq.md)
- <span data-ttu-id="daf99-219">Hibaelhárítás a következőkkel:</span><span class="sxs-lookup"><span data-stu-id="daf99-219">Troubleshoot with:</span></span>
    - [<span data-ttu-id="daf99-220">Védelem figyelése és hibaelhárítása</span><span class="sxs-lookup"><span data-stu-id="daf99-220">Monitor and troubleshoot protection</span></span>](site-recovery-monitoring-and-troubleshooting.md)
    - [<span data-ttu-id="daf99-221">A Microsoft ügyfélszolgálatának segítsége</span><span class="sxs-lookup"><span data-stu-id="daf99-221">Help from Microsoft support</span></span>](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support)
    - [<span data-ttu-id="daf99-222">Gyakori hibák és megoldások</span><span class="sxs-lookup"><span data-stu-id="daf99-222">Common errors and resolutions</span></span>](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions)
