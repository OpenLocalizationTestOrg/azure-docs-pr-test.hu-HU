---
title: "Tekintse át a VMware-replikáció az Azure architektúra |} Microsoft Docs"
description: "Ez a cikk áttekintést összetevők és használható, ha a helyszíni VMware virtuális gépek replikálása Azure-bA az Azure Site Recovery szolgáltatással architektúra"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27.017
ms.author: raynew
ms.openlocfilehash: 4aae04a793bab11562c20ceec0e1ae8f1a035a0f
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="step-1-review-the-architecture-for-vmware-replication-to-azure"></a><span data-ttu-id="5441f-103">1. lépés:, Tekintse át a VMware-replikáció az Azure architektúra</span><span class="sxs-lookup"><span data-stu-id="5441f-103">Step 1: Review the architecture for VMware replication to Azure</span></span>

<span data-ttu-id="5441f-104">Ez a cikk ismerteti az összetevők és a folyamatok használható, ha a helyszíni VMware virtuális gépek replikálása az Azure használatával a [Azure Site Recovery](site-recovery-overview.md) szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="5441f-104">This article describes the components and processes used when replicating on-premises VMware virtual machines to Azure using the [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="5441f-105">Megjegyzéseket a cikk alján tehet, kérdéseket pedig az [Azure Recovery Services fórumon](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr) teheti fel.</span><span class="sxs-lookup"><span data-stu-id="5441f-105">Post any comments at the bottom of this article, or ask questions in the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="5441f-106">Az architektúra összetevői</span><span class="sxs-lookup"><span data-stu-id="5441f-106">Architectural components</span></span>

<span data-ttu-id="5441f-107">A táblázat foglalja össze a szükséges összetevők.</span><span class="sxs-lookup"><span data-stu-id="5441f-107">The table summarizes the components you need.</span></span>

<span data-ttu-id="5441f-108">**Összetevő**</span><span class="sxs-lookup"><span data-stu-id="5441f-108">**Component**</span></span> | <span data-ttu-id="5441f-109">**Követelmény**</span><span class="sxs-lookup"><span data-stu-id="5441f-109">**Requirement**</span></span> | <span data-ttu-id="5441f-110">**Részletek**</span><span class="sxs-lookup"><span data-stu-id="5441f-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="5441f-111">**Azure**</span><span class="sxs-lookup"><span data-stu-id="5441f-111">**Azure**</span></span> | <span data-ttu-id="5441f-112">Azure-előfizetéssel, egy Azure storage-fiókot és egy Azure-hálózatra van szüksége.</span><span class="sxs-lookup"><span data-stu-id="5441f-112">You need an Azure subscription, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="5441f-113">A tárfiók tárolja a replikált adatok.</span><span class="sxs-lookup"><span data-stu-id="5441f-113">Replicated data is stored in the storage account.</span></span> <span data-ttu-id="5441f-114">Azure virtuális gépek jönnek létre a replikált adatokat a helyszíni helyről feladatátvétel esetén.</span><span class="sxs-lookup"><span data-stu-id="5441f-114">Azure VMs are created with the replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="5441f-115">Az Azure virtuális gépek a létrejöttükkor csatlakoznak az Azure virtuális hálózathoz.</span><span class="sxs-lookup"><span data-stu-id="5441f-115">The Azure VMs connect to the Azure virtual network when they're created.</span></span>
<span data-ttu-id="5441f-116">**Konfigurációs kiszolgáló**</span><span class="sxs-lookup"><span data-stu-id="5441f-116">**Configuration server**</span></span> | <span data-ttu-id="5441f-117">Egyetlen helyszíni felügyeleti kiszolgáló (a VMware virtuális gép) rendszert futtató összes az helyszíni Site Recovery összetevőket a telepítéshez.</span><span class="sxs-lookup"><span data-stu-id="5441f-117">A single on-premises management server (VMware VM) that runs all the on-premises Site Recovery components for the deployment.</span></span> <span data-ttu-id="5441f-118">Ezek közé tartozik a konfigurációs kiszolgáló, a folyamatkiszolgáló, a fő célkiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="5441f-118">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="5441f-119">A konfigurációs kiszolgáló összetevő koordinálja a helyszíni rendszer és az Azure közötti kommunikációt, és felügyeli az adatreplikációt.</span><span class="sxs-lookup"><span data-stu-id="5441f-119">The configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="5441f-120">**Folyamatkiszolgáló**:</span><span class="sxs-lookup"><span data-stu-id="5441f-120">**Process server**:</span></span>  | <span data-ttu-id="5441f-121">Alapértelmezés szerint telepítve van a konfigurációs kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="5441f-121">Installed by default on the configuration server.</span></span> | <span data-ttu-id="5441f-122">Replikációs átjáróként üzemel.</span><span class="sxs-lookup"><span data-stu-id="5441f-122">Acts as a replication gateway.</span></span> <span data-ttu-id="5441f-123">Fogadja a replikációs adatokat, gyorsítótárazással, tömörítéssel és titkosítással optimalizálja őket, majd továbbítja az Azure Storage-nak.</span><span class="sxs-lookup"><span data-stu-id="5441f-123">Receives replication data, optimizes it with caching, compression, and encryption, and sends it to Azure storage.</span></span><br/><br/> <span data-ttu-id="5441f-124">A folyamatkiszolgáló ezenfelül kezeli a mobilitási szolgáltatás leküldéses telepítését a védett gépekre, és elvégzi a WMware virtuális gépek automatikus felderítését.</span><span class="sxs-lookup"><span data-stu-id="5441f-124">The process server also handles push installation of the Mobility service to protected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="5441f-125">Az üzemelő példány bővülésével további, önálló és dedikált folyamatkiszolgálókat helyezhet üzembe, amelyek segítségével képes lesz a megnövekedett replikációs forgalom kezelésére is.</span><span class="sxs-lookup"><span data-stu-id="5441f-125">As your deployment grows you can add additional separate dedicated process servers to handle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="5441f-126">**Fő célkiszolgáló**</span><span class="sxs-lookup"><span data-stu-id="5441f-126">**Master target server**</span></span> | <span data-ttu-id="5441f-127">Alapértelmezés szerint telepítve van a helyszíni konfigurációs kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="5441f-127">Installed by default on the on-premises configuration server.</span></span> | <span data-ttu-id="5441f-128">Az Azure-ból történő feladat-visszavétel során kezeli a replikációs adatokat.</span><span class="sxs-lookup"><span data-stu-id="5441f-128">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="5441f-129">Ha a feladat-visszavételi adatforgalom kötetei nagyok, a feladat-visszavételhez üzembe helyezhet egy másik fő célkiszolgálót.</span><span class="sxs-lookup"><span data-stu-id="5441f-129">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="5441f-130">**VMware-kiszolgálók**</span><span class="sxs-lookup"><span data-stu-id="5441f-130">**VMware servers**</span></span> | <span data-ttu-id="5441f-131">A VMware virtuális gépek vSphere ESXi-kiszolgálókon futnak, és a gazdagépek felügyeletéhez egy vCenter-kiszolgáló üzembe helyezését javasoljuk.</span><span class="sxs-lookup"><span data-stu-id="5441f-131">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server to manage the hosts.</span></span> | <span data-ttu-id="5441f-132">Vegyen fel VMware-kiszolgálókat a Recovery Services-tárolóba.</span><span class="sxs-lookup"><span data-stu-id="5441f-132">You add VMware servers to your Recovery Services vault.</span></span>
<span data-ttu-id="5441f-133">**Replikált gépek**</span><span class="sxs-lookup"><span data-stu-id="5441f-133">**Replicated machines**</span></span> | <span data-ttu-id="5441f-134">A mobilitási szolgáltatás telepíti az egyes VMware virtuális gépek replikálása.</span><span class="sxs-lookup"><span data-stu-id="5441f-134">The Mobility service will be installed on each VMware VM you replicate.</span></span> <span data-ttu-id="5441f-135">A szolgáltatás manuálisan is telepíthető az egyes gépekre, de leküldéses telepítés is végrehajtható a folyamatkiszolgálóról.</span><span class="sxs-lookup"><span data-stu-id="5441f-135">It can be installed manually on each machine, or with a push installation from the process server.</span></span>

<span data-ttu-id="5441f-136">**1. ábra: Összetevők: VMware-ről Azure-ra**</span><span class="sxs-lookup"><span data-stu-id="5441f-136">**Figure 1: VMware to Azure components**</span></span>

![Összetevők](./media/vmware-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="5441f-138">Replikációs folyamat</span><span class="sxs-lookup"><span data-stu-id="5441f-138">Replication process</span></span>

1. <span data-ttu-id="5441f-139">A központi telepítését, beleértve a helyszíni és az Azure összetevők beállítása.</span><span class="sxs-lookup"><span data-stu-id="5441f-139">You set up the deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="5441f-140">A Recovery Services-tárolónak kell megadni a forrásként és célként, állítsa be a konfigurációs kiszolgáló, hozzon létre egy replikációs házirendet, telepíteni a mobilitási szolgáltatást, engedélyezze a replikálást és feladatátvételi teszt futtatása.</span><span class="sxs-lookup"><span data-stu-id="5441f-140">In the Recovery Services vault, you specify the replication source and target, set up the configuration server, create a replication policy, deploy the Mobility service, enable replication, and run a test failover.</span></span>
2. <span data-ttu-id="5441f-141">Gépek replikálásához a replikációs házirendet, és egy kezdeti másolatot készít az adatokat a rendszer replikálja az Azure storage.</span><span class="sxs-lookup"><span data-stu-id="5441f-141">Machines replicate in accordance with the replication policy, and an initial copy of the data is replicated to Azure storage.</span></span>
3. <span data-ttu-id="5441f-142">Kezdeti replikáció befejezését követően, a változási különbözeteket az Azure-bA replikálását kezdődik.</span><span class="sxs-lookup"><span data-stu-id="5441f-142">After initial replication finishes, replication of delta changes to Azure begins.</span></span> <span data-ttu-id="5441f-143">A gépek nyomon követett módosításait a rendszer egy .hrl fájlban tárolja.</span><span class="sxs-lookup"><span data-stu-id="5441f-143">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="5441f-144">A replikációs folyamat kezelése érdekében a replikálást végző gépek a 443-as bejövő HTTPS-porton kommunikálnak a konfigurációs kiszolgálóval.</span><span class="sxs-lookup"><span data-stu-id="5441f-144">Replicating machines communicate with the configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="5441f-145">Replikáló gépek küldhet-e adatokat a folyamatkiszolgálónak HTTPS 9443 porton bejövő (módosítható).</span><span class="sxs-lookup"><span data-stu-id="5441f-145">Replicating machines send replication data to the process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="5441f-146">Az Azure-replikációs folyamat kezelését a konfigurációs kiszolgáló a 443-as kimenő HTTPS-porton keresztül végzi el.</span><span class="sxs-lookup"><span data-stu-id="5441f-146">The configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="5441f-147">A folyamatkiszolgáló adatokat fogad a forrásgépekről, amelyeket optimalizál és titkosít, majd a 443-as kimenő porton küldi elküld az Azure-tárolóba.</span><span class="sxs-lookup"><span data-stu-id="5441f-147">The process server receives data from source machines, optimizes and encrypts it, and sends it to Azure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="5441f-148">Ha engedélyezve van a több virtuális gépre kiterjedő konzisztencia, a replikációs csoportban található gépek a 20004-es porton kommunikálnak egymással.</span><span class="sxs-lookup"><span data-stu-id="5441f-148">If you enable multi-VM consistency, then machines in the replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="5441f-149">Több virtuális gépes környezetről akkor beszélünk, ha a gépek feladatátvételkor azonos összeomlásbiztos és alkalmazáskonzisztens helyreállítási pontokat használó replikációs csoportokba vannak rendezve.</span><span class="sxs-lookup"><span data-stu-id="5441f-149">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="5441f-150">Ez akkor lehet hasznos, ha a gépek ugyanazt a számítási feladatot futtatják, így konzisztensnek kell maradniuk.</span><span class="sxs-lookup"><span data-stu-id="5441f-150">This is useful if machines are running the same workload and need to be consistent.</span></span>
4. <span data-ttu-id="5441f-151">Az adatforgalmat a rendszer az interneten keresztül az Azure Storage nyilvános végpontjaira replikálja.</span><span class="sxs-lookup"><span data-stu-id="5441f-151">Traffic is replicated to Azure storage public endpoints, over the internet.</span></span> <span data-ttu-id="5441f-152">Erre a célra az Azure ExpressRoute [nyilvános társviszony-létesítési](../expressroute/expressroute-circuit-peerings.md#public-peering) szolgáltatását is használhatja.</span><span class="sxs-lookup"><span data-stu-id="5441f-152">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="5441f-153">Az adatforgalmat helyszíni helyek és az Azure között helyek közötti VPN-en keresztül nem lehet replikálni.</span><span class="sxs-lookup"><span data-stu-id="5441f-153">Replicating traffic over a site-to-site VPN from an on-premises site to Azure isn't supported.</span></span>


<span data-ttu-id="5441f-154">**2. ábra: Replikáció VMware-ről Azure-ra**</span><span class="sxs-lookup"><span data-stu-id="5441f-154">**Figure 2: VMware to Azure replication**</span></span>

![Továbbfejlesztett](./media/vmware-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="5441f-156">Feladatátvételi és feladat-visszavételi folyamat</span><span class="sxs-lookup"><span data-stu-id="5441f-156">Failover and failback process</span></span>

1. <span data-ttu-id="5441f-157">Miután ellenőrizte, hogy a feladatátvételi teszt a várt módon működik-e, igény szerint nem tervezett feladatátvételeket futtathat az Azure-hoz.</span><span class="sxs-lookup"><span data-stu-id="5441f-157">After you verify that test failover is working as expected, you can run unplanned failovers to Azure as required.</span></span> <span data-ttu-id="5441f-158">A tervezett feladatátvétel nem támogatott.</span><span class="sxs-lookup"><span data-stu-id="5441f-158">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="5441f-159">Elvégezheti egyetlen gép feladatátvételét, vagy létrehozhat több virtuális gép feladatátvételét tartalmazó [helyreállítási terveket](site-recovery-create-recovery-plans.md) is.</span><span class="sxs-lookup"><span data-stu-id="5441f-159">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), to fail over multiple VMs.</span></span>
3. <span data-ttu-id="5441f-160">Feladatátvétel futtatásakor az Azure-ban replikaként létrehozott virtuális gépek jönnek létre.</span><span class="sxs-lookup"><span data-stu-id="5441f-160">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="5441f-161">Akkor kell feladatátvételt végezni, ha hozzá szeretne férni a replikaként létrehozott Azure virtuális gép számítási feladataihoz.</span><span class="sxs-lookup"><span data-stu-id="5441f-161">You commit a failover to start accessing the workload from the replica Azure VM.</span></span>
4. <span data-ttu-id="5441f-162">Amint az elsődleges helyszíni hely megint elérhetővé válik, visszaadhatja a feladatokat.</span><span class="sxs-lookup"><span data-stu-id="5441f-162">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="5441f-163">Ehhez be kell állítani a feladat-visszavételi infrastruktúrát, el kell kezdeni a gép replikálását a másodlagos helyről az elsődlegesre, valamint nem tervezett feladatátvételt kell futtatni a másodlagos helyről.</span><span class="sxs-lookup"><span data-stu-id="5441f-163">You set up a failback infrastructure, start replicating the machine from the secondary site to the primary, and run an unplanned failover from the secondary site.</span></span> <span data-ttu-id="5441f-164">Ezen feladatátvétel végrehajtását követően az adatok visszakerülnek a helyszíni helyre, és az Azure-ba történő replikációt újra engedélyezni kell.</span><span class="sxs-lookup"><span data-stu-id="5441f-164">After you commit this failover, data will be back on-premises, and you need to enable replication to Azure again.</span></span> [<span data-ttu-id="5441f-165">További információ</span><span class="sxs-lookup"><span data-stu-id="5441f-165">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="5441f-166">A feladat-visszavételre vonatkozó követelmények:</span><span class="sxs-lookup"><span data-stu-id="5441f-166">There are a few failback requirements:</span></span>


- <span data-ttu-id="5441f-167">**Ideiglenes folyamatkiszolgáló az Azure-ban**: ha feladatátvételt követően szeretné visszaadni a feladatokat az Azure-ból, be kell állítania egy folyamatkiszolgálóként üzemelő Azure virtuális gépet, amely kezeli az Azure-ból való replikációt.</span><span class="sxs-lookup"><span data-stu-id="5441f-167">**Temporary process server in Azure**: If you want to fail back from Azure after failover you'll need to set up an Azure VM configured as a process server, to handle replication from Azure.</span></span> <span data-ttu-id="5441f-168">Ez a virtuális gép a feladatok visszaadását követően törölhető.</span><span class="sxs-lookup"><span data-stu-id="5441f-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="5441f-169">**VPN-kapcsolat**: a feladat-visszavételhez szüksége lesz egy VPN-kapcsolatra (vagy Azure ExpressRoute-ra), amelyet a helyszíni hely Azure-hálózatában kell beállítania.</span><span class="sxs-lookup"><span data-stu-id="5441f-169">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from the Azure network to the on-premises site.</span></span>
- <span data-ttu-id="5441f-170">**Önálló helyszíni fő célkiszolgáló**: a helyszíni fő célkiszolgáló kezeli a feladat-visszavételt.</span><span class="sxs-lookup"><span data-stu-id="5441f-170">**Separate on-premises master target server**: The on-premises master target server handles failback.</span></span> <span data-ttu-id="5441f-171">A fő célkiszolgálót alapértelmezés szerint a felügyeleti kiszolgálóra kell telepíteni, de nagyobb mértékű forgalom feladat-visszavétele esetén érdemes ebből a célból egy önálló helyszíni fő célkiszolgálót is létrehozni.</span><span class="sxs-lookup"><span data-stu-id="5441f-171">The master target server is installed by default on the management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="5441f-172">**Feladat-visszavételi szabályzat**: A helyszíni helyre történő újbóli replikáláshoz feladat-visszavételi szabályzatra van szükség.</span><span class="sxs-lookup"><span data-stu-id="5441f-172">**Failback policy**: To replicate back to your on-premises site, you need a failback policy.</span></span> <span data-ttu-id="5441f-173">A replikációs szabályzat létrehozásakor a rendszer ezt automatikusan létrehozza.</span><span class="sxs-lookup"><span data-stu-id="5441f-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="5441f-174">**VMware-infrastruktúra**: A feladatot egy helyszíni VMware virtuális gépnek kell visszavennie.</span><span class="sxs-lookup"><span data-stu-id="5441f-174">**VMware infrastructure**: You must fail back to an on-premises VMware VM.</span></span> <span data-ttu-id="5441f-175">Ez azt jelenti, hogy helyszíni VMware-infrastruktúrára akkor is szükség van, ha helyszíni fizikai kiszolgálókat replikál az Azure-ba.</span><span class="sxs-lookup"><span data-stu-id="5441f-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers to Azure.</span></span>

<span data-ttu-id="5441f-176">**3. ábra: VMware-/fizikai gépek közötti feladat-visszavétel**</span><span class="sxs-lookup"><span data-stu-id="5441f-176">**Figure 3: VMware/physical failback**</span></span>

![Feladat-visszavétel](./media/vmware-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="5441f-178">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="5441f-178">Next steps</span></span>

<span data-ttu-id="5441f-179">Ugrás a [2. lépés: Ellenőrizze az Előfeltételek és korlátozások](vmware-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="5441f-179">Go to [Step 2: Verify prerequisites and limitations](vmware-walkthrough-prerequisites.md)</span></span>
