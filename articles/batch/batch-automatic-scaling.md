---
title: "aaaAutomatically méretezési számítási csomópontok az Azure Batch-készlet |} Microsoft Docs"
description: "Enable automatikus méretezésének egy felhőalapú készlet toodynamically beállítása hello hello készlet számítási csomópontjainak számát."
services: batch
documentationcenter: 
author: tamram
manager: timlt
editor: tysonn
ms.assetid: c624cdfc-c5f2-4d13-a7d7-ae080833b779
ms.service: batch
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: multiple
ms.date: 06/20/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: b6d1e0c5d8e0e56e15a4d3588150f2466a689f19
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="create-an-automatic-scaling-formula-for-scaling-compute-nodes-in-a-batch-pool"></a><span data-ttu-id="435f6-103">Hozzon létre egy méretezhetővé válik a Batch-készlet számítási csomópontjainak automatikus méretezési képlet</span><span class="sxs-lookup"><span data-stu-id="435f6-103">Create an automatic scaling formula for scaling compute nodes in a Batch pool</span></span>

<span data-ttu-id="435f6-104">Az Azure Batch automatikusan át tudja méretezni készletek meghatározott paraméterei alapján.</span><span class="sxs-lookup"><span data-stu-id="435f6-104">Azure Batch can automatically scale pools based on parameters that you define.</span></span> <span data-ttu-id="435f6-105">Az automatikus skálázás kötegelt dinamikusan kerülnek be a csomópontok tooa készlet feladat igények növekedése, és eltávolítja a számítási csomópontok, mivel csökkentik.</span><span class="sxs-lookup"><span data-stu-id="435f6-105">With automatic scaling, Batch dynamically adds nodes tooa pool as task demands increase, and removes compute nodes as they decrease.</span></span> <span data-ttu-id="435f6-106">A kötegelt alkalmazás által használt csomópontok száma hello automatikusan módosításával időt és pénzt is mentheti.</span><span class="sxs-lookup"><span data-stu-id="435f6-106">You can save both time and money by automatically adjusting hello number of compute nodes used by your Batch application.</span></span> 

<span data-ttu-id="435f6-107">Automatikus skálázás a számítási csomópontok készletét társítja azt engedélyezi egy *automatikus skálázás képlet* megadhat.</span><span class="sxs-lookup"><span data-stu-id="435f6-107">You enable automatic scaling on a pool of compute nodes by associating with it an *autoscale formula* that you define.</span></span> <span data-ttu-id="435f6-108">hello Batch szolgáltatás használja hello automatikus skálázás képlet toodetermine hello számítási csomópontok száma, amelyek a szükséges tooexecute a terhelést.</span><span class="sxs-lookup"><span data-stu-id="435f6-108">hello Batch service uses hello autoscale formula toodetermine hello number of compute nodes that are needed tooexecute your workload.</span></span> <span data-ttu-id="435f6-109">Számítási csomópontok lehet, hogy dedikált csomópontok vagy [alacsony prioritású csomópontok](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="435f6-109">Compute nodes may be dedicated nodes or [low-priority nodes](batch-low-pri-vms.md).</span></span> <span data-ttu-id="435f6-110">Kötegelt tooservice metrikák összegyűjtött adatokon rendszeresen válaszol.</span><span class="sxs-lookup"><span data-stu-id="435f6-110">Batch responds tooservice metrics data that is collected periodically.</span></span> <span data-ttu-id="435f6-111">A metrikák adatok használatával, kötegelt módosítja a képlet alapján és konfigurálható időközönként hello készlet számítási csomópontjai hello száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-111">Using this metrics data, Batch adjusts hello number of compute nodes in hello pool based on your formula and at a configurable interval.</span></span>

<span data-ttu-id="435f6-112">A tárolókészlet létrehozásakor vagy meglévő címkészlet automatikus skálázás engedélyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="435f6-112">You can enable automatic scaling either when a pool is created, or on an existing pool.</span></span> <span data-ttu-id="435f6-113">Az automatikus skálázás beállítása készletben meglévő képlet is módosíthatja.</span><span class="sxs-lookup"><span data-stu-id="435f6-113">You can also change an existing formula on a pool that is configured for autoscaling.</span></span> <span data-ttu-id="435f6-114">Kötegelt lehetővé teszi a képletekben toopools és toomonitor hello állapotának automatikus skálázás hozzárendelése előtt fut tooevaluate.</span><span class="sxs-lookup"><span data-stu-id="435f6-114">Batch enables you tooevaluate your formulas before assigning them toopools and toomonitor hello status of automatic scaling runs.</span></span>

<span data-ttu-id="435f6-115">Ez a cikk ismerteti, amelyek hello különféle entitásokat, amelyek az automatikus skálázás képletek, beleértve a változók, operátorok, műveletek és funkciók alkotják.</span><span class="sxs-lookup"><span data-stu-id="435f6-115">This article discusses hello various entities that make up your autoscale formulas, including variables, operators, operations, and functions.</span></span> <span data-ttu-id="435f6-116">Arról lesz szó hogyan tooobtain különböző számítási erőforrás és a feladat metrikák kötegelt belül.</span><span class="sxs-lookup"><span data-stu-id="435f6-116">We discuss how tooobtain various compute resource and task metrics within Batch.</span></span> <span data-ttu-id="435f6-117">Ezek a készlet csomópontok száma alapuló erőforrás-használat és a feladat állapota metrikák tooadjust is használhatja.</span><span class="sxs-lookup"><span data-stu-id="435f6-117">You can use these metrics tooadjust your pool's node count based on resource usage and task status.</span></span> <span data-ttu-id="435f6-118">Majd ismerteti hogyan hello a képlet tooconstruct és automatikus méretezésének készlet használatával is lehetővé teszik, hogy Batch REST és a .NET API-k.</span><span class="sxs-lookup"><span data-stu-id="435f6-118">We then describe how tooconstruct a formula and enable automatic scaling on a pool by using both hello Batch REST and .NET APIs.</span></span> <span data-ttu-id="435f6-119">Végül azt befejezéséhez néhány példa képletek.</span><span class="sxs-lookup"><span data-stu-id="435f6-119">Finally, we finish up with a few example formulas.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="435f6-120">Batch-fiók létrehozásakor megadhatja a hello [fiókkonfiguráció](batch-api-basics.md#account), amely meghatározza, hogy készletek foglal le a Batch szolgáltatás az előfizetéshez (hello alapértelmezett), vagy a felhasználó az előfizetéshez.</span><span class="sxs-lookup"><span data-stu-id="435f6-120">When you create a Batch account, you can specify hello [account configuration](batch-api-basics.md#account), which determines whether pools are allocated in a Batch service subscription (hello default), or in your user subscription.</span></span> <span data-ttu-id="435f6-121">A Batch-fiók hello alapértelmezett Batch szolgáltatás konfigurációs hozta létre, ha a fiók használható a feldolgozás magok maximális száma korlátozott tooa.</span><span class="sxs-lookup"><span data-stu-id="435f6-121">If you created your Batch account with hello default Batch Service configuration, then your account is limited tooa maximum number of cores that can be used for processing.</span></span> <span data-ttu-id="435f6-122">hello Batch szolgáltatás méretezi a számítási csomópontok csak másolatot toothat core korlátot.</span><span class="sxs-lookup"><span data-stu-id="435f6-122">hello Batch service scales compute nodes only up toothat core limit.</span></span> <span data-ttu-id="435f6-123">Emiatt hello Batch szolgáltatás nem jut el az automatikus skálázás képlet által meghatározott számítási csomópontok száma hello cél.</span><span class="sxs-lookup"><span data-stu-id="435f6-123">For this reason, hello Batch service may not reach hello target number of compute nodes specified by an autoscale formula.</span></span> <span data-ttu-id="435f6-124">Lásd: [kvótái és korlátai hello Azure Batch szolgáltatás](batch-quota-limit.md) információk megtekintéséhez és a fiók kvótákat növelését.</span><span class="sxs-lookup"><span data-stu-id="435f6-124">See [Quotas and limits for hello Azure Batch service](batch-quota-limit.md) for information on viewing and increasing your account quotas.</span></span>
>
><span data-ttu-id="435f6-125">Hello felhasználói előfizetési konfigurációval létrehozta a fiókot, ha a fiók hello előfizetés hello magkvótája megosztja.</span><span class="sxs-lookup"><span data-stu-id="435f6-125">If you created your account with hello User Subscription configuration, then your account shares in hello core quota for hello subscription.</span></span> <span data-ttu-id="435f6-126">További információkért lásd [az Azure-előfizetésekre és -szolgáltatásokra vonatkozó korlátozásokat, kvótákat és megkötéseket](../azure-subscription-service-limits.md) ismertető témakör [a virtuális gépek korlátaira](../azure-subscription-service-limits.md#virtual-machines-limits) vonatkozó részét.</span><span class="sxs-lookup"><span data-stu-id="435f6-126">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

## <a name="automatic-scaling-formulas"></a><span data-ttu-id="435f6-127">Automatikus méretezési képletek</span><span class="sxs-lookup"><span data-stu-id="435f6-127">Automatic scaling formulas</span></span>
<span data-ttu-id="435f6-128">Az automatikus méretezési képlete karakterlánc-értéke megadhat egy vagy több utasítást tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="435f6-128">An automatic scaling formula is a string value that you define that contains one or more statements.</span></span> <span data-ttu-id="435f6-129">hello automatikus skálázás képlet hozzá van rendelve a tooa készlet [autoScaleFormula] [ rest_autoscaleformula] elem (Batch REST) vagy [CloudPool.AutoScaleFormula] [ net_cloudpool_autoscaleformula] a tulajdonság (Batch .NET).</span><span class="sxs-lookup"><span data-stu-id="435f6-129">hello autoscale formula is assigned tooa pool's [autoScaleFormula][rest_autoscaleformula] element (Batch REST) or [CloudPool.AutoScaleFormula][net_cloudpool_autoscaleformula] property (Batch .NET).</span></span> <span data-ttu-id="435f6-130">hello Batch szolgáltatás használ a számítási csomópontok képlet toodetermine hello cél száma hello készletben hello következő intervallum feldolgozása.</span><span class="sxs-lookup"><span data-stu-id="435f6-130">hello Batch service uses your formula toodetermine hello target number of compute nodes in hello pool for hello next interval of processing.</span></span> <span data-ttu-id="435f6-131">hello képlet karakterlánc nem haladhatja meg a 8 KB-os, mentése too100 utasításokat, amelyek pontosvesszővel elválasztva, és tartalmazhat sortörést és megjegyzéseket is tartalmazhat.</span><span class="sxs-lookup"><span data-stu-id="435f6-131">hello formula string cannot exceed 8 KB, can include up too100 statements that are separated by semicolons, and can include line breaks and comments.</span></span>

<span data-ttu-id="435f6-132">Az eltolásokat tekintheti automatikus méretezési képletek, egy kötegelt automatikus skálázás "nyelv".</span><span class="sxs-lookup"><span data-stu-id="435f6-132">You can think of automatic scaling formulas as a Batch autoscale "language."</span></span> <span data-ttu-id="435f6-133">Képletadat kimutatásai, szabad formátumú kifejezések szolgáltatás által definiált változókat (hello Batch szolgáltatás által beállított változók) és a felhasználó által definiált változókat (Ön által meghatározott változók) is tartalmazhatja.</span><span class="sxs-lookup"><span data-stu-id="435f6-133">Formula statements are free-formed expressions that can include both service-defined variables (variables defined by hello Batch service) and user-defined variables (variables that you define).</span></span> <span data-ttu-id="435f6-134">Azok a feladatra, beépített típusok, a kezelők és a funkciók használatával, ezeket az értékeket különféle műveleteket végezhet.</span><span class="sxs-lookup"><span data-stu-id="435f6-134">They can perform various operations on these values by using built-in types, operators, and functions.</span></span> <span data-ttu-id="435f6-135">Például egy utasítás is igénybe vehet a következő képernyő hello:</span><span class="sxs-lookup"><span data-stu-id="435f6-135">For example, a statement might take hello following form:</span></span>

```
$myNewVariable = function($ServiceDefinedVariable, $myCustomVariable);
```

<span data-ttu-id="435f6-136">Képletek általában több utasítás műveleteket értékek, amelyek akkor kapja meg az előző utasítások tartalmaznak.</span><span class="sxs-lookup"><span data-stu-id="435f6-136">Formulas generally contain multiple statements that perform operations on values that are obtained in previous statements.</span></span> <span data-ttu-id="435f6-137">Például azt szereznie értéket `variable1`, tooa függvény toopopulate átadni `variable2`:</span><span class="sxs-lookup"><span data-stu-id="435f6-137">For example, first we obtain a value for `variable1`, then pass it tooa function toopopulate `variable2`:</span></span>

```
$variable1 = function1($ServiceDefinedVariable);
$variable2 = function2($OtherServiceDefinedVariable, $variable1);
```

<span data-ttu-id="435f6-138">Vegye fel az automatikus skálázás képlet tooarrive a számítási csomópontok cél számú ezekről az utasításokról.</span><span class="sxs-lookup"><span data-stu-id="435f6-138">Include these statements in your autoscale formula tooarrive at a target number of compute nodes.</span></span> <span data-ttu-id="435f6-139">Dedikált csomópontok és alacsony prioritású csomópont is saját tárolóbeállítások, így megadhatja az egyes csomópont target.</span><span class="sxs-lookup"><span data-stu-id="435f6-139">Dedicated nodes and low-priority nodes each have their own target settings, so that you can define a target for each type of node.</span></span> <span data-ttu-id="435f6-140">Az automatikus skálázás képlet tartalmazhat egy célértéke dedikált csomópontok, alacsony prioritású csomópont target értéket vagy mindkettőt.</span><span class="sxs-lookup"><span data-stu-id="435f6-140">An autoscale formula can include a target value for dedicated nodes, a target value for low-priority nodes, or both.</span></span>

<span data-ttu-id="435f6-141">csomópontok száma hello cél lehet magasabb, alsó, vagy hello ugyanaz, mint az adott típusú hello készletben csomópontok hello aktuális száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-141">hello target number of nodes may be higher, lower, or hello same as hello current number of nodes of that type in hello pool.</span></span> <span data-ttu-id="435f6-142">Kötegelt a készlet automatikus skálázás képlet kiértékelése adott időközönként (lásd: [automatikus skálázás intervallumok](#automatic-scaling-interval)).</span><span class="sxs-lookup"><span data-stu-id="435f6-142">Batch evaluates a pool's autoscale formula at a specific interval (see [automatic scaling intervals](#automatic-scaling-interval)).</span></span> <span data-ttu-id="435f6-143">Kötegelt módosítja hello cél hello gyűjtő toohello száma az automatikus skálázás képlet meghatározó értékelési hello időpontban csomópontjának típusonkénti darabszámot.</span><span class="sxs-lookup"><span data-stu-id="435f6-143">Batch adjusts hello target number of each type of node in hello pool toohello number that your autoscale formula specifies at hello time of evaluation.</span></span>

### <a name="sample-autoscale-formula"></a><span data-ttu-id="435f6-144">Minta automatikus skálázás képlet</span><span class="sxs-lookup"><span data-stu-id="435f6-144">Sample autoscale formula</span></span>

<span data-ttu-id="435f6-145">Íme egy példa az automatikus skálázás úgy, hogy a legtöbb forgatókönyvhöz módosított toowork lehet.</span><span class="sxs-lookup"><span data-stu-id="435f6-145">Here is an example of an autoscale formula that can be adjusted toowork for most scenarios.</span></span> <span data-ttu-id="435f6-146">változók hello `startingNumberOfVMs` és `maxNumberofVMs` hello példa képlet módosított tooyour igényeit is lehet.</span><span class="sxs-lookup"><span data-stu-id="435f6-146">hello variables `startingNumberOfVMs` and `maxNumberofVMs` in hello example formula can be adjusted tooyour needs.</span></span> <span data-ttu-id="435f6-147">A képlet dedikált csomópontok méretezi, de lehet módosított tooapply tooscale alacsony prioritású csomópontok is.</span><span class="sxs-lookup"><span data-stu-id="435f6-147">This formula scales dedicated nodes, but can be modified tooapply tooscale low-priority nodes as well.</span></span> 

```
startingNumberOfVMs = 1;
maxNumberofVMs = 25;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

<span data-ttu-id="435f6-148">Az automatikus skálázás képlettel hello készlet először hozza létre egyetlen virtuális gépen.</span><span class="sxs-lookup"><span data-stu-id="435f6-148">With this autoscale formula, hello pool is initially created with a single VM.</span></span> <span data-ttu-id="435f6-149">Hello `$PendingTasks` metrika fut, vagy az aszinkron feladatok hello számát határozza meg.</span><span class="sxs-lookup"><span data-stu-id="435f6-149">hello `$PendingTasks` metric defines hello number of tasks that are running or queued.</span></span> <span data-ttu-id="435f6-150">hello képlet hello átlagos száma függőben lévő feladatok talál hello utolsó 180 másodperc, és beállítja a hello `$TargetDedicatedNodes` változó ennek megfelelően.</span><span class="sxs-lookup"><span data-stu-id="435f6-150">hello formula finds hello average number of pending tasks in hello last 180 seconds and sets hello `$TargetDedicatedNodes` variable accordingly.</span></span> <span data-ttu-id="435f6-151">hello képlet biztosítja, hogy soha nem dedikált csomópontok hello cél száma meghaladja a 25 virtuális gépek.</span><span class="sxs-lookup"><span data-stu-id="435f6-151">hello formula ensures that hello target number of dedicated nodes never exceeds 25 VMs.</span></span> <span data-ttu-id="435f6-152">Új feladatok be, mivel hello készlet automatikusan nő.</span><span class="sxs-lookup"><span data-stu-id="435f6-152">As new tasks are submitted, hello pool automatically grows.</span></span> <span data-ttu-id="435f6-153">Feladat befejeződött virtuális gépek szabad egyenként válik, és hello automatikus skálázás képlet zsugorítja hello készlet.</span><span class="sxs-lookup"><span data-stu-id="435f6-153">As tasks complete, VMs become free one by one and hello autoscaling formula shrinks hello pool.</span></span>

## <a name="variables"></a><span data-ttu-id="435f6-154">Változók</span><span class="sxs-lookup"><span data-stu-id="435f6-154">Variables</span></span>
<span data-ttu-id="435f6-155">Mindkét használhatja **szolgáltatás által definiált** és **felhasználói** az automatikus skálázás képletekben változók.</span><span class="sxs-lookup"><span data-stu-id="435f6-155">You can use both **service-defined** and **user-defined** variables in your autoscale formulas.</span></span> <span data-ttu-id="435f6-156">a Batch szolgáltatás toohello beépített hello szolgáltatás által definiált változókat.</span><span class="sxs-lookup"><span data-stu-id="435f6-156">hello service-defined variables are built in toohello Batch service.</span></span> <span data-ttu-id="435f6-157">Néhány szolgáltatás által definiált változókat írható-olvasható, és csak olvasható.</span><span class="sxs-lookup"><span data-stu-id="435f6-157">Some service-defined variables are read-write, and some are read-only.</span></span> <span data-ttu-id="435f6-158">Felhasználói változók az alábbiak változókat, amelyek adhat meg.</span><span class="sxs-lookup"><span data-stu-id="435f6-158">User-defined variables are variables that you define.</span></span> <span data-ttu-id="435f6-159">Hello előző részben, hello példa képletben `$TargetDedicatedNodes` és `$PendingTasks` szolgáltatás által definiált változók.</span><span class="sxs-lookup"><span data-stu-id="435f6-159">In hello example formula shown in hello previous section, `$TargetDedicatedNodes` and `$PendingTasks` are service-defined variables.</span></span> <span data-ttu-id="435f6-160">Változók `startingNumberOfVMs` és `maxNumberofVMs` felhasználói változók.</span><span class="sxs-lookup"><span data-stu-id="435f6-160">Variables `startingNumberOfVMs` and `maxNumberofVMs` are user-defined variables.</span></span>

> [!NOTE]
> <span data-ttu-id="435f6-161">Szolgáltatás által definiált változókat mindig előzi dollárjelet ($).</span><span class="sxs-lookup"><span data-stu-id="435f6-161">Service-defined variables are always preceded by a dollar sign ($).</span></span> <span data-ttu-id="435f6-162">A felhasználói változók hello dollárjel nem kötelező megadni.</span><span class="sxs-lookup"><span data-stu-id="435f6-162">For user-defined variables, hello dollar sign is optional.</span></span>
>
>

<span data-ttu-id="435f6-163">a következő táblák hello mindkét írható-olvasható, és csak olvasható változók, amelyeket a Batch szolgáltatás hello megjelenítése.</span><span class="sxs-lookup"><span data-stu-id="435f6-163">hello following tables show both read-write and read-only variables that are defined by hello Batch service.</span></span>

<span data-ttu-id="435f6-164">Get, és adja meg a szolgáltatás által definiált változók értékeit hello számítási csomópontok száma toomanage hello a készletben:</span><span class="sxs-lookup"><span data-stu-id="435f6-164">You can get and set hello values of these service-defined variables toomanage hello number of compute nodes in a pool:</span></span>

| <span data-ttu-id="435f6-165">Olvasási és írási szolgáltatás által definiált változó</span><span class="sxs-lookup"><span data-stu-id="435f6-165">Read-write service-defined variables</span></span> | <span data-ttu-id="435f6-166">Leírás</span><span class="sxs-lookup"><span data-stu-id="435f6-166">Description</span></span> |
| --- | --- |
| <span data-ttu-id="435f6-167">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-167">$TargetDedicatedNodes</span></span> |<span data-ttu-id="435f6-168">hello cél száma dedikált számítási csomópontjain hello készlet.</span><span class="sxs-lookup"><span data-stu-id="435f6-168">hello target number of dedicated compute nodes for hello pool.</span></span> <span data-ttu-id="435f6-169">dedikált csomópontok száma hello cél van megadva, mert a készlet nem lehetséges, hogy mindig elérése szükséges hello csomópontok száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-169">hello number of dedicated nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="435f6-170">Például ha dedikált csomópontok száma hello cél módosítása előtt hello automatikus skálázás értékelésével készlet elérte hello kezdeti cél, majd hello készlet nem érte el hello cél.</span><span class="sxs-lookup"><span data-stu-id="435f6-170">For example, if hello target number of dedicated nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <br /><br /> <span data-ttu-id="435f6-171">Egy fiók, létre hello Batch szolgáltatás konfigurációs készlet nem érhetik el a célértéket Ha hello cél meghaladja a kötegelt fiók csomópont vagy core kvótát.</span><span class="sxs-lookup"><span data-stu-id="435f6-171">A pool in an account created with hello Batch Service configuration may not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <span data-ttu-id="435f6-172">Egy fiók, létre hello felhasználói előfizetés konfigurációs készlet nem érhetik el a célértéket Ha hello cél meghaladja hello megosztott magkvótája hello előfizetés.</span><span class="sxs-lookup"><span data-stu-id="435f6-172">A pool in an account created with hello User Subscription configuration may not achieve its target if hello target exceeds hello shared core quota for hello subscription.</span></span>|
| <span data-ttu-id="435f6-173">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-173">$TargetLowPriorityNodes</span></span> |<span data-ttu-id="435f6-174">alacsony prioritású hello cél száma számítási csomópontjain hello készlet.</span><span class="sxs-lookup"><span data-stu-id="435f6-174">hello target number of low-priority compute nodes for hello pool.</span></span> <span data-ttu-id="435f6-175">alacsony prioritású csomópontok száma hello cél van megadva, mert a készlet nem lehetséges, hogy mindig elérése szükséges hello csomópontok száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-175">hello number of low-priority nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="435f6-176">Például ha alacsony prioritású csomópontok száma hello cél módosítása előtt hello automatikus skálázás értékelésével készlet elérte hello kezdeti cél, majd hello készlet nem érte el hello cél.</span><span class="sxs-lookup"><span data-stu-id="435f6-176">For example, if hello target number of low-priority nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <span data-ttu-id="435f6-177">Egy készlet is nem érhetik el a célértéket Ha hello cél meghaladja a kötegelt fiók csomópont vagy core kvóta.</span><span class="sxs-lookup"><span data-stu-id="435f6-177">A pool may also not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <br /><br /> <span data-ttu-id="435f6-178">Alacsony prioritású számítási csomóponton további információkért lásd: [alacsony prioritású virtuális gépek használata a kötegelt (előzetes verzió)](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="435f6-178">For more information on low-priority compute nodes, see [Use low-priority VMs with Batch (Preview)](batch-low-pri-vms.md).</span></span> |
| <span data-ttu-id="435f6-179">$NodeDeallocationOption</span><span class="sxs-lookup"><span data-stu-id="435f6-179">$NodeDeallocationOption</span></span> |<span data-ttu-id="435f6-180">hello művelet, amikor a számítási csomópontok el lesznek távolítva a készletben.</span><span class="sxs-lookup"><span data-stu-id="435f6-180">hello action that occurs when compute nodes are removed from a pool.</span></span> <span data-ttu-id="435f6-181">Lehetséges értékek:</span><span class="sxs-lookup"><span data-stu-id="435f6-181">Possible values are:</span></span><ul><li><span data-ttu-id="435f6-182">**requeue**--feladatok azonnal leáll, és úgy, hogy azok újraütemezte helyezi őket újra a feladat-várólistán hello.</span><span class="sxs-lookup"><span data-stu-id="435f6-182">**requeue**--Terminates tasks immediately and puts them back on hello job queue so that they are rescheduled.</span></span><li><span data-ttu-id="435f6-183">**Állítsa le**--feladatok azonnal leáll, és eltávolítja azokat a hello feladat-várólistán.</span><span class="sxs-lookup"><span data-stu-id="435f6-183">**terminate**--Terminates tasks immediately and removes them from hello job queue.</span></span><li><span data-ttu-id="435f6-184">**taskcompletion**--vár a jelenleg futó toofinish feladatokat, majd eltávolítja a hello csomópont hello készletből.</span><span class="sxs-lookup"><span data-stu-id="435f6-184">**taskcompletion**--Waits for currently running tasks toofinish and then removes hello node from hello pool.</span></span><li><span data-ttu-id="435f6-185">**retaineddata**– hello készletből hello csomópont eltávolítása előtt tisztítani hello helyi feladat megőrzi lévő összes adat hello csomópont toobe vár.</span><span class="sxs-lookup"><span data-stu-id="435f6-185">**retaineddata**--Waits for all hello local task-retained data on hello node toobe cleaned up before removing hello node from hello pool.</span></span></ul> |

<span data-ttu-id="435f6-186">A szolgáltatás által definiált változókat toomake módosításának hello kötegelt szolgáltatásból metrikák alapuló hello érték is beolvasásához:</span><span class="sxs-lookup"><span data-stu-id="435f6-186">You can get hello value of these service-defined variables toomake adjustments that are based on metrics from hello Batch service:</span></span>

| <span data-ttu-id="435f6-187">Csak olvasható szolgáltatás által definiált változó</span><span class="sxs-lookup"><span data-stu-id="435f6-187">Read-only service-defined variables</span></span> | <span data-ttu-id="435f6-188">Leírás</span><span class="sxs-lookup"><span data-stu-id="435f6-188">Description</span></span> |
| --- | --- |
| <span data-ttu-id="435f6-189">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="435f6-189">$CPUPercent</span></span> |<span data-ttu-id="435f6-190">a processzorhasználat aránya átlagos hello.</span><span class="sxs-lookup"><span data-stu-id="435f6-190">hello average percentage of CPU usage.</span></span> |
| <span data-ttu-id="435f6-191">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="435f6-191">$WallClockSeconds</span></span> |<span data-ttu-id="435f6-192">felhasznált másodperces hello számát.</span><span class="sxs-lookup"><span data-stu-id="435f6-192">hello number of seconds consumed.</span></span> |
| <span data-ttu-id="435f6-193">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-193">$MemoryBytes</span></span> |<span data-ttu-id="435f6-194">hello átlagos száma mérete (MB) használt.</span><span class="sxs-lookup"><span data-stu-id="435f6-194">hello average number of megabytes used.</span></span> |
| <span data-ttu-id="435f6-195">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-195">$DiskBytes</span></span> |<span data-ttu-id="435f6-196">hello hello helyi lemezeken használt gigabájt átlagos száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-196">hello average number of gigabytes used on hello local disks.</span></span> |
| <span data-ttu-id="435f6-197">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-197">$DiskReadBytes</span></span> |<span data-ttu-id="435f6-198">hello olvasott bájtok számát.</span><span class="sxs-lookup"><span data-stu-id="435f6-198">hello number of bytes read.</span></span> |
| <span data-ttu-id="435f6-199">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-199">$DiskWriteBytes</span></span> |<span data-ttu-id="435f6-200">hello írt bájtok száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-200">hello number of bytes written.</span></span> |
| <span data-ttu-id="435f6-201">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="435f6-201">$DiskReadOps</span></span> |<span data-ttu-id="435f6-202">lemezolvasási műveletek száma hello végre.</span><span class="sxs-lookup"><span data-stu-id="435f6-202">hello count of read disk operations performed.</span></span> |
| <span data-ttu-id="435f6-203">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="435f6-203">$DiskWriteOps</span></span> |<span data-ttu-id="435f6-204">hello végrehajtott írási lemez műveletek száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-204">hello count of write disk operations performed.</span></span> |
| <span data-ttu-id="435f6-205">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-205">$NetworkInBytes</span></span> |<span data-ttu-id="435f6-206">hello bejövő bájtok száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-206">hello number of inbound bytes.</span></span> |
| <span data-ttu-id="435f6-207">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-207">$NetworkOutBytes</span></span> |<span data-ttu-id="435f6-208">küldött bájtok száma hello.</span><span class="sxs-lookup"><span data-stu-id="435f6-208">hello number of outbound bytes.</span></span> |
| <span data-ttu-id="435f6-209">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="435f6-209">$SampleNodeCount</span></span> |<span data-ttu-id="435f6-210">a számítási csomópontok száma hello.</span><span class="sxs-lookup"><span data-stu-id="435f6-210">hello count of compute nodes.</span></span> |
| <span data-ttu-id="435f6-211">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-211">$ActiveTasks</span></span> |<span data-ttu-id="435f6-212">hello a száma, amelyek készen tooexecute, de még nem végrehajtása feladatok.</span><span class="sxs-lookup"><span data-stu-id="435f6-212">hello number of tasks that are ready tooexecute but are not yet executing.</span></span> <span data-ttu-id="435f6-213">hello $ActiveTasks száma minden feladatokat, amelyek hello aktív állapotban, és amelynek függőségek teljesülnek tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="435f6-213">hello $ActiveTasks count includes all tasks that are in hello active state and whose dependencies have been satisfied.</span></span> <span data-ttu-id="435f6-214">Minden feladatot hello aktív állapotban, de amelynek függőségek nem teljesülnek hello $ActiveTasks száma nem tartoznak.</span><span class="sxs-lookup"><span data-stu-id="435f6-214">Any tasks that are in hello active state but whose dependencies have not been satisfied are excluded from hello $ActiveTasks count.</span></span>|
| <span data-ttu-id="435f6-215">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-215">$RunningTasks</span></span> |<span data-ttu-id="435f6-216">feladatok fut. hello száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-216">hello number of tasks in a running state.</span></span> |
| <span data-ttu-id="435f6-217">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-217">$PendingTasks</span></span> |<span data-ttu-id="435f6-218">$ActiveTasks és $RunningTasks hello összege.</span><span class="sxs-lookup"><span data-stu-id="435f6-218">hello sum of $ActiveTasks and $RunningTasks.</span></span> |
| <span data-ttu-id="435f6-219">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-219">$SucceededTasks</span></span> |<span data-ttu-id="435f6-220">hello számos feladatot, amely sikeresen befejeződött.</span><span class="sxs-lookup"><span data-stu-id="435f6-220">hello number of tasks that finished successfully.</span></span> |
| <span data-ttu-id="435f6-221">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-221">$FailedTasks</span></span> |<span data-ttu-id="435f6-222">a sikertelen feladatok száma hello.</span><span class="sxs-lookup"><span data-stu-id="435f6-222">hello number of tasks that failed.</span></span> |
| <span data-ttu-id="435f6-223">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-223">$CurrentDedicatedNodes</span></span> |<span data-ttu-id="435f6-224">hello aktuális száma dedikált számítási csomópontjain.</span><span class="sxs-lookup"><span data-stu-id="435f6-224">hello current number of dedicated compute nodes.</span></span> |
| <span data-ttu-id="435f6-225">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-225">$CurrentLowPriorityNodes</span></span> |<span data-ttu-id="435f6-226">alacsony prioritású hello aktuális száma számítási csomópontok, beleértve azoknak a fürtöknek, pre-empted törölték.</span><span class="sxs-lookup"><span data-stu-id="435f6-226">hello current number of low-priority compute nodes, including any nodes that have been pre-empted.</span></span> |
| <span data-ttu-id="435f6-227">$PreemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="435f6-227">$PreemptedNodeCount</span></span> | <span data-ttu-id="435f6-228">hello készletben pre-empted állapotban lévő csomópontok hello száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-228">hello number of nodes in hello pool that are in a pre-empted state.</span></span> |

> [!TIP]
> <span data-ttu-id="435f6-229">hello csak olvasható, a szolgáltatás által meghatározott hello előző táblázatban látható értékek *objektumok* társított minden egyes tooaccess adatok különböző módszereket biztosító.</span><span class="sxs-lookup"><span data-stu-id="435f6-229">hello read-only, service-defined variables that are shown in hello previous table are *objects* that provide various methods tooaccess data associated with each.</span></span> <span data-ttu-id="435f6-230">További információkért lásd: [szerezze be a mintaadatokat](#getsampledata) című cikkben.</span><span class="sxs-lookup"><span data-stu-id="435f6-230">For more information, see [Obtain sample data](#getsampledata) later in this article.</span></span>
>
>

## <a name="types"></a><span data-ttu-id="435f6-231">Típusok</span><span class="sxs-lookup"><span data-stu-id="435f6-231">Types</span></span>
<span data-ttu-id="435f6-232">Ezek a típusok támogatottak a képlet:</span><span class="sxs-lookup"><span data-stu-id="435f6-232">These types are supported in a formula:</span></span>

* <span data-ttu-id="435f6-233">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-233">double</span></span>
* <span data-ttu-id="435f6-234">doubleVec</span><span class="sxs-lookup"><span data-stu-id="435f6-234">doubleVec</span></span>
* <span data-ttu-id="435f6-235">doubleVecList</span><span class="sxs-lookup"><span data-stu-id="435f6-235">doubleVecList</span></span>
* <span data-ttu-id="435f6-236">Karakterlánc</span><span class="sxs-lookup"><span data-stu-id="435f6-236">string</span></span>
* <span data-ttu-id="435f6-237">Timestamp típusú--időbélyeg egy összetett struktúra, amely tartalmazza a következő tagok hello:</span><span class="sxs-lookup"><span data-stu-id="435f6-237">timestamp--timestamp is a compound structure that contains hello following members:</span></span>

  * <span data-ttu-id="435f6-238">Év</span><span class="sxs-lookup"><span data-stu-id="435f6-238">year</span></span>
  * <span data-ttu-id="435f6-239">a hónap (1-12)</span><span class="sxs-lookup"><span data-stu-id="435f6-239">month (1-12)</span></span>
  * <span data-ttu-id="435f6-240">a nap (1-31)</span><span class="sxs-lookup"><span data-stu-id="435f6-240">day (1-31)</span></span>
  * <span data-ttu-id="435f6-241">milyen napra esik (hello formátumban szám; például hétfő 1)</span><span class="sxs-lookup"><span data-stu-id="435f6-241">weekday (in hello format of number; for example, 1 for Monday)</span></span>
  * <span data-ttu-id="435f6-242">óra (24 órás számformátumú; például 13 azt jelenti, hogy 1 óra)</span><span class="sxs-lookup"><span data-stu-id="435f6-242">hour (in 24-hour number format; for example, 13 means 1 PM)</span></span>
  * <span data-ttu-id="435f6-243">a perc (00 és 59 közötti)</span><span class="sxs-lookup"><span data-stu-id="435f6-243">minute (00-59)</span></span>
  * <span data-ttu-id="435f6-244">második (00 és 59 közötti)</span><span class="sxs-lookup"><span data-stu-id="435f6-244">second (00-59)</span></span>
* <span data-ttu-id="435f6-245">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="435f6-245">timeinterval</span></span>

  * <span data-ttu-id="435f6-246">TimeInterval_Zero</span><span class="sxs-lookup"><span data-stu-id="435f6-246">TimeInterval_Zero</span></span>
  * <span data-ttu-id="435f6-247">TimeInterval_100ns</span><span class="sxs-lookup"><span data-stu-id="435f6-247">TimeInterval_100ns</span></span>
  * <span data-ttu-id="435f6-248">TimeInterval_Microsecond</span><span class="sxs-lookup"><span data-stu-id="435f6-248">TimeInterval_Microsecond</span></span>
  * <span data-ttu-id="435f6-249">TimeInterval_Millisecond</span><span class="sxs-lookup"><span data-stu-id="435f6-249">TimeInterval_Millisecond</span></span>
  * <span data-ttu-id="435f6-250">TimeInterval_Second</span><span class="sxs-lookup"><span data-stu-id="435f6-250">TimeInterval_Second</span></span>
  * <span data-ttu-id="435f6-251">TimeInterval_Minute</span><span class="sxs-lookup"><span data-stu-id="435f6-251">TimeInterval_Minute</span></span>
  * <span data-ttu-id="435f6-252">TimeInterval_Hour</span><span class="sxs-lookup"><span data-stu-id="435f6-252">TimeInterval_Hour</span></span>
  * <span data-ttu-id="435f6-253">TimeInterval_Day</span><span class="sxs-lookup"><span data-stu-id="435f6-253">TimeInterval_Day</span></span>
  * <span data-ttu-id="435f6-254">TimeInterval_Week</span><span class="sxs-lookup"><span data-stu-id="435f6-254">TimeInterval_Week</span></span>
  * <span data-ttu-id="435f6-255">TimeInterval_Year</span><span class="sxs-lookup"><span data-stu-id="435f6-255">TimeInterval_Year</span></span>

## <a name="operations"></a><span data-ttu-id="435f6-256">Műveletek</span><span class="sxs-lookup"><span data-stu-id="435f6-256">Operations</span></span>
<span data-ttu-id="435f6-257">Ezeket a műveleteket a hello előző szakaszban felsorolt hello típusok engedélyezettek.</span><span class="sxs-lookup"><span data-stu-id="435f6-257">These operations are allowed on hello types that are listed in hello previous section.</span></span>

| <span data-ttu-id="435f6-258">Művelet</span><span class="sxs-lookup"><span data-stu-id="435f6-258">Operation</span></span> | <span data-ttu-id="435f6-259">Támogatott operátorok</span><span class="sxs-lookup"><span data-stu-id="435f6-259">Supported operators</span></span> | <span data-ttu-id="435f6-260">Eredménytípus</span><span class="sxs-lookup"><span data-stu-id="435f6-260">Result type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="435f6-261">kettős *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-261">double *operator* double</span></span> |<span data-ttu-id="435f6-262">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="435f6-262">+, -, *, /</span></span> |<span data-ttu-id="435f6-263">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-263">double</span></span> |
| <span data-ttu-id="435f6-264">kettős *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="435f6-264">double *operator* timeinterval</span></span> |* |<span data-ttu-id="435f6-265">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="435f6-265">timeinterval</span></span> |
| <span data-ttu-id="435f6-266">doubleVec *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-266">doubleVec *operator* double</span></span> |<span data-ttu-id="435f6-267">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="435f6-267">+, -, *, /</span></span> |<span data-ttu-id="435f6-268">doubleVec</span><span class="sxs-lookup"><span data-stu-id="435f6-268">doubleVec</span></span> |
| <span data-ttu-id="435f6-269">doubleVec *operátor* doubleVec</span><span class="sxs-lookup"><span data-stu-id="435f6-269">doubleVec *operator* doubleVec</span></span> |<span data-ttu-id="435f6-270">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="435f6-270">+, -, *, /</span></span> |<span data-ttu-id="435f6-271">doubleVec</span><span class="sxs-lookup"><span data-stu-id="435f6-271">doubleVec</span></span> |
| <span data-ttu-id="435f6-272">TimeInterval *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-272">timeinterval *operator* double</span></span> |<span data-ttu-id="435f6-273">*, /</span><span class="sxs-lookup"><span data-stu-id="435f6-273">*, /</span></span> |<span data-ttu-id="435f6-274">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="435f6-274">timeinterval</span></span> |
| <span data-ttu-id="435f6-275">TimeInterval *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="435f6-275">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="435f6-276">+, -</span><span class="sxs-lookup"><span data-stu-id="435f6-276">+, -</span></span> |<span data-ttu-id="435f6-277">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="435f6-277">timeinterval</span></span> |
| <span data-ttu-id="435f6-278">TimeInterval *operátor* időbélyeg</span><span class="sxs-lookup"><span data-stu-id="435f6-278">timeinterval *operator* timestamp</span></span> |+ |<span data-ttu-id="435f6-279">időbélyeg</span><span class="sxs-lookup"><span data-stu-id="435f6-279">timestamp</span></span> |
| <span data-ttu-id="435f6-280">Timestamp típusú *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="435f6-280">timestamp *operator* timeinterval</span></span> |+ |<span data-ttu-id="435f6-281">időbélyeg</span><span class="sxs-lookup"><span data-stu-id="435f6-281">timestamp</span></span> |
| <span data-ttu-id="435f6-282">Timestamp típusú *operátor* időbélyeg</span><span class="sxs-lookup"><span data-stu-id="435f6-282">timestamp *operator* timestamp</span></span> |- |<span data-ttu-id="435f6-283">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="435f6-283">timeinterval</span></span> |
| <span data-ttu-id="435f6-284">*operátor*dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-284">*operator*double</span></span> |<span data-ttu-id="435f6-285">-, !</span><span class="sxs-lookup"><span data-stu-id="435f6-285">-, !</span></span> |<span data-ttu-id="435f6-286">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-286">double</span></span> |
| <span data-ttu-id="435f6-287">*operátor*timeinterval</span><span class="sxs-lookup"><span data-stu-id="435f6-287">*operator*timeinterval</span></span> |- |<span data-ttu-id="435f6-288">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="435f6-288">timeinterval</span></span> |
| <span data-ttu-id="435f6-289">kettős *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-289">double *operator* double</span></span> |<span data-ttu-id="435f6-290"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="435f6-290"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="435f6-291">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-291">double</span></span> |
| <span data-ttu-id="435f6-292">karakterlánc *operátor* karakterlánc</span><span class="sxs-lookup"><span data-stu-id="435f6-292">string *operator* string</span></span> |<span data-ttu-id="435f6-293"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="435f6-293"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="435f6-294">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-294">double</span></span> |
| <span data-ttu-id="435f6-295">Timestamp típusú *operátor* időbélyeg</span><span class="sxs-lookup"><span data-stu-id="435f6-295">timestamp *operator* timestamp</span></span> |<span data-ttu-id="435f6-296"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="435f6-296"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="435f6-297">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-297">double</span></span> |
| <span data-ttu-id="435f6-298">TimeInterval *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="435f6-298">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="435f6-299"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="435f6-299"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="435f6-300">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-300">double</span></span> |
| <span data-ttu-id="435f6-301">kettős *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-301">double *operator* double</span></span> |<span data-ttu-id="435f6-302">&&, &#124;&#124;</span><span class="sxs-lookup"><span data-stu-id="435f6-302">&&, &#124;&#124;</span></span> |<span data-ttu-id="435f6-303">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-303">double</span></span> |

<span data-ttu-id="435f6-304">Dupla típusú értékként Ternáris operátorral tesztelése során (`double ? statement1 : statement2`), nem nulla van **igaz**, és nulla **hamis**.</span><span class="sxs-lookup"><span data-stu-id="435f6-304">When testing a double with a ternary operator (`double ? statement1 : statement2`), nonzero is **true**, and zero is **false**.</span></span>

## <a name="functions"></a><span data-ttu-id="435f6-305">Functions</span><span class="sxs-lookup"><span data-stu-id="435f6-305">Functions</span></span>
<span data-ttu-id="435f6-306">Ezek előre definiált **funkciók** toouse egy automatikus méretezési képlet definiálásakor érhetők el.</span><span class="sxs-lookup"><span data-stu-id="435f6-306">These predefined **functions** are available for you toouse in defining an automatic scaling formula.</span></span>

| <span data-ttu-id="435f6-307">Függvény</span><span class="sxs-lookup"><span data-stu-id="435f6-307">Function</span></span> | <span data-ttu-id="435f6-308">Visszatérési típusa</span><span class="sxs-lookup"><span data-stu-id="435f6-308">Return type</span></span> | <span data-ttu-id="435f6-309">Leírás</span><span class="sxs-lookup"><span data-stu-id="435f6-309">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="435f6-310">AVG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-310">avg(doubleVecList)</span></span> |<span data-ttu-id="435f6-311">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-311">double</span></span> |<span data-ttu-id="435f6-312">Beolvasása hello hello doubleVecList szereplő összes érték átlagos értékét.</span><span class="sxs-lookup"><span data-stu-id="435f6-312">Returns hello average value for all values in hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-313">len(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-313">len(doubleVecList)</span></span> |<span data-ttu-id="435f6-314">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-314">double</span></span> |<span data-ttu-id="435f6-315">Beolvasása hello hello doubleVecList létrehozott hello vektor hosszának.</span><span class="sxs-lookup"><span data-stu-id="435f6-315">Returns hello length of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-316">LG(Double)</span><span class="sxs-lookup"><span data-stu-id="435f6-316">lg(double)</span></span> |<span data-ttu-id="435f6-317">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-317">double</span></span> |<span data-ttu-id="435f6-318">2 értéket adja vissza hello napló alapszintű hello a dupla.</span><span class="sxs-lookup"><span data-stu-id="435f6-318">Returns hello log base 2 of hello double.</span></span> |
| <span data-ttu-id="435f6-319">LG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-319">lg(doubleVecList)</span></span> |<span data-ttu-id="435f6-320">doubleVec</span><span class="sxs-lookup"><span data-stu-id="435f6-320">doubleVec</span></span> |<span data-ttu-id="435f6-321">Hello component-wise napló hello doubleVecList alap 2 adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-321">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="435f6-322">Egy vec(double) hello paraméter explicit módon kell átadni.</span><span class="sxs-lookup"><span data-stu-id="435f6-322">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="435f6-323">Ellenkező esetben hello dupla lg(double) verzió feltételezi.</span><span class="sxs-lookup"><span data-stu-id="435f6-323">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="435f6-324">ln(Double)</span><span class="sxs-lookup"><span data-stu-id="435f6-324">ln(double)</span></span> |<span data-ttu-id="435f6-325">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-325">double</span></span> |<span data-ttu-id="435f6-326">Beolvasása hello dupla hello természetes naplóját.</span><span class="sxs-lookup"><span data-stu-id="435f6-326">Returns hello natural log of hello double.</span></span> |
| <span data-ttu-id="435f6-327">ln(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-327">ln(doubleVecList)</span></span> |<span data-ttu-id="435f6-328">doubleVec</span><span class="sxs-lookup"><span data-stu-id="435f6-328">doubleVec</span></span> |<span data-ttu-id="435f6-329">Hello component-wise napló hello doubleVecList alap 2 adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-329">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="435f6-330">Egy vec(double) hello paraméter explicit módon kell átadni.</span><span class="sxs-lookup"><span data-stu-id="435f6-330">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="435f6-331">Ellenkező esetben hello dupla lg(double) verzió feltételezi.</span><span class="sxs-lookup"><span data-stu-id="435f6-331">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="435f6-332">log(Double)</span><span class="sxs-lookup"><span data-stu-id="435f6-332">log(double)</span></span> |<span data-ttu-id="435f6-333">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-333">double</span></span> |<span data-ttu-id="435f6-334">Visszaadja hello napló hello alap 10 dupla.</span><span class="sxs-lookup"><span data-stu-id="435f6-334">Returns hello log base 10 of hello double.</span></span> |
| <span data-ttu-id="435f6-335">log(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-335">log(doubleVecList)</span></span> |<span data-ttu-id="435f6-336">doubleVec</span><span class="sxs-lookup"><span data-stu-id="435f6-336">doubleVec</span></span> |<span data-ttu-id="435f6-337">Hello component-wise napló hello doubleVecList alap 10 adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-337">Returns hello component-wise log base 10 of hello doubleVecList.</span></span> <span data-ttu-id="435f6-338">Egy vec(double) hello egyetlen dupla paraméter explicit módon kell átadni.</span><span class="sxs-lookup"><span data-stu-id="435f6-338">A vec(double) must be explicitly passed for hello single double parameter.</span></span> <span data-ttu-id="435f6-339">Ellenkező esetben hello dupla log(double) verzió feltételezi.</span><span class="sxs-lookup"><span data-stu-id="435f6-339">Otherwise, hello double log(double) version is assumed.</span></span> |
| <span data-ttu-id="435f6-340">Max(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-340">max(doubleVecList)</span></span> |<span data-ttu-id="435f6-341">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-341">double</span></span> |<span data-ttu-id="435f6-342">Beolvasása hello hello doubleVecList maximális értéket.</span><span class="sxs-lookup"><span data-stu-id="435f6-342">Returns hello maximum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-343">Min(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-343">min(doubleVecList)</span></span> |<span data-ttu-id="435f6-344">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-344">double</span></span> |<span data-ttu-id="435f6-345">Beolvasása hello hello doubleVecList minimális értéket.</span><span class="sxs-lookup"><span data-stu-id="435f6-345">Returns hello minimum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-346">NORM(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-346">norm(doubleVecList)</span></span> |<span data-ttu-id="435f6-347">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-347">double</span></span> |<span data-ttu-id="435f6-348">Vissza a két-alapértelmezetté hello vektor hello doubleVecList létrehozott hello.</span><span class="sxs-lookup"><span data-stu-id="435f6-348">Returns hello two-norm of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-349">a PERCENTILIS (doubleVec v, dupla p)</span><span class="sxs-lookup"><span data-stu-id="435f6-349">percentile(doubleVec v, double p)</span></span> |<span data-ttu-id="435f6-350">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-350">double</span></span> |<span data-ttu-id="435f6-351">Beolvasása hello PERCENTILIS elem hello vektor v.</span><span class="sxs-lookup"><span data-stu-id="435f6-351">Returns hello percentile element of hello vector v.</span></span> |
| <span data-ttu-id="435f6-352">rand()</span><span class="sxs-lookup"><span data-stu-id="435f6-352">rand()</span></span> |<span data-ttu-id="435f6-353">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-353">double</span></span> |<span data-ttu-id="435f6-354">Egy véletlenszerű értéke 0,0 és 1,0 között.</span><span class="sxs-lookup"><span data-stu-id="435f6-354">Returns a random value between 0.0 and 1.0.</span></span> |
| <span data-ttu-id="435f6-355">Range(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-355">range(doubleVecList)</span></span> |<span data-ttu-id="435f6-356">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-356">double</span></span> |<span data-ttu-id="435f6-357">Hello doubleVecList hello hello minimális és maximális értékek különbségét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-357">Returns hello difference between hello min and max values in hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-358">STD(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-358">std(doubleVecList)</span></span> |<span data-ttu-id="435f6-359">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-359">double</span></span> |<span data-ttu-id="435f6-360">Beolvasása hello minta szórásának hello doubleVecList hello értékeit.</span><span class="sxs-lookup"><span data-stu-id="435f6-360">Returns hello sample standard deviation of hello values in hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-361">Stop()</span><span class="sxs-lookup"><span data-stu-id="435f6-361">stop()</span></span> | |<span data-ttu-id="435f6-362">Leállítja a hello automatikus skálázás kifejezés kiértékelése.</span><span class="sxs-lookup"><span data-stu-id="435f6-362">Stops evaluation of hello autoscaling expression.</span></span> |
| <span data-ttu-id="435f6-363">Sum(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="435f6-363">sum(doubleVecList)</span></span> |<span data-ttu-id="435f6-364">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-364">double</span></span> |<span data-ttu-id="435f6-365">Beolvasása hello hello doubleVecList összetevői összes hello összege.</span><span class="sxs-lookup"><span data-stu-id="435f6-365">Returns hello sum of all hello components of hello doubleVecList.</span></span> |
| <span data-ttu-id="435f6-366">idő (dateTime karakterlánc = "")</span><span class="sxs-lookup"><span data-stu-id="435f6-366">time(string dateTime="")</span></span> |<span data-ttu-id="435f6-367">időbélyeg</span><span class="sxs-lookup"><span data-stu-id="435f6-367">timestamp</span></span> |<span data-ttu-id="435f6-368">Ha adja vissza hello időbélyegzőjét hello aktuális idő paraméterek át lettek adva, vagy hello hello dátum/idő karakterlánc időbélyegzőjét, ha átadva.</span><span class="sxs-lookup"><span data-stu-id="435f6-368">Returns hello time stamp of hello current time if no parameters are passed, or hello time stamp of hello dateTime string if it is passed.</span></span> <span data-ttu-id="435f6-369">Támogatott dátum és idő formátumok a következők: W3C-DTF és RFC 1123.</span><span class="sxs-lookup"><span data-stu-id="435f6-369">Supported dateTime formats are W3C-DTF and RFC 1123.</span></span> |
| <span data-ttu-id="435f6-370">val (doubleVec v, dupla i)</span><span class="sxs-lookup"><span data-stu-id="435f6-370">val(doubleVec v, double i)</span></span> |<span data-ttu-id="435f6-371">Dupla</span><span class="sxs-lookup"><span data-stu-id="435f6-371">double</span></span> |<span data-ttu-id="435f6-372">Hello tényező, amely helyén i vektoros v, a nulla kezdődő indexű hello értékét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-372">Returns hello value of hello element that is at location i in vector v, with a starting index of zero.</span></span> |

<span data-ttu-id="435f6-373">Egy listát, amelynek argumentuma fogadhatnak hello függvények hello előző táblázatban ismertetett.</span><span class="sxs-lookup"><span data-stu-id="435f6-373">Some of hello functions that are described in hello previous table can accept a list as an argument.</span></span> <span data-ttu-id="435f6-374">hello vesszővel elválasztott lista bármilyen kombinációját *dupla* és *doubleVec*.</span><span class="sxs-lookup"><span data-stu-id="435f6-374">hello comma-separated list is any combination of *double* and *doubleVec*.</span></span> <span data-ttu-id="435f6-375">Példa:</span><span class="sxs-lookup"><span data-stu-id="435f6-375">For example:</span></span>

`doubleVecList := ( (double | doubleVec)+(, (double | doubleVec) )* )?`

<span data-ttu-id="435f6-376">Hello *doubleVecList* értéke egyetlen konvertált tooa *doubleVec* kiértékelése előtt.</span><span class="sxs-lookup"><span data-stu-id="435f6-376">hello *doubleVecList* value is converted tooa single *doubleVec* before evaluation.</span></span> <span data-ttu-id="435f6-377">Például ha `v = [1,2,3]`, majd hívja `avg(v)` egyenértékű toocalling van `avg(1,2,3)`.</span><span class="sxs-lookup"><span data-stu-id="435f6-377">For example, if `v = [1,2,3]`, then calling `avg(v)` is equivalent toocalling `avg(1,2,3)`.</span></span> <span data-ttu-id="435f6-378">Hívása `avg(v, 7)` egyenértékű toocalling van `avg(1,2,3,7)`.</span><span class="sxs-lookup"><span data-stu-id="435f6-378">Calling `avg(v, 7)` is equivalent toocalling `avg(1,2,3,7)`.</span></span>

## <span data-ttu-id="435f6-379"><a name="getsampledata"></a>Szerezze be a mintaadatokat</span><span class="sxs-lookup"><span data-stu-id="435f6-379"><a name="getsampledata"></a>Obtain sample data</span></span>
<span data-ttu-id="435f6-380">Hello Batch szolgáltatás által biztosított metrikákat adatok (minták) automatikus skálázási hajtanak végre műveleteket.</span><span class="sxs-lookup"><span data-stu-id="435f6-380">Autoscale formulas act on metrics data (samples) that is provided by hello Batch service.</span></span> <span data-ttu-id="435f6-381">A képlet nő, vagy zsugorítja a készlet méretét, amelyek hello szolgáltatás megszerzi hello értékek alapján.</span><span class="sxs-lookup"><span data-stu-id="435f6-381">A formula grows or shrinks pool size based on hello values that it obtains from hello service.</span></span> <span data-ttu-id="435f6-382">hello szolgáltatás által definiált változókat leírt korábban olyan objektumok, amelyek különböző módszereket biztosítanak a társított objektumokat, amelyek tooaccess vonatkozó adatokat.</span><span class="sxs-lookup"><span data-stu-id="435f6-382">hello service-defined variables that were described previously are objects that provide various methods tooaccess data that is associated with that object.</span></span> <span data-ttu-id="435f6-383">Például hello következő kifejezés mutatja egy kérelem tooget hello utolsó öt percen CPU-használat:</span><span class="sxs-lookup"><span data-stu-id="435f6-383">For example, hello following expression shows a request tooget hello last five minutes of CPU usage:</span></span>

```
$CPUPercent.GetSample(TimeInterval_Minute * 5)
```

| <span data-ttu-id="435f6-384">Módszer</span><span class="sxs-lookup"><span data-stu-id="435f6-384">Method</span></span> | <span data-ttu-id="435f6-385">Leírás</span><span class="sxs-lookup"><span data-stu-id="435f6-385">Description</span></span> |
| --- | --- |
| <span data-ttu-id="435f6-386">GetSample()</span><span class="sxs-lookup"><span data-stu-id="435f6-386">GetSample()</span></span> |<span data-ttu-id="435f6-387">Hello `GetSample()` metódus egy adatok minták-vektorát adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-387">hello `GetSample()` method returns a vector of data samples.</span></span><br/><br/><span data-ttu-id="435f6-388">Egy minta érték metrikák adatok érdemes 30 másodperc.</span><span class="sxs-lookup"><span data-stu-id="435f6-388">A sample is 30 seconds worth of metrics data.</span></span> <span data-ttu-id="435f6-389">Más szóval minták akkor kapja meg, 30 másodperces.</span><span class="sxs-lookup"><span data-stu-id="435f6-389">In other words, samples are obtained every 30 seconds.</span></span> <span data-ttu-id="435f6-390">Azonban az alábbi esetekben, amikor egy minta gyűjt, és elérhető tooa képlet késleltetés van.</span><span class="sxs-lookup"><span data-stu-id="435f6-390">But as noted below, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="435f6-391">Mint ilyen nem minden mintákat egy adott időszakra vonatkozóan egy képlettel értékelésre érhetők el.</span><span class="sxs-lookup"><span data-stu-id="435f6-391">As such, not all samples for a given time period may be available for evaluation by a formula.</span></span><ul><li>`doubleVec GetSample(double count)`<br/><span data-ttu-id="435f6-392">Minták tooobtain hello legutóbbi minták összegyűjtött hello számát adja meg.</span><span class="sxs-lookup"><span data-stu-id="435f6-392">Specifies hello number of samples tooobtain from hello most recent samples that were collected.</span></span><br/><br/><span data-ttu-id="435f6-393">`GetSample(1)`az utolsó elérhető minta hello adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-393">`GetSample(1)` returns hello last available sample.</span></span> <span data-ttu-id="435f6-394">A metrikák, például `$CPUPercent`, azonban ez nem használható mert lehetetlen tooknow *amikor* hello minta gyűjtötte a program.</span><span class="sxs-lookup"><span data-stu-id="435f6-394">For metrics like `$CPUPercent`, however, this should not be used because it is impossible tooknow *when* hello sample was collected.</span></span> <span data-ttu-id="435f6-395">Előfordulhat, hogy friss, vagy a rendszer problémák miatt előfordulhat, hogy sokkal régebbi.</span><span class="sxs-lookup"><span data-stu-id="435f6-395">It might be recent, or, because of system issues, it might be much older.</span></span> <span data-ttu-id="435f6-396">Érdemes az ilyen esetekben toouse egy adott időintervallumban alább látható módon.</span><span class="sxs-lookup"><span data-stu-id="435f6-396">It is better in such cases toouse a time interval as shown below.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime [, double samplePercent])`<br/><span data-ttu-id="435f6-397">Adja meg vagy időszakon minta adatgyűjtést.</span><span class="sxs-lookup"><span data-stu-id="435f6-397">Specifies a time frame for gathering sample data.</span></span> <span data-ttu-id="435f6-398">Másik lehetőségként azt is, amely hello elérhetőnek kell lennie a minták hello százalékos kért időkereten belül.</span><span class="sxs-lookup"><span data-stu-id="435f6-398">Optionally, it also specifies hello percentage of samples that must be available in hello requested time frame.</span></span><br/><br/><span data-ttu-id="435f6-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)`20 minták alakítanák vissza, ha az elmúlt 10 perc hello összes mintát hello CPUPercent előzmények léteznek.</span><span class="sxs-lookup"><span data-stu-id="435f6-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)` would return 20 samples if all samples for hello last 10 minutes are present in hello CPUPercent history.</span></span> <span data-ttu-id="435f6-400">Ha a előzmények hello utolsó perce nem volt elérhető, azonban csak 18 minták akkor adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-400">If hello last minute of history was not available, however, only 18 samples would be returned.</span></span> <span data-ttu-id="435f6-401">Ebben az esetben:</span><span class="sxs-lookup"><span data-stu-id="435f6-401">In this case:</span></span><br/><br/><span data-ttu-id="435f6-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)`fognak működni, mert csak 90 százalékos hello minták érhetők el.</span><span class="sxs-lookup"><span data-stu-id="435f6-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)` would fail because only 90 percent of hello samples are available.</span></span><br/><br/><span data-ttu-id="435f6-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)`járnak.</span><span class="sxs-lookup"><span data-stu-id="435f6-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` would succeed.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime, (timestamp or timeinterval) endTime [, double samplePercent])`<br/><span data-ttu-id="435f6-404">Adatgyűjtés a kezdési idő és a befejezési idő időkeretet határozza meg.</span><span class="sxs-lookup"><span data-stu-id="435f6-404">Specifies a time frame for gathering data, with both a start time and an end time.</span></span><br/><br/><span data-ttu-id="435f6-405">Fent említett nincs amikor minta gyűjt, és elérhető tooa képlet késleltetés.</span><span class="sxs-lookup"><span data-stu-id="435f6-405">As mentioned above, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="435f6-406">Hello használatakor vegye figyelembe az a késleltetés `GetSample` metódust.</span><span class="sxs-lookup"><span data-stu-id="435f6-406">Consider this delay when you use hello `GetSample` method.</span></span> <span data-ttu-id="435f6-407">Lásd: `GetSamplePercent` alatt.</span><span class="sxs-lookup"><span data-stu-id="435f6-407">See `GetSamplePercent` below.</span></span> |
| <span data-ttu-id="435f6-408">GetSamplePeriod()</span><span class="sxs-lookup"><span data-stu-id="435f6-408">GetSamplePeriod()</span></span> |<span data-ttu-id="435f6-409">Egy korábbi minta adathalmaz végrehajtott minták hello dátumtartományt ad vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-409">Returns hello period of samples that were taken in a historical sample data set.</span></span> |
| <span data-ttu-id="435f6-410">Count()</span><span class="sxs-lookup"><span data-stu-id="435f6-410">Count()</span></span> |<span data-ttu-id="435f6-411">Beolvasása hello hello metrika előzmények minták száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-411">Returns hello total number of samples in hello metric history.</span></span> |
| <span data-ttu-id="435f6-412">HistoryBeginTime()</span><span class="sxs-lookup"><span data-stu-id="435f6-412">HistoryBeginTime()</span></span> |<span data-ttu-id="435f6-413">Beolvasása hello hello legrégebbi rendelkezésre álló adatok minta hello metrika időbélyegzőjét.</span><span class="sxs-lookup"><span data-stu-id="435f6-413">Returns hello time stamp of hello oldest available data sample for hello metric.</span></span> |
| <span data-ttu-id="435f6-414">GetSamplePercent()</span><span class="sxs-lookup"><span data-stu-id="435f6-414">GetSamplePercent()</span></span> |<span data-ttu-id="435f6-415">Értéket ad vissza egy adott időintervallumban a rendelkezésre álló minták százalékos hello.</span><span class="sxs-lookup"><span data-stu-id="435f6-415">Returns hello percentage of samples that are available for a given time interval.</span></span> <span data-ttu-id="435f6-416">Példa:</span><span class="sxs-lookup"><span data-stu-id="435f6-416">For example:</span></span><br/><br/>`doubleVec GetSamplePercent( (timestamp or timeinterval) startTime [, (timestamp or timeinterval) endTime] )`<br/><br/><span data-ttu-id="435f6-417">Mivel hello `GetSample` módszer nem jár sikerrel, ha a visszaadott minták hello aránya nem éri el hello `samplePercent` megadott, használhat hello `GetSamplePercent` metódus toocheck első.</span><span class="sxs-lookup"><span data-stu-id="435f6-417">Because hello `GetSample` method fails if hello percentage of samples returned is less than hello `samplePercent` specified, you can use hello `GetSamplePercent` method toocheck first.</span></span> <span data-ttu-id="435f6-418">Majd egy másik műveletet hajthatnak végre, ha elegendő minták léteznek, Leállítás, hello automatikus méretezési értékelése nélkül.</span><span class="sxs-lookup"><span data-stu-id="435f6-418">Then you can perform an alternate action if insufficient samples are present, without halting hello automatic scaling evaluation.</span></span> |

### <a name="samples-sample-percentage-and-hello-getsample-method"></a><span data-ttu-id="435f6-419">Minták, a minta százalékos és hello *GetSample()* módszer</span><span class="sxs-lookup"><span data-stu-id="435f6-419">Samples, sample percentage, and hello *GetSample()* method</span></span>
<span data-ttu-id="435f6-420">hello alapvető működéséhez, az automatikus skálázás képlet tooobtain tevékenység- és metrika értékét, majd állítsa be a készlet méretét az adatok alapján.</span><span class="sxs-lookup"><span data-stu-id="435f6-420">hello core operation of an autoscale formula is tooobtain task and resource metric data and then adjust pool size based on that data.</span></span> <span data-ttu-id="435f6-421">Mint ilyen akkor fontos toohave pontosan ismeri a automatikus skálázás képletek hogyan működnek együtt a metrikai adatok (minták).</span><span class="sxs-lookup"><span data-stu-id="435f6-421">As such, it is important toohave a clear understanding of how autoscale formulas interact with metrics data (samples).</span></span>

<span data-ttu-id="435f6-422">**Példák**</span><span class="sxs-lookup"><span data-stu-id="435f6-422">**Samples**</span></span>

<span data-ttu-id="435f6-423">hello Batch szolgáltatás rendszeres időközönként a tevékenység- és mérőszámok mintát vesz igénybe, és elérhető tooyour automatikus skálázás képletek lehetővé teszi.</span><span class="sxs-lookup"><span data-stu-id="435f6-423">hello Batch service periodically takes samples of task and resource metrics and makes them available tooyour autoscale formulas.</span></span> <span data-ttu-id="435f6-424">Ezeket a mintákat hello Batch szolgáltatás által 30 másodpercenként rögzítését.</span><span class="sxs-lookup"><span data-stu-id="435f6-424">These samples are recorded every 30 seconds by hello Batch service.</span></span> <span data-ttu-id="435f6-425">Van azonban általában a késleltetés között, ha ezek a minták rögzítve, és elérhetővé válnak túl (és tudja olvasni.) az automatikus skálázás formulákat.</span><span class="sxs-lookup"><span data-stu-id="435f6-425">However, there is typically a delay between when those samples were recorded and when they are made available too(and can be read by) your autoscale formulas.</span></span> <span data-ttu-id="435f6-426">Emellett toovarious tényezőkkel, például hálózati vagy egyéb infrastrukturális problémára, miatt minták előfordulhat, hogy nem rögzíti egy adott időszakban.</span><span class="sxs-lookup"><span data-stu-id="435f6-426">Additionally, due toovarious factors such as network or other infrastructure issues, samples may not be recorded for a particular interval.</span></span>

<span data-ttu-id="435f6-427">**A minta százalékos aránya**</span><span class="sxs-lookup"><span data-stu-id="435f6-427">**Sample percentage**</span></span>

<span data-ttu-id="435f6-428">Amikor `samplePercent` toohello átadása `GetSample()` metódus vagy hello `GetSamplePercent()` metódus lehívásra kerül, _százalékos_ hivatkozik tooa összehasonlítása hello száma minták hello Batch szolgáltatás által rögzített és hello a száma, amelyek a rendelkezésre álló tooyour automatikus skálázás képlet minták.</span><span class="sxs-lookup"><span data-stu-id="435f6-428">When `samplePercent` is passed toohello `GetSample()` method or hello `GetSamplePercent()` method is called, _percent_ refers tooa comparison between hello total possible number of samples that are recorded by hello Batch service and hello number of samples that are available tooyour autoscale formula.</span></span>

<span data-ttu-id="435f6-429">Nézzük timespan érték 10 perc példaként.</span><span class="sxs-lookup"><span data-stu-id="435f6-429">Let's look at a 10-minute timespan as an example.</span></span> <span data-ttu-id="435f6-430">Minták tárolja, 30 másodperces timespan érték 10 perc belül, mert hello maximális kötegelt rögzített minták száma 20 minták (2 / perc) lehet.</span><span class="sxs-lookup"><span data-stu-id="435f6-430">Because samples are recorded every 30 seconds within a 10-minute timespan, hello maximum total number of samples that are recorded by Batch would be 20 samples (2 per minute).</span></span> <span data-ttu-id="435f6-431">Előfordulhat azonban, miatt toohello hello jelentéskészítő mechanizmus és más olyan problémák Azure-ban rejlő késését, nem csak 15 mintákat, amelyek a rendelkezésre álló tooyour automatikus skálázás képlet olvasását.</span><span class="sxs-lookup"><span data-stu-id="435f6-431">However, due toohello inherent latency of hello reporting mechanism and other issues within Azure, there may be only 15 samples that are available tooyour autoscale formula for reading.</span></span> <span data-ttu-id="435f6-432">Így például, hogy 10 perc alatt 75 %-a hello rögzített minták száma lehet elérhető tooyour képlet.</span><span class="sxs-lookup"><span data-stu-id="435f6-432">So, for example, for that 10-minute period, only 75% of hello total number of samples recorded may be available tooyour formula.</span></span>

<span data-ttu-id="435f6-433">**GetSample() és minta tartományok**</span><span class="sxs-lookup"><span data-stu-id="435f6-433">**GetSample() and sample ranges**</span></span>

<span data-ttu-id="435f6-434">Az automatikus skálázás képletek folyamatos toobe növekvő, és a készletek zsugorítását &mdash; csomópontok hozzáadása vagy eltávolítása a csomópontok.</span><span class="sxs-lookup"><span data-stu-id="435f6-434">Your autoscale formulas are going toobe growing and shrinking your pools &mdash; adding nodes or removing nodes.</span></span> <span data-ttu-id="435f6-435">Csomópontok pénz költségeket, mert a képlet egy intelligens módot használó elegendő adatot alapuló elemzési tooensure kívánt.</span><span class="sxs-lookup"><span data-stu-id="435f6-435">Because nodes cost you money, you want tooensure that your formulas use an intelligent method of analysis that is based on sufficient data.</span></span> <span data-ttu-id="435f6-436">Ezért azt javasoljuk, hogy használja-e a trendek-elemzés a képletekben.</span><span class="sxs-lookup"><span data-stu-id="435f6-436">Therefore, we recommend that you use a trending-type analysis in your formulas.</span></span> <span data-ttu-id="435f6-437">Ez a típus növekszik, és az összegyűjtött minták alapján készletek zsugorítja.</span><span class="sxs-lookup"><span data-stu-id="435f6-437">This type grows and shrinks your pools based on a range of collected samples.</span></span>

<span data-ttu-id="435f6-438">Igen, használjon toodo `GetSample(interval look-back start, interval look-back end)` tooreturn vektor minták:</span><span class="sxs-lookup"><span data-stu-id="435f6-438">toodo so, use `GetSample(interval look-back start, interval look-back end)` tooreturn a vector of samples:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(1 * TimeInterval_Minute, 6 * TimeInterval_Minute);
```

<span data-ttu-id="435f6-439">Hello sorban fölött kötegelt kiértékelésekor értékek vektor vissza minták számos.</span><span class="sxs-lookup"><span data-stu-id="435f6-439">When hello above line is evaluated by Batch, it returns a range of samples as a vector of values.</span></span> <span data-ttu-id="435f6-440">Példa:</span><span class="sxs-lookup"><span data-stu-id="435f6-440">For example:</span></span>

```
$runningTasksSample=[1,1,1,1,1,1,1,1,1,1];
```

<span data-ttu-id="435f6-441">Miután hello vektoros minták összegyűjtött használhatók funkciók, például a `min()`, `max()`, és `avg()` tooderive jelentéssel bíró értékeinek hello gyűjtött tartományon.</span><span class="sxs-lookup"><span data-stu-id="435f6-441">Once you've collected hello vector of samples, you can then use functions like `min()`, `max()`, and `avg()` tooderive meaningful values from hello collected range.</span></span>

<span data-ttu-id="435f6-442">A fokozott biztonság érdekében beállíthatja egy kiértékelési toofail Ha kisebb, mint egy bizonyos minta százalék érhető el egy adott időszakra vonatkozóan.</span><span class="sxs-lookup"><span data-stu-id="435f6-442">For additional security, you can force a formula evaluation toofail if less than a certain sample percentage is available for a particular time period.</span></span> <span data-ttu-id="435f6-443">Ha egy kiértékelési toofail kényszerítéséhez utasította további kötegelt toocease hello képlet értékelése hello megadott százalékos minták nem áll rendelkezésre.</span><span class="sxs-lookup"><span data-stu-id="435f6-443">When you force a formula evaluation toofail, you instruct Batch toocease further evaluation of hello formula if hello specified percentage of samples is not available.</span></span> <span data-ttu-id="435f6-444">Ebben az esetben nem történik változás toohello készletméretet.</span><span class="sxs-lookup"><span data-stu-id="435f6-444">In this case, no change is made toohello pool size.</span></span> <span data-ttu-id="435f6-445">toospecify szükséges százalékos arányában minták hello értékelési toosucceed, adja meg azt, a harmadik paraméter túl hello`GetSample()`.</span><span class="sxs-lookup"><span data-stu-id="435f6-445">toospecify a required percentage of samples for hello evaluation toosucceed, specify it as hello third parameter too`GetSample()`.</span></span> <span data-ttu-id="435f6-446">Itt 75 százalékával minták követelményt van megadva:</span><span class="sxs-lookup"><span data-stu-id="435f6-446">Here, a requirement of 75 percent of samples is specified:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(60 * TimeInterval_Second, 120 * TimeInterval_Second, 75);
```

<span data-ttu-id="435f6-447">Mivel a minta rendelkezésre állási késés előfordulhat, fontos tooalways adjon meg egy időtartományt a következő megjelenését visszaírt kezdő időpontja korábbi, mint egy perc.</span><span class="sxs-lookup"><span data-stu-id="435f6-447">Because there may be a delay in sample availability, it is important tooalways specify a time range with a look-back start time that is older than one minute.</span></span> <span data-ttu-id="435f6-448">Körülbelül egy percet vesz igénybe a minták toopropagate hello rendszeren keresztül, így minták hello közé `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="435f6-448">It takes approximately one minute for samples toopropagate through hello system, so samples in hello range `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` may not be available.</span></span> <span data-ttu-id="435f6-449">Ebben az esetben hello százalékos paraméterét használhatja `GetSample()` tooforce egy adott minta százalékos követelményt.</span><span class="sxs-lookup"><span data-stu-id="435f6-449">Again, you can use hello percentage parameter of `GetSample()` tooforce a particular sample percentage requirement.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="435f6-450">A Microsoft **erősen ajánlott** , amikor **elkerülése érdekében a megbízható függő *csak* a `GetSample(1)` az automatikus skálázás képletekben**.</span><span class="sxs-lookup"><span data-stu-id="435f6-450">We **strongly recommend** that you **avoid relying *only* on `GetSample(1)` in your autoscale formulas**.</span></span> <span data-ttu-id="435f6-451">Ennek az az oka `GetSample(1)` lényegében szerint toohello Batch szolgáltatás, a "Me hello rendelkezik, az utolsó minta adjon nem számít, hogy mennyivel beolvasni."</span><span class="sxs-lookup"><span data-stu-id="435f6-451">This is because `GetSample(1)` essentially says toohello Batch service, "Give me hello last sample you have, no matter how long ago you retrieved it."</span></span> <span data-ttu-id="435f6-452">Csak egy egyszeres, és lehet, hogy egy régebbi mintát, mert nem lehet képviselője hello nagyobb kép legutóbbi tevékenység vagy erőforrás-állapot.</span><span class="sxs-lookup"><span data-stu-id="435f6-452">Since it is only a single sample, and it may be an older sample, it may not be representative of hello larger picture of recent task or resource state.</span></span> <span data-ttu-id="435f6-453">Ha a `GetSample(1)`, győződjön meg arról, hogy a nagyobb utasítás részét, és nem hello csak pontja, amely a képlet támaszkodik.</span><span class="sxs-lookup"><span data-stu-id="435f6-453">If you do use `GetSample(1)`, make sure that it's part of a larger statement and not hello only data point that your formula relies on.</span></span>
>
>

## <a name="metrics"></a><span data-ttu-id="435f6-454">Mérőszámok</span><span class="sxs-lookup"><span data-stu-id="435f6-454">Metrics</span></span>
<span data-ttu-id="435f6-455">Erőforrás és a feladat metrikák képlet definiálásakor még használhatja.</span><span class="sxs-lookup"><span data-stu-id="435f6-455">You can use both resource and task metrics when you're defining a formula.</span></span> <span data-ttu-id="435f6-456">Hello készletben hello metrikák adatokon alapulnak beszerzése és értékelje ki dedikált csomópontok száma hello cél módosíthatja.</span><span class="sxs-lookup"><span data-stu-id="435f6-456">You adjust hello target number of dedicated nodes in hello pool based on hello metrics data that you obtain and evaluate.</span></span> <span data-ttu-id="435f6-457">Lásd: hello [változók](#variables) szakasz fölött mindegyik metrikát olvashat.</span><span class="sxs-lookup"><span data-stu-id="435f6-457">See hello [Variables](#variables) section above for more information on each metric.</span></span>

<table>
  <tr>
    <th><span data-ttu-id="435f6-458">Metrika</span><span class="sxs-lookup"><span data-stu-id="435f6-458">Metric</span></span></th>
    <th><span data-ttu-id="435f6-459">Leírás</span><span class="sxs-lookup"><span data-stu-id="435f6-459">Description</span></span></th>
  </tr>
  <tr>
    <td><span data-ttu-id="435f6-460"><b>Erőforrás</b></span><span class="sxs-lookup"><span data-stu-id="435f6-460"><b>Resource</b></span></span></td>
    <td><p><span data-ttu-id="435f6-461">Erőforrás metrikák hello CPU, a hello sávszélesség, a számítási csomópontok hello memóriahasználata alapulnak, és hello csomópontok száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-461">Resource metrics are based on hello CPU, hello bandwidth, hello memory usage of compute nodes, and hello number of nodes.</span></span></p>
        <p> <span data-ttu-id="435f6-462">A szolgáltatás által definiált változókat hasznosak korrekciók csomópontok száma alapján:</span><span class="sxs-lookup"><span data-stu-id="435f6-462">These service-defined variables are useful for making adjustments based on node count:</span></span></p>
    <p><ul>
            <li><span data-ttu-id="435f6-463">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-463">$TargetDedicatedNodes</span></span></li>
            <li><span data-ttu-id="435f6-464">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-464">$TargetLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="435f6-465">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-465">$CurrentDedicatedNodes</span></span></li>
            <li><span data-ttu-id="435f6-466">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="435f6-466">$CurrentLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="435f6-467">$preemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="435f6-467">$preemptedNodeCount</span></span></li>
            <li><span data-ttu-id="435f6-468">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="435f6-468">$SampleNodeCount</span></span></li>
    </ul></p>
    <p><span data-ttu-id="435f6-469">A szolgáltatás által definiált változókat hasznosak korrekciók csomópont erőforrás-használat alapján:</span><span class="sxs-lookup"><span data-stu-id="435f6-469">These service-defined variables are useful for making adjustments based on node resource usage:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="435f6-470">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="435f6-470">$CPUPercent</span></span></li>
      <li><span data-ttu-id="435f6-471">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="435f6-471">$WallClockSeconds</span></span></li>
      <li><span data-ttu-id="435f6-472">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-472">$MemoryBytes</span></span></li>
      <li><span data-ttu-id="435f6-473">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-473">$DiskBytes</span></span></li>
      <li><span data-ttu-id="435f6-474">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-474">$DiskReadBytes</span></span></li>
      <li><span data-ttu-id="435f6-475">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-475">$DiskWriteBytes</span></span></li>
      <li><span data-ttu-id="435f6-476">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="435f6-476">$DiskReadOps</span></span></li>
      <li><span data-ttu-id="435f6-477">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="435f6-477">$DiskWriteOps</span></span></li>
      <li><span data-ttu-id="435f6-478">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-478">$NetworkInBytes</span></span></li>
      <li><span data-ttu-id="435f6-479">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="435f6-479">$NetworkOutBytes</span></span></li></ul></p>
  </tr>
  <tr>
    <td><span data-ttu-id="435f6-480"><b>Tevékenység</b></span><span class="sxs-lookup"><span data-stu-id="435f6-480"><b>Task</b></span></span></td>
    <td><p><span data-ttu-id="435f6-481">Feladat metrikák függőben, feladatok, például az aktív, hello állapotának alapulnak, és befejeződött.</span><span class="sxs-lookup"><span data-stu-id="435f6-481">Task metrics are based on hello status of tasks, such as Active, Pending, and Completed.</span></span> <span data-ttu-id="435f6-482">hello következő szolgáltatás által definiált változókat hasznos, ha a feladat mérőszámok alapján készletméretet korrekciók:</span><span class="sxs-lookup"><span data-stu-id="435f6-482">hello following service-defined variables are useful for making pool-size adjustments based on task metrics:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="435f6-483">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-483">$ActiveTasks</span></span></li>
      <li><span data-ttu-id="435f6-484">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-484">$RunningTasks</span></span></li>
      <li><span data-ttu-id="435f6-485">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-485">$PendingTasks</span></span></li>
      <li><span data-ttu-id="435f6-486">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-486">$SucceededTasks</span></span></li>
            <li><span data-ttu-id="435f6-487">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="435f6-487">$FailedTasks</span></span></li></ul></p>
        </td>
  </tr>
</table>

## <a name="write-an-autoscale-formula"></a><span data-ttu-id="435f6-488">Az automatikus skálázás képlet írása</span><span class="sxs-lookup"><span data-stu-id="435f6-488">Write an autoscale formula</span></span>
<span data-ttu-id="435f6-489">Kibővített kialakítást hozhat létre az automatikus skálázás képlet képező utasításokat, amelyek a fenti összetevők hello használja, majd egyesítése egy teljes képlet ezen utasításokat.</span><span class="sxs-lookup"><span data-stu-id="435f6-489">You build an autoscale formula by forming statements that use hello above components, then combine those statements into a complete formula.</span></span> <span data-ttu-id="435f6-490">Ebben a szakaszban egy példa automatikus skálázás képlet által végrehajtható műveleteket az egyes valós méretezési döntések tudjuk létrehozni.</span><span class="sxs-lookup"><span data-stu-id="435f6-490">In this section, we create an example autoscale formula that can perform some real-world scaling decisions.</span></span>

<span data-ttu-id="435f6-491">Először is határozza meg az új automatikus skálázás képlet hello követelményei.</span><span class="sxs-lookup"><span data-stu-id="435f6-491">First, let's define hello requirements for our new autoscale formula.</span></span> <span data-ttu-id="435f6-492">hello képlet a következőket:</span><span class="sxs-lookup"><span data-stu-id="435f6-492">hello formula should:</span></span>

1. <span data-ttu-id="435f6-493">Növelje a készlet dedikált számítási csomópontok száma hello célja, ha a CPU-használata túl magas.</span><span class="sxs-lookup"><span data-stu-id="435f6-493">Increase hello target number of dedicated compute nodes in a pool if CPU usage is high.</span></span>
2. <span data-ttu-id="435f6-494">Egy dedikált számítási csomópontok száma hello cél csökkentéséhez, amikor a CPU-használat alacsony.</span><span class="sxs-lookup"><span data-stu-id="435f6-494">Decrease hello target number of dedicated compute nodes in a pool when CPU usage is low.</span></span>
3. <span data-ttu-id="435f6-495">Mindig korlátozása hello too400 dedikált csomópontok maximális száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-495">Always restrict hello maximum number of dedicated nodes too400.</span></span>

<span data-ttu-id="435f6-496">magas CPU-használat során csomópontok száma tooincrease hello hello utasításban, amely tölti fel a felhasználó által definiált változó határozza meg (`$totalDedicatedNodes`) 110 százalékát hello aktuális cél dedikált csomópontok száma, de csak akkor, ha értékkel hello minimális átlagos CPU-használat hello során az utolsó 10 percet 70 százalék felett volt.</span><span class="sxs-lookup"><span data-stu-id="435f6-496">tooincrease hello number of nodes during high CPU usage, define hello statement that populates a user-defined variable (`$totalDedicatedNodes`) with a value that is 110 percent of hello current target number of dedicated nodes, but only if hello minimum average CPU usage during hello last 10 minutes was above 70 percent.</span></span> <span data-ttu-id="435f6-497">Ellenkező esetben használja a hello értéket a kijelölt csomópontok hello aktuális száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-497">Otherwise, use hello value for hello current number of dedicated nodes.</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
```

<span data-ttu-id="435f6-498">túl*csökkentése* hello dedikált csomópontok száma alacsony CPU-használat során, a képlet beállítása hello a következő utasítás azonos hello `$totalDedicatedNodes` hello aktuális cél dedikált csomópontok száma ha hello változó too90 százaléka átlagos CPU-használat hello elmúlt 60 perc volt a 20 százalékát.</span><span class="sxs-lookup"><span data-stu-id="435f6-498">too*decrease* hello number of dedicated nodes during low CPU usage, hello next statement in our formula sets hello same `$totalDedicatedNodes` variable too90 percent of hello current target number of dedicated nodes if hello average CPU usage in hello past 60 minutes was under 20 percent.</span></span> <span data-ttu-id="435f6-499">Ellenkező esetben használja az aktuális értéke hello `$totalDedicatedNodes` , amely jelenleg a fenti hello utasításban feltöltve.</span><span class="sxs-lookup"><span data-stu-id="435f6-499">Otherwise, use hello current value of `$totalDedicatedNodes` that we populated in hello statement above.</span></span>

```
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
```

<span data-ttu-id="435f6-500">Most korlátozása dedikált számítási csomópontok tooa legfeljebb 400 hello cél száma:</span><span class="sxs-lookup"><span data-stu-id="435f6-500">Now limit hello target number of dedicated compute nodes tooa maximum of 400:</span></span>

```
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

<span data-ttu-id="435f6-501">Az alábbiakban hello teljes képlet:</span><span class="sxs-lookup"><span data-stu-id="435f6-501">Here's hello complete formula:</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

## <a name="create-an-autoscale-enabled-pool-with-net"></a><span data-ttu-id="435f6-502">A .NET az automatikus skálázás engedélyezve készlet létrehozása</span><span class="sxs-lookup"><span data-stu-id="435f6-502">Create an autoscale-enabled pool with .NET</span></span>

<span data-ttu-id="435f6-503">az automatikus skálázást engedélyezve van a .NET, a készlet toocreate kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="435f6-503">toocreate a pool with autoscaling enabled in .NET, follow these steps:</span></span>

1. <span data-ttu-id="435f6-504">Hozzon létre hello címkészlet, amely [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span><span class="sxs-lookup"><span data-stu-id="435f6-504">Create hello pool with [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span></span>
2. <span data-ttu-id="435f6-505">Set hello [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) tulajdonság túl`true`.</span><span class="sxs-lookup"><span data-stu-id="435f6-505">Set hello [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) property too`true`.</span></span>
3. <span data-ttu-id="435f6-506">Set hello [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) az automatikus skálázás képlettel tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="435f6-506">Set hello [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) property with your autoscale formula.</span></span>
4. <span data-ttu-id="435f6-507">(Választható) Set hello [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) tulajdonság (alapértelmezett érték 15 perc).</span><span class="sxs-lookup"><span data-stu-id="435f6-507">(Optional) Set hello [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) property (default is 15 minutes).</span></span>
5. <span data-ttu-id="435f6-508">Hello címkészlet, amely véglegesíti [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) vagy [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span><span class="sxs-lookup"><span data-stu-id="435f6-508">Commit hello pool with [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) or [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span></span>

<span data-ttu-id="435f6-509">hello következő kódrészletet létrehoz egy automatikus skálázás engedélyezve készlet .NET.</span><span class="sxs-lookup"><span data-stu-id="435f6-509">hello following code snippet creates an autoscale-enabled pool in .NET.</span></span> <span data-ttu-id="435f6-510">hello készlet automatikus skálázás képlet beállítja hello cél számát dedikált csomópontok too5 hétfőn, és minden egyéb hello hét napján 1.</span><span class="sxs-lookup"><span data-stu-id="435f6-510">hello pool's autoscale formula sets hello target number of dedicated nodes too5 on Mondays, and 1 on every other day of hello week.</span></span> <span data-ttu-id="435f6-511">Hello [automatikus méretezési időköz](#automatic-scaling-interval) van beállítva too30 perc.</span><span class="sxs-lookup"><span data-stu-id="435f6-511">hello [automatic scaling interval](#automatic-scaling-interval) is set too30 minutes.</span></span> <span data-ttu-id="435f6-512">Ezen és egyéb C# kódtöredékek ebben a cikkben hello `myBatchClient` hello megfelelően inicializálva példánya [BatchClient] [ net_batchclient] osztály.</span><span class="sxs-lookup"><span data-stu-id="435f6-512">In this and hello other C# snippets in this article, `myBatchClient` is a properly initialized instance of hello [BatchClient][net_batchclient] class.</span></span>

```csharp
CloudPool pool = myBatchClient.PoolOperations.CreatePool(
                    poolId: "mypool",
                    virtualMachineSize: "small", // single-core, 1.75 GB memory, 225 GB disk
                    cloudServiceConfiguration: new CloudServiceConfiguration(osFamily: "5"));    
pool.AutoScaleEnabled = true;
pool.AutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";
pool.AutoScaleEvaluationInterval = TimeSpan.FromMinutes(30);
await pool.CommitAsync();
```

> [!IMPORTANT]
> <span data-ttu-id="435f6-513">Az automatikus skálázás engedélyezve készletet hoz létre, ha nem ad meg hello _targetDedicatedComputeNodes_ paraméter vagy hello _targetLowPriorityComputeNodes_ hello paraméter hívja túl **CreatePool**.</span><span class="sxs-lookup"><span data-stu-id="435f6-513">When you create an autoscale-enabled pool, do not specify hello _targetDedicatedComputeNodes_ parameter or hello _targetLowPriorityComputeNodes_ parameter on hello call too**CreatePool**.</span></span> <span data-ttu-id="435f6-514">Ehelyett adja meg a hello **AutoScaleEnabled** és **AutoScaleFormula** hello készlet tulajdonságai.</span><span class="sxs-lookup"><span data-stu-id="435f6-514">Instead, specify hello **AutoScaleEnabled** and **AutoScaleFormula** properties on hello pool.</span></span> <span data-ttu-id="435f6-515">Ezen tulajdonságok hello értékek meghatározzák, hogy minden csomópont típusú hello cél száma.</span><span class="sxs-lookup"><span data-stu-id="435f6-515">hello values for these properties determine hello target number of each type of node.</span></span> <span data-ttu-id="435f6-516">Emellett toomanually átméretezése az automatikus skálázás engedélyezve készlet (például a [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), első **tiltsa le a** az automatikus skálázás hello készletet, majd méretezze át.</span><span class="sxs-lookup"><span data-stu-id="435f6-516">Also, toomanually resize an autoscale-enabled pool (for example, with [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), first **disable** automatic scaling on hello pool, then resize it.</span></span>
>
>

<span data-ttu-id="435f6-517">Ezenkívül tooBatch .NET használhatja bármelyik más hello [kötegelt SDK-k](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [kötegelt PowerShell-parancsmagok](batch-powershell-cmdlets-get-started.md), és hello [kötegelt CLI](batch-cli-get-started.md)tooconfigure automatikus skálázást.</span><span class="sxs-lookup"><span data-stu-id="435f6-517">In addition tooBatch .NET, you can use any of hello other [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell cmdlets](batch-powershell-cmdlets-get-started.md), and hello [Batch CLI](batch-cli-get-started.md) tooconfigure autoscaling.</span></span>


### <a name="automatic-scaling-interval"></a><span data-ttu-id="435f6-518">Automatikus méretezési időköz</span><span class="sxs-lookup"><span data-stu-id="435f6-518">Automatic scaling interval</span></span>
<span data-ttu-id="435f6-519">Alapértelmezés szerint hello Batch szolgáltatás beállítása szerint tooits automatikus skálázás képlet, 15 percenként a készlet méretét.</span><span class="sxs-lookup"><span data-stu-id="435f6-519">By default, hello Batch service adjusts a pool's size according tooits autoscale formula every 15 minutes.</span></span> <span data-ttu-id="435f6-520">Ez az időtartam alatt a következő alkalmazáskészlet tulajdonságaiban hello segítségével konfigurálható:</span><span class="sxs-lookup"><span data-stu-id="435f6-520">This interval is configurable by using hello following pool properties:</span></span>

* <span data-ttu-id="435f6-521">[CloudPool.AutoScaleEvaluationInterval] [ net_cloudpool_autoscaleevalinterval] (kötegelt .NET)</span><span class="sxs-lookup"><span data-stu-id="435f6-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (Batch .NET)</span></span>
* <span data-ttu-id="435f6-522">[autoScaleEvaluationInterval] [ rest_autoscaleinterval] (REST API-t)</span><span class="sxs-lookup"><span data-stu-id="435f6-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (REST API)</span></span>

<span data-ttu-id="435f6-523">hello minimális időköze az öt percet, és hello maximális 168 óra.</span><span class="sxs-lookup"><span data-stu-id="435f6-523">hello minimum interval is five minutes, and hello maximum is 168 hours.</span></span> <span data-ttu-id="435f6-524">Időközönkénti ezen a tartományon kívül van megadva, ha a Batch szolgáltatás hello egy hibás kérés (400) hibaüzenetet adja vissza.</span><span class="sxs-lookup"><span data-stu-id="435f6-524">If an interval outside this range is specified, hello Batch service returns a Bad Request (400) error.</span></span>

> [!NOTE]
> <span data-ttu-id="435f6-525">Automatikus skálázás nem jelenleg tervezett toorespond toochanges kisebb, mint egy percen belül, de ahelyett, hogy a gyűjtő tooadjust hello mérete fokozatosan szánt futtatja, a munkaterhelés.</span><span class="sxs-lookup"><span data-stu-id="435f6-525">Autoscaling is not currently intended toorespond toochanges in less than a minute, but rather is intended tooadjust hello size of your pool gradually as you run a workload.</span></span>
>
>

## <a name="enable-autoscaling-on-an-existing-pool"></a><span data-ttu-id="435f6-526">Egy meglévő készlet automatikus skálázás engedélyezéséhez</span><span class="sxs-lookup"><span data-stu-id="435f6-526">Enable autoscaling on an existing pool</span></span>

<span data-ttu-id="435f6-527">Minden egyes kötegelt SDK biztosít egy módon tooenable automatikus skálázást.</span><span class="sxs-lookup"><span data-stu-id="435f6-527">Each Batch SDK provides a way tooenable autoscaling.</span></span> <span data-ttu-id="435f6-528">Példa:</span><span class="sxs-lookup"><span data-stu-id="435f6-528">For example:</span></span>

* <span data-ttu-id="435f6-529">[BatchClient.PoolOperations.EnableAutoScaleAsync] [ net_enableautoscaleasync] (kötegelt .NET)</span><span class="sxs-lookup"><span data-stu-id="435f6-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span></span>
* <span data-ttu-id="435f6-530">[A készlet automatikus skálázás engedélyezése] [ rest_enableautoscale] (REST API-t)</span><span class="sxs-lookup"><span data-stu-id="435f6-530">[Enable automatic scaling on a pool][rest_enableautoscale] (REST API)</span></span>

<span data-ttu-id="435f6-531">Ha engedélyezi az automatikus skálázás meglévő címkészlet, tartsa szem előtt tartva hello pontok a következő:</span><span class="sxs-lookup"><span data-stu-id="435f6-531">When you enable autoscaling on an existing pool, keep in mind hello following points:</span></span>

* <span data-ttu-id="435f6-532">Ha az automatikus skálázás jelenleg le van tiltva a hello készlet hello kérelem tooenable automatikus skálázás küldésekor, adjon meg érvényes automatikus skálázás képlet hello kérés elküldésekor.</span><span class="sxs-lookup"><span data-stu-id="435f6-532">If automatic scaling is currently disabled on hello pool when you issue hello request tooenable autoscaling, you must specify a valid autoscale formula when you issue hello request.</span></span> <span data-ttu-id="435f6-533">Opcionálisan megadhat az automatikus skálázás újraértékelési időközét.</span><span class="sxs-lookup"><span data-stu-id="435f6-533">You can optionally specify an autoscale evaluation interval.</span></span> <span data-ttu-id="435f6-534">Ha nem adja meg a időközt, hello alapértelmezett érték 15 perc szolgál.</span><span class="sxs-lookup"><span data-stu-id="435f6-534">If you do not specify an interval, hello default value of 15 minutes is used.</span></span>
* <span data-ttu-id="435f6-535">Ha az automatikus skálázás hello készlet jelenleg engedélyezve van, megadhatja az automatikus skálázás képlet, egy újraértékelési időközét, vagy mindkettőt.</span><span class="sxs-lookup"><span data-stu-id="435f6-535">If autoscale is currently enabled on hello pool, you can specify an autoscale formula, an evaluation interval, or both.</span></span> <span data-ttu-id="435f6-536">Ezek a tulajdonságok közül legalább egy meg kell adnia.</span><span class="sxs-lookup"><span data-stu-id="435f6-536">You must specify at least one of these properties.</span></span>

  * <span data-ttu-id="435f6-537">Ha egy új automatikus skálázás újraértékelési időközét adja meg, majd hello meglévő értékelésének ütemezése le van állítva, és új ütemezés szerint elindult.</span><span class="sxs-lookup"><span data-stu-id="435f6-537">If you specify a new autoscale evaluation interval, then hello existing evaluation schedule is stopped and a new schedule is started.</span></span> <span data-ttu-id="435f6-538">hello új ütemezés kezdési idő az hello idő, mely hello kérelem tooenable automatikus skálázás ki.</span><span class="sxs-lookup"><span data-stu-id="435f6-538">hello new schedule's start time is hello time at which hello request tooenable autoscaling was issued.</span></span>
  * <span data-ttu-id="435f6-539">Kihagyása vagy hello automatikus skálázás képlet vagy a kiértékelési időköz, a Batch szolgáltatás hello toouse hello aktuális értéket továbbra is.</span><span class="sxs-lookup"><span data-stu-id="435f6-539">If you omit either hello autoscale formula or evaluation interval, hello Batch service continues toouse hello current value of that setting.</span></span>

> [!NOTE]
> <span data-ttu-id="435f6-540">Ha a hello értéket adott meg *targetDedicatedComputeNodes* vagy *targetLowPriorityComputeNodes* hello paraméterei **CreatePool** metódus hello létrehozásakor a .NET, vagy egy másik nyelvet, majd ezeket az értékeket hello összehasonlítható paramétereinek alkalmazáskészlet figyelmen kívül lesznek hagyva, automatikus skálázás képlet hello kiértékelésekor.</span><span class="sxs-lookup"><span data-stu-id="435f6-540">If you specified values for hello *targetDedicatedComputeNodes* or *targetLowPriorityComputeNodes* parameters of hello **CreatePool** method when you created hello pool in .NET, or for hello comparable parameters in another language, then those values are ignored when hello automatic scaling formula is evaluated.</span></span>
>
>

<span data-ttu-id="435f6-541">A C# kódrészletet használja hello [Batch .NET] [ net_api] könyvtár tooenable automatikus skálázás meglévő címkészlet:</span><span class="sxs-lookup"><span data-stu-id="435f6-541">This C# code snippet uses hello [Batch .NET][net_api] library tooenable autoscaling on an existing pool:</span></span>

```csharp
// Define hello autoscaling formula. This formula sets hello target number of nodes
// too5 on Mondays, and 1 on every other day of hello week
string myAutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";

// Set hello autoscale formula on hello existing pool
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myAutoScaleFormula);
```

### <a name="update-an-autoscale-formula"></a><span data-ttu-id="435f6-542">Az automatikus skálázás képlet frissítése</span><span class="sxs-lookup"><span data-stu-id="435f6-542">Update an autoscale formula</span></span>

<span data-ttu-id="435f6-543">egy meglévő automatikus skálázás engedélyezve készlet, hívás hello művelet tooenable automatikus skálázás újra az új képlet hello tooupdate hello képletet.</span><span class="sxs-lookup"><span data-stu-id="435f6-543">tooupdate hello formula on an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new formula.</span></span> <span data-ttu-id="435f6-544">Például, ha az automatikus skálázás már engedélyezve van a `myexistingpool` eljárás végrehajtásakor a következő kód .NET hello, az automatikus skálázás képlet helyére hello tartalmát `myNewFormula`.</span><span class="sxs-lookup"><span data-stu-id="435f6-544">For example, if autoscaling is already enabled on `myexistingpool` when hello following .NET code is executed, its autoscale formula is replaced with hello contents of `myNewFormula`.</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myNewFormula);
```

### <a name="update-hello-autoscale-interval"></a><span data-ttu-id="435f6-545">Frissítési hello automatikus skálázás időköz</span><span class="sxs-lookup"><span data-stu-id="435f6-545">Update hello autoscale interval</span></span>

<span data-ttu-id="435f6-546">tooupdate hello automatikus skálázás újraértékelési időközét meglévő automatikus skálázás engedélyezve-készlet, hívás hello művelet tooenable automatikus skálázás újra az új hello időköz.</span><span class="sxs-lookup"><span data-stu-id="435f6-546">tooupdate hello autoscale evaluation interval of an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new interval.</span></span> <span data-ttu-id="435f6-547">Például tooset hello automatikus skálázás értékelési időköz too60 perc már automatikus skálázás engedélyezve a .NET-készletre vonatkozó:</span><span class="sxs-lookup"><span data-stu-id="435f6-547">For example, tooset hello autoscale evaluation interval too60 minutes for a pool that's already autoscale-enabled in .NET:</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleEvaluationInterval: TimeSpan.FromMinutes(60));
```

## <a name="evaluate-an-autoscale-formula"></a><span data-ttu-id="435f6-548">Az automatikus skálázás képlet kiértékelése</span><span class="sxs-lookup"><span data-stu-id="435f6-548">Evaluate an autoscale formula</span></span>

<span data-ttu-id="435f6-549">A képlet kiértékelheti tooa készlet alkalmazása előtt.</span><span class="sxs-lookup"><span data-stu-id="435f6-549">You can evaluate a formula before applying it tooa pool.</span></span> <span data-ttu-id="435f6-550">Ezzel a módszerrel tesztelheti hello képlet toosee hogyan kimutatásait kiértékelése előtt hello képlet üzembe helyezésre.</span><span class="sxs-lookup"><span data-stu-id="435f6-550">In this way, you can test hello formula toosee how its statements evaluate before you put hello formula into production.</span></span>

<span data-ttu-id="435f6-551">az automatikus skálázás képlet tooevaluate, először engedélyeznie kell egy érvényes képlettel hello készlet automatikus skálázást.</span><span class="sxs-lookup"><span data-stu-id="435f6-551">tooevaluate an autoscale formula, you must first enable autoscaling on hello pool with a valid formula.</span></span> <span data-ttu-id="435f6-552">egy készlet, amely még nem rendelkezik az automatikus skálázás képlet tootest engedélyezve van, hello egysoros képlet használata `$TargetDedicatedNodes = 0` Ha először engedélyezi az automatikus skálázást.</span><span class="sxs-lookup"><span data-stu-id="435f6-552">tootest a formula on a pool that doesn't yet have autoscaling enabled, use hello one-line formula `$TargetDedicatedNodes = 0` when you first enable autoscaling.</span></span> <span data-ttu-id="435f6-553">Ezt követően használja a következő tooevaluate hello képletet tootest hello egyikét:</span><span class="sxs-lookup"><span data-stu-id="435f6-553">Then, use one of hello following tooevaluate hello formula you want tootest:</span></span>

* <span data-ttu-id="435f6-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) vagy [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span><span class="sxs-lookup"><span data-stu-id="435f6-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) or [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span></span>

    <span data-ttu-id="435f6-555">A Batch .NET módszerekhez hello azonosító egy meglévő készlet és hello automatikus skálázás képlet tooevaluate tartalmazó karakterláncot.</span><span class="sxs-lookup"><span data-stu-id="435f6-555">These Batch .NET methods require hello ID of an existing pool and a string containing hello autoscale formula tooevaluate.</span></span>

* [<span data-ttu-id="435f6-556">Az automatikus méretezési képlet kiértékelése</span><span class="sxs-lookup"><span data-stu-id="435f6-556">Evaluate an automatic scaling formula</span></span>](https://docs.microsoft.com/rest/api/batchservice/evaluate-an-automatic-scaling-formula)

    <span data-ttu-id="435f6-557">A REST API-kérelem a adja meg a hello készlet hello URI-azonosító, és automatikus skálázási képletnek hello hello *autoScaleFormula* hello kérelemtörzset eleme.</span><span class="sxs-lookup"><span data-stu-id="435f6-557">In this REST API request, specify hello pool ID in hello URI, and hello autoscale formula in hello *autoScaleFormula* element of hello request body.</span></span> <span data-ttu-id="435f6-558">hello válasz hello művelet bármely kapcsolódó toohello képlet hiba információkat tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="435f6-558">hello response of hello operation contains any error information that might be related toohello formula.</span></span>

<span data-ttu-id="435f6-559">Ezen [Batch .NET] [ net_api] kódrészletet, azt az automatikus skálázás képlet kiértékeléséhez.</span><span class="sxs-lookup"><span data-stu-id="435f6-559">In this [Batch .NET][net_api] code snippet, we evaluate an autoscale formula.</span></span> <span data-ttu-id="435f6-560">Ha hello készlet nem rendelkezik automatikus skálázás engedélyezve van, engedélyezzük az első.</span><span class="sxs-lookup"><span data-stu-id="435f6-560">If hello pool does not have autoscaling enabled, we enable it first.</span></span>

```csharp
// First obtain a reference tooan existing pool
CloudPool pool = await batchClient.PoolOperations.GetPoolAsync("myExistingPool");

// If autoscaling isn't already enabled on hello pool, enable it.
// You can't evaluate an autoscale formula on non-autoscale-enabled pool.
if (pool.AutoScaleEnabled == false)
{
    // We need a valid autoscale formula tooenable autoscaling on the
    // pool. This formula is valid, but won't resize hello pool:
    await pool.EnableAutoScaleAsync(
        autoscaleFormula: "$TargetDedicatedNodes = {pool.CurrentDedicatedNodes};",
        autoscaleEvaluationInterval: TimeSpan.FromMinutes(5));

    // Batch limits EnableAutoScaleAsync calls tooonce every 30 seconds.
    // Because we want tooapply our new autoscale formula below if it
    // evaluates successfully, and we *just* enabled autoscaling on
    // this pool, we pause here tooensure we pass that threshold.
    Thread.Sleep(TimeSpan.FromSeconds(31));

    // Refresh hello properties of hello pool so that we've got the
    // latest value for AutoScaleEnabled
    await pool.RefreshAsync();
}

// We must ensure that autoscaling is enabled on hello pool prior to
// evaluating a formula
if (pool.AutoScaleEnabled == true)
{
    // hello formula tooevaluate - adjusts target number of nodes based on
    // day of week and time of day
    string myFormula = @"
        $curTime = time();
        $workHours = $curTime.hour >= 8 && $curTime.hour < 18;
        $isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
        $isWorkingWeekdayHour = $workHours && $isWeekday;
        $TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
    ";

    // Perform hello autoscale formula evaluation. Note that this code does not
    // actually apply hello formula toohello pool.
    AutoScaleRun eval =
        await batchClient.PoolOperations.EvaluateAutoScaleAsync(pool.Id, myFormula);

    if (eval.Error == null)
    {
        // Evaluation success - print hello results of hello AutoScaleRun.
        // This will display hello values of each variable as evaluated by the
        // autoscale formula.
        Console.WriteLine("AutoScaleRun.Results: " +
            eval.Results.Replace("$", "\n    $"));

        // Apply hello formula toohello pool since it evaluated successfully
        await batchClient.PoolOperations.EnableAutoScaleAsync(pool.Id, myFormula);
    }
    else
    {
        // Evaluation failed, output hello message associated with hello error
        Console.WriteLine("AutoScaleRun.Error.Message: " +
            eval.Error.Message);
    }
}
```

<span data-ttu-id="435f6-561">A következő kódrészletet látható hello képlet sikeres értékelése eredménye hasonló:</span><span class="sxs-lookup"><span data-stu-id="435f6-561">Successful evaluation of hello formula shown in this code snippet produces results similar to:</span></span>

```
AutoScaleRun.Results:
    $TargetDedicatedNodes=10;
    $NodeDeallocationOption=requeue;
    $curTime=2016-10-13T19:18:47.805Z;
    $isWeekday=1;
    $isWorkingWeekdayHour=0;
    $workHours=0
```

## <a name="get-information-about-autoscale-runs"></a><span data-ttu-id="435f6-562">Automatikus skálázás futtatása adatainak beolvasása</span><span class="sxs-lookup"><span data-stu-id="435f6-562">Get information about autoscale runs</span></span>

<span data-ttu-id="435f6-563">a képlet szerint végző tooensure várt, azt javasoljuk, hogy rendszeres időközönként ellenőrizze a kötegelt végzi, a készlet hello automatikus skálázás kísérletekről hello eredményeit.</span><span class="sxs-lookup"><span data-stu-id="435f6-563">tooensure that your formula is performing as expected, we recommend that you periodically check hello results of hello autoscaling runs that Batch performs on your pool.</span></span> <span data-ttu-id="435f6-564">toodo tehát beolvasása (vagy frissítse) egy hivatkozás toohello tárolókészlet, és az utolsó automatikus skálázás futtatása hello tulajdonságainak vizsgálata.</span><span class="sxs-lookup"><span data-stu-id="435f6-564">toodo so, get (or refresh) a reference toohello pool, and examine hello properties of its last autoscale run.</span></span>

<span data-ttu-id="435f6-565">A Batch .NET hello [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) tulajdonság több tulajdonságai hello legújabb automatikus skálázás hello készlet elvégezni futtatnak ismertetik:</span><span class="sxs-lookup"><span data-stu-id="435f6-565">In Batch .NET, hello [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) property has several properties that provide information about hello latest automatic scaling run performed on hello pool:</span></span>

* [<span data-ttu-id="435f6-566">AutoScaleRun.Timestamp</span><span class="sxs-lookup"><span data-stu-id="435f6-566">AutoScaleRun.Timestamp</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.timestamp)
* [<span data-ttu-id="435f6-567">AutoScaleRun.Results</span><span class="sxs-lookup"><span data-stu-id="435f6-567">AutoScaleRun.Results</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.results)
* [<span data-ttu-id="435f6-568">AutoScaleRun.Error</span><span class="sxs-lookup"><span data-stu-id="435f6-568">AutoScaleRun.Error</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.error)

<span data-ttu-id="435f6-569">Hello REST API-t, a hello [készlet adatainak beolvasása](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) kérelem hello készletbe, amely tartalmazza a hello legújabb automatikus skálázás hello információk futtatni információt ad vissza [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="435f6-569">In hello REST API, hello [Get information about a pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) request returns information about hello pool, which includes hello latest automatic scaling run information in hello [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) property.</span></span>

<span data-ttu-id="435f6-570">hello következő C# kódrészletet használja hello Batch .NET könyvtár tooprint információ hello utolsó automatikus skálázás futtassa a készlet _myPool_:</span><span class="sxs-lookup"><span data-stu-id="435f6-570">hello following C# code snippet uses hello Batch .NET library tooprint information about hello last autoscaling run on pool _myPool_:</span></span>

```csharp
await Cloud pool = myBatchClient.PoolOperations.GetPoolAsync("myPool");
Console.WriteLine("Last execution: " + pool.AutoScaleRun.Timestamp);
Console.WriteLine("Result:" + pool.AutoScaleRun.Results.Replace("$", "\n  $"));
Console.WriteLine("Error: " + pool.AutoScaleRun.Error);
```

<span data-ttu-id="435f6-571">Részlet megelőző hello Példakimenet:</span><span class="sxs-lookup"><span data-stu-id="435f6-571">Sample output of hello preceding snippet:</span></span>

```
Last execution: 10/14/2016 18:36:43
Result:
  $TargetDedicatedNodes=10;
  $NodeDeallocationOption=requeue;
  $curTime=2016-10-14T18:36:43.282Z;
  $isWeekday=1;
  $isWorkingWeekdayHour=0;
  $workHours=0
Error:
```

## <a name="example-autoscale-formulas"></a><span data-ttu-id="435f6-572">Példa automatikus skálázás képletek</span><span class="sxs-lookup"><span data-stu-id="435f6-572">Example autoscale formulas</span></span>
<span data-ttu-id="435f6-573">Vizsgáljuk meg néhány képletek, amelyek különböző módokon tooadjust hello számítási erőforrások mennyisége a készletben.</span><span class="sxs-lookup"><span data-stu-id="435f6-573">Let's look at a few formulas that show different ways tooadjust hello amount of compute resources in a pool.</span></span>

### <a name="example-1-time-based-adjustment"></a><span data-ttu-id="435f6-574">1. példa: Időalapú módosítása</span><span class="sxs-lookup"><span data-stu-id="435f6-574">Example 1: Time-based adjustment</span></span>
<span data-ttu-id="435f6-575">Tegyük fel, hogy tooadjust hello készlet mérete alapján hello hét napja hello napját és idejét.</span><span class="sxs-lookup"><span data-stu-id="435f6-575">Suppose you want tooadjust hello pool size based on hello day of hello week and time of day.</span></span> <span data-ttu-id="435f6-576">Ez a példa bemutatja, hogyan tárolókészlet hello csomópontok tooincrease vagy csökken hello számának megfelelően.</span><span class="sxs-lookup"><span data-stu-id="435f6-576">This example shows how tooincrease or decrease hello number of nodes in hello pool accordingly.</span></span>

<span data-ttu-id="435f6-577">hello képlet először beolvassa hello aktuális idő.</span><span class="sxs-lookup"><span data-stu-id="435f6-577">hello formula first obtains hello current time.</span></span> <span data-ttu-id="435f6-578">Ha a hét napja (1-5) és munkaidőn belül (8 AM too6 PM), hello cél készletméretet too20 csomópontok van beállítva.</span><span class="sxs-lookup"><span data-stu-id="435f6-578">If it's a weekday (1-5) and within working hours (8 AM too6 PM), hello target pool size is set too20 nodes.</span></span> <span data-ttu-id="435f6-579">Ellenkező esetben van állítva, akkor too10 csomópontok.</span><span class="sxs-lookup"><span data-stu-id="435f6-579">Otherwise, it's set too10 nodes.</span></span>

```
$curTime = time();
$workHours = $curTime.hour >= 8 && $curTime.hour < 18;
$isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
$isWorkingWeekdayHour = $workHours && $isWeekday;
$TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
```

### <a name="example-2-task-based-adjustment"></a><span data-ttu-id="435f6-580">2. példa: Feladatalapú módosítása</span><span class="sxs-lookup"><span data-stu-id="435f6-580">Example 2: Task-based adjustment</span></span>
<span data-ttu-id="435f6-581">Ebben a példában hello készletméretet módosul hello várólistában lévő feladatok hello száma alapján.</span><span class="sxs-lookup"><span data-stu-id="435f6-581">In this example, hello pool size is adjusted based on hello number of tasks in hello queue.</span></span> <span data-ttu-id="435f6-582">Megjegyzések és a sortöréseket a képlet karakterláncok elfogadhatók.</span><span class="sxs-lookup"><span data-stu-id="435f6-582">Both comments and line breaks are acceptable in formula strings.</span></span>

```csharp
// Get pending tasks for hello past 15 minutes.
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
// If we have fewer than 70 percent data points, we use hello last sample point,
// otherwise we use hello maximum of last sample point and hello history average.
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1), avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// If number of pending tasks is not 0, set targetVM toopending tasks, otherwise
// half of current dedicated.
$targetVMs = $tasks > 0? $tasks:max(0, $TargetDedicatedNodes/2);
// hello pool size is capped at 20, if target VM value is more than that, set it
// too20. This value should be adjusted according tooyour use case.
$TargetDedicatedNodes = max(0, min($targetVMs, 20));
// Set node deallocation mode - keep nodes active only until tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-3-accounting-for-parallel-tasks"></a><span data-ttu-id="435f6-583">3. példa: Párhuzamos tevékenységek nyilvántartás</span><span class="sxs-lookup"><span data-stu-id="435f6-583">Example 3: Accounting for parallel tasks</span></span>
<span data-ttu-id="435f6-584">Ez a példa hello készletméretet hello feladatok száma alapján állítja be.</span><span class="sxs-lookup"><span data-stu-id="435f6-584">This example adjusts hello pool size based on hello number of tasks.</span></span> <span data-ttu-id="435f6-585">A képlet is veszi figyelembe hello [MaxTasksPerComputeNode] [ net_maxtasks] hello készlethez beállított értéket.</span><span class="sxs-lookup"><span data-stu-id="435f6-585">This formula also takes into account hello [MaxTasksPerComputeNode][net_maxtasks] value that has been set for hello pool.</span></span> <span data-ttu-id="435f6-586">Ez a módszer akkor hasznos, ahol [párhuzamos tevékenység végrehajtása](batch-parallel-node-tasks.md) a készlet engedélyezve lett.</span><span class="sxs-lookup"><span data-stu-id="435f6-586">This approach is useful in situations where [parallel task execution](batch-parallel-node-tasks.md) has been enabled on your pool.</span></span>

```csharp
// Determine whether 70 percent of hello samples have been recorded in hello past
// 15 minutes; if not, use last sample
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1),avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// Set hello number of nodes tooadd tooone-fourth hello number of active tasks (the
// MaxTasksPerComputeNode property on this pool is set too4, adjust this number
// for your use case)
$cores = $TargetDedicatedNodes * 4;
$extraVMs = (($tasks - $cores) + 3) / 4;
$targetVMs = ($TargetDedicatedNodes + $extraVMs);
// Attempt toogrow hello number of compute nodes toomatch hello number of active
// tasks, with a maximum of 3
$TargetDedicatedNodes = max(0,min($targetVMs,3));
// Keep hello nodes active until hello tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-4-setting-an-initial-pool-size"></a><span data-ttu-id="435f6-587">4. példa: Egy kezdeti mérete beállítása</span><span class="sxs-lookup"><span data-stu-id="435f6-587">Example 4: Setting an initial pool size</span></span>
<span data-ttu-id="435f6-588">Ez a példa azt mutatja be a C#-kód részlet az automatikus skálázás úgy, hogy beállítja a készlet méretének tooa hello csomópontok száma megadott egy kezdeti időszak.</span><span class="sxs-lookup"><span data-stu-id="435f6-588">This example shows a C# code snippet with an autoscale formula that sets hello pool size tooa specified number of nodes for an initial time period.</span></span> <span data-ttu-id="435f6-589">Majd helyesbíti hello készlet mérete alapján hello fut, és aktív feladatok után hello kezdeti időszak lejárt.</span><span class="sxs-lookup"><span data-stu-id="435f6-589">Then it adjusts hello pool size based on hello number of running and active tasks after hello initial time period has elapsed.</span></span>

<span data-ttu-id="435f6-590">a következő kódrészletet hello hello képlet:</span><span class="sxs-lookup"><span data-stu-id="435f6-590">hello formula in hello following code snippet:</span></span>

* <span data-ttu-id="435f6-591">Beállítja a hello kezdeti készlet mérete toofour csomópontok.</span><span class="sxs-lookup"><span data-stu-id="435f6-591">Sets hello initial pool size toofour nodes.</span></span>
* <span data-ttu-id="435f6-592">Nem hello készlet méretének módosítása belül hello hello készlet életciklus első 10 perc.</span><span class="sxs-lookup"><span data-stu-id="435f6-592">Does not adjust hello pool size within hello first 10 minutes of hello pool's lifecycle.</span></span>
* <span data-ttu-id="435f6-593">10 perc elteltével beolvassa a hello maximális értékének hello fut a száma, és az aktív feladatok belül hello elmúlt 60 perc.</span><span class="sxs-lookup"><span data-stu-id="435f6-593">After 10 minutes, obtains hello max value of hello number of running and active tasks within hello past 60 minutes.</span></span>
  * <span data-ttu-id="435f6-594">Ha mindkét értékek 0 (Ez azt jelzi, hogy egy feladat sem volt futó vagy hello aktív elmúlt 60 perc), hello készletméretet too0 van beállítva.</span><span class="sxs-lookup"><span data-stu-id="435f6-594">If both values are 0 (indicating that no tasks were running or active in hello last 60 minutes), hello pool size is set too0.</span></span>
  * <span data-ttu-id="435f6-595">Ha bármelyik érték nullánál nem kisebb, nem történik változás.</span><span class="sxs-lookup"><span data-stu-id="435f6-595">If either value is greater than zero, no change is made.</span></span>

```csharp
string now = DateTime.UtcNow.ToString("r");
string formula = string.Format(@"
    $TargetDedicatedNodes = {1};
    lifespan         = time() - time(""{0}"");
    span             = TimeInterval_Minute * 60;
    startup          = TimeInterval_Minute * 10;
    ratio            = 50;

    $TargetDedicatedNodes = (lifespan > startup ? (max($RunningTasks.GetSample(span, ratio), $ActiveTasks.GetSample(span, ratio)) == 0 ? 0 : $TargetDedicatedNodes) : {1});
    ", now, 4);
```

## <a name="next-steps"></a><span data-ttu-id="435f6-596">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="435f6-596">Next steps</span></span>
* <span data-ttu-id="435f6-597">[Azure Batch számítási erőforrás-használat csomópont egyidejű feladatok maximális](batch-parallel-node-tasks.md) részletesen ismerteti, hogyan hajthat végre több feladat egyidejű hello számítási csomópontok a készlethez.</span><span class="sxs-lookup"><span data-stu-id="435f6-597">[Maximize Azure Batch compute resource usage with concurrent node tasks](batch-parallel-node-tasks.md) contains details about how you can execute multiple tasks simultaneously on hello compute nodes in your pool.</span></span> <span data-ttu-id="435f6-598">Továbbá tooautoscaling, ez a szolgáltatás segíthet bizonyos munkaterhelések esetén, így pénzt takaríthat toolower feladat időtartama.</span><span class="sxs-lookup"><span data-stu-id="435f6-598">In addition tooautoscaling, this feature may help toolower job duration for some workloads, saving you money.</span></span>
* <span data-ttu-id="435f6-599">Egy másik hatékonyságát gyorsító győződjön meg arról, hogy a kötegelt kérelem lekérdezések hello hello legtöbb optimális módját a Batch szolgáltatás.</span><span class="sxs-lookup"><span data-stu-id="435f6-599">For another efficiency booster, ensure that your Batch application queries hello Batch service in hello most optimal way.</span></span> <span data-ttu-id="435f6-600">Lásd: [hello Azure Batch szolgáltatás hatékony lekérdezéséhez](batch-efficient-list-queries.md) toolearn hogyan toolimit hello átmenő hello keresztülhaladnak a hálózaton, ha több ezer hello állapotának adatok mennyisége számítási csomópontok és a feladatok.</span><span class="sxs-lookup"><span data-stu-id="435f6-600">See [Query hello Azure Batch service efficiently](batch-efficient-list-queries.md) toolearn how toolimit hello amount of data that crosses hello wire when you query hello status of potentially thousands of compute nodes or tasks.</span></span>

[net_api]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch
[net_batchclient]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.batchclient
[net_cloudpool_autoscaleformula]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula
[net_cloudpool_autoscaleevalinterval]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval
[net_enableautoscaleasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.enableautoscaleasync
[net_maxtasks]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.maxtaskspercomputenode
[net_poolops_resizepoolasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.resizepoolasync

[rest_api]: https://docs.microsoft.com/rest/api/batchservice/
[rest_autoscaleformula]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_autoscaleinterval]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_enableautoscale]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
