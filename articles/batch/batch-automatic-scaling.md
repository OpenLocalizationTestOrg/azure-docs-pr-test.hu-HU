---
title: "Automatikus méretezési számítási csomópontok az Azure Batch-készlet |} Microsoft Docs"
description: "A felhő készlet dinamikusan úgy, hogy a készlet számítási csomópontok száma automatikus skálázás engedélyezése."
services: batch
documentationcenter: 
author: tamram
manager: timlt
editor: tysonn
ms.assetid: c624cdfc-c5f2-4d13-a7d7-ae080833b779
ms.service: batch
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: multiple
ms.date: 06/20/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f0e49cd8a64a48c53f5b6104703164a597c797f0
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="create-an-automatic-scaling-formula-for-scaling-compute-nodes-in-a-batch-pool"></a><span data-ttu-id="553cf-103">Hozzon létre egy méretezhetővé válik a Batch-készlet számítási csomópontjainak automatikus méretezési képlet</span><span class="sxs-lookup"><span data-stu-id="553cf-103">Create an automatic scaling formula for scaling compute nodes in a Batch pool</span></span>

<span data-ttu-id="553cf-104">Az Azure Batch automatikusan át tudja méretezni készletek meghatározott paraméterei alapján.</span><span class="sxs-lookup"><span data-stu-id="553cf-104">Azure Batch can automatically scale pools based on parameters that you define.</span></span> <span data-ttu-id="553cf-105">Az automatikus skálázás kötegelt csomópontok dinamikusan hozzáadja egy feladat igények növekedése erőforráskészletben, és eltávolítja a számítási csomópontok, mivel csökkentik.</span><span class="sxs-lookup"><span data-stu-id="553cf-105">With automatic scaling, Batch dynamically adds nodes to a pool as task demands increase, and removes compute nodes as they decrease.</span></span> <span data-ttu-id="553cf-106">Az időt és pénzt takaríthat automatikusan beállítja a kötegelt alkalmazás által használt csomópontok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-106">You can save both time and money by automatically adjusting the number of compute nodes used by your Batch application.</span></span> 

<span data-ttu-id="553cf-107">Automatikus skálázás a számítási csomópontok készletét társítja azt engedélyezi egy *automatikus skálázás képlet* megadhat.</span><span class="sxs-lookup"><span data-stu-id="553cf-107">You enable automatic scaling on a pool of compute nodes by associating with it an *autoscale formula* that you define.</span></span> <span data-ttu-id="553cf-108">A Batch szolgáltatás az automatikus skálázás képlet használatával határozhatja meg a számítási feladatok végrehajtásához szükséges számítási csomópontok számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-108">The Batch service uses the autoscale formula to determine the number of compute nodes that are needed to execute your workload.</span></span> <span data-ttu-id="553cf-109">Számítási csomópontok lehet, hogy dedikált csomópontok vagy [alacsony prioritású csomópontok](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="553cf-109">Compute nodes may be dedicated nodes or [low-priority nodes](batch-low-pri-vms.md).</span></span> <span data-ttu-id="553cf-110">Kötegelt válaszol-e a szolgáltatás metrikák összegyűjtött adatokon rendszeres időközönként.</span><span class="sxs-lookup"><span data-stu-id="553cf-110">Batch responds to service metrics data that is collected periodically.</span></span> <span data-ttu-id="553cf-111">A metrikák adatok használatával, kötegelt módosítja a képlet alapján és konfigurálható időközönként a készlet számítási csomópontjainak számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-111">Using this metrics data, Batch adjusts the number of compute nodes in the pool based on your formula and at a configurable interval.</span></span>

<span data-ttu-id="553cf-112">A tárolókészlet létrehozásakor vagy meglévő címkészlet automatikus skálázás engedélyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="553cf-112">You can enable automatic scaling either when a pool is created, or on an existing pool.</span></span> <span data-ttu-id="553cf-113">Az automatikus skálázás beállítása készletben meglévő képlet is módosíthatja.</span><span class="sxs-lookup"><span data-stu-id="553cf-113">You can also change an existing formula on a pool that is configured for autoscaling.</span></span> <span data-ttu-id="553cf-114">Kötegelt lehetővé teszi a képletekben kiértékelése előtt rendel készletek és automatikus méretezési futtatása állapotának figyelésére.</span><span class="sxs-lookup"><span data-stu-id="553cf-114">Batch enables you to evaluate your formulas before assigning them to pools and to monitor the status of automatic scaling runs.</span></span>

<span data-ttu-id="553cf-115">A cikk ismerteti a különböző entitások, amelyek az automatikus skálázás képletek, beleértve a változók, operátorok, műveletek és funkciók alkotják.</span><span class="sxs-lookup"><span data-stu-id="553cf-115">This article discusses the various entities that make up your autoscale formulas, including variables, operators, operations, and functions.</span></span> <span data-ttu-id="553cf-116">Különböző számítási erőforrás és a feladat metrikák belül kötegelt beszerzése arról lesz szó.</span><span class="sxs-lookup"><span data-stu-id="553cf-116">We discuss how to obtain various compute resource and task metrics within Batch.</span></span> <span data-ttu-id="553cf-117">A metrikák segítségével állítsa be a készlet csomópontok száma erőforrás-használat és a feladat állapota alapján.</span><span class="sxs-lookup"><span data-stu-id="553cf-117">You can use these metrics to adjust your pool's node count based on resource usage and task status.</span></span> <span data-ttu-id="553cf-118">A Microsoft majd azt ismertetik, hogyan képlet és automatikus skálázás engedélyezése a készlet a Batch REST és a .NET API-k használatával.</span><span class="sxs-lookup"><span data-stu-id="553cf-118">We then describe how to construct a formula and enable automatic scaling on a pool by using both the Batch REST and .NET APIs.</span></span> <span data-ttu-id="553cf-119">Végül azt befejezéséhez néhány példa képletek.</span><span class="sxs-lookup"><span data-stu-id="553cf-119">Finally, we finish up with a few example formulas.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="553cf-120">Batch-fiók létrehozásakor megadhatja a [fiókkonfiguráció](batch-api-basics.md#account), amely meghatározza, hogy készletek foglal le a Batch szolgáltatás az előfizetéshez (alapértelmezett), vagy a felhasználó az előfizetéshez.</span><span class="sxs-lookup"><span data-stu-id="553cf-120">When you create a Batch account, you can specify the [account configuration](batch-api-basics.md#account), which determines whether pools are allocated in a Batch service subscription (the default), or in your user subscription.</span></span> <span data-ttu-id="553cf-121">A Batch-fiók a kötegelt szolgáltatáskonfiguráció hozta létre, ha a fiók korlátozva magok használható a feldolgozás maximális számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-121">If you created your Batch account with the default Batch Service configuration, then your account is limited to a maximum number of cores that can be used for processing.</span></span> <span data-ttu-id="553cf-122">A Batch szolgáltatás méretezi a számítási csomópontok csak alapvető korlátnak.</span><span class="sxs-lookup"><span data-stu-id="553cf-122">The Batch service scales compute nodes only up to that core limit.</span></span> <span data-ttu-id="553cf-123">Emiatt a Batch szolgáltatás nem jut el az automatikus skálázás képlet által meghatározott számítási csomópontok cél száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-123">For this reason, the Batch service may not reach the target number of compute nodes specified by an autoscale formula.</span></span> <span data-ttu-id="553cf-124">Lásd: [kvótái és korlátai az Azure Batch szolgáltatás](batch-quota-limit.md) információk megtekintéséhez és a fiók kvótákat növelését.</span><span class="sxs-lookup"><span data-stu-id="553cf-124">See [Quotas and limits for the Azure Batch service](batch-quota-limit.md) for information on viewing and increasing your account quotas.</span></span>
>
><span data-ttu-id="553cf-125">Ha a felhasználó előfizetéshez konfigurációjával létrehozta a fiókot, a fiók az előfizetés magkvótája megosztja.</span><span class="sxs-lookup"><span data-stu-id="553cf-125">If you created your account with the User Subscription configuration, then your account shares in the core quota for the subscription.</span></span> <span data-ttu-id="553cf-126">További információkért lásd [az Azure-előfizetésekre és -szolgáltatásokra vonatkozó korlátozásokat, kvótákat és megkötéseket](../azure-subscription-service-limits.md) ismertető témakör [a virtuális gépek korlátaira](../azure-subscription-service-limits.md#virtual-machines-limits) vonatkozó részét.</span><span class="sxs-lookup"><span data-stu-id="553cf-126">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

## <a name="automatic-scaling-formulas"></a><span data-ttu-id="553cf-127">Automatikus méretezési képletek</span><span class="sxs-lookup"><span data-stu-id="553cf-127">Automatic scaling formulas</span></span>
<span data-ttu-id="553cf-128">Az automatikus méretezési képlete karakterlánc-értéke megadhat egy vagy több utasítást tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="553cf-128">An automatic scaling formula is a string value that you define that contains one or more statements.</span></span> <span data-ttu-id="553cf-129">Az automatikus skálázás képlet hozzá van rendelve egy alkalmazáskészlet [autoScaleFormula] [ rest_autoscaleformula] elem (Batch REST) vagy [CloudPool.AutoScaleFormula] [ net_cloudpool_autoscaleformula] a tulajdonság (Batch .NET).</span><span class="sxs-lookup"><span data-stu-id="553cf-129">The autoscale formula is assigned to a pool's [autoScaleFormula][rest_autoscaleformula] element (Batch REST) or [CloudPool.AutoScaleFormula][net_cloudpool_autoscaleformula] property (Batch .NET).</span></span> <span data-ttu-id="553cf-130">A Batch szolgáltatás a képlet használatával a következő időszakú feldolgozási a készlet számítási csomópontjai cél számának meghatározásához.</span><span class="sxs-lookup"><span data-stu-id="553cf-130">The Batch service uses your formula to determine the target number of compute nodes in the pool for the next interval of processing.</span></span> <span data-ttu-id="553cf-131">A képlet karakterlánc nem haladhatja meg a 8 KB-os, pontosvesszővel elválasztva, amely tartalmazhat sortörést és megjegyzéseket legfeljebb 100 utasításokat tartalmazhatnak.</span><span class="sxs-lookup"><span data-stu-id="553cf-131">The formula string cannot exceed 8 KB, can include up to 100 statements that are separated by semicolons, and can include line breaks and comments.</span></span>

<span data-ttu-id="553cf-132">Az eltolásokat tekintheti automatikus méretezési képletek, egy kötegelt automatikus skálázás "nyelv".</span><span class="sxs-lookup"><span data-stu-id="553cf-132">You can think of automatic scaling formulas as a Batch autoscale "language."</span></span> <span data-ttu-id="553cf-133">Képletadat kimutatásai, szabad formátumú kifejezések szolgáltatás által definiált változókat (a változók határozzák meg a Batch szolgáltatás) és a felhasználói változók (Ön által meghatározott változók) is tartalmazhatja.</span><span class="sxs-lookup"><span data-stu-id="553cf-133">Formula statements are free-formed expressions that can include both service-defined variables (variables defined by the Batch service) and user-defined variables (variables that you define).</span></span> <span data-ttu-id="553cf-134">Azok a feladatra, beépített típusok, a kezelők és a funkciók használatával, ezeket az értékeket különféle műveleteket végezhet.</span><span class="sxs-lookup"><span data-stu-id="553cf-134">They can perform various operations on these values by using built-in types, operators, and functions.</span></span> <span data-ttu-id="553cf-135">Például egy utasítás is igénybe vehet a következő formában:</span><span class="sxs-lookup"><span data-stu-id="553cf-135">For example, a statement might take the following form:</span></span>

```
$myNewVariable = function($ServiceDefinedVariable, $myCustomVariable);
```

<span data-ttu-id="553cf-136">Képletek általában több utasítás műveleteket értékek, amelyek akkor kapja meg az előző utasítások tartalmaznak.</span><span class="sxs-lookup"><span data-stu-id="553cf-136">Formulas generally contain multiple statements that perform operations on values that are obtained in previous statements.</span></span> <span data-ttu-id="553cf-137">Például azt szereznie értéket `variable1`, majd átadása egy függvény adatokkal való feltöltéséhez `variable2`:</span><span class="sxs-lookup"><span data-stu-id="553cf-137">For example, first we obtain a value for `variable1`, then pass it to a function to populate `variable2`:</span></span>

```
$variable1 = function1($ServiceDefinedVariable);
$variable2 = function2($OtherServiceDefinedVariable, $variable1);
```

<span data-ttu-id="553cf-138">Vegye fel a számítási csomópontok cél számos elérésének automatikus skálázás képlet ezekről az utasításokról.</span><span class="sxs-lookup"><span data-stu-id="553cf-138">Include these statements in your autoscale formula to arrive at a target number of compute nodes.</span></span> <span data-ttu-id="553cf-139">Dedikált csomópontok és alacsony prioritású csomópont is saját tárolóbeállítások, így megadhatja az egyes csomópont target.</span><span class="sxs-lookup"><span data-stu-id="553cf-139">Dedicated nodes and low-priority nodes each have their own target settings, so that you can define a target for each type of node.</span></span> <span data-ttu-id="553cf-140">Az automatikus skálázás képlet tartalmazhat egy célértéke dedikált csomópontok, alacsony prioritású csomópont target értéket vagy mindkettőt.</span><span class="sxs-lookup"><span data-stu-id="553cf-140">An autoscale formula can include a target value for dedicated nodes, a target value for low-priority nodes, or both.</span></span>

<span data-ttu-id="553cf-141">Lehet, hogy a tároló csomópontok száma nagyobb, alsó, illetve ugyanaz, mint a csomópontok a készlet típusú aktuális száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-141">The target number of nodes may be higher, lower, or the same as the current number of nodes of that type in the pool.</span></span> <span data-ttu-id="553cf-142">Kötegelt a készlet automatikus skálázás képlet kiértékelése adott időközönként (lásd: [automatikus skálázás intervallumok](#automatic-scaling-interval)).</span><span class="sxs-lookup"><span data-stu-id="553cf-142">Batch evaluates a pool's autoscale formula at a specific interval (see [automatic scaling intervals](#automatic-scaling-interval)).</span></span> <span data-ttu-id="553cf-143">Kötegelt beállítása minden típusú csomópont szám, amely az automatikus skálázás képlet megadja a kiértékelési idején a tárolókészlet cél száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-143">Batch adjusts the target number of each type of node in the pool to the number that your autoscale formula specifies at the time of evaluation.</span></span>

### <a name="sample-autoscale-formula"></a><span data-ttu-id="553cf-144">Minta automatikus skálázás képlet</span><span class="sxs-lookup"><span data-stu-id="553cf-144">Sample autoscale formula</span></span>

<span data-ttu-id="553cf-145">Íme egy példa az automatikus skálázás úgy, hogy működik a legtöbb esetben lehet beállítani.</span><span class="sxs-lookup"><span data-stu-id="553cf-145">Here is an example of an autoscale formula that can be adjusted to work for most scenarios.</span></span> <span data-ttu-id="553cf-146">A változók `startingNumberOfVMs` és `maxNumberofVMs` példában képlet módosítható az igényeinek megfelelően.</span><span class="sxs-lookup"><span data-stu-id="553cf-146">The variables `startingNumberOfVMs` and `maxNumberofVMs` in the example formula can be adjusted to your needs.</span></span> <span data-ttu-id="553cf-147">A képlet dedikált csomópontok méretezi, de méretezési alacsony prioritású, valamint csomópontra érvényes kell módosítani.</span><span class="sxs-lookup"><span data-stu-id="553cf-147">This formula scales dedicated nodes, but can be modified to apply to scale low-priority nodes as well.</span></span> 

```
startingNumberOfVMs = 1;
maxNumberofVMs = 25;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

<span data-ttu-id="553cf-148">Az automatikus skálázás képlettel a készlet először hozza létre egyetlen virtuális gépen.</span><span class="sxs-lookup"><span data-stu-id="553cf-148">With this autoscale formula, the pool is initially created with a single VM.</span></span> <span data-ttu-id="553cf-149">A `$PendingTasks` metrika határozza meg, amelyek fut, vagy az aszinkron feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-149">The `$PendingTasks` metric defines the number of tasks that are running or queued.</span></span> <span data-ttu-id="553cf-150">A képlet talál átlagos száma függőben lévő feladatok az elmúlt 180 másodperc és beállítása a `$TargetDedicatedNodes` változó ennek megfelelően.</span><span class="sxs-lookup"><span data-stu-id="553cf-150">The formula finds the average number of pending tasks in the last 180 seconds and sets the `$TargetDedicatedNodes` variable accordingly.</span></span> <span data-ttu-id="553cf-151">A képlet biztosítja, hogy a cél dedikált csomópontok száma soha nem meghaladja 25 virtuális gépek.</span><span class="sxs-lookup"><span data-stu-id="553cf-151">The formula ensures that the target number of dedicated nodes never exceeds 25 VMs.</span></span> <span data-ttu-id="553cf-152">Új feladatok be, mivel a készlet automatikusan nő.</span><span class="sxs-lookup"><span data-stu-id="553cf-152">As new tasks are submitted, the pool automatically grows.</span></span> <span data-ttu-id="553cf-153">A feladat befejeződött virtuális gépek szabad egyenként válnak, valamint az automatikus skálázás képlet zsugorítja a készlet.</span><span class="sxs-lookup"><span data-stu-id="553cf-153">As tasks complete, VMs become free one by one and the autoscaling formula shrinks the pool.</span></span>

## <a name="variables"></a><span data-ttu-id="553cf-154">Változók</span><span class="sxs-lookup"><span data-stu-id="553cf-154">Variables</span></span>
<span data-ttu-id="553cf-155">Mindkét használhatja **szolgáltatás által definiált** és **felhasználói** az automatikus skálázás képletekben változók.</span><span class="sxs-lookup"><span data-stu-id="553cf-155">You can use both **service-defined** and **user-defined** variables in your autoscale formulas.</span></span> <span data-ttu-id="553cf-156">A szolgáltatás által definiált változókat a Batch szolgáltatás beépített.</span><span class="sxs-lookup"><span data-stu-id="553cf-156">The service-defined variables are built in to the Batch service.</span></span> <span data-ttu-id="553cf-157">Néhány szolgáltatás által definiált változókat írható-olvasható, és csak olvasható.</span><span class="sxs-lookup"><span data-stu-id="553cf-157">Some service-defined variables are read-write, and some are read-only.</span></span> <span data-ttu-id="553cf-158">Felhasználói változók az alábbiak változókat, amelyek adhat meg.</span><span class="sxs-lookup"><span data-stu-id="553cf-158">User-defined variables are variables that you define.</span></span> <span data-ttu-id="553cf-159">A példa az előző részben található képletben `$TargetDedicatedNodes` és `$PendingTasks` szolgáltatás által definiált változók.</span><span class="sxs-lookup"><span data-stu-id="553cf-159">In the example formula shown in the previous section, `$TargetDedicatedNodes` and `$PendingTasks` are service-defined variables.</span></span> <span data-ttu-id="553cf-160">Változók `startingNumberOfVMs` és `maxNumberofVMs` felhasználói változók.</span><span class="sxs-lookup"><span data-stu-id="553cf-160">Variables `startingNumberOfVMs` and `maxNumberofVMs` are user-defined variables.</span></span>

> [!NOTE]
> <span data-ttu-id="553cf-161">Szolgáltatás által definiált változókat mindig előzi dollárjelet ($).</span><span class="sxs-lookup"><span data-stu-id="553cf-161">Service-defined variables are always preceded by a dollar sign ($).</span></span> <span data-ttu-id="553cf-162">Felhasználói változók az dollárjel nem kötelező megadni.</span><span class="sxs-lookup"><span data-stu-id="553cf-162">For user-defined variables, the dollar sign is optional.</span></span>
>
>

<span data-ttu-id="553cf-163">Az alábbi táblázatok tartalmazzák, amelyeket a Batch szolgáltatás írási és olvasási és az írásvédett változók.</span><span class="sxs-lookup"><span data-stu-id="553cf-163">The following tables show both read-write and read-only variables that are defined by the Batch service.</span></span>

<span data-ttu-id="553cf-164">Get, és adja meg a készlet számítási csomópontjai számú kezelését a szolgáltatás által definiált változók értékeit:</span><span class="sxs-lookup"><span data-stu-id="553cf-164">You can get and set the values of these service-defined variables to manage the number of compute nodes in a pool:</span></span>

| <span data-ttu-id="553cf-165">Olvasási és írási szolgáltatás által definiált változó</span><span class="sxs-lookup"><span data-stu-id="553cf-165">Read-write service-defined variables</span></span> | <span data-ttu-id="553cf-166">Leírás</span><span class="sxs-lookup"><span data-stu-id="553cf-166">Description</span></span> |
| --- | --- |
| <span data-ttu-id="553cf-167">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-167">$TargetDedicatedNodes</span></span> |<span data-ttu-id="553cf-168">A dedikált cél száma számítási csomópontok a készlet.</span><span class="sxs-lookup"><span data-stu-id="553cf-168">The target number of dedicated compute nodes for the pool.</span></span> <span data-ttu-id="553cf-169">Dedikált csomópontok száma cél van megadva, mert a készlet mindig nem érhetik el a kívánt csomópontok számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-169">The number of dedicated nodes is specified as a target because a pool may not always achieve the desired number of nodes.</span></span> <span data-ttu-id="553cf-170">Például ha a cél dedikált csomópontok száma módosul a automatikus skálázás próbaverzióként előtt a készlet elérte a kezdeti célként, majd a készlet előfordulhat, hogy nem érte el a cél.</span><span class="sxs-lookup"><span data-stu-id="553cf-170">For example, if the target number of dedicated nodes is modified by an autoscale evaluation before the pool has reached the initial target, then the pool may not reach the target.</span></span> <br /><br /> <span data-ttu-id="553cf-171">A Batch szolgáltatás beállításokkal létre egy fiókot a készlet nem érhetik el a célértéket Ha a cél meghaladja a kötegelt fiók csomópont vagy core kvóta.</span><span class="sxs-lookup"><span data-stu-id="553cf-171">A pool in an account created with the Batch Service configuration may not achieve its target if the target exceeds a Batch account node or core quota.</span></span> <span data-ttu-id="553cf-172">A felhasználó előfizetéshez beállításokkal létre egy fiókot a készlet nem érhetik el a célértéket, ha a cél meghaladja az előfizetés megosztott magkvótája.</span><span class="sxs-lookup"><span data-stu-id="553cf-172">A pool in an account created with the User Subscription configuration may not achieve its target if the target exceeds the shared core quota for the subscription.</span></span>|
| <span data-ttu-id="553cf-173">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-173">$TargetLowPriorityNodes</span></span> |<span data-ttu-id="553cf-174">Alacsony prioritású cél száma számítási csomópontok a készlet.</span><span class="sxs-lookup"><span data-stu-id="553cf-174">The target number of low-priority compute nodes for the pool.</span></span> <span data-ttu-id="553cf-175">Alacsony prioritású csomópontok száma cél van megadva, mert a készlet mindig nem érhetik el a kívánt csomópontok számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-175">The number of low-priority nodes is specified as a target because a pool may not always achieve the desired number of nodes.</span></span> <span data-ttu-id="553cf-176">Például ha a cél alacsony prioritású csomópontok száma módosul a automatikus skálázás próbaverzióként előtt a készlet elérte a kezdeti célként, majd a készlet előfordulhat, hogy nem érte el a cél.</span><span class="sxs-lookup"><span data-stu-id="553cf-176">For example, if the target number of low-priority nodes is modified by an autoscale evaluation before the pool has reached the initial target, then the pool may not reach the target.</span></span> <span data-ttu-id="553cf-177">Egy készlet is nem érhetik el a célértéket Ha a cél meghaladja a kötegelt fiók csomópont vagy core kvóta.</span><span class="sxs-lookup"><span data-stu-id="553cf-177">A pool may also not achieve its target if the target exceeds a Batch account node or core quota.</span></span> <br /><br /> <span data-ttu-id="553cf-178">Alacsony prioritású számítási csomóponton további információkért lásd: [alacsony prioritású virtuális gépek használata a kötegelt (előzetes verzió)](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="553cf-178">For more information on low-priority compute nodes, see [Use low-priority VMs with Batch (Preview)](batch-low-pri-vms.md).</span></span> |
| <span data-ttu-id="553cf-179">$NodeDeallocationOption</span><span class="sxs-lookup"><span data-stu-id="553cf-179">$NodeDeallocationOption</span></span> |<span data-ttu-id="553cf-180">A művelet, amikor a számítási csomópontok el lesznek távolítva a készletben.</span><span class="sxs-lookup"><span data-stu-id="553cf-180">The action that occurs when compute nodes are removed from a pool.</span></span> <span data-ttu-id="553cf-181">Lehetséges értékek:</span><span class="sxs-lookup"><span data-stu-id="553cf-181">Possible values are:</span></span><ul><li><span data-ttu-id="553cf-182">**requeue**--feladatok azonnal leáll, és, hogy azok újraütemezte helyezi őket újra a feladat-várólistába.</span><span class="sxs-lookup"><span data-stu-id="553cf-182">**requeue**--Terminates tasks immediately and puts them back on the job queue so that they are rescheduled.</span></span><li><span data-ttu-id="553cf-183">**Állítsa le**--feladatok azonnal leáll, és eltávolítja azokat a feladat-várólistán.</span><span class="sxs-lookup"><span data-stu-id="553cf-183">**terminate**--Terminates tasks immediately and removes them from the job queue.</span></span><li><span data-ttu-id="553cf-184">**taskcompletion**--vár a jelenleg futó feladatok befejezéséhez, majd eltávolítja a csomópontot a készletből.</span><span class="sxs-lookup"><span data-stu-id="553cf-184">**taskcompletion**--Waits for currently running tasks to finish and then removes the node from the pool.</span></span><li><span data-ttu-id="553cf-185">**retaineddata**– az összes helyi feladat őrzi meg a csomóponton, hogy a csomópont eltávolítása a készletből előtt tisztítani vár.</span><span class="sxs-lookup"><span data-stu-id="553cf-185">**retaineddata**--Waits for all the local task-retained data on the node to be cleaned up before removing the node from the pool.</span></span></ul> |

<span data-ttu-id="553cf-186">A Batch szolgáltatás metrikák alapuló módosításokra szolgáltatás által definiált változókhoz értékének kaphat:</span><span class="sxs-lookup"><span data-stu-id="553cf-186">You can get the value of these service-defined variables to make adjustments that are based on metrics from the Batch service:</span></span>

| <span data-ttu-id="553cf-187">Csak olvasható szolgáltatás által definiált változó</span><span class="sxs-lookup"><span data-stu-id="553cf-187">Read-only service-defined variables</span></span> | <span data-ttu-id="553cf-188">Leírás</span><span class="sxs-lookup"><span data-stu-id="553cf-188">Description</span></span> |
| --- | --- |
| <span data-ttu-id="553cf-189">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="553cf-189">$CPUPercent</span></span> |<span data-ttu-id="553cf-190">Az átlagos CPU-használat százalékos aránya</span><span class="sxs-lookup"><span data-stu-id="553cf-190">The average percentage of CPU usage.</span></span> |
| <span data-ttu-id="553cf-191">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="553cf-191">$WallClockSeconds</span></span> |<span data-ttu-id="553cf-192">A felhasznált másodpercek számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-192">The number of seconds consumed.</span></span> |
| <span data-ttu-id="553cf-193">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-193">$MemoryBytes</span></span> |<span data-ttu-id="553cf-194">A használt mérete (MB) átlagos száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-194">The average number of megabytes used.</span></span> |
| <span data-ttu-id="553cf-195">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-195">$DiskBytes</span></span> |<span data-ttu-id="553cf-196">A helyi lemezeken használt gigabájt átlagos száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-196">The average number of gigabytes used on the local disks.</span></span> |
| <span data-ttu-id="553cf-197">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-197">$DiskReadBytes</span></span> |<span data-ttu-id="553cf-198">A beolvasott bájtok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-198">The number of bytes read.</span></span> |
| <span data-ttu-id="553cf-199">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-199">$DiskWriteBytes</span></span> |<span data-ttu-id="553cf-200">Az írt bájtok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-200">The number of bytes written.</span></span> |
| <span data-ttu-id="553cf-201">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="553cf-201">$DiskReadOps</span></span> |<span data-ttu-id="553cf-202">A végrehajtott lemezolvasási műveletek száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-202">The count of read disk operations performed.</span></span> |
| <span data-ttu-id="553cf-203">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="553cf-203">$DiskWriteOps</span></span> |<span data-ttu-id="553cf-204">A végrehajtott írási lemez műveletek száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-204">The count of write disk operations performed.</span></span> |
| <span data-ttu-id="553cf-205">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-205">$NetworkInBytes</span></span> |<span data-ttu-id="553cf-206">Bejövő bájtok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-206">The number of inbound bytes.</span></span> |
| <span data-ttu-id="553cf-207">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-207">$NetworkOutBytes</span></span> |<span data-ttu-id="553cf-208">Küldött bájtok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-208">The number of outbound bytes.</span></span> |
| <span data-ttu-id="553cf-209">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="553cf-209">$SampleNodeCount</span></span> |<span data-ttu-id="553cf-210">A számítási csomópontok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-210">The count of compute nodes.</span></span> |
| <span data-ttu-id="553cf-211">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-211">$ActiveTasks</span></span> |<span data-ttu-id="553cf-212">A végrehajtásra kész, de még nem végrehajtása feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-212">The number of tasks that are ready to execute but are not yet executing.</span></span> <span data-ttu-id="553cf-213">A $ActiveTasks száma minden feladatokat, amelyek az aktív állapotú, és amelynek függőségek teljesülnek tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="553cf-213">The $ActiveTasks count includes all tasks that are in the active state and whose dependencies have been satisfied.</span></span> <span data-ttu-id="553cf-214">Minden feladatot, amely az aktív állapotban van, de amelynek függőségek nem teljesülnek a $ActiveTasks száma nem tartoznak.</span><span class="sxs-lookup"><span data-stu-id="553cf-214">Any tasks that are in the active state but whose dependencies have not been satisfied are excluded from the $ActiveTasks count.</span></span>|
| <span data-ttu-id="553cf-215">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-215">$RunningTasks</span></span> |<span data-ttu-id="553cf-216">Futó állapotban feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-216">The number of tasks in a running state.</span></span> |
| <span data-ttu-id="553cf-217">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-217">$PendingTasks</span></span> |<span data-ttu-id="553cf-218">$ActiveTasks és $RunningTasks összege.</span><span class="sxs-lookup"><span data-stu-id="553cf-218">The sum of $ActiveTasks and $RunningTasks.</span></span> |
| <span data-ttu-id="553cf-219">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-219">$SucceededTasks</span></span> |<span data-ttu-id="553cf-220">Sikeresen befejeződött feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-220">The number of tasks that finished successfully.</span></span> |
| <span data-ttu-id="553cf-221">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-221">$FailedTasks</span></span> |<span data-ttu-id="553cf-222">A sikertelen feladatok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-222">The number of tasks that failed.</span></span> |
| <span data-ttu-id="553cf-223">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-223">$CurrentDedicatedNodes</span></span> |<span data-ttu-id="553cf-224">A számítási csomópontok dedikált aktuális száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-224">The current number of dedicated compute nodes.</span></span> |
| <span data-ttu-id="553cf-225">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-225">$CurrentLowPriorityNodes</span></span> |<span data-ttu-id="553cf-226">Alacsony prioritású aktuális száma a számítási csomópontok, beleértve azoknak a fürtöknek, pre-empted volt.</span><span class="sxs-lookup"><span data-stu-id="553cf-226">The current number of low-priority compute nodes, including any nodes that have been pre-empted.</span></span> |
| <span data-ttu-id="553cf-227">$PreemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="553cf-227">$PreemptedNodeCount</span></span> | <span data-ttu-id="553cf-228">A készlet pre-empted állapotban lévő csomópontok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-228">The number of nodes in the pool that are in a pre-empted state.</span></span> |

> [!TIP]
> <span data-ttu-id="553cf-229">A csak olvasható, a szolgáltatás által meghatározott változók az előző táblázatban látható *objektumok* , adja meg a különböző módszereket a hozzájuk kapcsolódó adatok eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="553cf-229">The read-only, service-defined variables that are shown in the previous table are *objects* that provide various methods to access data associated with each.</span></span> <span data-ttu-id="553cf-230">További információkért lásd: [szerezze be a mintaadatokat](#getsampledata) című cikkben.</span><span class="sxs-lookup"><span data-stu-id="553cf-230">For more information, see [Obtain sample data](#getsampledata) later in this article.</span></span>
>
>

## <a name="types"></a><span data-ttu-id="553cf-231">Típusok</span><span class="sxs-lookup"><span data-stu-id="553cf-231">Types</span></span>
<span data-ttu-id="553cf-232">Ezek a típusok támogatottak a képlet:</span><span class="sxs-lookup"><span data-stu-id="553cf-232">These types are supported in a formula:</span></span>

* <span data-ttu-id="553cf-233">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-233">double</span></span>
* <span data-ttu-id="553cf-234">doubleVec</span><span class="sxs-lookup"><span data-stu-id="553cf-234">doubleVec</span></span>
* <span data-ttu-id="553cf-235">doubleVecList</span><span class="sxs-lookup"><span data-stu-id="553cf-235">doubleVecList</span></span>
* <span data-ttu-id="553cf-236">Karakterlánc</span><span class="sxs-lookup"><span data-stu-id="553cf-236">string</span></span>
* <span data-ttu-id="553cf-237">Timestamp típusú--időbélyeg olyan összetett struktúra, amely a következő tagot tartalmaz:</span><span class="sxs-lookup"><span data-stu-id="553cf-237">timestamp--timestamp is a compound structure that contains the following members:</span></span>

  * <span data-ttu-id="553cf-238">Év</span><span class="sxs-lookup"><span data-stu-id="553cf-238">year</span></span>
  * <span data-ttu-id="553cf-239">a hónap (1-12)</span><span class="sxs-lookup"><span data-stu-id="553cf-239">month (1-12)</span></span>
  * <span data-ttu-id="553cf-240">a nap (1-31)</span><span class="sxs-lookup"><span data-stu-id="553cf-240">day (1-31)</span></span>
  * <span data-ttu-id="553cf-241">milyen napra esik (a kell száma; például hétfő 1)</span><span class="sxs-lookup"><span data-stu-id="553cf-241">weekday (in the format of number; for example, 1 for Monday)</span></span>
  * <span data-ttu-id="553cf-242">óra (24 órás számformátumú; például 13 azt jelenti, hogy 1 óra)</span><span class="sxs-lookup"><span data-stu-id="553cf-242">hour (in 24-hour number format; for example, 13 means 1 PM)</span></span>
  * <span data-ttu-id="553cf-243">a perc (00 és 59 közötti)</span><span class="sxs-lookup"><span data-stu-id="553cf-243">minute (00-59)</span></span>
  * <span data-ttu-id="553cf-244">második (00 és 59 közötti)</span><span class="sxs-lookup"><span data-stu-id="553cf-244">second (00-59)</span></span>
* <span data-ttu-id="553cf-245">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="553cf-245">timeinterval</span></span>

  * <span data-ttu-id="553cf-246">TimeInterval_Zero</span><span class="sxs-lookup"><span data-stu-id="553cf-246">TimeInterval_Zero</span></span>
  * <span data-ttu-id="553cf-247">TimeInterval_100ns</span><span class="sxs-lookup"><span data-stu-id="553cf-247">TimeInterval_100ns</span></span>
  * <span data-ttu-id="553cf-248">TimeInterval_Microsecond</span><span class="sxs-lookup"><span data-stu-id="553cf-248">TimeInterval_Microsecond</span></span>
  * <span data-ttu-id="553cf-249">TimeInterval_Millisecond</span><span class="sxs-lookup"><span data-stu-id="553cf-249">TimeInterval_Millisecond</span></span>
  * <span data-ttu-id="553cf-250">TimeInterval_Second</span><span class="sxs-lookup"><span data-stu-id="553cf-250">TimeInterval_Second</span></span>
  * <span data-ttu-id="553cf-251">TimeInterval_Minute</span><span class="sxs-lookup"><span data-stu-id="553cf-251">TimeInterval_Minute</span></span>
  * <span data-ttu-id="553cf-252">TimeInterval_Hour</span><span class="sxs-lookup"><span data-stu-id="553cf-252">TimeInterval_Hour</span></span>
  * <span data-ttu-id="553cf-253">TimeInterval_Day</span><span class="sxs-lookup"><span data-stu-id="553cf-253">TimeInterval_Day</span></span>
  * <span data-ttu-id="553cf-254">TimeInterval_Week</span><span class="sxs-lookup"><span data-stu-id="553cf-254">TimeInterval_Week</span></span>
  * <span data-ttu-id="553cf-255">TimeInterval_Year</span><span class="sxs-lookup"><span data-stu-id="553cf-255">TimeInterval_Year</span></span>

## <a name="operations"></a><span data-ttu-id="553cf-256">Műveletek</span><span class="sxs-lookup"><span data-stu-id="553cf-256">Operations</span></span>
<span data-ttu-id="553cf-257">Ezeket a műveleteket az előző szakaszban felsorolt típusok engedélyezettek.</span><span class="sxs-lookup"><span data-stu-id="553cf-257">These operations are allowed on the types that are listed in the previous section.</span></span>

| <span data-ttu-id="553cf-258">Művelet</span><span class="sxs-lookup"><span data-stu-id="553cf-258">Operation</span></span> | <span data-ttu-id="553cf-259">Támogatott operátorok</span><span class="sxs-lookup"><span data-stu-id="553cf-259">Supported operators</span></span> | <span data-ttu-id="553cf-260">Eredménytípus</span><span class="sxs-lookup"><span data-stu-id="553cf-260">Result type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="553cf-261">kettős *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-261">double *operator* double</span></span> |<span data-ttu-id="553cf-262">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="553cf-262">+, -, *, /</span></span> |<span data-ttu-id="553cf-263">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-263">double</span></span> |
| <span data-ttu-id="553cf-264">kettős *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="553cf-264">double *operator* timeinterval</span></span> |* |<span data-ttu-id="553cf-265">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="553cf-265">timeinterval</span></span> |
| <span data-ttu-id="553cf-266">doubleVec *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-266">doubleVec *operator* double</span></span> |<span data-ttu-id="553cf-267">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="553cf-267">+, -, *, /</span></span> |<span data-ttu-id="553cf-268">doubleVec</span><span class="sxs-lookup"><span data-stu-id="553cf-268">doubleVec</span></span> |
| <span data-ttu-id="553cf-269">doubleVec *operátor* doubleVec</span><span class="sxs-lookup"><span data-stu-id="553cf-269">doubleVec *operator* doubleVec</span></span> |<span data-ttu-id="553cf-270">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="553cf-270">+, -, *, /</span></span> |<span data-ttu-id="553cf-271">doubleVec</span><span class="sxs-lookup"><span data-stu-id="553cf-271">doubleVec</span></span> |
| <span data-ttu-id="553cf-272">TimeInterval *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-272">timeinterval *operator* double</span></span> |<span data-ttu-id="553cf-273">*, /</span><span class="sxs-lookup"><span data-stu-id="553cf-273">*, /</span></span> |<span data-ttu-id="553cf-274">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="553cf-274">timeinterval</span></span> |
| <span data-ttu-id="553cf-275">TimeInterval *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="553cf-275">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="553cf-276">+, -</span><span class="sxs-lookup"><span data-stu-id="553cf-276">+, -</span></span> |<span data-ttu-id="553cf-277">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="553cf-277">timeinterval</span></span> |
| <span data-ttu-id="553cf-278">TimeInterval *operátor* időbélyeg</span><span class="sxs-lookup"><span data-stu-id="553cf-278">timeinterval *operator* timestamp</span></span> |+ |<span data-ttu-id="553cf-279">időbélyeg</span><span class="sxs-lookup"><span data-stu-id="553cf-279">timestamp</span></span> |
| <span data-ttu-id="553cf-280">Timestamp típusú *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="553cf-280">timestamp *operator* timeinterval</span></span> |+ |<span data-ttu-id="553cf-281">időbélyeg</span><span class="sxs-lookup"><span data-stu-id="553cf-281">timestamp</span></span> |
| <span data-ttu-id="553cf-282">Timestamp típusú *operátor* időbélyeg</span><span class="sxs-lookup"><span data-stu-id="553cf-282">timestamp *operator* timestamp</span></span> |- |<span data-ttu-id="553cf-283">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="553cf-283">timeinterval</span></span> |
| <span data-ttu-id="553cf-284">*operátor*dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-284">*operator*double</span></span> |<span data-ttu-id="553cf-285">-, !</span><span class="sxs-lookup"><span data-stu-id="553cf-285">-, !</span></span> |<span data-ttu-id="553cf-286">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-286">double</span></span> |
| <span data-ttu-id="553cf-287">*operátor*timeinterval</span><span class="sxs-lookup"><span data-stu-id="553cf-287">*operator*timeinterval</span></span> |- |<span data-ttu-id="553cf-288">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="553cf-288">timeinterval</span></span> |
| <span data-ttu-id="553cf-289">kettős *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-289">double *operator* double</span></span> |<span data-ttu-id="553cf-290"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="553cf-290"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="553cf-291">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-291">double</span></span> |
| <span data-ttu-id="553cf-292">karakterlánc *operátor* karakterlánc</span><span class="sxs-lookup"><span data-stu-id="553cf-292">string *operator* string</span></span> |<span data-ttu-id="553cf-293"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="553cf-293"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="553cf-294">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-294">double</span></span> |
| <span data-ttu-id="553cf-295">Timestamp típusú *operátor* időbélyeg</span><span class="sxs-lookup"><span data-stu-id="553cf-295">timestamp *operator* timestamp</span></span> |<span data-ttu-id="553cf-296"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="553cf-296"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="553cf-297">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-297">double</span></span> |
| <span data-ttu-id="553cf-298">TimeInterval *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="553cf-298">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="553cf-299"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="553cf-299"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="553cf-300">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-300">double</span></span> |
| <span data-ttu-id="553cf-301">kettős *operátor* dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-301">double *operator* double</span></span> |<span data-ttu-id="553cf-302">&&, &#124;&#124;</span><span class="sxs-lookup"><span data-stu-id="553cf-302">&&, &#124;&#124;</span></span> |<span data-ttu-id="553cf-303">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-303">double</span></span> |

<span data-ttu-id="553cf-304">Dupla típusú értékként Ternáris operátorral tesztelése során (`double ? statement1 : statement2`), nem nulla van **igaz**, és nulla **hamis**.</span><span class="sxs-lookup"><span data-stu-id="553cf-304">When testing a double with a ternary operator (`double ? statement1 : statement2`), nonzero is **true**, and zero is **false**.</span></span>

## <a name="functions"></a><span data-ttu-id="553cf-305">Functions</span><span class="sxs-lookup"><span data-stu-id="553cf-305">Functions</span></span>
<span data-ttu-id="553cf-306">Ezek előre definiált **funkciók** érhetők el, hogy az automatikus méretezési képlet definiálásakor használja.</span><span class="sxs-lookup"><span data-stu-id="553cf-306">These predefined **functions** are available for you to use in defining an automatic scaling formula.</span></span>

| <span data-ttu-id="553cf-307">Függvény</span><span class="sxs-lookup"><span data-stu-id="553cf-307">Function</span></span> | <span data-ttu-id="553cf-308">Visszatérési típusa</span><span class="sxs-lookup"><span data-stu-id="553cf-308">Return type</span></span> | <span data-ttu-id="553cf-309">Leírás</span><span class="sxs-lookup"><span data-stu-id="553cf-309">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="553cf-310">AVG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-310">avg(doubleVecList)</span></span> |<span data-ttu-id="553cf-311">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-311">double</span></span> |<span data-ttu-id="553cf-312">A doubleVecList átlagértékét összes értékét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-312">Returns the average value for all values in the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-313">len(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-313">len(doubleVecList)</span></span> |<span data-ttu-id="553cf-314">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-314">double</span></span> |<span data-ttu-id="553cf-315">A a doubleVecList létrehozott vektor hosszának beolvasása.</span><span class="sxs-lookup"><span data-stu-id="553cf-315">Returns the length of the vector that is created from the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-316">LG(Double)</span><span class="sxs-lookup"><span data-stu-id="553cf-316">lg(double)</span></span> |<span data-ttu-id="553cf-317">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-317">double</span></span> |<span data-ttu-id="553cf-318">A napló alap 2. a dupla adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-318">Returns the log base 2 of the double.</span></span> |
| <span data-ttu-id="553cf-319">LG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-319">lg(doubleVecList)</span></span> |<span data-ttu-id="553cf-320">doubleVec</span><span class="sxs-lookup"><span data-stu-id="553cf-320">doubleVec</span></span> |<span data-ttu-id="553cf-321">A component-wise napló alap 2. a doubleVecList adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-321">Returns the component-wise log base 2 of the doubleVecList.</span></span> <span data-ttu-id="553cf-322">Egy vec(double) paraméter explicit módon kell átadni.</span><span class="sxs-lookup"><span data-stu-id="553cf-322">A vec(double) must be explicitly passed for the parameter.</span></span> <span data-ttu-id="553cf-323">Ellenkező esetben a dupla lg(double) verzió feltételezi.</span><span class="sxs-lookup"><span data-stu-id="553cf-323">Otherwise, the double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="553cf-324">ln(Double)</span><span class="sxs-lookup"><span data-stu-id="553cf-324">ln(double)</span></span> |<span data-ttu-id="553cf-325">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-325">double</span></span> |<span data-ttu-id="553cf-326">A kettős természetes naplójának adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-326">Returns the natural log of the double.</span></span> |
| <span data-ttu-id="553cf-327">ln(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-327">ln(doubleVecList)</span></span> |<span data-ttu-id="553cf-328">doubleVec</span><span class="sxs-lookup"><span data-stu-id="553cf-328">doubleVec</span></span> |<span data-ttu-id="553cf-329">A component-wise napló alap 2. a doubleVecList adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-329">Returns the component-wise log base 2 of the doubleVecList.</span></span> <span data-ttu-id="553cf-330">Egy vec(double) paraméter explicit módon kell átadni.</span><span class="sxs-lookup"><span data-stu-id="553cf-330">A vec(double) must be explicitly passed for the parameter.</span></span> <span data-ttu-id="553cf-331">Ellenkező esetben a dupla lg(double) verzió feltételezi.</span><span class="sxs-lookup"><span data-stu-id="553cf-331">Otherwise, the double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="553cf-332">log(Double)</span><span class="sxs-lookup"><span data-stu-id="553cf-332">log(double)</span></span> |<span data-ttu-id="553cf-333">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-333">double</span></span> |<span data-ttu-id="553cf-334">A napló a kettős 10 alap adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-334">Returns the log base 10 of the double.</span></span> |
| <span data-ttu-id="553cf-335">log(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-335">log(doubleVecList)</span></span> |<span data-ttu-id="553cf-336">doubleVec</span><span class="sxs-lookup"><span data-stu-id="553cf-336">doubleVec</span></span> |<span data-ttu-id="553cf-337">A component-wise napló a doubleVecList alap 10 adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-337">Returns the component-wise log base 10 of the doubleVecList.</span></span> <span data-ttu-id="553cf-338">Egy vec(double) explicit módon kell átadni a egyetlen dupla paramétert.</span><span class="sxs-lookup"><span data-stu-id="553cf-338">A vec(double) must be explicitly passed for the single double parameter.</span></span> <span data-ttu-id="553cf-339">Ellenkező esetben a dupla log(double) verzió feltételezi.</span><span class="sxs-lookup"><span data-stu-id="553cf-339">Otherwise, the double log(double) version is assumed.</span></span> |
| <span data-ttu-id="553cf-340">Max(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-340">max(doubleVecList)</span></span> |<span data-ttu-id="553cf-341">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-341">double</span></span> |<span data-ttu-id="553cf-342">A doubleVecList maximális értékét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-342">Returns the maximum value in the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-343">Min(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-343">min(doubleVecList)</span></span> |<span data-ttu-id="553cf-344">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-344">double</span></span> |<span data-ttu-id="553cf-345">A doubleVecList minimális értékét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-345">Returns the minimum value in the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-346">NORM(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-346">norm(doubleVecList)</span></span> |<span data-ttu-id="553cf-347">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-347">double</span></span> |<span data-ttu-id="553cf-348">A két-alapértelmezetté a doubleVecList létrehozott vektor adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-348">Returns the two-norm of the vector that is created from the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-349">a PERCENTILIS (doubleVec v, dupla p)</span><span class="sxs-lookup"><span data-stu-id="553cf-349">percentile(doubleVec v, double p)</span></span> |<span data-ttu-id="553cf-350">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-350">double</span></span> |<span data-ttu-id="553cf-351">A PERCENTILIS elem a v vektor beolvasása.</span><span class="sxs-lookup"><span data-stu-id="553cf-351">Returns the percentile element of the vector v.</span></span> |
| <span data-ttu-id="553cf-352">rand()</span><span class="sxs-lookup"><span data-stu-id="553cf-352">rand()</span></span> |<span data-ttu-id="553cf-353">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-353">double</span></span> |<span data-ttu-id="553cf-354">Egy véletlenszerű értéke 0,0 és 1,0 között.</span><span class="sxs-lookup"><span data-stu-id="553cf-354">Returns a random value between 0.0 and 1.0.</span></span> |
| <span data-ttu-id="553cf-355">Range(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-355">range(doubleVecList)</span></span> |<span data-ttu-id="553cf-356">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-356">double</span></span> |<span data-ttu-id="553cf-357">A doubleVecList a minimális és maximális értékek különbségét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-357">Returns the difference between the min and max values in the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-358">STD(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-358">std(doubleVecList)</span></span> |<span data-ttu-id="553cf-359">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-359">double</span></span> |<span data-ttu-id="553cf-360">A doubleVecList értékek minta szórását adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-360">Returns the sample standard deviation of the values in the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-361">Stop()</span><span class="sxs-lookup"><span data-stu-id="553cf-361">stop()</span></span> | |<span data-ttu-id="553cf-362">Leállítja az automatikus skálázás kifejezés kiértékelése.</span><span class="sxs-lookup"><span data-stu-id="553cf-362">Stops evaluation of the autoscaling expression.</span></span> |
| <span data-ttu-id="553cf-363">Sum(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="553cf-363">sum(doubleVecList)</span></span> |<span data-ttu-id="553cf-364">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-364">double</span></span> |<span data-ttu-id="553cf-365">A doubleVecList összetevőit összegét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-365">Returns the sum of all the components of the doubleVecList.</span></span> |
| <span data-ttu-id="553cf-366">idő (dateTime karakterlánc = "")</span><span class="sxs-lookup"><span data-stu-id="553cf-366">time(string dateTime="")</span></span> |<span data-ttu-id="553cf-367">időbélyeg</span><span class="sxs-lookup"><span data-stu-id="553cf-367">timestamp</span></span> |<span data-ttu-id="553cf-368">Ha átadva adja vissza a jelenlegi időpontnál, ha nincs átadott paraméter van, vagy a dátum/idő karakterlánc időbélyegzőjét.</span><span class="sxs-lookup"><span data-stu-id="553cf-368">Returns the time stamp of the current time if no parameters are passed, or the time stamp of the dateTime string if it is passed.</span></span> <span data-ttu-id="553cf-369">Támogatott dátum és idő formátumok a következők: W3C-DTF és RFC 1123.</span><span class="sxs-lookup"><span data-stu-id="553cf-369">Supported dateTime formats are W3C-DTF and RFC 1123.</span></span> |
| <span data-ttu-id="553cf-370">val (doubleVec v, dupla i)</span><span class="sxs-lookup"><span data-stu-id="553cf-370">val(doubleVec v, double i)</span></span> |<span data-ttu-id="553cf-371">Dupla</span><span class="sxs-lookup"><span data-stu-id="553cf-371">double</span></span> |<span data-ttu-id="553cf-372">Az elem, helyén i vektoros v, a nulla kezdődő indexű értékét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-372">Returns the value of the element that is at location i in vector v, with a starting index of zero.</span></span> |

<span data-ttu-id="553cf-373">A függvények, az előző táblázatban ismertetett fogadhatnak egy listát, amelynek argumentuma.</span><span class="sxs-lookup"><span data-stu-id="553cf-373">Some of the functions that are described in the previous table can accept a list as an argument.</span></span> <span data-ttu-id="553cf-374">A vesszővel elválasztott lista bármilyen kombinációját *dupla* és *doubleVec*.</span><span class="sxs-lookup"><span data-stu-id="553cf-374">The comma-separated list is any combination of *double* and *doubleVec*.</span></span> <span data-ttu-id="553cf-375">Példa:</span><span class="sxs-lookup"><span data-stu-id="553cf-375">For example:</span></span>

`doubleVecList := ( (double | doubleVec)+(, (double | doubleVec) )* )?`

<span data-ttu-id="553cf-376">A *doubleVecList* érték alakítja át egyetlen *doubleVec* kiértékelése előtt.</span><span class="sxs-lookup"><span data-stu-id="553cf-376">The *doubleVecList* value is converted to a single *doubleVec* before evaluation.</span></span> <span data-ttu-id="553cf-377">Például ha `v = [1,2,3]`, majd hívja `avg(v)` hívása egyenértékű `avg(1,2,3)`.</span><span class="sxs-lookup"><span data-stu-id="553cf-377">For example, if `v = [1,2,3]`, then calling `avg(v)` is equivalent to calling `avg(1,2,3)`.</span></span> <span data-ttu-id="553cf-378">Hívása `avg(v, 7)` hívása egyenértékű `avg(1,2,3,7)`.</span><span class="sxs-lookup"><span data-stu-id="553cf-378">Calling `avg(v, 7)` is equivalent to calling `avg(1,2,3,7)`.</span></span>

## <span data-ttu-id="553cf-379"><a name="getsampledata"></a>Szerezze be a mintaadatokat</span><span class="sxs-lookup"><span data-stu-id="553cf-379"><a name="getsampledata"></a>Obtain sample data</span></span>
<span data-ttu-id="553cf-380">A Batch szolgáltatás által biztosított metrikákat adatok (minták) automatikus skálázási hajtanak végre műveleteket.</span><span class="sxs-lookup"><span data-stu-id="553cf-380">Autoscale formulas act on metrics data (samples) that is provided by the Batch service.</span></span> <span data-ttu-id="553cf-381">A képlet növekszik, vagy zsugorítja megszerzi a szolgáltatásból értékek alapján a készlet méretét.</span><span class="sxs-lookup"><span data-stu-id="553cf-381">A formula grows or shrinks pool size based on the values that it obtains from the service.</span></span> <span data-ttu-id="553cf-382">A szolgáltatás által definiált változókat leírt korábban olyan objektumok, adja meg a különböző módszereket, hogy az objektum társított adatok eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="553cf-382">The service-defined variables that were described previously are objects that provide various methods to access data that is associated with that object.</span></span> <span data-ttu-id="553cf-383">Például az alábbi kifejezés látható, a CPU-használat az elmúlt 5 percben beolvasása kérelem:</span><span class="sxs-lookup"><span data-stu-id="553cf-383">For example, the following expression shows a request to get the last five minutes of CPU usage:</span></span>

```
$CPUPercent.GetSample(TimeInterval_Minute * 5)
```

| <span data-ttu-id="553cf-384">Módszer</span><span class="sxs-lookup"><span data-stu-id="553cf-384">Method</span></span> | <span data-ttu-id="553cf-385">Leírás</span><span class="sxs-lookup"><span data-stu-id="553cf-385">Description</span></span> |
| --- | --- |
| <span data-ttu-id="553cf-386">GetSample()</span><span class="sxs-lookup"><span data-stu-id="553cf-386">GetSample()</span></span> |<span data-ttu-id="553cf-387">A `GetSample()` metódus egy adatok minták-vektorát adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-387">The `GetSample()` method returns a vector of data samples.</span></span><br/><br/><span data-ttu-id="553cf-388">Egy minta érték metrikák adatok érdemes 30 másodperc.</span><span class="sxs-lookup"><span data-stu-id="553cf-388">A sample is 30 seconds worth of metrics data.</span></span> <span data-ttu-id="553cf-389">Más szóval minták akkor kapja meg, 30 másodperces.</span><span class="sxs-lookup"><span data-stu-id="553cf-389">In other words, samples are obtained every 30 seconds.</span></span> <span data-ttu-id="553cf-390">Azonban az alábbi esetekben, amikor egy minta gyűjt, és elérhető képlet késleltetés van.</span><span class="sxs-lookup"><span data-stu-id="553cf-390">But as noted below, there is a delay between when a sample is collected and when it is available to a formula.</span></span> <span data-ttu-id="553cf-391">Mint ilyen nem minden mintákat egy adott időszakra vonatkozóan egy képlettel értékelésre érhetők el.</span><span class="sxs-lookup"><span data-stu-id="553cf-391">As such, not all samples for a given time period may be available for evaluation by a formula.</span></span><ul><li>`doubleVec GetSample(double count)`<br/><span data-ttu-id="553cf-392">Adja meg a legutóbbi minták összegyűjtött beszerezni minták számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-392">Specifies the number of samples to obtain from the most recent samples that were collected.</span></span><br/><br/><span data-ttu-id="553cf-393">`GetSample(1)`a legutóbbi elérhető minta adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-393">`GetSample(1)` returns the last available sample.</span></span> <span data-ttu-id="553cf-394">A metrikák, például `$CPUPercent`, azonban ez nem használható, mert nem lehet tudni, hogy *amikor* gyűjtötte a program a minta.</span><span class="sxs-lookup"><span data-stu-id="553cf-394">For metrics like `$CPUPercent`, however, this should not be used because it is impossible to know *when* the sample was collected.</span></span> <span data-ttu-id="553cf-395">Előfordulhat, hogy friss, vagy a rendszer problémák miatt előfordulhat, hogy sokkal régebbi.</span><span class="sxs-lookup"><span data-stu-id="553cf-395">It might be recent, or, because of system issues, it might be much older.</span></span> <span data-ttu-id="553cf-396">Érdemes ebben az esetben egy adott időintervallumban alább látható módon használatára.</span><span class="sxs-lookup"><span data-stu-id="553cf-396">It is better in such cases to use a time interval as shown below.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime [, double samplePercent])`<br/><span data-ttu-id="553cf-397">Adja meg vagy időszakon minta adatgyűjtést.</span><span class="sxs-lookup"><span data-stu-id="553cf-397">Specifies a time frame for gathering sample data.</span></span> <span data-ttu-id="553cf-398">Szükség esetén azt is a százalékos értékét határozza meg, hogy a kért időkereten belül el kell érnie minták.</span><span class="sxs-lookup"><span data-stu-id="553cf-398">Optionally, it also specifies the percentage of samples that must be available in the requested time frame.</span></span><br/><br/><span data-ttu-id="553cf-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)`20 minták alakítanák vissza, ha az elmúlt 10 perc minden minták léteznek CPUPercent előzményeit.</span><span class="sxs-lookup"><span data-stu-id="553cf-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)` would return 20 samples if all samples for the last 10 minutes are present in the CPUPercent history.</span></span> <span data-ttu-id="553cf-400">Ha az elmúlt percben az előzményeket nem volt elérhető, azonban csak 18 minták akkor adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-400">If the last minute of history was not available, however, only 18 samples would be returned.</span></span> <span data-ttu-id="553cf-401">Ebben az esetben:</span><span class="sxs-lookup"><span data-stu-id="553cf-401">In this case:</span></span><br/><br/><span data-ttu-id="553cf-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)`fognak működni, mert a minták csak 90 %-át érhetők el.</span><span class="sxs-lookup"><span data-stu-id="553cf-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)` would fail because only 90 percent of the samples are available.</span></span><br/><br/><span data-ttu-id="553cf-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)`járnak.</span><span class="sxs-lookup"><span data-stu-id="553cf-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` would succeed.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime, (timestamp or timeinterval) endTime [, double samplePercent])`<br/><span data-ttu-id="553cf-404">Adatgyűjtés a kezdési idő és a befejezési idő időkeretet határozza meg.</span><span class="sxs-lookup"><span data-stu-id="553cf-404">Specifies a time frame for gathering data, with both a start time and an end time.</span></span><br/><br/><span data-ttu-id="553cf-405">Fent említett nincs amikor minta gyűjt, és elérhető képlet késleltetés.</span><span class="sxs-lookup"><span data-stu-id="553cf-405">As mentioned above, there is a delay between when a sample is collected and when it is available to a formula.</span></span> <span data-ttu-id="553cf-406">Ez a késés használatakor vegye figyelembe a `GetSample` metódust.</span><span class="sxs-lookup"><span data-stu-id="553cf-406">Consider this delay when you use the `GetSample` method.</span></span> <span data-ttu-id="553cf-407">Lásd: `GetSamplePercent` alatt.</span><span class="sxs-lookup"><span data-stu-id="553cf-407">See `GetSamplePercent` below.</span></span> |
| <span data-ttu-id="553cf-408">GetSamplePeriod()</span><span class="sxs-lookup"><span data-stu-id="553cf-408">GetSamplePeriod()</span></span> |<span data-ttu-id="553cf-409">Egy korábbi minta adathalmaz végrehajtott minták a dátumtartományt ad vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-409">Returns the period of samples that were taken in a historical sample data set.</span></span> |
| <span data-ttu-id="553cf-410">Count()</span><span class="sxs-lookup"><span data-stu-id="553cf-410">Count()</span></span> |<span data-ttu-id="553cf-411">A metrika előzmények minták teljes számát adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-411">Returns the total number of samples in the metric history.</span></span> |
| <span data-ttu-id="553cf-412">HistoryBeginTime()</span><span class="sxs-lookup"><span data-stu-id="553cf-412">HistoryBeginTime()</span></span> |<span data-ttu-id="553cf-413">A metrika a legrégebbi rendelkezésre álló adatok minta időbélyegzőjét adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-413">Returns the time stamp of the oldest available data sample for the metric.</span></span> |
| <span data-ttu-id="553cf-414">GetSamplePercent()</span><span class="sxs-lookup"><span data-stu-id="553cf-414">GetSamplePercent()</span></span> |<span data-ttu-id="553cf-415">Egy adott időintervallumban a rendelkezésre álló minták aránya adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-415">Returns the percentage of samples that are available for a given time interval.</span></span> <span data-ttu-id="553cf-416">Példa:</span><span class="sxs-lookup"><span data-stu-id="553cf-416">For example:</span></span><br/><br/>`doubleVec GetSamplePercent( (timestamp or timeinterval) startTime [, (timestamp or timeinterval) endTime] )`<br/><br/><span data-ttu-id="553cf-417">Mivel a `GetSample` módszer nem jár sikerrel, ha minták százalékos visszaadott kisebb, mint a `samplePercent` megadott, használhatja a `GetSamplePercent` először ellenőrzési módszert.</span><span class="sxs-lookup"><span data-stu-id="553cf-417">Because the `GetSample` method fails if the percentage of samples returned is less than the `samplePercent` specified, you can use the `GetSamplePercent` method to check first.</span></span> <span data-ttu-id="553cf-418">Majd egy másik műveletet hajthatnak végre, ha elegendő minták léteznek, Leállítás, az automatikus méretezési értékelése nélkül.</span><span class="sxs-lookup"><span data-stu-id="553cf-418">Then you can perform an alternate action if insufficient samples are present, without halting the automatic scaling evaluation.</span></span> |

### <a name="samples-sample-percentage-and-the-getsample-method"></a><span data-ttu-id="553cf-419">Minták, a minta százalék, és a *GetSample()* módszer</span><span class="sxs-lookup"><span data-stu-id="553cf-419">Samples, sample percentage, and the *GetSample()* method</span></span>
<span data-ttu-id="553cf-420">Az automatikus skálázás képlet alapvető működéséhez szerezze be a tevékenység- és metrika értékét, és majd módosítsa a készlet mérete az adatok alapján.</span><span class="sxs-lookup"><span data-stu-id="553cf-420">The core operation of an autoscale formula is to obtain task and resource metric data and then adjust pool size based on that data.</span></span> <span data-ttu-id="553cf-421">Fontos, hogy az automatikus skálázás képletek hogyan működnek együtt a metrikai adatok (minták).</span><span class="sxs-lookup"><span data-stu-id="553cf-421">As such, it is important to have a clear understanding of how autoscale formulas interact with metrics data (samples).</span></span>

<span data-ttu-id="553cf-422">**Példák**</span><span class="sxs-lookup"><span data-stu-id="553cf-422">**Samples**</span></span>

<span data-ttu-id="553cf-423">A Batch szolgáltatás rendszeres időközönként tevékenység- és metrikákat mintát vesz igénybe, és elérhetővé válnak az automatikus skálázás képletek.</span><span class="sxs-lookup"><span data-stu-id="553cf-423">The Batch service periodically takes samples of task and resource metrics and makes them available to your autoscale formulas.</span></span> <span data-ttu-id="553cf-424">Ezeket a mintákat a Batch szolgáltatás 30 másodpercenként rögzítését.</span><span class="sxs-lookup"><span data-stu-id="553cf-424">These samples are recorded every 30 seconds by the Batch service.</span></span> <span data-ttu-id="553cf-425">Van azonban általában a késleltetés között, ha ezek a minták rögzítve, és amikor a rendelkezésre álló (és tudja olvasni.) az automatikus skálázás formulákat.</span><span class="sxs-lookup"><span data-stu-id="553cf-425">However, there is typically a delay between when those samples were recorded and when they are made available to (and can be read by) your autoscale formulas.</span></span> <span data-ttu-id="553cf-426">Továbbá például hálózati vagy egyéb infrastrukturális problémára különböző tényezők miatt minták előfordulhat, hogy nem rögzíti egy adott időszakban.</span><span class="sxs-lookup"><span data-stu-id="553cf-426">Additionally, due to various factors such as network or other infrastructure issues, samples may not be recorded for a particular interval.</span></span>

<span data-ttu-id="553cf-427">**A minta százalékos aránya**</span><span class="sxs-lookup"><span data-stu-id="553cf-427">**Sample percentage**</span></span>

<span data-ttu-id="553cf-428">Ha `samplePercent` számára a `GetSample()` metódus vagy a `GetSamplePercent()` metódus lehívásra kerül, _százalék_ hivatkozik a teljes lehetséges minták a Batch szolgáltatás által rögzített és száma összehasonlítása az automatikus skálázás képlet elérhető mintát.</span><span class="sxs-lookup"><span data-stu-id="553cf-428">When `samplePercent` is passed to the `GetSample()` method or the `GetSamplePercent()` method is called, _percent_ refers to a comparison between the total possible number of samples that are recorded by the Batch service and the number of samples that are available to your autoscale formula.</span></span>

<span data-ttu-id="553cf-429">Nézzük timespan érték 10 perc példaként.</span><span class="sxs-lookup"><span data-stu-id="553cf-429">Let's look at a 10-minute timespan as an example.</span></span> <span data-ttu-id="553cf-430">Minták tárolja, 30 másodperces timespan érték 10 perc belül, mert a köteg által rögzített minták maximális száma lenne 20 minták (2 / perc).</span><span class="sxs-lookup"><span data-stu-id="553cf-430">Because samples are recorded every 30 seconds within a 10-minute timespan, the maximum total number of samples that are recorded by Batch would be 20 samples (2 per minute).</span></span> <span data-ttu-id="553cf-431">Azonban a jelentéskészítési mechanizmus és más olyan problémák Azure-ban rejlő késését, mert előfordulhat, csak az automatikus skálázás képlet olvasásra rendelkezésre álló 15 minták.</span><span class="sxs-lookup"><span data-stu-id="553cf-431">However, due to the inherent latency of the reporting mechanism and other issues within Azure, there may be only 15 samples that are available to your autoscale formula for reading.</span></span> <span data-ttu-id="553cf-432">Tehát például az, hogy 10 perc alatt 75 %-a rögzített minták száma érhetők el a képlet.</span><span class="sxs-lookup"><span data-stu-id="553cf-432">So, for example, for that 10-minute period, only 75% of the total number of samples recorded may be available to your formula.</span></span>

<span data-ttu-id="553cf-433">**GetSample() és minta tartományok**</span><span class="sxs-lookup"><span data-stu-id="553cf-433">**GetSample() and sample ranges**</span></span>

<span data-ttu-id="553cf-434">Az automatikus skálázás képletek fog növekszik és a készletek zsugorítását &mdash; csomópontok hozzáadása vagy eltávolítása a csomópontok.</span><span class="sxs-lookup"><span data-stu-id="553cf-434">Your autoscale formulas are going to be growing and shrinking your pools &mdash; adding nodes or removing nodes.</span></span> <span data-ttu-id="553cf-435">Csomópontok pénz költségeket, mert szeretne biztosítani, hogy a képletekben módszerhez egy intelligens elemzés, amely elegendő adatokon alapul.</span><span class="sxs-lookup"><span data-stu-id="553cf-435">Because nodes cost you money, you want to ensure that your formulas use an intelligent method of analysis that is based on sufficient data.</span></span> <span data-ttu-id="553cf-436">Ezért azt javasoljuk, hogy használja-e a trendek-elemzés a képletekben.</span><span class="sxs-lookup"><span data-stu-id="553cf-436">Therefore, we recommend that you use a trending-type analysis in your formulas.</span></span> <span data-ttu-id="553cf-437">Ez a típus növekszik, és az összegyűjtött minták alapján készletek zsugorítja.</span><span class="sxs-lookup"><span data-stu-id="553cf-437">This type grows and shrinks your pools based on a range of collected samples.</span></span>

<span data-ttu-id="553cf-438">Ehhez használja `GetSample(interval look-back start, interval look-back end)` minták vektor vissza:</span><span class="sxs-lookup"><span data-stu-id="553cf-438">To do so, use `GetSample(interval look-back start, interval look-back end)` to return a vector of samples:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(1 * TimeInterval_Minute, 6 * TimeInterval_Minute);
```

<span data-ttu-id="553cf-439">A fenti sor kötegelt kiértékelésekor értékek vektor vissza minták számos.</span><span class="sxs-lookup"><span data-stu-id="553cf-439">When the above line is evaluated by Batch, it returns a range of samples as a vector of values.</span></span> <span data-ttu-id="553cf-440">Példa:</span><span class="sxs-lookup"><span data-stu-id="553cf-440">For example:</span></span>

```
$runningTasksSample=[1,1,1,1,1,1,1,1,1,1];
```

<span data-ttu-id="553cf-441">Miután minták vektoros összegyűjtött használhatók funkciók, például a `min()`, `max()`, és `avg()` jelentéssel bíró értékek kapcsolattípusokból származhatnak az összegyűjtött tartományon.</span><span class="sxs-lookup"><span data-stu-id="553cf-441">Once you've collected the vector of samples, you can then use functions like `min()`, `max()`, and `avg()` to derive meaningful values from the collected range.</span></span>

<span data-ttu-id="553cf-442">A fokozott biztonság érdekében kényszerítheti a kiértékelési sikertelen lesz, ha kisebb, mint egy bizonyos minta százalék érhető el egy adott időszakra vonatkozóan.</span><span class="sxs-lookup"><span data-stu-id="553cf-442">For additional security, you can force a formula evaluation to fail if less than a certain sample percentage is available for a particular time period.</span></span> <span data-ttu-id="553cf-443">Ha kényszeríti a kiértékelési sikertelen lesz, kötegelt, hogy további a képlet értékelése megszűnik, ha nem érhető el a megadott százalék minták utasította.</span><span class="sxs-lookup"><span data-stu-id="553cf-443">When you force a formula evaluation to fail, you instruct Batch to cease further evaluation of the formula if the specified percentage of samples is not available.</span></span> <span data-ttu-id="553cf-444">Ebben az esetben nem módosítja a készlet méretét.</span><span class="sxs-lookup"><span data-stu-id="553cf-444">In this case, no change is made to the pool size.</span></span> <span data-ttu-id="553cf-445">Minták sikeres értékeléséhez szükséges százalékos megadásához adja meg azt a harmadik paraméter `GetSample()`.</span><span class="sxs-lookup"><span data-stu-id="553cf-445">To specify a required percentage of samples for the evaluation to succeed, specify it as the third parameter to `GetSample()`.</span></span> <span data-ttu-id="553cf-446">Itt 75 százalékával minták követelményt van megadva:</span><span class="sxs-lookup"><span data-stu-id="553cf-446">Here, a requirement of 75 percent of samples is specified:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(60 * TimeInterval_Second, 120 * TimeInterval_Second, 75);
```

<span data-ttu-id="553cf-447">A minta rendelkezésre állási késés előfordulhat, mert fontos mindig adjon meg egy időtartományt megjelenését visszaírt kezdő időpontja korábbi, mint egy perc.</span><span class="sxs-lookup"><span data-stu-id="553cf-447">Because there may be a delay in sample availability, it is important to always specify a time range with a look-back start time that is older than one minute.</span></span> <span data-ttu-id="553cf-448">Az minták propagálásához a rendszer körülbelül egy percet vesz igénybe, így minták a tartomány `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="553cf-448">It takes approximately one minute for samples to propagate through the system, so samples in the range `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` may not be available.</span></span> <span data-ttu-id="553cf-449">Ebben az esetben használhatja a százalékos paramétere `GetSample()` adott minta százalékos követelmény kényszerítése.</span><span class="sxs-lookup"><span data-stu-id="553cf-449">Again, you can use the percentage parameter of `GetSample()` to force a particular sample percentage requirement.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="553cf-450">A Microsoft **erősen ajánlott** , amikor **elkerülése érdekében a megbízható függő *csak* a `GetSample(1)` az automatikus skálázás képletekben**.</span><span class="sxs-lookup"><span data-stu-id="553cf-450">We **strongly recommend** that you **avoid relying *only* on `GetSample(1)` in your autoscale formulas**.</span></span> <span data-ttu-id="553cf-451">Ennek az az oka `GetSample(1)` lényegében szerint a Batch szolgáltatás "Adja meg az utolsó mintát, rendelkezik, függetlenül attól, hogy mennyivel beolvasni."</span><span class="sxs-lookup"><span data-stu-id="553cf-451">This is because `GetSample(1)` essentially says to the Batch service, "Give me the last sample you have, no matter how long ago you retrieved it."</span></span> <span data-ttu-id="553cf-452">Csak egy egyszeres, és lehet, hogy egy régebbi mintát, mert nem lehet jellemző a legutóbbi tevékenység vagy erőforrás állapotának nagyobb képe.</span><span class="sxs-lookup"><span data-stu-id="553cf-452">Since it is only a single sample, and it may be an older sample, it may not be representative of the larger picture of recent task or resource state.</span></span> <span data-ttu-id="553cf-453">Ha a `GetSample(1)`, győződjön meg arról, hogy része egy nagyobb utasítás, és nem az egyetlen adatpont, amely a képlet támaszkodik.</span><span class="sxs-lookup"><span data-stu-id="553cf-453">If you do use `GetSample(1)`, make sure that it's part of a larger statement and not the only data point that your formula relies on.</span></span>
>
>

## <a name="metrics"></a><span data-ttu-id="553cf-454">Mérőszámok</span><span class="sxs-lookup"><span data-stu-id="553cf-454">Metrics</span></span>
<span data-ttu-id="553cf-455">Erőforrás és a feladat metrikák képlet definiálásakor még használhatja.</span><span class="sxs-lookup"><span data-stu-id="553cf-455">You can use both resource and task metrics when you're defining a formula.</span></span> <span data-ttu-id="553cf-456">Módosíthatja a dedikált csomópontok a készlet az beszerzése és kiértékelése metrikák adatokon alapulnak cél száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-456">You adjust the target number of dedicated nodes in the pool based on the metrics data that you obtain and evaluate.</span></span> <span data-ttu-id="553cf-457">Tekintse meg a [változók](#variables) szakasz fölött mindegyik metrikát olvashat.</span><span class="sxs-lookup"><span data-stu-id="553cf-457">See the [Variables](#variables) section above for more information on each metric.</span></span>

<table>
  <tr>
    <th><span data-ttu-id="553cf-458">Metrika</span><span class="sxs-lookup"><span data-stu-id="553cf-458">Metric</span></span></th>
    <th><span data-ttu-id="553cf-459">Leírás</span><span class="sxs-lookup"><span data-stu-id="553cf-459">Description</span></span></th>
  </tr>
  <tr>
    <td><span data-ttu-id="553cf-460"><b>Erőforrás</b></span><span class="sxs-lookup"><span data-stu-id="553cf-460"><b>Resource</b></span></span></td>
    <td><p><span data-ttu-id="553cf-461">Erőforrás metrikáit a CPU, a sávszélesség, a memória használata, a számítási csomópontok és a csomópontok száma alapulnak.</span><span class="sxs-lookup"><span data-stu-id="553cf-461">Resource metrics are based on the CPU, the bandwidth, the memory usage of compute nodes, and the number of nodes.</span></span></p>
        <p> <span data-ttu-id="553cf-462">A szolgáltatás által definiált változókat hasznosak korrekciók csomópontok száma alapján:</span><span class="sxs-lookup"><span data-stu-id="553cf-462">These service-defined variables are useful for making adjustments based on node count:</span></span></p>
    <p><ul>
            <li><span data-ttu-id="553cf-463">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-463">$TargetDedicatedNodes</span></span></li>
            <li><span data-ttu-id="553cf-464">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-464">$TargetLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="553cf-465">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-465">$CurrentDedicatedNodes</span></span></li>
            <li><span data-ttu-id="553cf-466">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="553cf-466">$CurrentLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="553cf-467">$preemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="553cf-467">$preemptedNodeCount</span></span></li>
            <li><span data-ttu-id="553cf-468">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="553cf-468">$SampleNodeCount</span></span></li>
    </ul></p>
    <p><span data-ttu-id="553cf-469">A szolgáltatás által definiált változókat hasznosak korrekciók csomópont erőforrás-használat alapján:</span><span class="sxs-lookup"><span data-stu-id="553cf-469">These service-defined variables are useful for making adjustments based on node resource usage:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="553cf-470">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="553cf-470">$CPUPercent</span></span></li>
      <li><span data-ttu-id="553cf-471">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="553cf-471">$WallClockSeconds</span></span></li>
      <li><span data-ttu-id="553cf-472">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-472">$MemoryBytes</span></span></li>
      <li><span data-ttu-id="553cf-473">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-473">$DiskBytes</span></span></li>
      <li><span data-ttu-id="553cf-474">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-474">$DiskReadBytes</span></span></li>
      <li><span data-ttu-id="553cf-475">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-475">$DiskWriteBytes</span></span></li>
      <li><span data-ttu-id="553cf-476">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="553cf-476">$DiskReadOps</span></span></li>
      <li><span data-ttu-id="553cf-477">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="553cf-477">$DiskWriteOps</span></span></li>
      <li><span data-ttu-id="553cf-478">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-478">$NetworkInBytes</span></span></li>
      <li><span data-ttu-id="553cf-479">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="553cf-479">$NetworkOutBytes</span></span></li></ul></p>
  </tr>
  <tr>
    <td><span data-ttu-id="553cf-480"><b>Tevékenység</b></span><span class="sxs-lookup"><span data-stu-id="553cf-480"><b>Task</b></span></span></td>
    <td><p><span data-ttu-id="553cf-481">Feladat metrikák függőben, például az aktív, a feladatok állapotának alapulnak, és befejeződött.</span><span class="sxs-lookup"><span data-stu-id="553cf-481">Task metrics are based on the status of tasks, such as Active, Pending, and Completed.</span></span> <span data-ttu-id="553cf-482">A következő szolgáltatás által definiált változókat hasznosak feladat mérőszámok alapján készletméretet korrekciók:</span><span class="sxs-lookup"><span data-stu-id="553cf-482">The following service-defined variables are useful for making pool-size adjustments based on task metrics:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="553cf-483">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-483">$ActiveTasks</span></span></li>
      <li><span data-ttu-id="553cf-484">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-484">$RunningTasks</span></span></li>
      <li><span data-ttu-id="553cf-485">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-485">$PendingTasks</span></span></li>
      <li><span data-ttu-id="553cf-486">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-486">$SucceededTasks</span></span></li>
            <li><span data-ttu-id="553cf-487">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="553cf-487">$FailedTasks</span></span></li></ul></p>
        </td>
  </tr>
</table>

## <a name="write-an-autoscale-formula"></a><span data-ttu-id="553cf-488">Az automatikus skálázás képlet írása</span><span class="sxs-lookup"><span data-stu-id="553cf-488">Write an autoscale formula</span></span>
<span data-ttu-id="553cf-489">Kibővített kialakítást hozhat létre az automatikus skálázás képlet képező utasításokat, amelyek a fenti összetevőket használnak, majd egyesítése egy teljes képlet ezen utasításokat.</span><span class="sxs-lookup"><span data-stu-id="553cf-489">You build an autoscale formula by forming statements that use the above components, then combine those statements into a complete formula.</span></span> <span data-ttu-id="553cf-490">Ebben a szakaszban egy példa automatikus skálázás képlet által végrehajtható műveleteket az egyes valós méretezési döntések tudjuk létrehozni.</span><span class="sxs-lookup"><span data-stu-id="553cf-490">In this section, we create an example autoscale formula that can perform some real-world scaling decisions.</span></span>

<span data-ttu-id="553cf-491">Először is határozza meg az új automatikus skálázás képlet követelményei.</span><span class="sxs-lookup"><span data-stu-id="553cf-491">First, let's define the requirements for our new autoscale formula.</span></span> <span data-ttu-id="553cf-492">A képlet a következőket:</span><span class="sxs-lookup"><span data-stu-id="553cf-492">The formula should:</span></span>

1. <span data-ttu-id="553cf-493">Dedikált számítási csomópontok a készlet cél számának növelése, ha a CPU-használata túl magas.</span><span class="sxs-lookup"><span data-stu-id="553cf-493">Increase the target number of dedicated compute nodes in a pool if CPU usage is high.</span></span>
2. <span data-ttu-id="553cf-494">Dedikált számítási csomópontok a készlet cél számának csökkentéséhez, amikor a CPU-használat alacsony.</span><span class="sxs-lookup"><span data-stu-id="553cf-494">Decrease the target number of dedicated compute nodes in a pool when CPU usage is low.</span></span>
3. <span data-ttu-id="553cf-495">Mindig korlátozása 400 dedikált csomópontok maximális száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-495">Always restrict the maximum number of dedicated nodes to 400.</span></span>

<span data-ttu-id="553cf-496">A csomópontok számának növeléséhez során magas CPU-használatot, definiálni kell az utasítást, amely tölti fel a felhasználó által definiált változó (`$totalDedicatedNodes`) értékkel, amely 110 százalékos aránya a cél száma dedikált csomópontok, de csak akkor, ha a minimális átlagos CPU-használat során a elmúlt 10 perc 70 százalék felett volt.</span><span class="sxs-lookup"><span data-stu-id="553cf-496">To increase the number of nodes during high CPU usage, define the statement that populates a user-defined variable (`$totalDedicatedNodes`) with a value that is 110 percent of the current target number of dedicated nodes, but only if the minimum average CPU usage during the last 10 minutes was above 70 percent.</span></span> <span data-ttu-id="553cf-497">Ellenkező esetben használja az értéket a kijelölt csomópontok száma.</span><span class="sxs-lookup"><span data-stu-id="553cf-497">Otherwise, use the value for the current number of dedicated nodes.</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
```

<span data-ttu-id="553cf-498">A *csökkentése* során alacsony processzorhasználat, a következő utasítás a képletben dedikált csomópontok száma beállítja azonos `$totalDedicatedNodes` változó – 90 százalékára az aktuális célként kijelölt csomópontok száma, ha a átlagos processzorhasználat százalékos mértéke az elmúlt 60 perc alatt 20 % volt.</span><span class="sxs-lookup"><span data-stu-id="553cf-498">To *decrease* the number of dedicated nodes during low CPU usage, the next statement in our formula sets the same `$totalDedicatedNodes` variable to 90 percent of the current target number of dedicated nodes if the average CPU usage in the past 60 minutes was under 20 percent.</span></span> <span data-ttu-id="553cf-499">Ellenkező esetben használja az aktuális értéke `$totalDedicatedNodes` , amely jelenleg a fenti utasításban feltöltve.</span><span class="sxs-lookup"><span data-stu-id="553cf-499">Otherwise, use the current value of `$totalDedicatedNodes` that we populated in the statement above.</span></span>

```
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
```

<span data-ttu-id="553cf-500">Most dedikált számítási csomópontok legfeljebb 400 cél számának korlátozása:</span><span class="sxs-lookup"><span data-stu-id="553cf-500">Now limit the target number of dedicated compute nodes to a maximum of 400:</span></span>

```
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

<span data-ttu-id="553cf-501">A teljes képlet a következő:</span><span class="sxs-lookup"><span data-stu-id="553cf-501">Here's the complete formula:</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

## <a name="create-an-autoscale-enabled-pool-with-net"></a><span data-ttu-id="553cf-502">A .NET az automatikus skálázás engedélyezve készlet létrehozása</span><span class="sxs-lookup"><span data-stu-id="553cf-502">Create an autoscale-enabled pool with .NET</span></span>

<span data-ttu-id="553cf-503">Az automatikus skálázást engedélyezve van a .NET-készlet létrehozása, kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="553cf-503">To create a pool with autoscaling enabled in .NET, follow these steps:</span></span>

1. <span data-ttu-id="553cf-504">A készlet létrehozásához [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span><span class="sxs-lookup"><span data-stu-id="553cf-504">Create the pool with [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span></span>
2. <span data-ttu-id="553cf-505">Állítsa be a [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) tulajdonságot `true`.</span><span class="sxs-lookup"><span data-stu-id="553cf-505">Set the [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) property to `true`.</span></span>
3. <span data-ttu-id="553cf-506">Állítsa be a [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) az automatikus skálázás képlettel tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="553cf-506">Set the [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) property with your autoscale formula.</span></span>
4. <span data-ttu-id="553cf-507">(Választható) Állítsa be a [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) tulajdonság (alapértelmezett érték 15 perc).</span><span class="sxs-lookup"><span data-stu-id="553cf-507">(Optional) Set the [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) property (default is 15 minutes).</span></span>
5. <span data-ttu-id="553cf-508">A címkészlet, amely véglegesíti [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) vagy [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span><span class="sxs-lookup"><span data-stu-id="553cf-508">Commit the pool with [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) or [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span></span>

<span data-ttu-id="553cf-509">A következő kódrészletet az automatikus skálázás engedélyezve készlet .NET hoz létre.</span><span class="sxs-lookup"><span data-stu-id="553cf-509">The following code snippet creates an autoscale-enabled pool in .NET.</span></span> <span data-ttu-id="553cf-510">A készlet automatikus skálázás képlet állítja be a cél több hétfőn 5 dedikált csomópontot, és minden egyéb a hét napja, 1.</span><span class="sxs-lookup"><span data-stu-id="553cf-510">The pool's autoscale formula sets the target number of dedicated nodes to 5 on Mondays, and 1 on every other day of the week.</span></span> <span data-ttu-id="553cf-511">A [automatikus méretezési időköz](#automatic-scaling-interval) 30 percre van beállítva.</span><span class="sxs-lookup"><span data-stu-id="553cf-511">The [automatic scaling interval](#automatic-scaling-interval) is set to 30 minutes.</span></span> <span data-ttu-id="553cf-512">Ebben és más C# kódtöredékek ebben a cikkben `myBatchClient` megfelelően inicializálva példánya a [BatchClient] [ net_batchclient] osztály.</span><span class="sxs-lookup"><span data-stu-id="553cf-512">In this and the other C# snippets in this article, `myBatchClient` is a properly initialized instance of the [BatchClient][net_batchclient] class.</span></span>

```csharp
CloudPool pool = myBatchClient.PoolOperations.CreatePool(
                    poolId: "mypool",
                    virtualMachineSize: "small", // single-core, 1.75 GB memory, 225 GB disk
                    cloudServiceConfiguration: new CloudServiceConfiguration(osFamily: "5"));    
pool.AutoScaleEnabled = true;
pool.AutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";
pool.AutoScaleEvaluationInterval = TimeSpan.FromMinutes(30);
await pool.CommitAsync();
```

> [!IMPORTANT]
> <span data-ttu-id="553cf-513">Az automatikus skálázás engedélyezve készletet hoz létre, ha nem adja meg a _targetDedicatedComputeNodes_ paraméter vagy a _targetLowPriorityComputeNodes_ hívásakor paraméter **CreatePool** .</span><span class="sxs-lookup"><span data-stu-id="553cf-513">When you create an autoscale-enabled pool, do not specify the _targetDedicatedComputeNodes_ parameter or the _targetLowPriorityComputeNodes_ parameter on the call to **CreatePool**.</span></span> <span data-ttu-id="553cf-514">Ehelyett adja meg a **AutoScaleEnabled** és **AutoScaleFormula** a készlet tulajdonságai.</span><span class="sxs-lookup"><span data-stu-id="553cf-514">Instead, specify the **AutoScaleEnabled** and **AutoScaleFormula** properties on the pool.</span></span> <span data-ttu-id="553cf-515">Ezek a tulajdonságok értékeit minden típusú csomópont target számának meghatározásához.</span><span class="sxs-lookup"><span data-stu-id="553cf-515">The values for these properties determine the target number of each type of node.</span></span> <span data-ttu-id="553cf-516">Manuálisan méretezze át az automatikus skálázás-kompatibilis készlet is, a (például a [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), első **letiltása** automatikus méretezésének a tárolókészlet, majd méretezze át.</span><span class="sxs-lookup"><span data-stu-id="553cf-516">Also, to manually resize an autoscale-enabled pool (for example, with [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), first **disable** automatic scaling on the pool, then resize it.</span></span>
>
>

<span data-ttu-id="553cf-517">Mellett Batch .NET, használhatja a másik [kötegelt SDK-k](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [kötegelt PowerShell-parancsmagok](batch-powershell-cmdlets-get-started.md), és a [kötegelt CLI](batch-cli-get-started.md) számára automatikus skálázás konfigurálása.</span><span class="sxs-lookup"><span data-stu-id="553cf-517">In addition to Batch .NET, you can use any of the other [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell cmdlets](batch-powershell-cmdlets-get-started.md), and the [Batch CLI](batch-cli-get-started.md) to configure autoscaling.</span></span>


### <a name="automatic-scaling-interval"></a><span data-ttu-id="553cf-518">Automatikus méretezési időköz</span><span class="sxs-lookup"><span data-stu-id="553cf-518">Automatic scaling interval</span></span>
<span data-ttu-id="553cf-519">Alapértelmezés szerint a Batch szolgáltatás 15 percenként állítja be a készlet méretét az automatikus skálázási képletnek megfelelően.</span><span class="sxs-lookup"><span data-stu-id="553cf-519">By default, the Batch service adjusts a pool's size according to its autoscale formula every 15 minutes.</span></span> <span data-ttu-id="553cf-520">Ez az időtartam alatt a következő alkalmazáskészlet tulajdonságaiban használatával konfigurálható:</span><span class="sxs-lookup"><span data-stu-id="553cf-520">This interval is configurable by using the following pool properties:</span></span>

* <span data-ttu-id="553cf-521">[CloudPool.AutoScaleEvaluationInterval] [ net_cloudpool_autoscaleevalinterval] (kötegelt .NET)</span><span class="sxs-lookup"><span data-stu-id="553cf-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (Batch .NET)</span></span>
* <span data-ttu-id="553cf-522">[autoScaleEvaluationInterval] [ rest_autoscaleinterval] (REST API-t)</span><span class="sxs-lookup"><span data-stu-id="553cf-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (REST API)</span></span>

<span data-ttu-id="553cf-523">A minimális időköze öt perc, a maximális 168 óra.</span><span class="sxs-lookup"><span data-stu-id="553cf-523">The minimum interval is five minutes, and the maximum is 168 hours.</span></span> <span data-ttu-id="553cf-524">Ha az időközönkénti ezen a tartományon kívül van megadva, a Batch szolgáltatás egy hibás kérés (400) hibaüzenetet adja vissza.</span><span class="sxs-lookup"><span data-stu-id="553cf-524">If an interval outside this range is specified, the Batch service returns a Bad Request (400) error.</span></span>

> [!NOTE]
> <span data-ttu-id="553cf-525">Automatikus skálázás nem célja jelenleg igazodjanak kisebb, mint egy percen belül, de ahelyett, hogy olyan fokozatosan futtatása a munkaterhelés, a készlet méretének beállítása.</span><span class="sxs-lookup"><span data-stu-id="553cf-525">Autoscaling is not currently intended to respond to changes in less than a minute, but rather is intended to adjust the size of your pool gradually as you run a workload.</span></span>
>
>

## <a name="enable-autoscaling-on-an-existing-pool"></a><span data-ttu-id="553cf-526">Egy meglévő készlet automatikus skálázás engedélyezéséhez</span><span class="sxs-lookup"><span data-stu-id="553cf-526">Enable autoscaling on an existing pool</span></span>

<span data-ttu-id="553cf-527">Minden egyes kötegelt SDK biztosítja az automatikus skálázás engedélyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="553cf-527">Each Batch SDK provides a way to enable autoscaling.</span></span> <span data-ttu-id="553cf-528">Példa:</span><span class="sxs-lookup"><span data-stu-id="553cf-528">For example:</span></span>

* <span data-ttu-id="553cf-529">[BatchClient.PoolOperations.EnableAutoScaleAsync] [ net_enableautoscaleasync] (kötegelt .NET)</span><span class="sxs-lookup"><span data-stu-id="553cf-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span></span>
* <span data-ttu-id="553cf-530">[A készlet automatikus skálázás engedélyezése] [ rest_enableautoscale] (REST API-t)</span><span class="sxs-lookup"><span data-stu-id="553cf-530">[Enable automatic scaling on a pool][rest_enableautoscale] (REST API)</span></span>

<span data-ttu-id="553cf-531">Ha engedélyezi az automatikus skálázás meglévő címkészlet, vegye figyelembe a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="553cf-531">When you enable autoscaling on an existing pool, keep in mind the following points:</span></span>

* <span data-ttu-id="553cf-532">Ha az automatikus skálázás jelenleg le van tiltva a készletet az automatikus skálázás engedélyezéséhez a kérelem elküldésekor, adjon meg érvényes automatikus skálázás képlet a kérelem elküldésekor.</span><span class="sxs-lookup"><span data-stu-id="553cf-532">If automatic scaling is currently disabled on the pool when you issue the request to enable autoscaling, you must specify a valid autoscale formula when you issue the request.</span></span> <span data-ttu-id="553cf-533">Opcionálisan megadhat az automatikus skálázás újraértékelési időközét.</span><span class="sxs-lookup"><span data-stu-id="553cf-533">You can optionally specify an autoscale evaluation interval.</span></span> <span data-ttu-id="553cf-534">Ha nem adja meg a időközt, az alapértelmezett érték 15 perc szolgál.</span><span class="sxs-lookup"><span data-stu-id="553cf-534">If you do not specify an interval, the default value of 15 minutes is used.</span></span>
* <span data-ttu-id="553cf-535">Ha automatikus skálázás jelenleg engedélyezve van a készletet, megadhatja az automatikus skálázás képlet, egy újraértékelési időközét, vagy mindkettőt.</span><span class="sxs-lookup"><span data-stu-id="553cf-535">If autoscale is currently enabled on the pool, you can specify an autoscale formula, an evaluation interval, or both.</span></span> <span data-ttu-id="553cf-536">Ezek a tulajdonságok közül legalább egy meg kell adnia.</span><span class="sxs-lookup"><span data-stu-id="553cf-536">You must specify at least one of these properties.</span></span>

  * <span data-ttu-id="553cf-537">Ha egy új automatikus skálázás újraértékelési időközét adja meg, majd a meglévő értékelésének ütemezése le van állítva, és új ütemezés szerint elindult.</span><span class="sxs-lookup"><span data-stu-id="553cf-537">If you specify a new autoscale evaluation interval, then the existing evaluation schedule is stopped and a new schedule is started.</span></span> <span data-ttu-id="553cf-538">Az új ütemezés kezdési ideje az az idő, amelynél a kérelem automatikus skálázás engedélyezéséhez ki.</span><span class="sxs-lookup"><span data-stu-id="553cf-538">The new schedule's start time is the time at which the request to enable autoscaling was issued.</span></span>
  * <span data-ttu-id="553cf-539">Ha nincs megadva vagy az automatikus skálázás képlet vagy újraértékelési időközét, a Batch szolgáltatás továbbra is az aktuális értéket használja.</span><span class="sxs-lookup"><span data-stu-id="553cf-539">If you omit either the autoscale formula or evaluation interval, the Batch service continues to use the current value of that setting.</span></span>

> [!NOTE]
> <span data-ttu-id="553cf-540">Ha a megadott értékek a *targetDedicatedComputeNodes* vagy *targetLowPriorityComputeNodes* paraméterei a **CreatePool** módszer a tárolókészlet létrehozásakor .NET, vagy egy másik nyelven összehasonlítható paraméterekhez, majd ezeket az értékeket figyelmen kívül hagyja az automatikus méretezési képlet kiértékelésekor.</span><span class="sxs-lookup"><span data-stu-id="553cf-540">If you specified values for the *targetDedicatedComputeNodes* or *targetLowPriorityComputeNodes* parameters of the **CreatePool** method when you created the pool in .NET, or for the comparable parameters in another language, then those values are ignored when the automatic scaling formula is evaluated.</span></span>
>
>

<span data-ttu-id="553cf-541">A C# kódrészletet használja a [Batch .NET] [ net_api] szalagtár meglévő címkészlet automatikus skálázás engedélyezéséhez:</span><span class="sxs-lookup"><span data-stu-id="553cf-541">This C# code snippet uses the [Batch .NET][net_api] library to enable autoscaling on an existing pool:</span></span>

```csharp
// Define the autoscaling formula. This formula sets the target number of nodes
// to 5 on Mondays, and 1 on every other day of the week
string myAutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";

// Set the autoscale formula on the existing pool
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myAutoScaleFormula);
```

### <a name="update-an-autoscale-formula"></a><span data-ttu-id="553cf-542">Az automatikus skálázás képlet frissítése</span><span class="sxs-lookup"><span data-stu-id="553cf-542">Update an autoscale formula</span></span>

<span data-ttu-id="553cf-543">A képlet meglévő automatikus skálázás engedélyezve címkészlet frissítéséhez hívható meg a művelet újra az új képletet az automatikus skálázás engedélyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="553cf-543">To update the formula on an existing autoscale-enabled pool, call the operation to enable autoscaling again with the new formula.</span></span> <span data-ttu-id="553cf-544">Például, ha az automatikus skálázás már engedélyezve van a `myexistingpool` eljárás végrehajtásakor a következő .NET-kódot, az automatikus skálázás képlet helyére tartalmát `myNewFormula`.</span><span class="sxs-lookup"><span data-stu-id="553cf-544">For example, if autoscaling is already enabled on `myexistingpool` when the following .NET code is executed, its autoscale formula is replaced with the contents of `myNewFormula`.</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myNewFormula);
```

### <a name="update-the-autoscale-interval"></a><span data-ttu-id="553cf-545">Frissítés az automatikus skálázás időköz</span><span class="sxs-lookup"><span data-stu-id="553cf-545">Update the autoscale interval</span></span>

<span data-ttu-id="553cf-546">Az automatikus skálázás újraértékelési időközét egy meglévő automatikus skálázás engedélyezve készlet frissítéséhez hívható meg a művelet újra az új időköz az automatikus skálázás engedélyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="553cf-546">To update the autoscale evaluation interval of an existing autoscale-enabled pool, call the operation to enable autoscaling again with the new interval.</span></span> <span data-ttu-id="553cf-547">Ha például az automatikus skálázás újraértékelési időközét beállítása és 60 perc már automatikus skálázás engedélyezve a .NET-készletre vonatkozó:</span><span class="sxs-lookup"><span data-stu-id="553cf-547">For example, to set the autoscale evaluation interval to 60 minutes for a pool that's already autoscale-enabled in .NET:</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleEvaluationInterval: TimeSpan.FromMinutes(60));
```

## <a name="evaluate-an-autoscale-formula"></a><span data-ttu-id="553cf-548">Az automatikus skálázás képlet kiértékelése</span><span class="sxs-lookup"><span data-stu-id="553cf-548">Evaluate an autoscale formula</span></span>

<span data-ttu-id="553cf-549">Mielőtt telepítené azt a készlethez kiértékelheti az képletet.</span><span class="sxs-lookup"><span data-stu-id="553cf-549">You can evaluate a formula before applying it to a pool.</span></span> <span data-ttu-id="553cf-550">Ezzel a módszerrel tesztelheti a képletet, hogy hogyan kimutatásait értékelje ki a képletet üzembe helyezésre előtt.</span><span class="sxs-lookup"><span data-stu-id="553cf-550">In this way, you can test the formula to see how its statements evaluate before you put the formula into production.</span></span>

<span data-ttu-id="553cf-551">Az automatikus skálázás képlet kiértékeléséhez, először engedélyeznie kell a készlet egy érvényes képletet az automatikus skálázást.</span><span class="sxs-lookup"><span data-stu-id="553cf-551">To evaluate an autoscale formula, you must first enable autoscaling on the pool with a valid formula.</span></span> <span data-ttu-id="553cf-552">Egy készlet, amely még nem rendelkezik engedélyezett automatikus skálázás képlet teszteléséhez használja a egysoros `$TargetDedicatedNodes = 0` Ha először engedélyezi az automatikus skálázást.</span><span class="sxs-lookup"><span data-stu-id="553cf-552">To test a formula on a pool that doesn't yet have autoscaling enabled, use the one-line formula `$TargetDedicatedNodes = 0` when you first enable autoscaling.</span></span> <span data-ttu-id="553cf-553">Ezután segítségével a következők egyikét értékelje ki a vizsgálni kívánt képlet:</span><span class="sxs-lookup"><span data-stu-id="553cf-553">Then, use one of the following to evaluate the formula you want to test:</span></span>

* <span data-ttu-id="553cf-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) vagy [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span><span class="sxs-lookup"><span data-stu-id="553cf-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) or [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span></span>

    <span data-ttu-id="553cf-555">A Batch .NET módszerekhez kiértékelése egy meglévő készlet és az automatikus skálázás képletet tartalmazó karakterlánc Azonosítóját.</span><span class="sxs-lookup"><span data-stu-id="553cf-555">These Batch .NET methods require the ID of an existing pool and a string containing the autoscale formula to evaluate.</span></span>

* [<span data-ttu-id="553cf-556">Az automatikus méretezési képlet kiértékelése</span><span class="sxs-lookup"><span data-stu-id="553cf-556">Evaluate an automatic scaling formula</span></span>](https://docs.microsoft.com/rest/api/batchservice/evaluate-an-automatic-scaling-formula)

    <span data-ttu-id="553cf-557">A REST API-kérelem, adja meg az URI azonosító a készlet Azonosítóját, és az automatikus skálázás képlet a *autoScaleFormula* eleme a kérés törzsében.</span><span class="sxs-lookup"><span data-stu-id="553cf-557">In this REST API request, specify the pool ID in the URI, and the autoscale formula in the *autoScaleFormula* element of the request body.</span></span> <span data-ttu-id="553cf-558">A válasz a művelet bármilyen melyikhez kapcsolódhat a képlet hibát adatokat tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="553cf-558">The response of the operation contains any error information that might be related to the formula.</span></span>

<span data-ttu-id="553cf-559">Ezen [Batch .NET] [ net_api] kódrészletet, azt az automatikus skálázás képlet kiértékeléséhez.</span><span class="sxs-lookup"><span data-stu-id="553cf-559">In this [Batch .NET][net_api] code snippet, we evaluate an autoscale formula.</span></span> <span data-ttu-id="553cf-560">Ha a készlet nem rendelkezik automatikus skálázás engedélyezve van, engedélyezzük az első.</span><span class="sxs-lookup"><span data-stu-id="553cf-560">If the pool does not have autoscaling enabled, we enable it first.</span></span>

```csharp
// First obtain a reference to an existing pool
CloudPool pool = await batchClient.PoolOperations.GetPoolAsync("myExistingPool");

// If autoscaling isn't already enabled on the pool, enable it.
// You can't evaluate an autoscale formula on non-autoscale-enabled pool.
if (pool.AutoScaleEnabled == false)
{
    // We need a valid autoscale formula to enable autoscaling on the
    // pool. This formula is valid, but won't resize the pool:
    await pool.EnableAutoScaleAsync(
        autoscaleFormula: "$TargetDedicatedNodes = {pool.CurrentDedicatedNodes};",
        autoscaleEvaluationInterval: TimeSpan.FromMinutes(5));

    // Batch limits EnableAutoScaleAsync calls to once every 30 seconds.
    // Because we want to apply our new autoscale formula below if it
    // evaluates successfully, and we *just* enabled autoscaling on
    // this pool, we pause here to ensure we pass that threshold.
    Thread.Sleep(TimeSpan.FromSeconds(31));

    // Refresh the properties of the pool so that we've got the
    // latest value for AutoScaleEnabled
    await pool.RefreshAsync();
}

// We must ensure that autoscaling is enabled on the pool prior to
// evaluating a formula
if (pool.AutoScaleEnabled == true)
{
    // The formula to evaluate - adjusts target number of nodes based on
    // day of week and time of day
    string myFormula = @"
        $curTime = time();
        $workHours = $curTime.hour >= 8 && $curTime.hour < 18;
        $isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
        $isWorkingWeekdayHour = $workHours && $isWeekday;
        $TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
    ";

    // Perform the autoscale formula evaluation. Note that this code does not
    // actually apply the formula to the pool.
    AutoScaleRun eval =
        await batchClient.PoolOperations.EvaluateAutoScaleAsync(pool.Id, myFormula);

    if (eval.Error == null)
    {
        // Evaluation success - print the results of the AutoScaleRun.
        // This will display the values of each variable as evaluated by the
        // autoscale formula.
        Console.WriteLine("AutoScaleRun.Results: " +
            eval.Results.Replace("$", "\n    $"));

        // Apply the formula to the pool since it evaluated successfully
        await batchClient.PoolOperations.EnableAutoScaleAsync(pool.Id, myFormula);
    }
    else
    {
        // Evaluation failed, output the message associated with the error
        Console.WriteLine("AutoScaleRun.Error.Message: " +
            eval.Error.Message);
    }
}
```

<span data-ttu-id="553cf-561">A következő kódrészletet látható képlet sikeres kiértékelési eredménye hasonló:</span><span class="sxs-lookup"><span data-stu-id="553cf-561">Successful evaluation of the formula shown in this code snippet produces results similar to:</span></span>

```
AutoScaleRun.Results:
    $TargetDedicatedNodes=10;
    $NodeDeallocationOption=requeue;
    $curTime=2016-10-13T19:18:47.805Z;
    $isWeekday=1;
    $isWorkingWeekdayHour=0;
    $workHours=0
```

## <a name="get-information-about-autoscale-runs"></a><span data-ttu-id="553cf-562">Automatikus skálázás futtatása adatainak beolvasása</span><span class="sxs-lookup"><span data-stu-id="553cf-562">Get information about autoscale runs</span></span>

<span data-ttu-id="553cf-563">Győződjön meg arról, hogy a várt módon működik-e a képletet, azt javasoljuk, hogy rendszeres időközönként ellenőrizze az automatikus skálázás fut, a készlet végző kötegelt eredményeit.</span><span class="sxs-lookup"><span data-stu-id="553cf-563">To ensure that your formula is performing as expected, we recommend that you periodically check the results of the autoscaling runs that Batch performs on your pool.</span></span> <span data-ttu-id="553cf-564">A tehát (vagy frissítse) egy hivatkozást, a készletbe és az utolsó automatikus skálázás futtatása tulajdonságainak vizsgálata.</span><span class="sxs-lookup"><span data-stu-id="553cf-564">To do so, get (or refresh) a reference to the pool, and examine the properties of its last autoscale run.</span></span>

<span data-ttu-id="553cf-565">A Batch .NET a [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) tulajdonság rendelkezik, amelyek információval szolgálnak a legújabb automatikus skálázás futtatnak majd elvégezni a készlet több tulajdonságok:</span><span class="sxs-lookup"><span data-stu-id="553cf-565">In Batch .NET, the [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) property has several properties that provide information about the latest automatic scaling run performed on the pool:</span></span>

* [<span data-ttu-id="553cf-566">AutoScaleRun.Timestamp</span><span class="sxs-lookup"><span data-stu-id="553cf-566">AutoScaleRun.Timestamp</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.timestamp)
* [<span data-ttu-id="553cf-567">AutoScaleRun.Results</span><span class="sxs-lookup"><span data-stu-id="553cf-567">AutoScaleRun.Results</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.results)
* [<span data-ttu-id="553cf-568">AutoScaleRun.Error</span><span class="sxs-lookup"><span data-stu-id="553cf-568">AutoScaleRun.Error</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.error)

<span data-ttu-id="553cf-569">A REST API-ban a [készlet adatainak beolvasása](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) kérelmet a készletbe, amely tartalmazza a legújabb automatikus skálázás információk futtatni információt ad vissza a [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="553cf-569">In the REST API, the [Get information about a pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) request returns information about the pool, which includes the latest automatic scaling run information in the [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) property.</span></span>

<span data-ttu-id="553cf-570">A következő C# kódrészletet használja a Batch .NET kódtár adatokat a legutóbbi automatikus skálázás futtassa a készlet nyomtathat _myPool_:</span><span class="sxs-lookup"><span data-stu-id="553cf-570">The following C# code snippet uses the Batch .NET library to print information about the last autoscaling run on pool _myPool_:</span></span>

```csharp
await Cloud pool = myBatchClient.PoolOperations.GetPoolAsync("myPool");
Console.WriteLine("Last execution: " + pool.AutoScaleRun.Timestamp);
Console.WriteLine("Result:" + pool.AutoScaleRun.Results.Replace("$", "\n  $"));
Console.WriteLine("Error: " + pool.AutoScaleRun.Error);
```

<span data-ttu-id="553cf-571">Az előző részlet Példakimenet:</span><span class="sxs-lookup"><span data-stu-id="553cf-571">Sample output of the preceding snippet:</span></span>

```
Last execution: 10/14/2016 18:36:43
Result:
  $TargetDedicatedNodes=10;
  $NodeDeallocationOption=requeue;
  $curTime=2016-10-14T18:36:43.282Z;
  $isWeekday=1;
  $isWorkingWeekdayHour=0;
  $workHours=0
Error:
```

## <a name="example-autoscale-formulas"></a><span data-ttu-id="553cf-572">Példa automatikus skálázás képletek</span><span class="sxs-lookup"><span data-stu-id="553cf-572">Example autoscale formulas</span></span>
<span data-ttu-id="553cf-573">Vizsgáljuk meg néhány képletek, amelyek megjelenítik a különböző módon úgy, hogy a készlet számítási erőforrások mennyisége.</span><span class="sxs-lookup"><span data-stu-id="553cf-573">Let's look at a few formulas that show different ways to adjust the amount of compute resources in a pool.</span></span>

### <a name="example-1-time-based-adjustment"></a><span data-ttu-id="553cf-574">1. példa: Időalapú módosítása</span><span class="sxs-lookup"><span data-stu-id="553cf-574">Example 1: Time-based adjustment</span></span>
<span data-ttu-id="553cf-575">Tegyük fel, hogy úgy, hogy a készlet méretét, és a hét napja, nap alapul.</span><span class="sxs-lookup"><span data-stu-id="553cf-575">Suppose you want to adjust the pool size based on the day of the week and time of day.</span></span> <span data-ttu-id="553cf-576">Ez a példa bemutatja, hogyan növelhető vagy csökkenthető ennek megfelelően a készletben található csomópontok számát.</span><span class="sxs-lookup"><span data-stu-id="553cf-576">This example shows how to increase or decrease the number of nodes in the pool accordingly.</span></span>

<span data-ttu-id="553cf-577">A képlet először beolvassa az aktuális idővel.</span><span class="sxs-lookup"><span data-stu-id="553cf-577">The formula first obtains the current time.</span></span> <span data-ttu-id="553cf-578">Ha a hét napja (1-5) és munkaidőn (8 AM a 18: 00) belül, a cél készletméretet értéke 20 csomópontot.</span><span class="sxs-lookup"><span data-stu-id="553cf-578">If it's a weekday (1-5) and within working hours (8 AM to 6 PM), the target pool size is set to 20 nodes.</span></span> <span data-ttu-id="553cf-579">Ellenkező esetben az értéke 10 csomópontok.</span><span class="sxs-lookup"><span data-stu-id="553cf-579">Otherwise, it's set to 10 nodes.</span></span>

```
$curTime = time();
$workHours = $curTime.hour >= 8 && $curTime.hour < 18;
$isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
$isWorkingWeekdayHour = $workHours && $isWeekday;
$TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
```

### <a name="example-2-task-based-adjustment"></a><span data-ttu-id="553cf-580">2. példa: Feladatalapú módosítása</span><span class="sxs-lookup"><span data-stu-id="553cf-580">Example 2: Task-based adjustment</span></span>
<span data-ttu-id="553cf-581">Ebben a példában a készlet méretét módosul a várólistán lévő feladatok száma alapján.</span><span class="sxs-lookup"><span data-stu-id="553cf-581">In this example, the pool size is adjusted based on the number of tasks in the queue.</span></span> <span data-ttu-id="553cf-582">Megjegyzések és a sortöréseket a képlet karakterláncok elfogadhatók.</span><span class="sxs-lookup"><span data-stu-id="553cf-582">Both comments and line breaks are acceptable in formula strings.</span></span>

```csharp
// Get pending tasks for the past 15 minutes.
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
// If we have fewer than 70 percent data points, we use the last sample point,
// otherwise we use the maximum of last sample point and the history average.
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1), avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// If number of pending tasks is not 0, set targetVM to pending tasks, otherwise
// half of current dedicated.
$targetVMs = $tasks > 0? $tasks:max(0, $TargetDedicatedNodes/2);
// The pool size is capped at 20, if target VM value is more than that, set it
// to 20. This value should be adjusted according to your use case.
$TargetDedicatedNodes = max(0, min($targetVMs, 20));
// Set node deallocation mode - keep nodes active only until tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-3-accounting-for-parallel-tasks"></a><span data-ttu-id="553cf-583">3. példa: Párhuzamos tevékenységek nyilvántartás</span><span class="sxs-lookup"><span data-stu-id="553cf-583">Example 3: Accounting for parallel tasks</span></span>
<span data-ttu-id="553cf-584">Ebben a példában a készlet méretét, a feladatok száma alapján állítja be.</span><span class="sxs-lookup"><span data-stu-id="553cf-584">This example adjusts the pool size based on the number of tasks.</span></span> <span data-ttu-id="553cf-585">A képlet is figyelembe veszi a [MaxTasksPerComputeNode] [ net_maxtasks] érték, amely be van állítva a készletet.</span><span class="sxs-lookup"><span data-stu-id="553cf-585">This formula also takes into account the [MaxTasksPerComputeNode][net_maxtasks] value that has been set for the pool.</span></span> <span data-ttu-id="553cf-586">Ez a módszer akkor hasznos, ahol [párhuzamos tevékenység végrehajtása](batch-parallel-node-tasks.md) a készlet engedélyezve lett.</span><span class="sxs-lookup"><span data-stu-id="553cf-586">This approach is useful in situations where [parallel task execution](batch-parallel-node-tasks.md) has been enabled on your pool.</span></span>

```csharp
// Determine whether 70 percent of the samples have been recorded in the past
// 15 minutes; if not, use last sample
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1),avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// Set the number of nodes to add to one-fourth the number of active tasks (the
// MaxTasksPerComputeNode property on this pool is set to 4, adjust this number
// for your use case)
$cores = $TargetDedicatedNodes * 4;
$extraVMs = (($tasks - $cores) + 3) / 4;
$targetVMs = ($TargetDedicatedNodes + $extraVMs);
// Attempt to grow the number of compute nodes to match the number of active
// tasks, with a maximum of 3
$TargetDedicatedNodes = max(0,min($targetVMs,3));
// Keep the nodes active until the tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-4-setting-an-initial-pool-size"></a><span data-ttu-id="553cf-587">4. példa: Egy kezdeti mérete beállítása</span><span class="sxs-lookup"><span data-stu-id="553cf-587">Example 4: Setting an initial pool size</span></span>
<span data-ttu-id="553cf-588">Ez a példa bemutatja egy C# kódrészletet az automatikus skálázás képlettel, amely egy megadott számára korlátozva a csomópontok a készlet méretét határoz meg egy kezdeti időszak.</span><span class="sxs-lookup"><span data-stu-id="553cf-588">This example shows a C# code snippet with an autoscale formula that sets the pool size to a specified number of nodes for an initial time period.</span></span> <span data-ttu-id="553cf-589">Ezután azt állítja be a készlet mérete alapján fut számát és az aktív feladatok a kezdeti időszak eltelte után.</span><span class="sxs-lookup"><span data-stu-id="553cf-589">Then it adjusts the pool size based on the number of running and active tasks after the initial time period has elapsed.</span></span>

<span data-ttu-id="553cf-590">A képlet a következő kódrészletet:</span><span class="sxs-lookup"><span data-stu-id="553cf-590">The formula in the following code snippet:</span></span>

* <span data-ttu-id="553cf-591">Négy csomópont állítja be a kezdeti mérete.</span><span class="sxs-lookup"><span data-stu-id="553cf-591">Sets the initial pool size to four nodes.</span></span>
* <span data-ttu-id="553cf-592">A készlet életciklus első 10 percen belül nem igazítja a készlet méretét.</span><span class="sxs-lookup"><span data-stu-id="553cf-592">Does not adjust the pool size within the first 10 minutes of the pool's lifecycle.</span></span>
* <span data-ttu-id="553cf-593">10 perc elteltével beolvassa a maximális értékének száma az elmúlt 60 percen belül futó és az aktív feladatok.</span><span class="sxs-lookup"><span data-stu-id="553cf-593">After 10 minutes, obtains the max value of the number of running and active tasks within the past 60 minutes.</span></span>
  * <span data-ttu-id="553cf-594">Ha mindkét értékek 0 (Ez azt jelzi, hogy a feladat nem fut, vagy az elmúlt 60 perc aktív volt-e), a készlet méretét értéke 0.</span><span class="sxs-lookup"><span data-stu-id="553cf-594">If both values are 0 (indicating that no tasks were running or active in the last 60 minutes), the pool size is set to 0.</span></span>
  * <span data-ttu-id="553cf-595">Ha bármelyik érték nullánál nem kisebb, nem történik változás.</span><span class="sxs-lookup"><span data-stu-id="553cf-595">If either value is greater than zero, no change is made.</span></span>

```csharp
string now = DateTime.UtcNow.ToString("r");
string formula = string.Format(@"
    $TargetDedicatedNodes = {1};
    lifespan         = time() - time(""{0}"");
    span             = TimeInterval_Minute * 60;
    startup          = TimeInterval_Minute * 10;
    ratio            = 50;

    $TargetDedicatedNodes = (lifespan > startup ? (max($RunningTasks.GetSample(span, ratio), $ActiveTasks.GetSample(span, ratio)) == 0 ? 0 : $TargetDedicatedNodes) : {1});
    ", now, 4);
```

## <a name="next-steps"></a><span data-ttu-id="553cf-596">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="553cf-596">Next steps</span></span>
* <span data-ttu-id="553cf-597">[Azure Batch számítási erőforrás-használat csomópont egyidejű feladatok maximális](batch-parallel-node-tasks.md) részletesen ismerteti, hogyan hajthat végre több feladat egyidejű a készlet számítási csomópontjain.</span><span class="sxs-lookup"><span data-stu-id="553cf-597">[Maximize Azure Batch compute resource usage with concurrent node tasks](batch-parallel-node-tasks.md) contains details about how you can execute multiple tasks simultaneously on the compute nodes in your pool.</span></span> <span data-ttu-id="553cf-598">Mellett automatikus skálázást Ez a szolgáltatás segíthet feladat időtartama bizonyos munkaterhelések esetén, így pénzt takaríthat csökkenthető.</span><span class="sxs-lookup"><span data-stu-id="553cf-598">In addition to autoscaling, this feature may help to lower job duration for some workloads, saving you money.</span></span>
* <span data-ttu-id="553cf-599">Egy másik hatékonyságát gyorsító győződjön meg arról, hogy a kötegelt kérelem a Batch szolgáltatás lekérdezi a legoptimálisabb módon.</span><span class="sxs-lookup"><span data-stu-id="553cf-599">For another efficiency booster, ensure that your Batch application queries the Batch service in the most optimal way.</span></span> <span data-ttu-id="553cf-600">Lásd: [hatékonyan lekérdezése az Azure Batch szolgáltatás](batch-efficient-list-queries.md) megtudhatja, hogyan átmenő a hálózaton, amikor több ezer számítási csomópontok és a feladatok állapotának lekérdezése adatok korlátozásához.</span><span class="sxs-lookup"><span data-stu-id="553cf-600">See [Query the Azure Batch service efficiently](batch-efficient-list-queries.md) to learn how to limit the amount of data that crosses the wire when you query the status of potentially thousands of compute nodes or tasks.</span></span>

[net_api]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch
[net_batchclient]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.batchclient
[net_cloudpool_autoscaleformula]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula
[net_cloudpool_autoscaleevalinterval]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval
[net_enableautoscaleasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.enableautoscaleasync
[net_maxtasks]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.maxtaskspercomputenode
[net_poolops_resizepoolasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.resizepoolasync

[rest_api]: https://docs.microsoft.com/rest/api/batchservice/
[rest_autoscaleformula]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_autoscaleinterval]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_enableautoscale]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
