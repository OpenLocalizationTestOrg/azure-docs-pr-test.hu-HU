---
title: "aaaPersist feladat- és kimeneti tooAzure tárolás az Azure Batch szolgáltatás API hello |} Microsoft Docs"
description: "Ismerje meg, hogyan toouse Batch szolgáltatás API toopersist kötegelt feladat és a feladat kimenetét tooAzure tároló."
services: batch
author: tamram
manager: timlt
editor: 
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 06/16/2017
ms.author: tamram
ms.openlocfilehash: 71b3f7c0dda2d2a9d8eb3eef83229873c70ca22c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="persist-task-data-tooazure-storage-with-hello-batch-service-api"></a><span data-ttu-id="7fca0-103">Feladat adatok tooAzure tárolási hello Batch szolgáltatás API megőrzése</span><span class="sxs-lookup"><span data-stu-id="7fca0-103">Persist task data tooAzure Storage with hello Batch service API</span></span>

[!INCLUDE [batch-task-output-include](../../includes/batch-task-output-include.md)]

<span data-ttu-id="7fca0-104">Verziójával 2017-05-01-től kezdődően hello Batch szolgáltatás API támogatja tárolásakor kimeneti adatok tooAzure tároló és a készletek hello virtuálisgép-konfiguráció futó feladat manager feladatok.</span><span class="sxs-lookup"><span data-stu-id="7fca0-104">Starting with version 2017-05-01, hello Batch service API supports persisting output data tooAzure Storage for tasks and job manager tasks that run on pools with hello virtual machine configuration.</span></span> <span data-ttu-id="7fca0-105">Ha hozzáad egy feladatot, hello feladat kimenetének hello célját az Azure Storage megadhatja egy tárolót.</span><span class="sxs-lookup"><span data-stu-id="7fca0-105">When you add a task, you can specify a container in Azure Storage as hello destination for hello task's output.</span></span> <span data-ttu-id="7fca0-106">hello Batch szolgáltatás ezután ír a kimeneti adatok toothat tároló, hello feladat befejezésekor.</span><span class="sxs-lookup"><span data-stu-id="7fca0-106">hello Batch service then writes any output data toothat container when hello task is complete.</span></span>

<span data-ttu-id="7fca0-107">Egy előny toousing hello Batch szolgáltatás API toopersist feladat kimenetének, ezért nincs szükség a feladat hello toomodify hello alkalmazás fut.</span><span class="sxs-lookup"><span data-stu-id="7fca0-107">An advantage toousing hello Batch service API toopersist task output is that you do not need toomodify hello application that hello task is running.</span></span> <span data-ttu-id="7fca0-108">Ehelyett néhány egyszerű módosítások tooyour ügyfélalkalmazást, az hello kód által létrehozott hello tevékenység kimenete hello feladat is megmaradnak.</span><span class="sxs-lookup"><span data-stu-id="7fca0-108">Instead, with a few simple modifications tooyour client application, you can persist hello task's output from within hello code that creates hello task.</span></span>   

## <a name="when-do-i-use-hello-batch-service-api-toopersist-task-output"></a><span data-ttu-id="7fca0-109">Ha használja a Batch szolgáltatás API hello toopersist feladat kimenetének?</span><span class="sxs-lookup"><span data-stu-id="7fca0-109">When do I use hello Batch service API toopersist task output?</span></span>

<span data-ttu-id="7fca0-110">Az Azure Batch szolgáltatás több mint egyirányú toopersist feladat kimenete.</span><span class="sxs-lookup"><span data-stu-id="7fca0-110">Azure Batch provides more than one way toopersist task output.</span></span> <span data-ttu-id="7fca0-111">Hello Batch szolgáltatás API használata egy kényelmes módszert alkalmaz, amely a legjobb olyan környezethez a legalkalmasabb toothese forgatókönyvek van:</span><span class="sxs-lookup"><span data-stu-id="7fca0-111">Using hello Batch service API is a convenient approach that's best suited toothese scenarios:</span></span>

- <span data-ttu-id="7fca0-112">Azt szeretné, toowrite kód toopersist tevékenység kimenete az ügyfélalkalmazásban hello alkalmazás, amely a feladat futásának módosítása nélkül.</span><span class="sxs-lookup"><span data-stu-id="7fca0-112">You want toowrite code toopersist task output from within your client application, without modifying hello application that your task is running.</span></span>
- <span data-ttu-id="7fca0-113">Azt szeretné, hogy a kötegelt és feladat manager feladatok hello virtuálisgép-konfiguráció létre készletek toopersist kimenetét.</span><span class="sxs-lookup"><span data-stu-id="7fca0-113">You want toopersist output from Batch tasks and job manager tasks in pools created with hello virtual machine configuration.</span></span>
- <span data-ttu-id="7fca0-114">Azt szeretné, hogy toopersist kimeneti tooan Azure Storage-tárolóban egy tetszőleges nevet.</span><span class="sxs-lookup"><span data-stu-id="7fca0-114">You want toopersist output tooan Azure Storage container with an arbitrary name.</span></span>
- <span data-ttu-id="7fca0-115">Azt szeretné, hogy toopersist kimeneti tooan Azure Storage nevű tárolót függően toohello [kötegelt fájl egyezmények standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="7fca0-115">You want toopersist output tooan Azure Storage container named according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> 

<span data-ttu-id="7fca0-116">Ha a forgatókönyv eltér a fent felsorolt, szükség lehet tooconsider másik módszert.</span><span class="sxs-lookup"><span data-stu-id="7fca0-116">If your scenario differs from those listed above, you may need tooconsider a different approach.</span></span> <span data-ttu-id="7fca0-117">Például hello Batch szolgáltatás API jelenleg nem támogatja az adatfolyam kimeneti tooAzure tárolási hello feladat futása közben.</span><span class="sxs-lookup"><span data-stu-id="7fca0-117">For example, hello Batch service API does not currently support streaming output tooAzure Storage while hello task is running.</span></span> <span data-ttu-id="7fca0-118">kimeneti toostream, érdemes lehet hello kötegelt fájl egyezmények szalagtár használata esetén elérhető, a .NET-hez.</span><span class="sxs-lookup"><span data-stu-id="7fca0-118">toostream output, consider using hello Batch File Conventions library, available for .NET.</span></span> <span data-ttu-id="7fca0-119">A többi nyelvet kell tooimplement saját megoldás.</span><span class="sxs-lookup"><span data-stu-id="7fca0-119">For other languages, you'll need tooimplement your own solution.</span></span> <span data-ttu-id="7fca0-120">Más beállításokat a tárolásakor feladat kimenetének további információkért lásd: [Persist feladat- és kimeneti tooAzure tárolási](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="7fca0-120">For more information on other options for persisting task output, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span> 

## <a name="create-a-container-in-azure-storage"></a><span data-ttu-id="7fca0-121">A tároló létrehozása az Azure Storage</span><span class="sxs-lookup"><span data-stu-id="7fca0-121">Create a container in Azure Storage</span></span>

<span data-ttu-id="7fca0-122">toopersist tevékenység kimeneti tooAzure tárolási, meg kell toocreate olyan tároló, amely a kimeneti fájlok hello célhelyként szolgál.</span><span class="sxs-lookup"><span data-stu-id="7fca0-122">toopersist task output tooAzure Storage, you'll need toocreate a container that serves as hello destination for your output files.</span></span> <span data-ttu-id="7fca0-123">Hello tároló létrehozása, a feladat a feladat mentése előtt minél futtatása előtt.</span><span class="sxs-lookup"><span data-stu-id="7fca0-123">Create hello container before you run your task, preferably before you submit your job.</span></span> <span data-ttu-id="7fca0-124">toocreate hello tároló, használjon hello megfelelő Azure Storage ügyféloldali kódtára vagy SDK-val.</span><span class="sxs-lookup"><span data-stu-id="7fca0-124">toocreate hello container, use hello appropriate Azure Storage client library or SDK.</span></span> <span data-ttu-id="7fca0-125">Azure Storage API-k kapcsolatos további információkért lásd: hello [Azure Storage-dokumentációt](https://docs.microsoft.com/azure/storage/).</span><span class="sxs-lookup"><span data-stu-id="7fca0-125">For more information about Azure Storage APIs, see hello [Azure Storage documentation](https://docs.microsoft.com/azure/storage/).</span></span>

<span data-ttu-id="7fca0-126">Például, ha az alkalmazás írása C# nyelven íródtak, használja a hello [Azure Storage ügyféloldali kódtára a .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span><span class="sxs-lookup"><span data-stu-id="7fca0-126">For example, if you are writing your application in C#, use hello [Azure Storage client library for .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span></span> <span data-ttu-id="7fca0-127">a következő példa azt mutatja meg hogyan hello toocreate egy tárolót:</span><span class="sxs-lookup"><span data-stu-id="7fca0-127">hello following example shows how toocreate a container:</span></span>

```csharp
CloudBlobContainer container = storageAccount.CreateCloudBlobClient().GetContainerReference(containerName);
await conainer.CreateIfNotExists();
```

## <a name="get-a-shared-access-signature-for-hello-container"></a><span data-ttu-id="7fca0-128">A közös hozzáférésű jogosultságkód hello tároló beolvasása</span><span class="sxs-lookup"><span data-stu-id="7fca0-128">Get a shared access signature for hello container</span></span>

<span data-ttu-id="7fca0-129">Hello tároló létrehozása után beolvasása a közös hozzáférésű jogosultságkód (SAS) írási toohello tárolóval.</span><span class="sxs-lookup"><span data-stu-id="7fca0-129">After you create hello container, get a shared access signature (SAS) with write access toohello container.</span></span> <span data-ttu-id="7fca0-130">SAS-kód toohello tároló delegált hozzáférést biztosít.</span><span class="sxs-lookup"><span data-stu-id="7fca0-130">A SAS provides delegated access toohello container.</span></span> <span data-ttu-id="7fca0-131">hello SAS hozzáférést biztosít az egy megadott készlet azon engedélyek és a megadott időtartam alatt.</span><span class="sxs-lookup"><span data-stu-id="7fca0-131">hello SAS grants access with a specified set of permissions and over a specified time interval.</span></span> <span data-ttu-id="7fca0-132">hello Batch szolgáltatás tárolóval írási engedélyek toowrite tevékenység kimeneti toohello SAS kell.</span><span class="sxs-lookup"><span data-stu-id="7fca0-132">hello Batch service needs a SAS with write permissions toowrite task output toohello container.</span></span> <span data-ttu-id="7fca0-133">További információ a SAS: [használata közös hozzáférésű jogosultságkód \(SAS\) az Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="7fca0-133">For more information about SAS, see [Using shared access signatures \(SAS\) in Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>

<span data-ttu-id="7fca0-134">Amikor egy SAS hello Azure Storage API-k használata, hello API SAS token karakterláncot ad vissza.</span><span class="sxs-lookup"><span data-stu-id="7fca0-134">When you get a SAS using hello Azure Storage APIs, hello API returns a SAS token string.</span></span> <span data-ttu-id="7fca0-135">A lexikális elem karakterlánca hello SAS, beleértve a hello engedélyek és hello keresztül mely hello SAS érvényességi időtartama az összes paramétereket tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="7fca0-135">This token string includes all parameters of hello SAS, including hello permissions and hello interval over which hello SAS is valid.</span></span> <span data-ttu-id="7fca0-136">toouse hello SAS tooaccess az Azure Storage tárolója, meg kell tooappend hello SAS-token karakterlánc toohello erőforrás URI azonosítója.</span><span class="sxs-lookup"><span data-stu-id="7fca0-136">toouse hello SAS tooaccess a container in Azure Storage, you need tooappend hello SAS token string toohello resource URI.</span></span> <span data-ttu-id="7fca0-137">hello erőforrás URI, együtt hello hozzáfűzi a SAS-jogkivonat, hitelesített hozzáférést tooAzure tárolási biztosít.</span><span class="sxs-lookup"><span data-stu-id="7fca0-137">hello resource URI, together with hello appended SAS token, provides authenticated access tooAzure Storage.</span></span>

<span data-ttu-id="7fca0-138">hello alábbi példa bemutatja, hogyan a csak írható SAS tooget token-karakterlánc hello tároló, majd hozzáfűzi hello SAS toohello tároló URI:</span><span class="sxs-lookup"><span data-stu-id="7fca0-138">hello following example shows how tooget a write-only SAS token string for hello container, then appends hello SAS toohello container URI:</span></span>

```csharp
string containerSasToken = container.GetSharedAccessSignature(new SharedAccessBlobPolicy()
{
    SharedAccessExpiryTime = DateTimeOffset.UtcNow.AddDays(1),
    Permissions = SharedAccessBlobPermissions.Write
});

string containerSasUrl = container.Uri.AbsoluteUri + containerSasToken; 
```

## <a name="specify-output-files-for-task-output"></a><span data-ttu-id="7fca0-139">Adja meg a feladat kimenete a kimeneti fájlok</span><span class="sxs-lookup"><span data-stu-id="7fca0-139">Specify output files for task output</span></span>

<span data-ttu-id="7fca0-140">egy feladatot, kimeneti fájlok toospecify, hozzon létre egy gyűjteményt a [eredményfájl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objektumokat, és rendelje hozzá toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) tulajdonság hello feladat létrehozásakor.</span><span class="sxs-lookup"><span data-stu-id="7fca0-140">toospecify output files for a task, create a collection of [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objects and assign it toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) property when you create hello task.</span></span> 

<span data-ttu-id="7fca0-141">hello alábbi .NET példakód feladatot hoz létre, amely véletlenszerű számok tooa fájlt ír `output.txt`.</span><span class="sxs-lookup"><span data-stu-id="7fca0-141">hello following .NET code example creates a task that writes random numbers tooa file named `output.txt`.</span></span> <span data-ttu-id="7fca0-142">hello parancs létrehozza a kimeneti fájl `output.txt` toobe toohello tároló írása.</span><span class="sxs-lookup"><span data-stu-id="7fca0-142">hello example creates an output file for `output.txt` toobe written toohello container.</span></span> <span data-ttu-id="7fca0-143">hello példa is hoz létre a kimeneti fájlok bármely naplófájlok hello fájlminta megfelelő `std*.txt` (_pl._, `stdout.txt` és `stderr.txt`).</span><span class="sxs-lookup"><span data-stu-id="7fca0-143">hello example also creates output files for any log files that match hello file pattern `std*.txt` (_e.g._, `stdout.txt` and `stderr.txt`).</span></span> <span data-ttu-id="7fca0-144">hello létrehozott SAS hello tároló URL-címet korábban hello tároló van szükség.</span><span class="sxs-lookup"><span data-stu-id="7fca0-144">hello container URL requires hello SAS that was created previously for hello container.</span></span> <span data-ttu-id="7fca0-145">hello Batch szolgáltatás hello SAS tooauthenticate hozzáférés toohello tárolót használja:</span><span class="sxs-lookup"><span data-stu-id="7fca0-145">hello Batch service uses hello SAS tooauthenticate access toohello container:</span></span> 

```csharp
new CloudTask(taskId, "cmd /v:ON /c \"echo off && set && (FOR /L %i IN (1,1,100000) DO (ECHO !RANDOM!)) > output.txt\"")
{
    OutputFiles = new List<OutputFile>
    {
        new OutputFile(
            filePattern: @"..\std*.txt",
            destination: new OutputFileDestination(
         new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId)),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
        new OutputFile(
            filePattern: @"output.txt",
            destination: 
         new OutputFileDestination(new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId + @"\output.txt")),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
}
```

### <a name="specify-a-file-pattern-for-matching"></a><span data-ttu-id="7fca0-146">Az egyező fájl minta</span><span class="sxs-lookup"><span data-stu-id="7fca0-146">Specify a file pattern for matching</span></span>

<span data-ttu-id="7fca0-147">Kimeneti fájl megadása esetén használható hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) tulajdonság toospecify egy fájl mintát egyeztetéséhez.</span><span class="sxs-lookup"><span data-stu-id="7fca0-147">When you specify an output file, you can use hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) property toospecify a file pattern for matching.</span></span> <span data-ttu-id="7fca0-148">hello fájlminta előfordulhat, hogy felel meg, nulla fájlok, egyetlen fájl vagy a hello feladat által létrehozott fájlokat.</span><span class="sxs-lookup"><span data-stu-id="7fca0-148">hello file pattern may match zero files, a single file, or a set of files that are created by hello task.</span></span>

<span data-ttu-id="7fca0-149">Hello **FilePattern** tulajdonság támogatja a szabványos fájlrendszere helyettesítő karaktereket, mint `*` (a nem rekurzív megegyezik) és `**` (a rekurzív megegyezik).</span><span class="sxs-lookup"><span data-stu-id="7fca0-149">hello **FilePattern** property supports standard filesystem wildcards such as `*` (for non-recursive matches) and `**` (for recursive matches).</span></span> <span data-ttu-id="7fca0-150">Például adja meg a fenti hello kódminta hello fájl mintát toomatch `std*.txt` nem rekurzív módon:</span><span class="sxs-lookup"><span data-stu-id="7fca0-150">For example, hello code sample above specifies hello file pattern toomatch `std*.txt` non-recursively:</span></span> 

`filePattern: @"..\std*.txt"`

<span data-ttu-id="7fca0-151">tooupload egyetlen fájl, a fájl minta nem használható helyettesítő adható meg.</span><span class="sxs-lookup"><span data-stu-id="7fca0-151">tooupload a single file, specify a file pattern with no wildcards.</span></span> <span data-ttu-id="7fca0-152">Például adja meg a fenti hello kódminta hello fájl mintát toomatch `output.txt`:</span><span class="sxs-lookup"><span data-stu-id="7fca0-152">For example, hello code sample above specifies hello file pattern toomatch `output.txt`:</span></span>

`filePattern: @"output.txt"`

### <a name="specify-an-upload-condition"></a><span data-ttu-id="7fca0-153">Adjon meg egy feltöltési állapot</span><span class="sxs-lookup"><span data-stu-id="7fca0-153">Specify an upload condition</span></span>

<span data-ttu-id="7fca0-154">Hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) tulajdonság lehetővé teszi a kimeneti fájlok feltételes feltöltése.</span><span class="sxs-lookup"><span data-stu-id="7fca0-154">hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) property permits conditional uploading of output files.</span></span> <span data-ttu-id="7fca0-155">Egy általános forgatókönyv tooupload egy fájlt, ha hello feladat sikeres, és egy másik készlet fájlok akkor, ha nem sikerül.</span><span class="sxs-lookup"><span data-stu-id="7fca0-155">A common scenario is tooupload one set of files if hello task succeeds, and a different set of files if it fails.</span></span> <span data-ttu-id="7fca0-156">Előfordulhat például tooupload részletes naplófájlok azt szeretné, csak akkor, ha hello feladat sikertelen lesz, és egy nem nulla kilépési kód kilép.</span><span class="sxs-lookup"><span data-stu-id="7fca0-156">For example, you may want tooupload verbose log files only when hello task fails and exits with a nonzero exit code.</span></span> <span data-ttu-id="7fca0-157">Hasonlóképpen érdemes lehet tooupload eredmény fájlok csak hello feladat sikeres, ha azokat a fájlokat esetleg hiányzik vagy nem teljes, ha hello feladat sikertelen.</span><span class="sxs-lookup"><span data-stu-id="7fca0-157">Similarly, you may want tooupload result files only if hello task succeeds, as those files may be missing or incomplete if hello task fails.</span></span>

<span data-ttu-id="7fca0-158">hello fenti beállítja hello **UploadCondition** tulajdonság túl**TaskCompletion**.</span><span class="sxs-lookup"><span data-stu-id="7fca0-158">hello code sample above sets hello **UploadCondition** property too**TaskCompletion**.</span></span> <span data-ttu-id="7fca0-159">A beállítással megadható, hogy hello fájl feltöltése után hello feladatok, függetlenül hello kilépési kód hello értékének toobe.</span><span class="sxs-lookup"><span data-stu-id="7fca0-159">This setting specifies that hello file is toobe uploaded after hello tasks completes, regardless of hello value of hello exit code.</span></span> 

`uploadCondition: OutputFileUploadCondition.TaskCompletion`

<span data-ttu-id="7fca0-160">Egyéb beállításokat, lásd: hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) felsorolás.</span><span class="sxs-lookup"><span data-stu-id="7fca0-160">For other settings, see hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span></span>

### <a name="disambiguate-files-with-hello-same-name"></a><span data-ttu-id="7fca0-161">Elem egyértelműségének biztosításához hello fájlok ugyanazzal a névvel</span><span class="sxs-lookup"><span data-stu-id="7fca0-161">Disambiguate files with hello same name</span></span>

<span data-ttu-id="7fca0-162">hello feladatok feladatokban hello rendelkező fájlokat is eredményezhet, ugyanazzal a névvel.</span><span class="sxs-lookup"><span data-stu-id="7fca0-162">hello tasks in a job may produce files that have hello same name.</span></span> <span data-ttu-id="7fca0-163">Például `stdout.txt` és `stderr.txt` feladatokban futó minden feladatot hoz létre.</span><span class="sxs-lookup"><span data-stu-id="7fca0-163">For example, `stdout.txt` and `stderr.txt` are created for every task that runs in a job.</span></span> <span data-ttu-id="7fca0-164">Mivel minden tevékenység saját környezetében fut, ezek a fájlok hello csomópont fájlrendszeren nem ütköznek.</span><span class="sxs-lookup"><span data-stu-id="7fca0-164">Because each task runs in its own context, these files don't conflict on hello node's file system.</span></span> <span data-ttu-id="7fca0-165">Azonban a megosztott tároló több feladatok tooa fájlok feltöltésekor lesz szüksége hello toodisambiguate fájlok ugyanazzal a névvel.</span><span class="sxs-lookup"><span data-stu-id="7fca0-165">However, when you upload files from multiple tasks tooa shared container, you'll need toodisambiguate files with hello same name.</span></span>

<span data-ttu-id="7fca0-166">Hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) tulajdonság határozza meg a cél blob hello vagy virtuális könyvtárat a kimeneti fájlokat.</span><span class="sxs-lookup"><span data-stu-id="7fca0-166">hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) property specifies hello destination blob or virtual directory for output files.</span></span> <span data-ttu-id="7fca0-167">Használhatja a hello **elérési** tulajdonság tooname hello blob vagy virtuális könyvtárat úgy, hogy a kimeneti hello az Azure Storage egyedileg megnevezett ugyanazzal a névvel rendelkező fájlok.</span><span class="sxs-lookup"><span data-stu-id="7fca0-167">You can use hello **Path** property tooname hello blob or virtual directory in such a way that output files with hello same name are uniquely named in Azure Storage.</span></span> <span data-ttu-id="7fca0-168">Hello feladat azonosítójával hello elérési út egy jó módszer tooensure egyedi nevek és könnyebb a fájlok azonosításához.</span><span class="sxs-lookup"><span data-stu-id="7fca0-168">Using hello task ID in hello path is a good way tooensure unique names and easily identify files.</span></span>

<span data-ttu-id="7fca0-169">Ha hello **FilePattern** tulajdonsága tooa helyettesítő karakteres kifejezést, majd az összes, amely megfelel a mintának hello fájljai feltöltött toohello hello által megadott virtuális könyvtár **elérési** tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="7fca0-169">If hello **FilePattern** property is set tooa wildcard expression, then all files that match hello pattern are uploaded toohello virtual directory specified by hello **Path** property.</span></span> <span data-ttu-id="7fca0-170">Például ha hello tároló van `mycontainer`, hello tevékenység azonosítója `mytask`, és hello fájl minta `..\std*.txt`, majd hello abszolút URI-azonosítók toohello kimeneti fájlok az Azure Storage hasonló lesz:</span><span class="sxs-lookup"><span data-stu-id="7fca0-170">For example, if hello container is `mycontainer`, hello task ID is `mytask`, and hello file pattern is `..\std*.txt`, then hello absolute URIs toohello output files in Azure Storage will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/mytask/stderr.txt
https://myaccount.blob.core.windows.net/mycontainer/mytask/stdout.txt
```

<span data-ttu-id="7fca0-171">Ha hello **FilePattern** tulajdonság set toomatch egyetlen fájlnév, ami azt jelenti, nem tartalmaz helyettesítő karaktereket, majd hello hello értékének **elérési** tulajdonság határozza meg a hello teljesen minősített blob neve .</span><span class="sxs-lookup"><span data-stu-id="7fca0-171">If hello **FilePattern** property is set toomatch a single file name, meaning it does not contain any wildcard characters, then hello value of hello **Path** property specifies hello fully qualified blob name.</span></span> <span data-ttu-id="7fca0-172">Ha várhatóan több feladat egyetlen fájl ütközik elnevezési, szerepeltesse hello virtuális könyvtár nevét hello hello fájl neve toodisambiguate részeként azokat a fájlokat.</span><span class="sxs-lookup"><span data-stu-id="7fca0-172">If you anticipate naming conflicts with a single file from multiple tasks, then include hello name of hello virtual directory as part of hello file name toodisambiguate those files.</span></span> <span data-ttu-id="7fca0-173">Például set hello **elérési** tulajdonság tooinclude hello tevékenység azonosítója, hello elválasztó karaktert (általában egy perjel) és hello fájlnév:</span><span class="sxs-lookup"><span data-stu-id="7fca0-173">For example, set hello **Path** property tooinclude hello task ID, hello delimiter character (typically a forward slash), and hello file name:</span></span>

`path: taskId + @"/output.txt"`

<span data-ttu-id="7fca0-174">hello abszolút URI-azonosítók toohello kimeneti fájlok feladatok számú hasonló lesz:</span><span class="sxs-lookup"><span data-stu-id="7fca0-174">hello absolute URIs toohello output files for a set of tasks will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/task1/output.txt
https://myaccount.blob.core.windows.net/mycontainer/task2/output.txt
```

<span data-ttu-id="7fca0-175">További információ a virtuális könyvtárak az Azure Storage: [hello a tárolóban lévő blobok listázása](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span><span class="sxs-lookup"><span data-stu-id="7fca0-175">For more information about virtual directories in Azure Storage, see [List hello blobs in a container](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span></span>


## <a name="diagnose-file-upload-errors"></a><span data-ttu-id="7fca0-176">Fájl feltöltése hibák</span><span class="sxs-lookup"><span data-stu-id="7fca0-176">Diagnose file upload errors</span></span>

<span data-ttu-id="7fca0-177">Ha feltöltése a kimeneti fájlok tooAzure tárolási sikertelen, akkor hello feladat áthelyezi toohello **befejezve** állapotát és hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) tulajdonság értéke.</span><span class="sxs-lookup"><span data-stu-id="7fca0-177">If uploading output files tooAzure Storage fails, then hello task moves toohello **Completed** state and hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) property is set.</span></span> <span data-ttu-id="7fca0-178">Vizsgálja meg a hello **FailureInformation** tulajdonság toodetermine milyen hiba történt.</span><span class="sxs-lookup"><span data-stu-id="7fca0-178">Examine hello **FailureInformation** property toodetermine what error occurred.</span></span> <span data-ttu-id="7fca0-179">Íme például, ha hello tároló nem található a fájl feltöltése előforduló hiba:</span><span class="sxs-lookup"><span data-stu-id="7fca0-179">For example, here is an error that occurs on file upload if hello container cannot be found:</span></span> 

```
Category: UserError
Code: FileUploadContainerNotFound
Message: One of hello specified Azure container(s) was not found while attempting tooupload an output file
```

<span data-ttu-id="7fca0-180">Minden fájl feltöltése a Batch ír két naplófájl fájlok toohello számítási csomópont `fileuploadout.txt` és `fileuploaderr.txt`.</span><span class="sxs-lookup"><span data-stu-id="7fca0-180">On every file upload, Batch writes two log files toohello compute node, `fileuploadout.txt` and `fileuploaderr.txt`.</span></span> <span data-ttu-id="7fca0-181">A napló fájlok toolearn egy adott hibával kapcsolatos további ellenőrizheti.</span><span class="sxs-lookup"><span data-stu-id="7fca0-181">You can examine these log files toolearn more about a specific failure.</span></span> <span data-ttu-id="7fca0-182">Azokban az esetekben, ahol hello fájl feltöltése soha nem kíséreltek meg, például mert maga hello feladat futtatása nem sikerült majd a naplófájlok nem létezik.</span><span class="sxs-lookup"><span data-stu-id="7fca0-182">In cases where hello file upload was never attempted, for example because hello task itself couldn’t run, then these log files will not exist.</span></span>

## <a name="diagnose-file-upload-performance"></a><span data-ttu-id="7fca0-183">Diagnosztizálhatja fájl feltöltése</span><span class="sxs-lookup"><span data-stu-id="7fca0-183">Diagnose file upload performance</span></span>

<span data-ttu-id="7fca0-184">Hello `fileuploadout.txt` fájl feltöltési folyamatáról naplózza.</span><span class="sxs-lookup"><span data-stu-id="7fca0-184">hello `fileuploadout.txt` file logs upload progress.</span></span> <span data-ttu-id="7fca0-185">Láthatja, hogy a fájl toolearn további információk a fájlfeltöltések mennyi ideig tart.</span><span class="sxs-lookup"><span data-stu-id="7fca0-185">You can examine this file toolearn more about how long your file uploads are taking.</span></span> <span data-ttu-id="7fca0-186">Ne feledje, hogy nincsenek sok tényezőkről tooupload teljesítmény, beleértve hello csomópont, más tevékenység hello csomóponton hello feltöltés, a hello időpontjában hello méretét, hogy hello céltároló van hello hello Batch-készlet és ugyanabban a régióban, hogy hány csomópontra van Feltöltés toohello tárfiók: hello azonos időben, és így tovább.</span><span class="sxs-lookup"><span data-stu-id="7fca0-186">Keep in mind that there are many contributing factors tooupload performance, including hello size of hello node, other activity on hello node at hello time of hello upload, whether hello target container is in hello same region as hello Batch pool, how many nodes are uploading toohello storage account at hello same time, and so on.</span></span>

## <a name="use-hello-batch-service-api-with-hello-batch-file-conventions-standard"></a><span data-ttu-id="7fca0-187">Hello kötegelt fájl egyezmények szabványos hello Batch szolgáltatás API használata</span><span class="sxs-lookup"><span data-stu-id="7fca0-187">Use hello Batch service API with hello Batch File Conventions standard</span></span>

<span data-ttu-id="7fca0-188">Megőrizni a feladat kimenete a Batch szolgáltatás API hello, amikor a célként megadott tároló nevére, és blobok azonban van lehetősége.</span><span class="sxs-lookup"><span data-stu-id="7fca0-188">When you persist task output with hello Batch service API, you can name your destination container and blobs however you like.</span></span> <span data-ttu-id="7fca0-189">Másik lehetőségként tooname őket toohello szerint [kötegelt fájl egyezmények standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="7fca0-189">You can also choose tooname them according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> <span data-ttu-id="7fca0-190">hello fájl egyezmények standard hello céltárolója és a megadott kimeneti fájl alapján hello nevei hello feladat- és az Azure Storage blob hello nevét határozza meg.</span><span class="sxs-lookup"><span data-stu-id="7fca0-190">hello File Conventions standard determines hello names of hello destination container and blob in Azure Storage for a given output file based on hello names of hello job and task.</span></span> <span data-ttu-id="7fca0-191">Ha hello fájl egyezmények szabványos kimeneti fájlok elnevezési, akkor a kimeneti fájlok megtekintését a hello [Azure-portálon](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="7fca0-191">If you do use hello File Conventions standard for naming output files, then your output files are available for viewing in hello [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="7fca0-192">Fejlesztői C# nyelven íródtak, módszerekkel hello hello épített [kötegelt fájl egyezmények .NET-keretrendszerhez készült](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span><span class="sxs-lookup"><span data-stu-id="7fca0-192">If you are developing in C#, you can use hello methods built into hello [Batch File Conventions library for .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span></span> <span data-ttu-id="7fca0-193">Ezt a szalagtárat a tárolók és a blob-elérési útnak megfelelően nevű meg hello hoz létre.</span><span class="sxs-lookup"><span data-stu-id="7fca0-193">This library creates hello properly named containers and blob paths for you.</span></span> <span data-ttu-id="7fca0-194">Például hívása hello API tooget hello megfelelő hello tároló nevét, a hello feladatnév alapján:</span><span class="sxs-lookup"><span data-stu-id="7fca0-194">For example, you can call hello API tooget hello correct name for hello container, based on hello job name:</span></span>

```csharp
string containerName = job.OutputStorageContainerName();
```

<span data-ttu-id="7fca0-195">Használhatja a hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) metódus tooreturn közös hozzáférésű jogosultságkód (SAS) URL-Címeket használt toowrite toohello tároló.</span><span class="sxs-lookup"><span data-stu-id="7fca0-195">You can use hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) method tooreturn a shared access signature (SAS) URL that is used toowrite toohello container.</span></span> <span data-ttu-id="7fca0-196">Ezután adja át a biztonsági Társítások toohello [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) konstruktor.</span><span class="sxs-lookup"><span data-stu-id="7fca0-196">You can then pass this SAS toohello [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span></span>

<span data-ttu-id="7fca0-197">Ha C# nyelven fejleszt, szüksége lesz tooimplement hello fájl egyezmények standard saját maga.</span><span class="sxs-lookup"><span data-stu-id="7fca0-197">If you are developing in a language other than C#, you will need tooimplement hello File Conventions standard yourself.</span></span>

## <a name="code-sample"></a><span data-ttu-id="7fca0-198">Kódminta</span><span class="sxs-lookup"><span data-stu-id="7fca0-198">Code sample</span></span>

<span data-ttu-id="7fca0-199">Hello [PersistOutputs] [ github_persistoutputs] mintaprojektet egyike hello [Azure Batch-Kódminták] [ github_samples] a Githubon.</span><span class="sxs-lookup"><span data-stu-id="7fca0-199">hello [PersistOutputs][github_persistoutputs] sample project is one of hello [Azure Batch code samples][github_samples] on GitHub.</span></span> <span data-ttu-id="7fca0-200">A Visual Studio megoldás bemutatja, hogyan toouse hello kötegelt ügyféloldali kódtára a .NET toopersist tevékenység kimeneti toodurable tároló.</span><span class="sxs-lookup"><span data-stu-id="7fca0-200">This Visual Studio solution demonstrates how toouse hello Batch client library for .NET toopersist task output toodurable storage.</span></span> <span data-ttu-id="7fca0-201">toorun hello mintát, kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="7fca0-201">toorun hello sample, follow these steps:</span></span>

1. <span data-ttu-id="7fca0-202">Nyissa meg hello projektre a **Visual Studio 2015-ös vagy újabb**.</span><span class="sxs-lookup"><span data-stu-id="7fca0-202">Open hello project in **Visual Studio 2015 or newer**.</span></span>
2. <span data-ttu-id="7fca0-203">A kötegelt és a tárolási **fiók hitelesítő adatait** túl**AccountSettings.settings** hello Microsoft.Azure.Batch.Samples.Common projektben.</span><span class="sxs-lookup"><span data-stu-id="7fca0-203">Add your Batch and Storage **account credentials** too**AccountSettings.settings** in hello Microsoft.Azure.Batch.Samples.Common project.</span></span>
3. <span data-ttu-id="7fca0-204">**Build** (de ne futtassa) hello megoldás.</span><span class="sxs-lookup"><span data-stu-id="7fca0-204">**Build** (but do not run) hello solution.</span></span> <span data-ttu-id="7fca0-205">Ha a rendszer kéri, állítsa vissza a NuGet-csomagok.</span><span class="sxs-lookup"><span data-stu-id="7fca0-205">Restore any NuGet packages if prompted.</span></span>
4. <span data-ttu-id="7fca0-206">Használjon hello Azure portál tooupload egy [alkalmazáscsomag](batch-application-packages.md) a **PersistOutputsTask**.</span><span class="sxs-lookup"><span data-stu-id="7fca0-206">Use hello Azure portal tooupload an [application package](batch-application-packages.md) for **PersistOutputsTask**.</span></span> <span data-ttu-id="7fca0-207">Hello tartalmaznak `PersistOutputsTask.exe` és a függő szerelvényeket hello .zip-csomagja, hello alkalmazás azonosítója túl "PersistOutputsTask" és az alkalmazás hello Csomagverzió túl "1.0".</span><span class="sxs-lookup"><span data-stu-id="7fca0-207">Include hello `PersistOutputsTask.exe` and its dependent assemblies in hello .zip package, set hello application ID too"PersistOutputsTask", and hello application package version too"1.0".</span></span>
5. <span data-ttu-id="7fca0-208">**Start** (Futtatás) hello **PersistOutputs** projekt.</span><span class="sxs-lookup"><span data-stu-id="7fca0-208">**Start** (run) hello **PersistOutputs** project.</span></span>
6. <span data-ttu-id="7fca0-209">Amikor a kért toochoose hello adatmegőrzési technológia toouse futó hello minta be **2** toorun hello mintákkal hello Batch szolgáltatás API toopersist feladat kimenete.</span><span class="sxs-lookup"><span data-stu-id="7fca0-209">When prompted toochoose hello persistence technology toouse for running hello sample, enter **2** toorun hello sample using hello Batch service API toopersist task output.</span></span>
7. <span data-ttu-id="7fca0-210">Ha szükséges, újrafuttatása hello minta, írja be **3** toopersist kimeneti hello Batch szolgáltatás API, és is tooname hello tároló és a blob elérési utat célként toohello szabványos fájl konvenciók szerint.</span><span class="sxs-lookup"><span data-stu-id="7fca0-210">If desired, run hello sample again, entering **3** toopersist output with hello Batch service API, and also tooname hello destination container and blob path according toohello File Conventions standard.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7fca0-211">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="7fca0-211">Next steps</span></span>

- <span data-ttu-id="7fca0-212">A .NET-hez lévő objektumán feladat kimenetének hello fájl egyezmények könyvtárhoz további információkért lásd: [megőrizni a feladat- és adatok tooAzure tárolási hello kötegelt fájl egyezmények könyvtárhoz tartozó .NET toopersist ](batch-task-output-file-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="7fca0-212">For more information on persisting task output with hello File Conventions library for .NET, see [Persist job and task data tooAzure Storage with hello Batch File Conventions library for .NET toopersist ](batch-task-output-file-conventions.md).</span></span>
- <span data-ttu-id="7fca0-213">Más megoldások a kimeneti adatait az Azure Batch információkért lásd: [Persist feladat- és kimeneti tooAzure tárolási](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="7fca0-213">For information on other approaches for persisting output data in Azure Batch, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span>

[github_persistoutputs]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/PersistOutputs
[github_samples]: https://github.com/Azure/azure-batch-samples
