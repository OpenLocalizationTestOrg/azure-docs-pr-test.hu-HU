---
title: "aaaLoad terheléselosztó egyéni mintavételt és figyelési állapot |} Microsoft Docs"
description: "Ismerje meg, hogyan toouse egyéni vizsgálat Azure Load Balancer toomonitor példányok terheléselosztó mögött"
services: load-balancer
documentationcenter: na
author: kumudd
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 46b152c5-6a27-4bfc-bea3-05de9ce06a57
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/24/2016
ms.author: kumud
ms.openlocfilehash: 3dfcfcd2d5cffa58b160cb38d63acffbd997d452
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="understand-load-balancer-probes"></a><span data-ttu-id="884bc-103">A Load Balancer vizsgálatok ismertetése</span><span class="sxs-lookup"><span data-stu-id="884bc-103">Understand load balancer probes</span></span>

<span data-ttu-id="884bc-104">Az Azure Load Balancer hello funkció toomonitor hello állapotát kiszolgálópéldányok mintavételt használatával biztosít.</span><span class="sxs-lookup"><span data-stu-id="884bc-104">Azure Load Balancer offers hello capability toomonitor hello health of server instances by using probes.</span></span> <span data-ttu-id="884bc-105">Egy mintavételt toorespond meghibásodása esetén terheléselosztó leállítja az új kapcsolatok toohello nem megfelelő állapotú példány küldésekor.</span><span class="sxs-lookup"><span data-stu-id="884bc-105">When a probe fails toorespond, Load Balancer stops sending new connections toohello unhealthy instance.</span></span> <span data-ttu-id="884bc-106">hello meglévő kapcsolatok nem érinti, és új kapcsolatok küldött toohealthy példányok.</span><span class="sxs-lookup"><span data-stu-id="884bc-106">hello existing connections are not affected, and new connections are sent toohealthy instances.</span></span>

<span data-ttu-id="884bc-107">Felhőszolgáltatás szerepköreit (feldolgozói szerepköröket és webes szerepkörök) használja a vendégügynök mintavételi figyelésre.</span><span class="sxs-lookup"><span data-stu-id="884bc-107">Cloud service roles (worker roles and web roles) use a guest agent for probe monitoring.</span></span> <span data-ttu-id="884bc-108">TCP- vagy HTTP egyéni mintavételt terheléselosztó mögött a virtuális gépek használatakor be kell állítani.</span><span class="sxs-lookup"><span data-stu-id="884bc-108">TCP or HTTP custom probes must be configured when you use virtual machines behind Load Balancer.</span></span>

## <a name="understand-probe-count-and-timeout"></a><span data-ttu-id="884bc-109">Mintavételi száma és időtúllépés</span><span class="sxs-lookup"><span data-stu-id="884bc-109">Understand probe count and timeout</span></span>

<span data-ttu-id="884bc-110">Mintavételi viselkedés attól függ:</span><span class="sxs-lookup"><span data-stu-id="884bc-110">Probe behavior depends on:</span></span>

* <span data-ttu-id="884bc-111">sikeres mintavételek menüpontban, amelyek lehetővé teszik egy példány toobe üzemidőnek feliratú hello száma.</span><span class="sxs-lookup"><span data-stu-id="884bc-111">hello number of successful probes that allow an instance toobe labeled as up.</span></span>
* <span data-ttu-id="884bc-112">sikertelen mintavételek menüpontban, amelyek egy címkével, lefelé példány toobe hello száma.</span><span class="sxs-lookup"><span data-stu-id="884bc-112">hello number of failed probes that cause an instance toobe labeled as down.</span></span>

<span data-ttu-id="884bc-113">hello időkorlát és a gyakoriság értéke SuccessFailCount a megállapításához, hogy egy példány megerősített toobe fut, vagy nem működik.</span><span class="sxs-lookup"><span data-stu-id="884bc-113">hello timeout and frequency value set in  SuccessFailCount determine whether an instance is confirmed toobe running or not running.</span></span> <span data-ttu-id="884bc-114">A hello Azure-portálon a hello időtúllépés tootwo hello értékének hello gyakoriság van beállítva.</span><span class="sxs-lookup"><span data-stu-id="884bc-114">In hello Azure portal, hello timeout is set tootwo times hello value of hello frequency.</span></span>

<span data-ttu-id="884bc-115">elosztott terhelésű szoftverpéldányok hello mintavételi konfigurációs az a végpont (Ez azt jelenti, hogy egy elosztott terhelésű készlet) nem lehet hello azonos.</span><span class="sxs-lookup"><span data-stu-id="884bc-115">hello probe configuration of all load-balanced instances for an endpoint (that is, a load-balanced set) must be hello same.</span></span> <span data-ttu-id="884bc-116">Ez azt jelenti, hogy nem kell egy másik mintavétel konfigurálása az egyes szerepkör példánya vagy a virtuális gép hello azonos üzemeltetett szolgáltatás egy adott végpont kombinációjához.</span><span class="sxs-lookup"><span data-stu-id="884bc-116">This means you cannot have a different probe configuration for each role instance or virtual machine in hello same hosted service for a particular endpoint combination.</span></span> <span data-ttu-id="884bc-117">Például minden példány kell rendelkeznie, azonos helyi portok és időtúllépéseket okoz.</span><span class="sxs-lookup"><span data-stu-id="884bc-117">For example, each instance must have identical local ports and timeouts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="884bc-118">A Load Balancer mintavételi hello IP-címet 168.63.129.16 használja.</span><span class="sxs-lookup"><span data-stu-id="884bc-118">A Load Balancer probe uses hello IP address 168.63.129.16.</span></span> <span data-ttu-id="884bc-119">A nyilvános IP-cím elősegíti a kommunikációs toointernal platform erőforrások hello bring your-saját-IP-Azure virtuális hálózatot.</span><span class="sxs-lookup"><span data-stu-id="884bc-119">This public IP address facilitates communication toointernal platform resources for hello bring-your-own-IP Azure Virtual Network scenario.</span></span> <span data-ttu-id="884bc-120">hello virtuális nyilvános IP-cím 168.63.129.16 minden régióban szolgál, és nem változik.</span><span class="sxs-lookup"><span data-stu-id="884bc-120">hello virtual public IP address 168.63.129.16 is used in all regions and will not change.</span></span> <span data-ttu-id="884bc-121">Azt javasoljuk, hogy lehetővé tegye az IP-címet a helyi tűzfal házirendekben.</span><span class="sxs-lookup"><span data-stu-id="884bc-121">We recommend that you allow this IP address in any local firewall policies.</span></span> <span data-ttu-id="884bc-122">Ez nem tekinthető biztonsági kockázatot jelent, mert csak hello belső Azure platformon is forrás-, hogy a cím az üzenet.</span><span class="sxs-lookup"><span data-stu-id="884bc-122">It should not be considered a security risk because only hello internal Azure platform can source a message from that address.</span></span> <span data-ttu-id="884bc-123">Ha ezt nem teszi meg, nem lesznek a különböző helyzetekben, például konfigurálása váratlan viselkedést hello azonos IP-címtartomány 168.63.129.16, és hogy ismétlődő IP-címeket.</span><span class="sxs-lookup"><span data-stu-id="884bc-123">If you do not do this, there will be unexpected behavior in a variety of scenarios like configuring hello same IP address range of 168.63.129.16 and having duplicated IP addresses.</span></span>

## <a name="learn-about-hello-types-of-probes"></a><span data-ttu-id="884bc-124">További tudnivalók mintavételt hello típusai</span><span class="sxs-lookup"><span data-stu-id="884bc-124">Learn about hello types of probes</span></span>

### <a name="guest-agent-probe"></a><span data-ttu-id="884bc-125">Vendég ügynök mintavétele</span><span class="sxs-lookup"><span data-stu-id="884bc-125">Guest agent probe</span></span>

<span data-ttu-id="884bc-126">Ez a Hálózatfigyelő csak akkor használható Azure Cloud Services.</span><span class="sxs-lookup"><span data-stu-id="884bc-126">This probe is available for Azure Cloud Services only.</span></span> <span data-ttu-id="884bc-127">Terheléselosztó használja hello vendégügynök hello virtuális gépen belül, és ezután figyeli, és válaszol egy HTTP 200 OK válasz csak akkor, ha hello példány hello kész állapotban van (Ez azt jelenti, hogy nem szerepel egy másik állapot például elfoglalt, újrahasznosítása vagy leállítása).</span><span class="sxs-lookup"><span data-stu-id="884bc-127">Load Balancer utilizes hello guest agent inside hello virtual machine, and then listens and responds with an HTTP 200 OK response only when hello instance is in hello Ready state (that is, not in another state such as Busy, Recycling, or Stopping).</span></span>

<span data-ttu-id="884bc-128">További információkért lásd: [konfigurálása hello szolgáltatás definíciós fájljának (csdef) állapotteljesítmény](https://msdn.microsoft.com/library/azure/ee758710.aspx) vagy [létrehozásához, egy internetre irányuló terheléselosztót a felhőszolgáltatások](load-balancer-get-started-internet-classic-cloud.md#check-load-balancer-health-status-for-cloud-services).</span><span class="sxs-lookup"><span data-stu-id="884bc-128">For more information, see [Configuring hello service definition file (csdef) for health probes](https://msdn.microsoft.com/library/azure/ee758710.aspx) or [Get started creating an Internet-facing load balancer for cloud services](load-balancer-get-started-internet-classic-cloud.md#check-load-balancer-health-status-for-cloud-services).</span></span>

### <a name="what-makes-a-guest-agent-probe-mark-an-instance-as-unhealthy"></a><span data-ttu-id="884bc-129">A Vendég ügynök mintavétele jelölje példánya sérültként hasznossá?</span><span class="sxs-lookup"><span data-stu-id="884bc-129">What makes a guest agent probe mark an instance as unhealthy?</span></span>

<span data-ttu-id="884bc-130">A HTTP 200 OK toorespond hello vendégügynök meghibásodásakor hello load balancer jelek hello példányához nem válaszol, és a forgalom toothat példány küldése leáll.</span><span class="sxs-lookup"><span data-stu-id="884bc-130">If hello guest agent fails toorespond with HTTP 200 OK, hello load balancer marks hello instance as unresponsive and stops sending traffic toothat instance.</span></span> <span data-ttu-id="884bc-131">hello terheléselosztó tooping hello példány továbbra is.</span><span class="sxs-lookup"><span data-stu-id="884bc-131">hello load balancer continues tooping hello instance.</span></span> <span data-ttu-id="884bc-132">Ha hello vendégügynök válaszol egy HTTP 200, hello terheléselosztó újra elküldi forgalom toothat példány.</span><span class="sxs-lookup"><span data-stu-id="884bc-132">If hello guest agent responds with an HTTP 200, hello load balancer sends traffic toothat instance again.</span></span>

<span data-ttu-id="884bc-133">A webes szerepkör használata esetén hello webhely kód általában a w3wp.exe, nem figyelt hello Azure-hálót vagy vendégügynök fut.</span><span class="sxs-lookup"><span data-stu-id="884bc-133">When you use a web role, hello website code typically runs in w3wp.exe, which is not monitored by hello Azure fabric or guest agent.</span></span> <span data-ttu-id="884bc-134">Ez azt jelenti, hogy hibák w3wp.exe (például 500-as HTTP-válaszok) nem lesz jelentett toohello vendégügynök, hello terheléselosztó nem lépnek kívül Elforgatás példányhoz.</span><span class="sxs-lookup"><span data-stu-id="884bc-134">This means that failures in w3wp.exe (for example, HTTP 500 responses) will not be reported toohello guest agent, and hello load balancer will not take that instance out of rotation.</span></span>

### <a name="http-custom-probe"></a><span data-ttu-id="884bc-135">Egyéni HTTP-vizsgálatot</span><span class="sxs-lookup"><span data-stu-id="884bc-135">HTTP custom probe</span></span>

<span data-ttu-id="884bc-136">hello egyéni HTTP terheléselosztó mintavételi felülbírálások hello alapértelmezett Vendég ügynök mintavétele, ami azt jelenti, hogy a saját egyéni logika toodetermine hello állapotát hello szerepkörpéldányt hozhat létre.</span><span class="sxs-lookup"><span data-stu-id="884bc-136">hello custom HTTP Load Balancer probe overrides hello default guest agent probe, which means that you can create your own custom logic toodetermine hello health of hello role instance.</span></span> <span data-ttu-id="884bc-137">hello terheléselosztó-vizsgálat a végpont 15 másodpercenként alapértelmezés szerint.</span><span class="sxs-lookup"><span data-stu-id="884bc-137">hello load balancer probes your endpoint every 15 seconds, by default.</span></span> <span data-ttu-id="884bc-138">hello példány toobe a hello load balancer elforgatási tekinteni, ha hello határidőn (alapértelmezés szerint 31 másodperc) belül válaszol egy HTTP 200 a.</span><span class="sxs-lookup"><span data-stu-id="884bc-138">hello instance is considered toobe in hello load balancer rotation if it responds with an HTTP 200 within hello timeout period (31 seconds by default).</span></span>

<span data-ttu-id="884bc-139">Ez akkor lehet hasznos, ha azt szeretné, tooimplement load balancer Elforgatás saját logikát tooremove példányok.</span><span class="sxs-lookup"><span data-stu-id="884bc-139">This can be useful if you want tooimplement your own logic tooremove instances from load balancer rotation.</span></span> <span data-ttu-id="884bc-140">Például sikertelen eldöntheti, tooremove példány Ha 90 %-os Processzor túllépi ezt az értéket, és nem 200 állapotot ad vissza.</span><span class="sxs-lookup"><span data-stu-id="884bc-140">For example, you could decide tooremove an instance if it is above 90% CPU and returns a non-200 status.</span></span> <span data-ttu-id="884bc-141">Ha webes szerepkörök w3wp.exe, ez azt is jelenti automatikus kap a webhely megfigyeléséhez, mivel a webhely kódban hibák nem 200 állapot toohello terheléselosztói mintavétel ad vissza.</span><span class="sxs-lookup"><span data-stu-id="884bc-141">If you have web roles that use w3wp.exe, this also means you get automatic monitoring of your website, because failures in your website code will return a non-200 status toohello load balancer probe.</span></span>

> [!NOTE]
> <span data-ttu-id="884bc-142">hello HTTP egyéni mintavételi relatív elérési utakat, és csak a HTTP protokollt támogatja.</span><span class="sxs-lookup"><span data-stu-id="884bc-142">hello HTTP custom probe supports relative paths and HTTP protocol only.</span></span> <span data-ttu-id="884bc-143">HTTPS nem támogatott.</span><span class="sxs-lookup"><span data-stu-id="884bc-143">HTTPS is not supported.</span></span>

### <a name="what-makes-an-http-custom-probe-mark-an-instance-as-unhealthy"></a><span data-ttu-id="884bc-144">Az egyéni HTTP-vizsgálatot, jelölje meg, hogy megsérült példány hasznossá?</span><span class="sxs-lookup"><span data-stu-id="884bc-144">What makes an HTTP custom probe mark an instance as unhealthy?</span></span>

* <span data-ttu-id="884bc-145">hello HTTP alkalmazás eltérő (például a 403-as, 404 vagy 500) 200-as HTTP-válaszkód adja vissza.</span><span class="sxs-lookup"><span data-stu-id="884bc-145">hello HTTP application returns an HTTP response code other than 200 (for example, 403, 404, or 500).</span></span> <span data-ttu-id="884bc-146">Ez az a pozitív visszaigazolás, amely az alkalmazás hello példány azonnal kell tenni nem működik.</span><span class="sxs-lookup"><span data-stu-id="884bc-146">This is a positive acknowledgment that hello application instance should be taken out of service right away.</span></span>
* <span data-ttu-id="884bc-147">hello HTTP-kiszolgáló nem válaszol minden hello időkorlát után.</span><span class="sxs-lookup"><span data-stu-id="884bc-147">hello HTTP server does not respond at all after hello timeout period.</span></span> <span data-ttu-id="884bc-148">Attól függően, hogy hello időtúllépési érték, amely be van állítva, ez azt jelentheti, hogy több mintavételi kérések nyissa meg nem érkezik válasz, mielőtt hello mintavételi lekérdezi jelölésű nem fut (Ez azt jelenti, hogy mielőtt SuccessFailCount mintavételt megkapja).</span><span class="sxs-lookup"><span data-stu-id="884bc-148">Depending on hello timeout value that is set, this might mean that multiple probe requests go unanswered before hello probe gets marked as not running (that is, before SuccessFailCount probes are sent).</span></span>
* <span data-ttu-id="884bc-149">hello server hello kapcsolaton keresztül a TCP alaphelyzetbe állítása bezárása után.</span><span class="sxs-lookup"><span data-stu-id="884bc-149">hello server closes hello connection via a TCP reset.</span></span>

### <a name="tcp-custom-probe"></a><span data-ttu-id="884bc-150">Egyéni TCP-Hálózatfigyelővel</span><span class="sxs-lookup"><span data-stu-id="884bc-150">TCP custom probe</span></span>

<span data-ttu-id="884bc-151">TCP mintavételt kezdeményeznek kapcsolatot a háromutas kézfogás definiált hello port elvégzésével.</span><span class="sxs-lookup"><span data-stu-id="884bc-151">TCP probes initiate a connection by performing a three-way handshake with hello defined port.</span></span>

### <a name="what-makes-a-tcp-custom-probe-mark-an-instance-as-unhealthy"></a><span data-ttu-id="884bc-152">Egy egyéni TCP-Hálózatfigyelővel, jelölje meg, hogy megsérült példány hasznossá?</span><span class="sxs-lookup"><span data-stu-id="884bc-152">What makes a TCP custom probe mark an instance as unhealthy?</span></span>

* <span data-ttu-id="884bc-153">hello TCP-kiszolgáló nem válaszol minden hello időkorlát után.</span><span class="sxs-lookup"><span data-stu-id="884bc-153">hello TCP server does not respond at all after hello timeout period.</span></span> <span data-ttu-id="884bc-154">Ha hello mintavételi van megjelölve, nem fut sikertelen mintavételi hello száma attól függ, amely nem érkezik válasz nem fut a hello mintavételi megjelölése előtti konfigurált toogo volt kérelmek.</span><span class="sxs-lookup"><span data-stu-id="884bc-154">When hello probe is marked as not running depends on hello number of failed probe requests that were configured toogo unanswered before marking hello probe as not running.</span></span>
* <span data-ttu-id="884bc-155">hello mintavételi kap egy TCP hello szerepkörpéldány alaphelyzetbe.</span><span class="sxs-lookup"><span data-stu-id="884bc-155">hello probe receives a TCP reset from hello role instance.</span></span>

<span data-ttu-id="884bc-156">Egy HTTP állapotmintáihoz vagy a TCP-Hálózatfigyelővel konfigurálásával kapcsolatos további információkért lásd: [létrehozásához egy internetre irányuló terheléselosztót a Resource Manager PowerShell-lel](load-balancer-get-started-internet-arm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="884bc-156">For more information about configuring an HTTP health probe or a TCP probe, see [Get started creating an Internet-facing load balancer in Resource Manager using PowerShell](load-balancer-get-started-internet-arm-ps.md).</span></span>

## <a name="add-healthy-instances-back-into-load-balancer-rotation"></a><span data-ttu-id="884bc-157">Adja hozzá a megfelelő példányok újra üzembe a load balancer Elforgatás</span><span class="sxs-lookup"><span data-stu-id="884bc-157">Add healthy instances back into load balancer rotation</span></span>

<span data-ttu-id="884bc-158">TCP- és HTTP mintavételt kifogástalan minősülnek, és jelölje hello szerepkörpéldányt kifogástalan amennyiben:</span><span class="sxs-lookup"><span data-stu-id="884bc-158">TCP and HTTP probes are considered healthy and mark hello role instance as healthy when:</span></span>

* <span data-ttu-id="884bc-159">hello terheléselosztó lekérdezi egy pozitív mintavételi hello első alkalommal hello VM indul el.</span><span class="sxs-lookup"><span data-stu-id="884bc-159">hello load balancer gets a positive probe hello first time hello VM boots.</span></span>
* <span data-ttu-id="884bc-160">hello száma (lásd a korábbiakban) SuccessFailCount sikeres mintavételek menüpontban, amelyek a szükséges toomark hello szerepkörpéldányon kifogástalan hello értékének meghatározása.</span><span class="sxs-lookup"><span data-stu-id="884bc-160">hello number SuccessFailCount (described earlier) defines hello value of successful probes that are required toomark hello role instance as healthy.</span></span> <span data-ttu-id="884bc-161">Ha a szerepkör példánya el lett távolítva, a sikeres, egymást követő mintavételek menüpontban hello száma kell egyenlő vagy SuccessFailCount toomark hello szerepkörpéldányon futó hello értéke meghaladja.</span><span class="sxs-lookup"><span data-stu-id="884bc-161">If a role instance was removed, hello number of successful, successive probes must equal or exceed hello value of SuccessFailCount toomark hello role instance as running.</span></span>

> [!NOTE]
> <span data-ttu-id="884bc-162">Ha a szerepkör példánya hello állapotának van ingadozik, hello terheléselosztó már előtt hello szerepkörpéldányt vissza hello kifogástalan állapotban vár.</span><span class="sxs-lookup"><span data-stu-id="884bc-162">If hello health of a role instance is fluctuating, hello load balancer waits longer before putting hello role instance back in hello healthy state.</span></span> <span data-ttu-id="884bc-163">Ez házirend tooprotect hello felhasználói és hello infrastruktúra keresztül történik.</span><span class="sxs-lookup"><span data-stu-id="884bc-163">This is done via policy tooprotect hello user and hello infrastructure.</span></span>

## <a name="use-log-analytics-for-load-balancer"></a><span data-ttu-id="884bc-164">Naplóelemzési használ a Load Balancer</span><span class="sxs-lookup"><span data-stu-id="884bc-164">Use log analytics for Load Balancer</span></span>

<span data-ttu-id="884bc-165">Használhat [analytics keresse meg a terheléselosztó](load-balancer-monitor-log.md) toocheck hello mintavételi egészségügyi állapotát és a mintavételi száma.</span><span class="sxs-lookup"><span data-stu-id="884bc-165">You can use [log analytics for Load Balancer](load-balancer-monitor-log.md) toocheck on hello probe health status and probe count.</span></span> <span data-ttu-id="884bc-166">Naplózási használható terheléselosztó állapot Power bi-ban vagy az Azure Operational Insights tooprovide statisztikája.</span><span class="sxs-lookup"><span data-stu-id="884bc-166">Logging can be used with Power BI or Azure Operational Insights tooprovide statistics about Load Balancer health status.</span></span>
