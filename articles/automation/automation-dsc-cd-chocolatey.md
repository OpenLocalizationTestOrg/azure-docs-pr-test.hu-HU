---
title: "Azure Automation DSC Chocolatey a folyamatos üzembe helyezés |} Microsoft Docs"
description: "DevOps folyamatos üzembe helyezés Azure Automation DSC és Chocolatey Csomagkezelő használatával.  Példa a teljes JSON ARM-sablon és a PowerShell-forrás."
services: automation
documentationcenter: 
author: eslesar
manager: carmonm
editor: tysonn
ms.assetid: c0baa411-eb76-4f91-8d14-68f68b4805b6
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: na
ms.date: 10/29/2016
ms.author: golive
ms.openlocfilehash: f23d7374a8954a0a95853fa9e00b54a8d9c468c4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="usage-example-continuous-deployment-to-virtual-machines-using-automation-dsc-and-chocolatey"></a><span data-ttu-id="0c948-104">Példa: A virtuális gépek Automation DSC és Chocolatey folyamatos üzembe helyezés</span><span class="sxs-lookup"><span data-stu-id="0c948-104">Usage Example: Continuous deployment to Virtual Machines using Automation DSC and Chocolatey</span></span>
<span data-ttu-id="0c948-105">DevOps világában sok eszközöket különböző pontok folyamatos integrációs folyamatban van.</span><span class="sxs-lookup"><span data-stu-id="0c948-105">In a DevOps world there are many tools to assist with various points in the Continuous Integration pipeline.</span></span>  <span data-ttu-id="0c948-106">Azure Automation kívánt állapot konfigurációs szolgáltatása (DSC) egy üdvözlő új hozzáadása arra a DevOps csoportokat is alkalmaz.</span><span class="sxs-lookup"><span data-stu-id="0c948-106">Azure Automation Desired State Configuration (DSC) is a welcome new addition to the options that DevOps teams can employ.</span></span>  <span data-ttu-id="0c948-107">Ez a cikk bemutatja a beállítás mentése folyamatos Deployment (CD) a Windows-számítógépen.</span><span class="sxs-lookup"><span data-stu-id="0c948-107">This article demonstrates setting up Continuous Deployment (CD) for a Windows computer.</span></span>  <span data-ttu-id="0c948-108">Könnyen kiterjesztheti a technika (egy webhely, például) szerepkör, és onnan, valamint a további szerepkörök közé tartoznak a tetszőleges számú, Windows rendszerű számítógépeken szükség szerint.</span><span class="sxs-lookup"><span data-stu-id="0c948-108">You can easily extend the technique to include as many Windows computers as necessary in the role (a web site, for example), and from there to additional roles as well.</span></span>

![Infrastruktúra-szolgáltatási virtuális gépek folyamatos üzembe helyezés](./media/automation-dsc-cd-chocolatey/cdforiaasvm.png)

## <a name="at-a-high-level"></a><span data-ttu-id="0c948-110">Magas szinten</span><span class="sxs-lookup"><span data-stu-id="0c948-110">At a high level</span></span>
<span data-ttu-id="0c948-111">Igen, felhasználó ide látogatott bit, de Szerencsére az is lehet osztani két fő folyamatok:</span><span class="sxs-lookup"><span data-stu-id="0c948-111">There is quite a bit going on here, but fortunately it can be broken into two main processes:</span></span> 

* <span data-ttu-id="0c948-112">Kód írása tesztelés, létrehozása és közzététele telepítési csomagokat a rendszer fő- és alverzió verzióit.</span><span class="sxs-lookup"><span data-stu-id="0c948-112">Writing code and testing it, then creating and publishing installation packages for major and minor versions of the system.</span></span> 
* <span data-ttu-id="0c948-113">Létrehozása, és a virtuális gépek, amelyek telepítése és a kód végrehajtása a-csomagok kezelése.</span><span class="sxs-lookup"><span data-stu-id="0c948-113">Creating and managing VMs that will install and execute the code in the packages.</span></span>  

<span data-ttu-id="0c948-114">Ha mindkét alapvető eljárás helyen, akkor automatikusan frissíti a csomagot, bármely adott virtuális gép futó, új verziók létrehozott és telepített egy rövid lépés.</span><span class="sxs-lookup"><span data-stu-id="0c948-114">Once both of these core processes are in place, it’s a short step to automatically update the package running on any particular VM as new versions are created and deployed.</span></span>

## <a name="component-overview"></a><span data-ttu-id="0c948-115">Az összetevő áttekintése</span><span class="sxs-lookup"><span data-stu-id="0c948-115">Component overview</span></span>
<span data-ttu-id="0c948-116">Például a csomag kezelők [apt get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) a Linux világ, de nem nagy részét a Windows világ közérthető jól ismert.</span><span class="sxs-lookup"><span data-stu-id="0c948-116">Package managers such as [apt-get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) are pretty well known in the Linux world, but not so much in the Windows world.</span></span>  <span data-ttu-id="0c948-117">[Chocolatey](https://chocolatey.org/) egy ilyen dolog, és Scott Hanselman [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) a következő témakörben található nagy bevezetés.</span><span class="sxs-lookup"><span data-stu-id="0c948-117">[Chocolatey](https://chocolatey.org/) is such a thing, and Scott Hanselman’s [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) on the topic is a great intro.</span></span>  <span data-ttu-id="0c948-118">A ez már a vég Chocolatey lehetővé teszi egy központi tárházban csomagok csomagok telepítése a parancssor használatával Windows rendszerben.</span><span class="sxs-lookup"><span data-stu-id="0c948-118">In a nutshell, Chocolatey allows you to install packages from a central repository of packages into a Windows system using the command line.</span></span>  <span data-ttu-id="0c948-119">Hozhat létre és kezelheti a saját tárház, és Chocolatey csomagok kijelölt adattárak tetszőleges számú telepíthetnek.</span><span class="sxs-lookup"><span data-stu-id="0c948-119">You can create and manage your own repository, and Chocolatey can install packages from any number of repositories that you designate.</span></span>

<span data-ttu-id="0c948-120">Szükségeskonfiguráció-konfiguráló (DSC) ([áttekintése](https://technet.microsoft.com/library/dn249912.aspx)), amely lehetővé teszi a konfigurációt, amelyet a gép deklarálható PowerShell eszköz.</span><span class="sxs-lookup"><span data-stu-id="0c948-120">Desired State Configuration (DSC) ([overview](https://technet.microsoft.com/library/dn249912.aspx)) is a PowerShell tool that allows you to declare the configuration that you want for a machine.</span></span>  <span data-ttu-id="0c948-121">Feltételezzük például, hogy tudja, "Chocolatey telepíteni kívánt, kívánt telepített IIS-t, szeretném a 80-as port nyitva, kívánt 1.0.0 a webhely telepített verzió."</span><span class="sxs-lookup"><span data-stu-id="0c948-121">For example, you can say, “I want Chocolatey installed, I want IIS installed, I want port 80 opened, I want version 1.0.0 of my website installed.”</span></span>  <span data-ttu-id="0c948-122">A DSC helyi Configuration Manager (LCM) valósítja meg, hogy a konfigurálás.</span><span class="sxs-lookup"><span data-stu-id="0c948-122">The DSC Local Configuration Manager (LCM) implements that configuration.</span></span> <span data-ttu-id="0c948-123">A DSC lekérni a kiszolgáló rendelkezik egy konfigurációinak a gépek-tárházat.</span><span class="sxs-lookup"><span data-stu-id="0c948-123">A DSC Pull Server holds a repository of configurations for your machines.</span></span> <span data-ttu-id="0c948-124">Minden számítógépen LCM ellenőrzi rendszeres időközönként konfigurációja megegyezik-e a tárolt konfiguráció.</span><span class="sxs-lookup"><span data-stu-id="0c948-124">The LCM on each machine checks in periodically to see if its configuration matches the stored configuration.</span></span> <span data-ttu-id="0c948-125">Az állapotjelentés, vagy annak érdekében, a gép ismét igazodik a tárolt konfiguráció kísérlet.</span><span class="sxs-lookup"><span data-stu-id="0c948-125">It can either report status or attempt to bring the machine back into alignment with the stored configuration.</span></span> <span data-ttu-id="0c948-126">Egy számítógép vagy a módosított konfigurációjával igazítása során gépek csoportja tartalmazza a lekérési kiszolgálón tárolt konfigurációs szerkesztheti.</span><span class="sxs-lookup"><span data-stu-id="0c948-126">You can edit the stored configuration on the pull server to cause a machine or set of machines to come into alignment with the changed configuration.</span></span>

<span data-ttu-id="0c948-127">Azure Automation szolgáltatásbeli egy olyan felügyelt szolgáltatás, amely lehetővé teszi a runbookok, csomópontok, hitelesítő adatokat, erőforrások és ütemezési és globális változókat eszközök használatával különböző feladatok automatizálására Microsoft Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="0c948-127">Azure Automation is a managed service in Microsoft Azure that allows you to automate various tasks using runbooks, nodes, credentials, resources and assets such as schedules and global variables.</span></span> <span data-ttu-id="0c948-128">Az Azure Automation DSC kibővíti az automatizálási funkció PowerShell DSC eszközöket is tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="0c948-128">Azure Automation DSC extends this automation capability to include PowerShell DSC tools.</span></span>  <span data-ttu-id="0c948-129">Ez egy nagy [áttekintése](automation-dsc-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0c948-129">Here’s a great [overview](automation-dsc-overview.md).</span></span>

<span data-ttu-id="0c948-130">A DSC-erőforrás egy modul kód, amely az adott funkciót, például a hálózat, az Active Directory és az SQL Servert kezelésére.</span><span class="sxs-lookup"><span data-stu-id="0c948-130">A DSC Resource is a module of code that has specific capabilities, such as managing networking, Active Directory, or SQL Server.</span></span>  <span data-ttu-id="0c948-131">A DSC Chocolatey erőforrás tudja, hol (többek között) a NuGet-kiszolgáló elérhető, csomagokat letölteni, csomagok és így tovább.</span><span class="sxs-lookup"><span data-stu-id="0c948-131">The Chocolatey DSC Resource knows how to access a NuGet Server (among others), download packages, install packages, and so on.</span></span>  <span data-ttu-id="0c948-132">Sok más DSC-erőforrás a a [PowerShell-galériában](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span><span class="sxs-lookup"><span data-stu-id="0c948-132">There are many other DSC Resources in the [PowerShell Gallery](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span></span>  <span data-ttu-id="0c948-133">Ezek a modulok telepíti azokat az Azure Automation DSC-lekérni a kiszolgáló (,), ezek a konfigurációk által használható.</span><span class="sxs-lookup"><span data-stu-id="0c948-133">These modules are installed into your Azure Automation DSC Pull Server (by you) so they can be used by your configurations.</span></span>

<span data-ttu-id="0c948-134">Resource Manager-sablonok deklaratív teszik lehetővé a létrehozást, az infrastruktúra - többek között a hálózatok, az alhálózatok, a hálózati biztonsági és útválasztási, betölteni, terheléselosztók, hálózati adapterek, virtuális gépek és így tovább.</span><span class="sxs-lookup"><span data-stu-id="0c948-134">Resource Manager templates provide a declarative way of generating your infrastructure - things like networks, subnets, network security and routing, load balancers, NICs, VMs, and so on.</span></span>  <span data-ttu-id="0c948-135">Íme egy [cikk](../azure-resource-manager/resource-manager-deployment-model.md) , amely összehasonlítja a Resource Manager üzembe helyezési modellben (deklaratív) az Azure szolgáltatásfelügyelet (ASM vagy klasszikus) a központi telepítési modell (imperatív), és ismerteti az alapvető erőforrás-szolgáltató, számítási, tárolási és hálózati.</span><span class="sxs-lookup"><span data-stu-id="0c948-135">Here’s an [article](../azure-resource-manager/resource-manager-deployment-model.md) that compares the Resource Manager deployment model (declarative) with the Azure Service Management (ASM, or classic) deployment model (imperative), and discusses the core resource providers, compute, storage and network.</span></span>

<span data-ttu-id="0c948-136">Egy kulcs egy Resource Manager sablon szolgáltatása képesek-e ki van építve, telepítse a virtuális Gépet egy Virtuálisgép-bővítmény.</span><span class="sxs-lookup"><span data-stu-id="0c948-136">One key feature of an Resource Manager template is its ability to install a VM extension into the VM as it’s provisioned.</span></span>  <span data-ttu-id="0c948-137">A Virtuálisgép-bővítmény például egy egyéni parancsfájl futtatása, a víruskereső szoftver telepítése vagy a DSC-konfigurációs parancsprogram futtatása adott képességekkel rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="0c948-137">A VM extension has specific capabilities such as running a custom script, installing anti-virus software, or running a DSC configuration script.</span></span>  <span data-ttu-id="0c948-138">Nincsenek számos más típusú Virtuálisgép-bővítmények.</span><span class="sxs-lookup"><span data-stu-id="0c948-138">There are many other types of VM extensions.</span></span>

## <a name="quick-trip-around-the-diagram"></a><span data-ttu-id="0c948-139">A diagram körül gyors út</span><span class="sxs-lookup"><span data-stu-id="0c948-139">Quick trip around the diagram</span></span>
<span data-ttu-id="0c948-140">Indítása az oldal tetején, a kódot ír összeállítása és tesztelése, majd hozzon létre egy csomag.</span><span class="sxs-lookup"><span data-stu-id="0c948-140">Starting at the top, you write your code, build and test, then create an installation package.</span></span>  <span data-ttu-id="0c948-141">Chocolatey kezelni tud a különféle telepítési csomagokat, például az MSI-fájl, MSU, ZIP.</span><span class="sxs-lookup"><span data-stu-id="0c948-141">Chocolatey can handle various types of installation packages, such as MSI, MSU, ZIP.</span></span>  <span data-ttu-id="0c948-142">És a teendő a tényleges telepítési Chocolatey tartozó natív képességek nem elég legfeljebb PowerShell teljes hatványa rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="0c948-142">And you have the full power of PowerShell to do the actual installation if Chocolatey’s native capabilities aren’t quite up to it.</span></span>  <span data-ttu-id="0c948-143">A csomag üzembe valahol érhető el – a csomag tárházba.</span><span class="sxs-lookup"><span data-stu-id="0c948-143">Put the package into someplace reachable – a package repository.</span></span>  <span data-ttu-id="0c948-144">A használati példában az egyik nyilvános mappájába egy Azure blob storage-fiók, de bárhol lehet.</span><span class="sxs-lookup"><span data-stu-id="0c948-144">This usage example uses a public folder in an Azure blob storage account, but it can be anywhere.</span></span>  <span data-ttu-id="0c948-145">Felügyeleti csomag metaadatok natív módon a NuGet-kiszolgálók és néhány más chocolatey működik.</span><span class="sxs-lookup"><span data-stu-id="0c948-145">Chocolatey works natively with NuGet servers and a few others for management of package metadata.</span></span>  <span data-ttu-id="0c948-146">[Ez a cikk](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) azokat a lehetőségeket ismerteti.</span><span class="sxs-lookup"><span data-stu-id="0c948-146">[This article](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) describes the options.</span></span>  <span data-ttu-id="0c948-147">A használati példa NuGet.</span><span class="sxs-lookup"><span data-stu-id="0c948-147">This usage example uses NuGet.</span></span>  <span data-ttu-id="0c948-148">Egy Nuspec a csomagok metaadatait.</span><span class="sxs-lookup"><span data-stu-id="0c948-148">A Nuspec is metadata about your packages.</span></span>  <span data-ttu-id="0c948-149">A Nuspec "lefordítva" NuPkg meg, és a NuGet-kiszolgáló tárolja.</span><span class="sxs-lookup"><span data-stu-id="0c948-149">The Nuspec’s are “compiled” into NuPkg’s and stored in a NuGet server.</span></span>  <span data-ttu-id="0c948-150">Amikor a konfigurációs csomag kér név szerint, és hivatkozik a NuGet-kiszolgáló, a Chocolatey DSC-erőforrás (most a virtuális Gépre) a csomag grabs, és telepíti azt.</span><span class="sxs-lookup"><span data-stu-id="0c948-150">When your configuration requests a package by name, and references a NuGet server, the Chocolatey DSC Resource (now on the VM) grabs the package and installs it for you.</span></span>  <span data-ttu-id="0c948-151">A csomag egy adott verziójához is kérheti.</span><span class="sxs-lookup"><span data-stu-id="0c948-151">You can also request a specific version of a package.</span></span>

<span data-ttu-id="0c948-152">A bal alsó részén a kép az Azure Resource Managerrel (ARM) sablon esetében.</span><span class="sxs-lookup"><span data-stu-id="0c948-152">In the bottom left portion of the picture, there is an Azure Resource Manager (ARM) template.</span></span>  <span data-ttu-id="0c948-153">A használati példában a Virtuálisgép-bővítmény regisztrálja a virtuális Gépet az Azure Automation DSC lekérési kiszolgálójával (Ez azt jelenti, hogy a lekérési kiszolgálójával) rendelkező csomópont.</span><span class="sxs-lookup"><span data-stu-id="0c948-153">In this usage example, the VM extension registers the VM with the Azure Automation DSC Pull Server (that is, a pull server) as a Node.</span></span>  <span data-ttu-id="0c948-154">A konfiguráció a lekérési kiszolgálón tárolja.</span><span class="sxs-lookup"><span data-stu-id="0c948-154">The configuration is stored in the pull server.</span></span>  <span data-ttu-id="0c948-155">Ténylegesen, tárolt kétszer: egyszer egyszerű szövegként, és miután összeállítani MOF-fájlként (az alábbiakhoz ilyen dolgot tudnia.)  A portálon a MOF egy "csomópont-konfiguráció" (figyelésekor egyszerűen "konfiguráció").</span><span class="sxs-lookup"><span data-stu-id="0c948-155">Actually, it’s stored twice: once as plain text and once compiled as an MOF file (for those that know about such things.)  In the portal, the MOF is a “node configuration” (as opposed to simply “configuration”).</span></span>  <span data-ttu-id="0c948-156">A csomópont van társítva, ezért a csomópont tudni fogják konfigurációjában hitelesítendő entitások azonosítása.</span><span class="sxs-lookup"><span data-stu-id="0c948-156">It’s the artifact that’s associated with a Node so the node will know its configuration.</span></span>  <span data-ttu-id="0c948-157">Az alábbi részletek megjelenítése a csomópont-konfiguráció hozzárendelése a csomópont.</span><span class="sxs-lookup"><span data-stu-id="0c948-157">Details below show how to assign the node configuration to the node.</span></span>

<span data-ttu-id="0c948-158">Valószínűleg már végzett tetején, vagy azt a legtöbb bit.</span><span class="sxs-lookup"><span data-stu-id="0c948-158">Presumably you’re already doing the bit at the top, or most of it.</span></span>  <span data-ttu-id="0c948-159">A nuspec létrehozása, fordítása, és tárolja őket a NuGet-kiszolgáló egy kis is.</span><span class="sxs-lookup"><span data-stu-id="0c948-159">Creating the nuspec, compiling and storing it in a NuGet server is a small thing.</span></span>  <span data-ttu-id="0c948-160">És már Ön által felügyelt virtuális gépek.</span><span class="sxs-lookup"><span data-stu-id="0c948-160">And you’re already managing VMs.</span></span>  <span data-ttu-id="0c948-161">A lekérési kiszolgálójával (egyszer) beállítása, a regisztráló a csomópontok (egyszer), és a létrehozása és a (kezdetben) tárolja a konfigurációs hiba véve a következő lépés a folyamatos üzembe helyezés igényel.</span><span class="sxs-lookup"><span data-stu-id="0c948-161">Taking the next step to continuous deployment requires setting up the pull server (once), registering your nodes with it (once), and creating and storing the configuration there (initially).</span></span>  <span data-ttu-id="0c948-162">Mind a csomópont konfigurációs csomagok frissítése és központi telepítése a tárházban, majd frissítse a lekérési kiszolgálón (ismétlődő igény szerint).</span><span class="sxs-lookup"><span data-stu-id="0c948-162">Then as packages are upgraded and deployed to the repository, refresh the Configuration and Node Configuration in the pull server (repeat as needed).</span></span>

<span data-ttu-id="0c948-163">Ha még nem kezdve egy ARM-sablon, ez is OK gombra.</span><span class="sxs-lookup"><span data-stu-id="0c948-163">If you’re not starting with an ARM template, that’s also OK.</span></span>  <span data-ttu-id="0c948-164">PowerShell-parancsmagok célja, hogy a virtuális gépek regisztrálása a lekérési kiszolgálójával, és az összes többi van.</span><span class="sxs-lookup"><span data-stu-id="0c948-164">There are PowerShell cmdlets designed to help you register your VMs with the pull server and all of the rest.</span></span> <span data-ttu-id="0c948-165">További részletekért lásd: Ez a cikk: [bevezetési gépeket Azure Automation DSC általi kezelésre](automation-dsc-onboarding.md)</span><span class="sxs-lookup"><span data-stu-id="0c948-165">For more details, see this article: [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md)</span></span>

## <a name="step-1-setting-up-the-pull-server-and-automation-account"></a><span data-ttu-id="0c948-166">1. lépés: A lekérési kiszolgálón és az automatizálás fiók beállítása</span><span class="sxs-lookup"><span data-stu-id="0c948-166">Step 1: Setting up the pull server and automation account</span></span>
<span data-ttu-id="0c948-167">Egy hitelesített (Add-AzureRmAccount) PowerShell parancssorból: (percet is igénybe vehet néhány közben a lekérési kiszolgálón be van állítva)</span><span class="sxs-lookup"><span data-stu-id="0c948-167">At an authenticated (Add-AzureRmAccount) PowerShell command line:  (can take a few minutes while the pull server is set up)</span></span>

    New-AzureRmResourceGroup –Name MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES
    New-AzureRmAutomationAccount –ResourceGroupName MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES –Name MY-AUTOMATION-ACCOUNT 

<span data-ttu-id="0c948-168">Az automation-fiók (más néven helye) következő régiókban minden helyezhet el: USA keleti régiója 2, déli középső Régiójában, Velünk – (kormányzati) Virginia, Nyugat-Európában, Délkelet-Ázsiában, kelet-japán, közép-Indiában és Ausztrália délkeleti, Kanada központi Észak-Európa.</span><span class="sxs-lookup"><span data-stu-id="0c948-168">You can put your automation account into any of the following regions (aka location):  East US 2, South Central US, US Gov Virginia, West Europe, Southeast Asia, Japan East, Central India and Australia Southeast, Canada Central, North Europe.</span></span>

## <a name="step-2-vm-extension-tweaks-to-the-arm-template"></a><span data-ttu-id="0c948-169">2. lépés: Virtuális gép bővítmény beállításokból állnak az ARM-sablon</span><span class="sxs-lookup"><span data-stu-id="0c948-169">Step 2: VM extension tweaks to the ARM template</span></span>
<span data-ttu-id="0c948-170">VM-regisztrációk (a PowerShell DSC Virtuálisgép-bővítmény) részletei jelen [Azure gyors üzembe helyezés sablon](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span><span class="sxs-lookup"><span data-stu-id="0c948-170">Details for VM registration (using the PowerShell DSC VM extension) provided in this [Azure Quickstart Template](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span></span>  <span data-ttu-id="0c948-171">Ez a lépés az új virtuális gép regisztrálja a DSC-csomópontok közül a lekérési kiszolgálójával.</span><span class="sxs-lookup"><span data-stu-id="0c948-171">This step registers your new VM with the pull server in the list of DSC Nodes.</span></span>  <span data-ttu-id="0c948-172">Ez a regisztráció része van a csomópont-konfigurációnak a csomópont alkalmazandó megadása.</span><span class="sxs-lookup"><span data-stu-id="0c948-172">Part of this registration is specifying the node configuration to be applied to the node.</span></span>  <span data-ttu-id="0c948-173">Ez a csomópont-konfiguráció nem kell a lekérési kiszolgálón, ezért ezt a OK, amely a 4. lépés, ahol ehhez először még létezik.</span><span class="sxs-lookup"><span data-stu-id="0c948-173">This node configuration doesn't have to exist yet in the pull server, so it's OK that Step 4 is where this is done for the first time.</span></span>  <span data-ttu-id="0c948-174">De itt 2. lépésben kell a csomópont neve és a konfiguráció neve mellett döntött.</span><span class="sxs-lookup"><span data-stu-id="0c948-174">But here in Step 2 you do need to have decided the name of the node and the name of the configuration.</span></span>  <span data-ttu-id="0c948-175">A használati példában a csomópont "isvbox" pedig a konfiguráció "ISVBoxConfig".</span><span class="sxs-lookup"><span data-stu-id="0c948-175">In this usage example, the node is 'isvbox' and the configuration is 'ISVBoxConfig'.</span></span>  <span data-ttu-id="0c948-176">Így a csomópont-konfiguráció neve (meg kell határozni a DeploymentTemplate.json) "ISVBoxConfig.isvbox".</span><span class="sxs-lookup"><span data-stu-id="0c948-176">So the node configuration name (to be specified in DeploymentTemplate.json) is 'ISVBoxConfig.isvbox'.</span></span>  

## <a name="step-3-adding-required-dsc-resources-to-the-pull-server"></a><span data-ttu-id="0c948-177">3. lépés: A lekérési kiszolgálójával DSC szükséges erőforrások hozzáadása</span><span class="sxs-lookup"><span data-stu-id="0c948-177">Step 3: Adding required DSC resources to the pull server</span></span>
<span data-ttu-id="0c948-178">A PowerShell-galériában van tagolva DSC erőforrások telepítse az Azure Automation-fiók.</span><span class="sxs-lookup"><span data-stu-id="0c948-178">The PowerShell Gallery is instrumented to install DSC resources into your Azure Automation account.</span></span>  <span data-ttu-id="0c948-179">Nyissa meg az erőforrás, kattintson a "Központi telepítése az Azure Automation" gombra.</span><span class="sxs-lookup"><span data-stu-id="0c948-179">Navigate to the resource you want and click the “Deploy to Azure Automation” button.</span></span>

![PowerShell-galériában – példa](./media/automation-dsc-cd-chocolatey/xNetworking.PNG)

<span data-ttu-id="0c948-181">Nemrég adta hozzá az Azure-portálra egy másik módszer lehetővé teszi, hogy új modulok bekérésére vagy frissítse a meglévő modulok.</span><span class="sxs-lookup"><span data-stu-id="0c948-181">Another technique recently added to the Azure Portal allows you to pull in new modules or update existing modules.</span></span> <span data-ttu-id="0c948-182">Kattintson az Automation-fiók erőforrás, az eszközök csempe, és végül a modulok csempén.</span><span class="sxs-lookup"><span data-stu-id="0c948-182">Click through the Automation Account resource, the Assets tile, and finally the Modules tile.</span></span>  <span data-ttu-id="0c948-183">A tallózási gyűjteményelem ikon lehetővé teszi a katalógusban szereplő modulok listáját, részletekbe menően tárhatják fel részleteit, és végül importálja az Automation-fiók.</span><span class="sxs-lookup"><span data-stu-id="0c948-183">The Browse Gallery icon allows you to see the list of modules in the gallery, drill down into details and ultimately import into your Automation Account.</span></span> <span data-ttu-id="0c948-184">Ez remek módja a modulok naprakészen tartásához időről időre.</span><span class="sxs-lookup"><span data-stu-id="0c948-184">This is a great way to keep your modules up to date from time to time.</span></span> <span data-ttu-id="0c948-185">És az importálás funkció ellenőrzi annak érdekében, semmi sem lekérdezi szinkronban más modulok függőségek.</span><span class="sxs-lookup"><span data-stu-id="0c948-185">And, the import feature checks dependencies with other modules to ensure nothing gets out of sync.</span></span>

<span data-ttu-id="0c948-186">Vagy nincs az manuális módszerrel.</span><span class="sxs-lookup"><span data-stu-id="0c948-186">Or, there’s the manual approach.</span></span>  <span data-ttu-id="0c948-187">A PowerShell integrációs modul a Windows-számítógép mappaszerkezetét kissé eltér a mappastruktúra az Azure Automation által várt.</span><span class="sxs-lookup"><span data-stu-id="0c948-187">The folder structure of a PowerShell Integration Module for a Windows computer is a little different from the folder structure expected by the Azure Automation.</span></span>  <span data-ttu-id="0c948-188">Ehhez egy kis tökéletesítse beavatkozást.</span><span class="sxs-lookup"><span data-stu-id="0c948-188">This requires a little tweaking on your part.</span></span>  <span data-ttu-id="0c948-189">Azonban ez nem rögzített, és elkészült csak egyszer erőforrásonként (hacsak nem szeretné frissíteni a jövőben.)  A PowerShell integrációs modulok készítése további információkért lásd: Ez a cikk: [integrációs modulok készítése az Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span><span class="sxs-lookup"><span data-stu-id="0c948-189">But it’s not hard, and it’s done only once per resource (unless you want to upgrade it in future.)  For more information on authoring PowerShell Integration Modules, see this article: [Authoring Integration Modules for Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span></span>

* <span data-ttu-id="0c948-190">A modul telepítése, amelyekre szüksége van a munkaállomáson, az alábbiak szerint:</span><span class="sxs-lookup"><span data-stu-id="0c948-190">Install the module that you need on your workstation, as follows:</span></span>
  * <span data-ttu-id="0c948-191">Telepítés [Windows Management Framework v5](http://aka.ms/wmf5latest) (a Windows 10-hez nem szükséges)</span><span class="sxs-lookup"><span data-stu-id="0c948-191">Install [Windows Management Framework, v5](http://aka.ms/wmf5latest) (not needed for Windows 10)</span></span>
  * <span data-ttu-id="0c948-192">`Install-Module –Name MODULE-NAME`< – a PowerShell-galériából modul grabs</span><span class="sxs-lookup"><span data-stu-id="0c948-192">`Install-Module –Name MODULE-NAME`    <—grabs the module from the PowerShell Gallery</span></span> 
* <span data-ttu-id="0c948-193">A modul mappát másolja `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` egy ideiglenes mappába</span><span class="sxs-lookup"><span data-stu-id="0c948-193">Copy the module folder from `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` to a temp folder</span></span> 
* <span data-ttu-id="0c948-194">A fő mappa minták és dokumentáció törlése</span><span class="sxs-lookup"><span data-stu-id="0c948-194">Delete samples and documentation from the main folder</span></span> 
* <span data-ttu-id="0c948-195">A ZIP-mappáját, pontosan ugyanaz, mint a mappa a ZIP-fájl elnevezése</span><span class="sxs-lookup"><span data-stu-id="0c948-195">Zip the main folder, naming the ZIP file exactly the same as the folder</span></span> 
* <span data-ttu-id="0c948-196">A ZIP-fájl helyezze egy elérhető-e HTTP-helyre, például az Azure-Tárfiók a blob-tároló.</span><span class="sxs-lookup"><span data-stu-id="0c948-196">Put the ZIP file into a reachable HTTP location, such as blob storage in an Azure Storage Account.</span></span>
* <span data-ttu-id="0c948-197">Futtassa ezt a PowerShell:</span><span class="sxs-lookup"><span data-stu-id="0c948-197">Run this PowerShell:</span></span>
  
      New-AzureRmAutomationModule `
          -ResourceGroupName MY-AUTOMATION-RG -AutomationAccountName MY-AUTOMATION-ACCOUNT `
          -Name MODULE-NAME –ContentLink "https://STORAGE-URI/CONTAINERNAME/MODULE-NAME.zip"

<span data-ttu-id="0c948-198">A befoglalt példa cChoco és xNetworking hajtja végre ezeket a lépéseket.</span><span class="sxs-lookup"><span data-stu-id="0c948-198">The included example performs these steps for cChoco and xNetworking.</span></span> <span data-ttu-id="0c948-199">Tekintse meg a [megjegyzések](#notes) a cChoco a különleges kezelést.</span><span class="sxs-lookup"><span data-stu-id="0c948-199">See the [Notes](#notes) for special handling for cChoco.</span></span>

## <a name="step-4-adding-the-node-configuration-to-the-pull-server"></a><span data-ttu-id="0c948-200">4. lépés: A csomópont-konfiguráció hozzáadása a lekérési kiszolgálón</span><span class="sxs-lookup"><span data-stu-id="0c948-200">Step 4: Adding the node configuration to the pull server</span></span>
<span data-ttu-id="0c948-201">Nincs szükség különleges, a konfiguráció importál a lekérési kiszolgálójával, és a fordítási először kapcsolatos.</span><span class="sxs-lookup"><span data-stu-id="0c948-201">There’s nothing special about the first time you import your configuration into the pull server and compile.</span></span>  <span data-ttu-id="0c948-202">Az összes későbbi importálási/lefordítható ugyanazt a konfigurációt a pontosan is ugyanúgy néznek ki.</span><span class="sxs-lookup"><span data-stu-id="0c948-202">All subsequent import/compiles of the same configuration look exactly the same.</span></span>  <span data-ttu-id="0c948-203">Minden alkalommal, amikor frissíti a csomagot, és a leküldése éles kell meg ehhez a lépéshez győződjön meg arról, a konfigurációs fájl nem megfelelő – beleértve a csomag új verziója.</span><span class="sxs-lookup"><span data-stu-id="0c948-203">Each time you update your package and need to push it out to production you do this step after ensuring the configuration file is correct – including the new version of your package.</span></span>  <span data-ttu-id="0c948-204">Ez a konfigurációs fájl és a PowerShell használatával:</span><span class="sxs-lookup"><span data-stu-id="0c948-204">Here’s the configuration file and PowerShell:</span></span>

<span data-ttu-id="0c948-205">ISVBoxConfig.ps1:</span><span class="sxs-lookup"><span data-stu-id="0c948-205">ISVBoxConfig.ps1:</span></span>

    Configuration ISVBoxConfig 
    { 
        Import-DscResource -ModuleName cChoco 
        Import-DscResource -ModuleName xNetworking

        Node "isvbox" {   

            cChocoInstaller installChoco 
            { 
                InstallDir = "C:\choco" 
            }

            WindowsFeature installIIS 
            { 
                Ensure="Present" 
                Name="Web-Server" 
            }

            xFirewall WebFirewallRule 
            { 
                Direction = "Inbound" 
                Name = "Web-Server-TCP-In" 
                DisplayName = "Web Server (TCP-In)" 
                Description = "IIS allow incoming web site traffic." 
                DisplayGroup = "IIS Incoming Traffic" 
                State = "Enabled" 
                Access = "Allow" 
                Protocol = "TCP" 
                LocalPort = "80" 
                Ensure = "Present" 
            }

            cChocoPackageInstaller trivialWeb 
            {            
                Name = "trivialweb" 
                Version = "1.0.0" 
                Source = “MY-NUGET-V2-SERVER-ADDRESS” 
                DependsOn = "[cChocoInstaller]installChoco", 
                "[WindowsFeature]installIIS" 
            } 
        }    
    }

<span data-ttu-id="0c948-206">Új-ConfigurationScript.ps1:</span><span class="sxs-lookup"><span data-stu-id="0c948-206">New-ConfigurationScript.ps1:</span></span>

    Import-AzureRmAutomationDscConfiguration ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -SourcePath C:\temp\AzureAutomationDsc\ISVBoxConfig.ps1 ` 
        -Published –Force

    $jobData = Start-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -ConfigurationName ISVBoxConfig 

    $compilationJobId = $jobData.Id

    Get-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -Id $compilationJobId

<span data-ttu-id="0c948-207">Ezek új csomópont-konfiguráció lépéseket eredményez a lekérési kiszolgálón helyezés "ISVBoxConfig.isvbox" nevű.</span><span class="sxs-lookup"><span data-stu-id="0c948-207">These steps result in a new node configuration named “ISVBoxConfig.isvbox” being placed on the pull server.</span></span>  <span data-ttu-id="0c948-208">A csomópont-konfiguráció neve "configurationName.nodeName" mint épül.</span><span class="sxs-lookup"><span data-stu-id="0c948-208">The node configuration name is built as “configurationName.nodeName”.</span></span>

## <a name="step-5-creating-and-maintaining-package-metadata"></a><span data-ttu-id="0c948-209">5. lépés: Létrehozása és karbantartása csomag metaadatai</span><span class="sxs-lookup"><span data-stu-id="0c948-209">Step 5: Creating and maintaining package metadata</span></span>
<span data-ttu-id="0c948-210">Minden csomagot, hogy vannak-e a csomag tárházba van szüksége, amely leírja, hogy egy nuspec.</span><span class="sxs-lookup"><span data-stu-id="0c948-210">For each package that you put into the package repository, you need a nuspec that describes it.</span></span>  <span data-ttu-id="0c948-211">Adott nuspec kell összeállítani, és a NuGet-kiszolgáló által tárolt.</span><span class="sxs-lookup"><span data-stu-id="0c948-211">That nuspec must be compiled and stored in your NuGet server.</span></span> <span data-ttu-id="0c948-212">A műveletet [Itt](http://docs.nuget.org/create/creating-and-publishing-a-package).</span><span class="sxs-lookup"><span data-stu-id="0c948-212">This process is described [here](http://docs.nuget.org/create/creating-and-publishing-a-package).</span></span>  <span data-ttu-id="0c948-213">MyGet.org NuGet-kiszolgálóként is használhatja.</span><span class="sxs-lookup"><span data-stu-id="0c948-213">You can use MyGet.org as a NuGet server.</span></span>  <span data-ttu-id="0c948-214">Ez a szolgáltatás el, hanem alapszintű Termékváltozat, amely nem rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="0c948-214">They sell this service, but have a starter SKU that’s free.</span></span>  <span data-ttu-id="0c948-215">A NuGet.org saját NuGet-kiszolgáló a saját csomagok telepítésével kapcsolatos találhat.</span><span class="sxs-lookup"><span data-stu-id="0c948-215">At NuGet.org you’ll find instructions on installing your own NuGet server for your private packages.</span></span>

## <a name="step-6-tying-it-all-together"></a><span data-ttu-id="0c948-216">6. lépés: Az összes együtt Ön</span><span class="sxs-lookup"><span data-stu-id="0c948-216">Step 6: Tying it all together</span></span>
<span data-ttu-id="0c948-217">Minden alkalommal, amikor egy verzió QA továbbítja, jóvá van hagyva központi telepítéséhez a csomagot a létrehozása nuspec és frissítése, és a NuGet-kiszolgálóra telepített nupkg.</span><span class="sxs-lookup"><span data-stu-id="0c948-217">Each time a version passes QA and is approved for deployment, the package is created, nuspec and nupkg updated and deployed to the NuGet server.</span></span>  <span data-ttu-id="0c948-218">Ezenkívül a konfigurációs (4. lépés a fenti) frissíteni kell, hogy elfogadja az új verziószámmal.</span><span class="sxs-lookup"><span data-stu-id="0c948-218">In addition, the configuration (Step 4 above) must be updated to agree with the new version number.</span></span>  <span data-ttu-id="0c948-219">Kell küldeni a lekérési kiszolgálójával, és fordítva.</span><span class="sxs-lookup"><span data-stu-id="0c948-219">It must be sent to the pull server and compiled.</span></span>  <span data-ttu-id="0c948-220">Ettől kezdve akkor a virtuális gépek, amelyek függenek, hogy a frissítés lekéréses és telepítéséhez.</span><span class="sxs-lookup"><span data-stu-id="0c948-220">From that point on, it's up to the VMs that depend on that configuration to pull the update and install it.</span></span>  <span data-ttu-id="0c948-221">E frissítések egyszerű - csak egy vonal, vagy két PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0c948-221">Each of these updates are simple - just a line or two of PowerShell.</span></span>  <span data-ttu-id="0c948-222">Visual Studio Team Services, esetén némelyikük vannak ágyazva elérése érdekében együtt a build összeállítási feladatokat.</span><span class="sxs-lookup"><span data-stu-id="0c948-222">In the case of Visual Studio Team Services, some of them are encapsulated in build tasks that can be chained together in a build.</span></span>  <span data-ttu-id="0c948-223">Ez [cikk](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) további részleteket tartalmaz.</span><span class="sxs-lookup"><span data-stu-id="0c948-223">This [article](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) provides more details.</span></span>  <span data-ttu-id="0c948-224">Ez [GitHub-tárház](https://github.com/Microsoft/vso-agent-tasks) adatokat a különböző elérhető összeállítási feladatokat.</span><span class="sxs-lookup"><span data-stu-id="0c948-224">This [GitHub repo](https://github.com/Microsoft/vso-agent-tasks) details the various available build tasks.</span></span>

## <a name="notes"></a><span data-ttu-id="0c948-225">Megjegyzések</span><span class="sxs-lookup"><span data-stu-id="0c948-225">Notes</span></span>
<span data-ttu-id="0c948-226">Ez a példa egy virtuális Gépet az Azure katalógusában az általános Windows Server 2012 R2 lemezképéről kezdődik.</span><span class="sxs-lookup"><span data-stu-id="0c948-226">This usage example starts with a VM from a generic Windows Server 2012 R2 image from the Azure gallery.</span></span>  <span data-ttu-id="0c948-227">Indítsa el a tárolt képet, és majd végeznünk a DSC-konfiguráció onnan.</span><span class="sxs-lookup"><span data-stu-id="0c948-227">You can start from any stored image and then tweak from there with the DSC configuration.</span></span>  <span data-ttu-id="0c948-228">Sütik-konfiguráció módosítása lemezképekbe azonban sokkal nehezebb mint dinamikusan a a DSC használata konfigurációjának frissítése.</span><span class="sxs-lookup"><span data-stu-id="0c948-228">However, changing configuration that is baked into an image is much harder than dynamically updating the configuration using DSC.</span></span>

<span data-ttu-id="0c948-229">Ez a módszer használata a virtuális gépek egy ARM-sablon és a Virtuálisgép-bővítmény használatára nincs.</span><span class="sxs-lookup"><span data-stu-id="0c948-229">You don’t have to use an ARM template and the VM extension to use this technique with your VMs.</span></span>  <span data-ttu-id="0c948-230">És a virtuális gépek nem kell Azure CD felügyelet alatt kell lennie.</span><span class="sxs-lookup"><span data-stu-id="0c948-230">And your VMs don’t have to be on Azure to be under CD management.</span></span>  <span data-ttu-id="0c948-231">Minden szükséges Chocolatey telepített, és a LCM konfigurálva a virtuális Gépen, így az tudni fogja, hogy a lekéréses kiszolgálót.</span><span class="sxs-lookup"><span data-stu-id="0c948-231">All that’s necessary is that Chocolatey be installed and the LCM configured on the VM so it knows where the pull server is.</span></span>  

<span data-ttu-id="0c948-232">Természetesen Amikor frissít egy csomagot a virtuális gép, amely a termelésben, kell Elforgatás kívüli virtuális igénybe vehet, amíg a frissítés telepítve van.</span><span class="sxs-lookup"><span data-stu-id="0c948-232">Of course, when you update a package on a VM that’s in production, you need to take that VM out of rotation while the update is installed.</span></span>  <span data-ttu-id="0c948-233">Ennek módja széles körben változik.</span><span class="sxs-lookup"><span data-stu-id="0c948-233">How you do this varies widely.</span></span>  <span data-ttu-id="0c948-234">Például egy virtuális Gépet egy Azure terheléselosztó mögött, hozzáadhat egy egyéni mintavételi.</span><span class="sxs-lookup"><span data-stu-id="0c948-234">For example, with a VM behind an Azure Load Balancer, you can add a Custom Probe.</span></span>  <span data-ttu-id="0c948-235">A virtuális gép frissítésekor a mintavételi végpont, térjen vissza a 400 rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="0c948-235">While updating the VM, have the probe endpoint return a 400.</span></span>  <span data-ttu-id="0c948-236">A végeznünk szükségesek, hogy ez a módosítás következtében lehet belül a konfigurációs végeznünk való visszatéréshez azt vissza a 200-as, a frissítés befejezése után is.</span><span class="sxs-lookup"><span data-stu-id="0c948-236">The tweak necessary to cause this change can be inside your configuration, as can the tweak to switch it back to returning a 200 once the update is complete.</span></span>

<span data-ttu-id="0c948-237">Ez a példa a teljes forrás van [a Visual Studio-projekt](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) a Githubon.</span><span class="sxs-lookup"><span data-stu-id="0c948-237">Full source for this usage example is in [this Visual Studio project](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) on GitHub.</span></span>

## <a name="related-articles"></a><span data-ttu-id="0c948-238">Kapcsolódó cikkek</span><span class="sxs-lookup"><span data-stu-id="0c948-238">Related Articles</span></span>
* [<span data-ttu-id="0c948-239">Azure Automation DSC – áttekintés</span><span class="sxs-lookup"><span data-stu-id="0c948-239">Azure Automation DSC Overview</span></span>](automation-dsc-overview.md)
* [<span data-ttu-id="0c948-240">Azure Automation DSC-parancsmagokkal</span><span class="sxs-lookup"><span data-stu-id="0c948-240">Azure Automation DSC cmdlets</span></span>](https://msdn.microsoft.com/library/mt244122.aspx)
* [<span data-ttu-id="0c948-241">Azure Automation DSC általi kezelésre bevezetési gépek</span><span class="sxs-lookup"><span data-stu-id="0c948-241">Onboarding machines for management by Azure Automation DSC</span></span>](automation-dsc-onboarding.md)

