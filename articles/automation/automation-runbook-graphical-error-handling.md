---
title: "Hibakezelés az Azure Automation grafikus runbookokban | Microsoft Docs"
description: "Ez a cikk ismerteti a hibakezelési logika megvalósítását az Azure Automation grafikus runbookokban."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 12/26/2016
ms.author: magoedte
ms.openlocfilehash: 12313f7f245d32c33882f1036f7d4b48bfb3ddc5
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="error-handling-in-azure-automation-graphical-runbooks"></a><span data-ttu-id="bcd8c-103">Hibakezelés az Azure Automation grafikus runbookokban</span><span class="sxs-lookup"><span data-stu-id="bcd8c-103">Error handling in Azure Automation graphical runbooks</span></span>

<span data-ttu-id="bcd8c-104">Az egyik legfontosabb figyelembe veendő runbooktervezési alapelv a runbookokkal kapcsolatban felmerülő különböző helyzetek azonosítása.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-104">A key runbook design principal to consider is identifying different issues that a runbook might experience.</span></span> <span data-ttu-id="bcd8c-105">Az ilyen helyzetek közé tartoznak a sikeres műveletek, a várt hibaállapotok és a váratlan hibafeltételek.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-105">These issues can include success, expected error states, and unexpected error conditions.</span></span>

<span data-ttu-id="bcd8c-106">A runbookoknak hibakezelési képességekkel is kell rendelkezniük.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-106">Runbooks should include error handling.</span></span> <span data-ttu-id="bcd8c-107">Ha érvényesíteni szeretné egy tevékenység kimenetét, vagy a grafikus runbookokkal szeretne kezelni egy hibát, akkor használhat egy Windows PowerShell-kóddal végzett tevékenységet, feltételes logikát határozhat meg a tevékenység kimeneti hivatkozására, vagy egyéb módszert is alkalmazhat.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-107">To validate the output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on the output link of the activity, or apply another method.</span></span>          

<span data-ttu-id="bcd8c-108">Gyakran előfordul, hogy ha egy runbooktevékenységgel kapcsolatban megszakítást nem okozó hiba merül fel, akkor a rendszer az az után következő tevékenységeket a hibától függetlenül feldolgozza.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of the error.</span></span> <span data-ttu-id="bcd8c-109">A hiba valószínűleg kivételt hoz létre, a lényeg azonban az, hogy a következő tevékenység is lefuthat.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-109">The error is likely to generate an exception, but the next activity is still allowed to run.</span></span> <span data-ttu-id="bcd8c-110">A PowerShell ilyen módon kezeli a hibákat.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-110">This is the way that PowerShell is designed to handle errors.</span></span>    

<span data-ttu-id="bcd8c-111">A végrehajtás során előforduló PowerShell-hibák megszakítást okozó vagy megszakítást nem okozó típusúak lehetnek.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-111">The types of PowerShell errors that can occur during execution are terminating or non-terminating.</span></span> <span data-ttu-id="bcd8c-112">A megszakítást okozó és nem okozó hibák közötti különbség a következő:</span><span class="sxs-lookup"><span data-stu-id="bcd8c-112">The differences between terminating and non-terminating errors are as follows:</span></span>

* <span data-ttu-id="bcd8c-113">**Megszakítást okozó hiba**: A végrehajtás során bekövetkező súlyos hiba, amely teljes egészében megszakítja a parancs (vagy szkript) végrehajtását.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-113">**Terminating error**: A serious error during execution that halts the command (or script execution) completely.</span></span> <span data-ttu-id="bcd8c-114">Ilyenek például a nem létező parancsmagok, a parancsmag futását megakadályozó szintaktikai hibák vagy az egyéb végzetes hibák.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span></span>

* <span data-ttu-id="bcd8c-115">**Megszakítást nem okozó hiba**: Nem súlyos hiba, amely a hiba ellenére engedélyezi a végrehajtást.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-115">**Non-terminating error**: A non-serious error that allows execution to continue despite the failure.</span></span> <span data-ttu-id="bcd8c-116">Ilyenek például a műveleti hibák, például a „fájl nem található” vagy az engedélyekkel kapcsolatos problémák.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-116">Examples include operational errors such as file not found errors and permissions problems.</span></span>

<span data-ttu-id="bcd8c-117">Az Azure Automation grafikus runbookok kiegészültek a hibakezelés képességével is.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-117">Azure Automation graphical runbooks have been improved with the capability to include error handling.</span></span> <span data-ttu-id="bcd8c-118">A kivételeket mostantól nem megszakító hibákká változtathatja, valamint hibahivatkozásokat hozhat létre a tevékenységek között.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span></span> <span data-ttu-id="bcd8c-119">Ez a folyamat lehetővé teszi a runbook szerzője számára a hibák észlelését, és a létrejött vagy váratlan feltételek kezelését.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-119">This process allows a runbook author to catch errors and manage realized or unexpected conditions.</span></span>  

## <a name="when-to-use-error-handling"></a><span data-ttu-id="bcd8c-120">Mikor érdemes hibakezelést használni?</span><span class="sxs-lookup"><span data-stu-id="bcd8c-120">When to use error handling</span></span>

<span data-ttu-id="bcd8c-121">A kritikus tevékenységekkel kapcsolatos hibák vagy kivételek felmerülésekor fontos megakadályozni a runbook következő tevékenységének feldolgozását, és megfelelően kezelni a hibát.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-121">Whenever there is a critical activity that throws an error or exception, it's important to prevent the next activity in your runbook from processing and to handle the error appropriately.</span></span> <span data-ttu-id="bcd8c-122">Ez kritikus fontosságú abban az esetben, ha a runbookok valamilyen üzleti vagy szolgáltatási műveleti folyamatot támogatnak.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-122">This is especially critical when your runbooks are supporting a business or service operations process.</span></span>

<span data-ttu-id="bcd8c-123">A runbook szerzője minden egyes tevékenységhez, amely hibát eredményezhet, hozzáadhat egy hibahivatkozást, amely bármely más tevékenységre mutathat.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-123">For each activity that can produce an error, the runbook author can add an error link pointing to any other activity.</span></span>  <span data-ttu-id="bcd8c-124">A céltevékenység bármilyen típusú lehet, többek között kóddal végzett tevékenységek, parancsmag meghívása, másik runbook meghívása stb.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-124">The destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span></span>

<span data-ttu-id="bcd8c-125">Emellett a céltevékenység kimenő hivatkozásokat is tartalmazhat.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-125">In addition, the destination activity can also have outgoing links.</span></span> <span data-ttu-id="bcd8c-126">Ezek lehetnek szokványos hivatkozások vagy hibahivatkozások.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-126">These links can be regular links or error links.</span></span> <span data-ttu-id="bcd8c-127">Ez azt jelenti, hogy a runbook szerzője összetett hibakezelési logikát valósíthat meg anélkül, hogy kóddal végzett tevékenységekre kellene hagyatkoznia.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-127">This means the runbook author can implement complex error-handling logic without resorting to a code activity.</span></span> <span data-ttu-id="bcd8c-128">Az ajánlott eljárás egy általános funkciókkal rendelkező dedikált hibakezelési runbook létrehozása, ez azonban nem kötelező.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-128">The recommended practice is to create a dedicated error-handling runbook with common functionality, but it's not mandatory.</span></span> <span data-ttu-id="bcd8c-129">A PowerShell-kóddal végzett tevékenységben szereplő hibakezelési logika pedig nem az egyetlen alternatíva.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-129">Error-handling logic in a PowerShell code activity it isn't the only option.</span></span>  

<span data-ttu-id="bcd8c-130">Vegyünk példaként egy olyan runbookot, amely egy virtuális gépet próbál elindítani, majd telepíteni rá egy alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-130">For example, consider a runbook that tries to start a VM and install an application on it.</span></span> <span data-ttu-id="bcd8c-131">Ha a virtuális gép nem indul el megfelelően, akkor két műveletet végez:</span><span class="sxs-lookup"><span data-stu-id="bcd8c-131">If the VM doesn't start correctly, it performs two actions:</span></span>

1. <span data-ttu-id="bcd8c-132">Értesítést küld a problémáról.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-132">It sends a notification about this problem.</span></span>
2. <span data-ttu-id="bcd8c-133">Elindít egy másik runbookot, amely automatikusan új virtuális gépet helyez üzembe.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-133">It starts another runbook that automatically provisions a new VM instead.</span></span>

<span data-ttu-id="bcd8c-134">Az egyik megoldás, ha a hibahivatkozás egy, az 1. lépést kezelő tevékenységre mutat.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-134">One solution is to have an error link pointing to an activity that handles step one.</span></span> <span data-ttu-id="bcd8c-135">A **Write-Warning** parancsmagot például összekapcsolhatja a 2. lépéshez szükséges tevékenységgel, például a **Start-AzureRmAutomationRunbook** parancsmaggal.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-135">For example, you could connect the **Write-Warning** cmdlet to an activity for step two, such as the **Start-AzureRmAutomationRunbook** cmdlet.</span></span>

<span data-ttu-id="bcd8c-136">Ezt a viselkedést a további runbookokban való használat céljából általánosíthatja is, ha a két tevékenységet külön hibakezelési runbookba helyezi a korábban ajánlott útmutatás szerint.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following the guidance suggested earlier.</span></span> <span data-ttu-id="bcd8c-137">A hibakezelési runbook meghívása előtt egyéni üzenetet hozhat létre az eredeti runbook adataiból, majd paraméterként továbbviheti azt a hibakezelési runbookba.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-137">Before calling this error-handling runbook, you could construct a custom message from the data in the original runbook, and then pass it as a parameter to the error-handling runbook.</span></span>

## <a name="how-to-use-error-handling"></a><span data-ttu-id="bcd8c-138">A hibakezelés használata</span><span class="sxs-lookup"><span data-stu-id="bcd8c-138">How to use error handling</span></span>

<span data-ttu-id="bcd8c-139">Minden tevékenység rendelkezik a kivételeket nem megszakító hibákká módosító konfigurációval.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span></span> <span data-ttu-id="bcd8c-140">Alapértelmezés szerint ez a beállítás le van tiltva.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-140">By default, this setting is disabled.</span></span> <span data-ttu-id="bcd8c-141">Javasoljuk, hogy engedélyezze ezt a beállítást minden olyan tevékenységnél, amely esetében kezelni szeretné a hibákat.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-141">We recommend that you enable this setting on any activity where you want to handle errors.</span></span>  

<span data-ttu-id="bcd8c-142">A konfiguráció engedélyezésével biztosíthatja, hogy a tevékenységben mind a megszakítást okozó, mind a megszakítást nem okozó hibákat megszakítást nem okozó hibaként kezelje a rendszer, amelyeket hibahivatkozás segítségével kezelhet.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in the activity are handled as non-terminating errors, and can be handled with an error link.</span></span>  

<span data-ttu-id="bcd8c-143">A konfiguráció beállítását követően hozza létre a hiba kezelésére irányuló tevékenységet.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-143">After configuring this setting, you create an activity that handles the error.</span></span> <span data-ttu-id="bcd8c-144">Ha egy tevékenység hibát eredményez, akkor a rendszer a kimenti hibahivatkozásokat követi a szokásos hivatkozások helyett, még akkor is, ha a tevékenység normál kimenetet is eredményez.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-144">If an activity produces any error, then the outgoing error links are followed, and the regular links are not, even if the activity produces regular output as well.</span></span><br><br> ![Példa egy Automation runbook hibahivatkozásra](media/automation-runbook-graphical-error-handling/error-link-example.png)

<span data-ttu-id="bcd8c-146">Az alábbi példában egy runbook egy virtuális gép számítógép nevét tartalmazó változót ad vissza.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-146">In the following example, a runbook retrieves a variable that contains the computer name of a virtual machine.</span></span> <span data-ttu-id="bcd8c-147">Ezután a következő tevékenységgel megkísérli a virtuális gép elindítását.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-147">It then attempts to start the virtual machine with the next activity.</span></span><br><br> ![Példa egy Automation runbook hibakezelésére](media/automation-runbook-graphical-error-handling/runbook-example-error-handling.png)<br><br>      

<span data-ttu-id="bcd8c-149">A **Get-AutomationVariable** tevékenység és a **Start-AzureRmVm** a kivételek hibákká történő konvertálására vannak konfigurálva.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-149">The **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured to convert exceptions to errors.</span></span>  <span data-ttu-id="bcd8c-150">Ha probléma adódik a változó lekérésével vagy a virtuális gép indításával, akkor hiba jön létre.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-150">If there are problems getting the variable or starting the VM, then errors are generated.</span></span><br><br> <span data-ttu-id="bcd8c-151">![Egy Automation runbook hibakezelési tevékenységének beállításai](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span><span class="sxs-lookup"><span data-stu-id="bcd8c-151">![Automation runbook error-handling activity settings](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span></span>

<span data-ttu-id="bcd8c-152">Az ezen tevékenységekből származó hibahivatkozások egyetlen **hibakezelés** tevékenységbe (kóddal végzett tevékenység) áramlanak.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-152">Error links flow from these activities to a single **error management** activity (a code activity).</span></span> <span data-ttu-id="bcd8c-153">Ez a tevékenység egy egyszerű PowerShell-kifejezéssel van konfigurálva, amely a *Throw* (eldobás) kulcsszó használatával leállítja a feldolgozást, az *$Error.Exception.Message* segítségével pedig lekéri az aktuális kivételt leíró üzenetet.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-153">This activity is configured with a simple PowerShell expression that uses the *Throw* keyword to stop processing, along with *$Error.Exception.Message* to get the message that describes the current exception.</span></span><br><br> <span data-ttu-id="bcd8c-154">![Példa egy Automation runbook hibakezelési kódra](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span><span class="sxs-lookup"><span data-stu-id="bcd8c-154">![Automation runbook error-handling code example](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span></span>


## <a name="next-steps"></a><span data-ttu-id="bcd8c-155">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="bcd8c-155">Next steps</span></span>

* <span data-ttu-id="bcd8c-156">További információk a hivatkozásokról és a grafikus runbookokban szereplő hivatkozástípusokról: [Grafikus létrehozás az Azure Automationben](automation-graphical-authoring-intro.md#links-and-workflow).</span><span class="sxs-lookup"><span data-stu-id="bcd8c-156">To learn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span></span>

* <span data-ttu-id="bcd8c-157">A runbook végrehajtásával, a runbook-feladatok figyelésével, illetve az egyéb technikai részletekkel kapcsolatos további tudnivalókat a [Runbook-feladatok nyomon követése](automation-runbook-execution.md) című rész tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="bcd8c-157">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>
