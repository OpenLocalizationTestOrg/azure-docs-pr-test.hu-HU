---
title: "Az első Azure Automation PowerShell-runbookom | Microsoft Docs"
description: "Ez az oktatóanyag bemutatja egy egyszerű PowerShell-forgatókönyv létrehozását, tesztelését és közzétételét."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "azure powershell, powershell-szkript oktatóanyag, powershell automation"
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;sngun
ms.openlocfilehash: 4b32011b72acc647d4af44bb5ccbcaab408fb4d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="54d80-104">Az első PowerShell-forgatókönyvem</span><span class="sxs-lookup"><span data-stu-id="54d80-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="54d80-105">Grafikus</span><span class="sxs-lookup"><span data-stu-id="54d80-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="54d80-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="54d80-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="54d80-107">PowerShell-munkafolyamat</span><span class="sxs-lookup"><span data-stu-id="54d80-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="54d80-108">Ez az oktatóanyag bemutatja, hogyan hozhat létre az Azure Automationben egy [PowerShell-forgatókönyvet](automation-runbook-types.md#powershell-runbooks).</span><span class="sxs-lookup"><span data-stu-id="54d80-108">This tutorial walks you through the creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="54d80-109">Egy egyszerű runbookkal kezdünk, amelyet tesztelünk és közzé is teszünk, és bemutatjuk a runbook állapotának nyomon követését is.</span><span class="sxs-lookup"><span data-stu-id="54d80-109">We start with a simple runbook that we test and publish while we explain how to track the status of the runbook job.</span></span> <span data-ttu-id="54d80-110">Ezután módosítjuk a runbookot, hogy ténylegesen kezeljen Azure-erőforrásokat, ebben az esetben elindítson egy Azure-beli virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="54d80-110">Then we modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="54d80-111">Végül még robusztusabbá tesszük a runbookot, és runbook-paramétereket adunk hozzá.</span><span class="sxs-lookup"><span data-stu-id="54d80-111">Lastly, we make the runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="54d80-112">Előfeltételek</span><span class="sxs-lookup"><span data-stu-id="54d80-112">Prerequisites</span></span>
<span data-ttu-id="54d80-113">Az oktatóanyag teljesítéséhez a következőkre lesz szüksége:</span><span class="sxs-lookup"><span data-stu-id="54d80-113">To complete this tutorial, you need the following:</span></span>

* <span data-ttu-id="54d80-114">Egy Azure-előfizetés.</span><span class="sxs-lookup"><span data-stu-id="54d80-114">Azure subscription.</span></span> <span data-ttu-id="54d80-115">Ha még nem rendelkezik fiókkal, [aktiválhatja MSDN-előfizetői előnyeit](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/), illetve <a href="/pricing/free-account/" target="_blank">[regisztrálhat egy ingyenes fiókot](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="54d80-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="54d80-116">[Automation-fiók](automation-sec-configure-azure-runas-account.md) a forgatókönyv tárolásához és az Azure erőforrásokban való hitelesítéshez.</span><span class="sxs-lookup"><span data-stu-id="54d80-116">[Automation account](automation-sec-configure-azure-runas-account.md) to hold the runbook and authenticate to Azure resources.</span></span>  <span data-ttu-id="54d80-117">Ennek a fióknak jogosultsággal kell rendelkeznie a virtuális gép elindításához és leállításához.</span><span class="sxs-lookup"><span data-stu-id="54d80-117">This account must have permission to start and stop the virtual machine.</span></span>
* <span data-ttu-id="54d80-118">Egy Azure virtuális gép.</span><span class="sxs-lookup"><span data-stu-id="54d80-118">An Azure virtual machine.</span></span> <span data-ttu-id="54d80-119">Ezt a gépet leállítjuk és elindítjuk, tehát ne olyan virtuális gépet használjon, amely élesben működik.</span><span class="sxs-lookup"><span data-stu-id="54d80-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="54d80-120">1. lépés – Új forgatókönyv létrehozása</span><span class="sxs-lookup"><span data-stu-id="54d80-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="54d80-121">Először egy egyszerű forgatókönyvet hozunk létre, amely a *Hello World* szöveget adja vissza.</span><span class="sxs-lookup"><span data-stu-id="54d80-121">We'll start by creating a simple runbook that outputs the text *Hello World*.</span></span>

1. <span data-ttu-id="54d80-122">Az Azure Portalon nyissa meg az Automation-fiókját.</span><span class="sxs-lookup"><span data-stu-id="54d80-122">In the Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="54d80-123">Az Automation-fiók oldala gyors áttekintést nyújt a fiókban levő erőforrásokról.</span><span class="sxs-lookup"><span data-stu-id="54d80-123">The Automation account page gives you a quick view of the resources in this account.</span></span> <span data-ttu-id="54d80-124">Valószínűleg már rendelkezik adategységekkel.</span><span class="sxs-lookup"><span data-stu-id="54d80-124">You should already have some assets.</span></span> <span data-ttu-id="54d80-125">Ezek nagy része az új Automation-fiókhoz automatikusan hozzáadott modul.</span><span class="sxs-lookup"><span data-stu-id="54d80-125">Most of those are the modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="54d80-126">Rendelkeznie kell az [előfeltételek](#prerequisites) között említett hitelesítő adategységgel is.</span><span class="sxs-lookup"><span data-stu-id="54d80-126">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="54d80-127">Kattintson a **Runbookok** csempére a forgatókönyvek listájának megnyitásához.</span><span class="sxs-lookup"><span data-stu-id="54d80-127">Click the **Runbooks** tile to open the list of runbooks.</span></span><br><br> <span data-ttu-id="54d80-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span></span>  
3. <span data-ttu-id="54d80-129">Hozzon létre egy új runbookot a **Forgatókönyv hozzáadása**, majd az **Új forgatókönyv létrehozása** elemre kattintva.</span><span class="sxs-lookup"><span data-stu-id="54d80-129">Create a new runbook by clicking the **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="54d80-130">Adja a forgatókönyvnek a *MyFirstRunbook-PowerShell* nevet.</span><span class="sxs-lookup"><span data-stu-id="54d80-130">Give the runbook the name *MyFirstRunbook-PowerShell*.</span></span>
5. <span data-ttu-id="54d80-131">Ebben az esetben egy [PowerShell-forgatókönyvet](automation-runbook-types.md#powershell-runbooks) hozunk létre, ezért a **Forgatókönyv típusának** válassza a **PowerShell** lehetőséget.</span><span class="sxs-lookup"><span data-stu-id="54d80-131">In this case, we're going to create a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span><br><br> <span data-ttu-id="54d80-132">![Runbook típusa](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span></span>  
6. <span data-ttu-id="54d80-133">A forgatókönyv létrehozásához és a szöveges szerkesztő megnyitásához kattintson a **Létrehozás** gombra.</span><span class="sxs-lookup"><span data-stu-id="54d80-133">Click **Create** to create the runbook and open the textual editor.</span></span>

## <a name="step-2---add-code-to-the-runbook"></a><span data-ttu-id="54d80-134">2. lépés – Kód hozzáadása a forgatókönyvhöz</span><span class="sxs-lookup"><span data-stu-id="54d80-134">Step 2 - Add code to the runbook</span></span>
<span data-ttu-id="54d80-135">Beírhat közvetlenül a forgatókönyvbe kódot, vagy választhat parancsmagokat, forgatókönyveket és adategységeket a Könyvtár vezérlőből, majd hozzáadhatja őket a forgatókönyvhöz a kapcsolódó paraméterekkel együtt.</span><span class="sxs-lookup"><span data-stu-id="54d80-135">You can either type code directly into the runbook, or you can select cmdlets, runbooks, and assets from the Library control and have them added to the runbook with any related parameters.</span></span> <span data-ttu-id="54d80-136">Ebben a bemutatóban közvetlenül a runbookba írunk.</span><span class="sxs-lookup"><span data-stu-id="54d80-136">For this walkthrough, we type directly in the runbook.</span></span>

1. <span data-ttu-id="54d80-137">A forgatókönyvünk jelenleg üres, írja be a következőt: *Write-Output "Hello World."*.</span><span class="sxs-lookup"><span data-stu-id="54d80-137">Our runbook is currently empty, type *Write-Output "Hello World."*.</span></span><br><br> <span data-ttu-id="54d80-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="54d80-139">A **Mentés** gombra kattintva mentse el a forgatókönyvet.</span><span class="sxs-lookup"><span data-stu-id="54d80-139">Save the runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="54d80-140">![Mentés gomb](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-140">![Save Button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span></span>  

## <a name="step-3---test-the-runbook"></a><span data-ttu-id="54d80-141">3. lépés – A forgatókönyv tesztelése</span><span class="sxs-lookup"><span data-stu-id="54d80-141">Step 3 - Test the runbook</span></span>
<span data-ttu-id="54d80-142">Mielőtt közzétesszük a forgatókönyvet, hogy éles üzemben is elérhető legyen, tesztelnünk kell, hogy biztosan jól működik-e.</span><span class="sxs-lookup"><span data-stu-id="54d80-142">Before we publish the runbook to make it available in production, we want to test it to make sure that it works properly.</span></span> <span data-ttu-id="54d80-143">Egy forgatókönyv tesztelésekor a **Piszkozat** verziót futtatja, és interaktív módon megtekinti a kimenetét.</span><span class="sxs-lookup"><span data-stu-id="54d80-143">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="54d80-144">Kattintson a **Teszt panelre** a Teszt panel megnyitásához.</span><span class="sxs-lookup"><span data-stu-id="54d80-144">Click **Test pane** to open the Test pane.</span></span><br><br> <span data-ttu-id="54d80-145">![Teszt panel](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span></span>  
2. <span data-ttu-id="54d80-146">Kattintson az **Indítás** gombra a teszt elindításához.</span><span class="sxs-lookup"><span data-stu-id="54d80-146">Click **Start** to start the test.</span></span> <span data-ttu-id="54d80-147">Elvileg ez az egyetlen engedélyezett lehetőség.</span><span class="sxs-lookup"><span data-stu-id="54d80-147">This should be the only enabled option.</span></span>
3. <span data-ttu-id="54d80-148">Létrejön egy [forgatókönyv-feladat](automation-runbook-execution.md), és megjelenik annak állapota.</span><span class="sxs-lookup"><span data-stu-id="54d80-148">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="54d80-149">A feladat állapota kezdetben *Várólistán*. Ez azt jelöli, hogy egy felhőben lévő runbook-feldolgozó elérhetővé válására vár.</span><span class="sxs-lookup"><span data-stu-id="54d80-149">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to come available.</span></span> <span data-ttu-id="54d80-150">Ezután *Indítás* állapotúra változik, ha egy feldolgozó elvállalja a feladatot, majd *Fut* állapotúra, amikor a forgatókönyv elkezd futni.</span><span class="sxs-lookup"><span data-stu-id="54d80-150">It will then move to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span></span>  
4. <span data-ttu-id="54d80-151">Amikor a forgatókönyv feladat befejeződik, megjelenik a kimenete.</span><span class="sxs-lookup"><span data-stu-id="54d80-151">When the runbook job completes, its output is displayed.</span></span> <span data-ttu-id="54d80-152">A mi esetünkben ez a következő: *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="54d80-152">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="54d80-153">![Teszt panel kimenete](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-153">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
5. <span data-ttu-id="54d80-154">A vászonra való visszatéréshez zárja be a Teszt panelt.</span><span class="sxs-lookup"><span data-stu-id="54d80-154">Close the Test pane to return to the canvas.</span></span>

## <a name="step-4---publish-and-start-the-runbook"></a><span data-ttu-id="54d80-155">4. lépés: Közzététel és a forgatókönyv indítása</span><span class="sxs-lookup"><span data-stu-id="54d80-155">Step 4 - Publish and start the runbook</span></span>
<span data-ttu-id="54d80-156">A létrehozott runbook még mindig Piszkozat módban van.</span><span class="sxs-lookup"><span data-stu-id="54d80-156">The runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="54d80-157">Az üzemi környezetben való futtatás előtt közzé kell tennünk.</span><span class="sxs-lookup"><span data-stu-id="54d80-157">We need to publish it before we can run it in production.</span></span>  <span data-ttu-id="54d80-158">Amikor elérhetővé tesz egy forgatókönyvet, felülírja a Közzétett verziót a Piszkozattal.</span><span class="sxs-lookup"><span data-stu-id="54d80-158">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span></span>  <span data-ttu-id="54d80-159">Az esetünkben még nincs Közzétett verzió, mivel még csak most hoztuk létre a forgatókönyvet.</span><span class="sxs-lookup"><span data-stu-id="54d80-159">In our case, we don't have a Published version yet because we just created the runbook.</span></span>

1. <span data-ttu-id="54d80-160">A forgatókönyv közzétételéhez kattintson a **Közzététel** lehetőségre, és ha a rendszer kéri, kattintson az **Igen** gombra.</span><span class="sxs-lookup"><span data-stu-id="54d80-160">Click **Publish** to publish the runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="54d80-161">![Közzététel gomb](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-161">![Publish button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span></span>  
2. <span data-ttu-id="54d80-162">Ha most balra görgetve megtekinti a forgatókönyvet a **Forgatókönyvek** panelen, a **Közzétett** **Szerzői állapot** jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="54d80-162">If you scroll left to view the runbook in the **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="54d80-163">Görgessen vissza jobbra a **MyFirstRunbook-PowerShell** panel megtekintéséhez.</span><span class="sxs-lookup"><span data-stu-id="54d80-163">Scroll back to the right to view the pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="54d80-164">A felül látható lehetőségekkel elindíthatjuk és megtekinthetjük a runbookot, ütemezhetjük egy későbbi időpontban való indításra, vagy létrehozhatunk egy [webhookot](automation-webhooks.md), amely segítségével elindítható a runbook egy HTTP-hívással.</span><span class="sxs-lookup"><span data-stu-id="54d80-164">The options across the top allow us to start the runbook, view the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="54d80-165">Most csak el szeretnénk indítani a runbookot, tehát kattintson az **Indítás**, majd, amikor a Runbook indítása panel megnyílik, kattintson az **OK** gombra.</span><span class="sxs-lookup"><span data-stu-id="54d80-165">We want to start the runbook, so click **Start** and then click **Ok** when the Start Runbook blade opens.</span></span><br><br> <span data-ttu-id="54d80-166">![Indítás gomb](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-166">![Start button](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span></span><br>    
5. <span data-ttu-id="54d80-167">Megnyílik egy feladatpanel a létrehozott runbook-feladathoz.</span><span class="sxs-lookup"><span data-stu-id="54d80-167">A job pane is opened for the runbook job that we created.</span></span> <span data-ttu-id="54d80-168">Ezt a panelt bezárhatjuk, de ebben az esetben nyitva hagyjuk, hogy lássuk a feladat előrehaladását.</span><span class="sxs-lookup"><span data-stu-id="54d80-168">We can close this pane, but in this case we leave it open so we can watch the job's progress.</span></span>
6. <span data-ttu-id="54d80-169">A feladat állapota a **Feladat összegzése** területen látszik, és megfelel a korábban, a forgatókönyv tesztelésekor látott állapotoknak.</span><span class="sxs-lookup"><span data-stu-id="54d80-169">The job status is shown in **Job Summary** and matches the statuses that we saw when we tested the runbook.</span></span><br><br> <span data-ttu-id="54d80-170">![Feladat összegzése](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-170">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="54d80-171">Ha a forgatókönyv a *Befejezve* állapotot mutatja, kattintson a **Kimenet** lehetőségre.</span><span class="sxs-lookup"><span data-stu-id="54d80-171">Once the runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="54d80-172">A Kimenet panel megnyílik, és megjelenik a *Hello World* feliratunk.</span><span class="sxs-lookup"><span data-stu-id="54d80-172">The Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="54d80-173">![Feladat kimenete](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-173">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="54d80-174">Zárja be a Kimenet panelt.</span><span class="sxs-lookup"><span data-stu-id="54d80-174">Close the Output pane.</span></span>
9. <span data-ttu-id="54d80-175">A forgatókönyv-feladathoz tartozó Streamek panel megnyitásához kattintson **Az összes napló** lehetőségre.</span><span class="sxs-lookup"><span data-stu-id="54d80-175">Click **All Logs** to open the Streams pane for the runbook job.</span></span> <span data-ttu-id="54d80-176">A kimeneti streamben csak a *Hello World* eredményt látjuk, de ez megjeleníthet egyéb streameket is egy forgatókönyv feladatból, mint a Részletes vagy a Hiba, ha a forgatókönyv ezekbe ír.</span><span class="sxs-lookup"><span data-stu-id="54d80-176">We should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span></span><br><br> <span data-ttu-id="54d80-177">![Minden napló](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-177">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="54d80-178">A MyFirstRunbook-PowerShell panelre való visszatéréshez zárja be a Streamek és a Feladat panelt.</span><span class="sxs-lookup"><span data-stu-id="54d80-178">Close the Streams pane and the Job pane to return to the MyFirstRunbook-PowerShell pane.</span></span>
11. <span data-ttu-id="54d80-179">A forgatókönyv Feladatok paneljének megnyitásához kattintson a **Feladatok** lehetőségre.</span><span class="sxs-lookup"><span data-stu-id="54d80-179">Click **Jobs** to open the Jobs pane for this runbook.</span></span> <span data-ttu-id="54d80-180">Ez felsorolja az összes, a forgatókönyv által létrehozott feladatot.</span><span class="sxs-lookup"><span data-stu-id="54d80-180">This lists all of the jobs created by this runbook.</span></span> <span data-ttu-id="54d80-181">Egy feladat csak egyszer szerepel a listán, mert csak egyszer futtattuk a feladatot.</span><span class="sxs-lookup"><span data-stu-id="54d80-181">We should only see one job listed since we only ran the job once.</span></span><br><br> <span data-ttu-id="54d80-182">![Feladatlista](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-182">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="54d80-183">Erre a feladatra kattintva megnyithatja ugyanazt a Feladat panelt, amelyet már láttunk a runbook elindításakor.</span><span class="sxs-lookup"><span data-stu-id="54d80-183">You can click this job to open the same Job pane that we viewed when we started the runbook.</span></span> <span data-ttu-id="54d80-184">Ez lehetővé teszi, hogy az időben visszamenve megtekintse egy adott forgatókönyvhöz létrehozott összes feladat részleteit.</span><span class="sxs-lookup"><span data-stu-id="54d80-184">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-to-manage-azure-resources"></a><span data-ttu-id="54d80-185">5. lépés – Hitelesítés hozzáadása az Azure-erőforrások kezeléséhez</span><span class="sxs-lookup"><span data-stu-id="54d80-185">Step 5 - Add authentication to manage Azure resources</span></span>
<span data-ttu-id="54d80-186">Most már teszteltük és közzétettük a forgatókönyvet, de még nem csinál semmi hasznosat.</span><span class="sxs-lookup"><span data-stu-id="54d80-186">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="54d80-187">Azt szeretnénk, hogy Azure-erőforrásokat kezeljen.</span><span class="sxs-lookup"><span data-stu-id="54d80-187">We want to have it manage Azure resources.</span></span> <span data-ttu-id="54d80-188">Erre nem lesz képes egészen addig, amíg nem végez hitelesítést az [előfeltételek](#prerequisites) között említett hitelesítő adatokkal.</span><span class="sxs-lookup"><span data-stu-id="54d80-188">It won't be able to do that though unless we have it authenticate using the credentials that are referred to in the [prerequisites](#prerequisites).</span></span> <span data-ttu-id="54d80-189">Ezt az **Add-AzureRMAccount** parancsmaggal hajtjuk végre.</span><span class="sxs-lookup"><span data-stu-id="54d80-189">We do that with the **Add-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="54d80-190">Kattintson a MyFirstRunbook-PowerShell panel **Szerkesztés** gombjára szöveges szerkesztő megnyitásához.</span><span class="sxs-lookup"><span data-stu-id="54d80-190">Open the textual editor by clicking **Edit** on the MyFirstRunbook-PowerShell pane.</span></span><br><br> <span data-ttu-id="54d80-191">![Runbook szerkesztése](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-191">![Edit Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span></span><br>   
2. <span data-ttu-id="54d80-192">A **Write-Output** sorra már nincs szükségünk, így ezt kitörölheti.</span><span class="sxs-lookup"><span data-stu-id="54d80-192">We don't need the **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="54d80-193">Írja be, vagy másolja és illessze be a következő kódot, amely kezeli a hitelesítést az Automation futtató fiókjával:</span><span class="sxs-lookup"><span data-stu-id="54d80-193">Type or copy and paste the following code that handles the authentication with your Automation Run As account:</span></span>
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
   <br>
4. <span data-ttu-id="54d80-194">Kattintson a **Teszt panel** elemre, hogy tesztelhessük forgatókönyvet.</span><span class="sxs-lookup"><span data-stu-id="54d80-194">Click **Test pane** so that we can test the runbook.</span></span>
5. <span data-ttu-id="54d80-195">Kattintson az **Indítás** gombra a teszt elindításához.</span><span class="sxs-lookup"><span data-stu-id="54d80-195">Click **Start** to start the test.</span></span> <span data-ttu-id="54d80-196">Ha kész, a kimenetnek a fiókja alapvető adatait kell megjelenítenie, a következőhöz hasonló módon.</span><span class="sxs-lookup"><span data-stu-id="54d80-196">Once it completes, you should receive output similar to the following, displaying basic information from your account.</span></span> <span data-ttu-id="54d80-197">Ez ellenőrzi, hogy érvényes-e a hitelesítő adat.</span><span class="sxs-lookup"><span data-stu-id="54d80-197">This confirms that the credential is valid.</span></span><br><br> <span data-ttu-id="54d80-198">![Hitelesítés](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-198">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-to-start-a-virtual-machine"></a><span data-ttu-id="54d80-199">6. lépés: Kód hozzáadása a virtuális gép indításához</span><span class="sxs-lookup"><span data-stu-id="54d80-199">Step 6 - Add code to start a virtual machine</span></span>
<span data-ttu-id="54d80-200">Most, hogy a forgatókönyv hitelesítést végez az Azure-előfizetésünkön, kezelhetjük az erőforrásokat.</span><span class="sxs-lookup"><span data-stu-id="54d80-200">Now that our runbook is authenticating to our Azure subscription, we can manage resources.</span></span> <span data-ttu-id="54d80-201">Hozzáadunk egy parancsot a virtuális gép elindítására.</span><span class="sxs-lookup"><span data-stu-id="54d80-201">We add a command to start a virtual machine.</span></span> <span data-ttu-id="54d80-202">Kiválaszthatja az Azure-előfizetésében lévő bármelyik virtuális gépet, és most szoftveresen rögzítjük ezt a nevet a runbookban.</span><span class="sxs-lookup"><span data-stu-id="54d80-202">You can pick any virtual machine in your Azure subscription, and for now we will hardcode that name in the runbook.</span></span>

1. <span data-ttu-id="54d80-203">Az *Add-AzureRmAccount* után írja be a következőt: *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'*. Ezzel megadja az elindítani kívánt virtuális gép nevét, valamint az erőforráscsoportjának nevét.</span><span class="sxs-lookup"><span data-stu-id="54d80-203">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing the name and Resource Group name of the virtual machine to start.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="54d80-204">Mentse a forgatókönyvet, majd kattintson a **Teszt panel** elemre, hogy tesztelhessük.</span><span class="sxs-lookup"><span data-stu-id="54d80-204">Save the runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="54d80-205">Kattintson az **Indítás** gombra a teszt elindításához.</span><span class="sxs-lookup"><span data-stu-id="54d80-205">Click **Start** to start the test.</span></span> <span data-ttu-id="54d80-206">Ha kész, ellenőrizze, hogy a virtuális gép elindult-e.</span><span class="sxs-lookup"><span data-stu-id="54d80-206">Once it completes, check that the virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-to-the-runbook"></a><span data-ttu-id="54d80-207">7. lépés – Bemeneti paraméter hozzáadása a forgatókönyvhöz</span><span class="sxs-lookup"><span data-stu-id="54d80-207">Step 7 - Add an input parameter to the runbook</span></span>
<span data-ttu-id="54d80-208">A runbookunk jelenleg elindítja a runbookban szoftveresen rögzített virtuális gépet, de hasznosabb lenne, ha meg tudnánk adni a virtuális gépet a runbook elindulásakor.</span><span class="sxs-lookup"><span data-stu-id="54d80-208">Our runbook currently starts the virtual machine that we hardcoded in the runbook, but it would be more useful if we specify the virtual machine when the runbook is started.</span></span> <span data-ttu-id="54d80-209">Most hozzáadunk bemeneti paramétereket a forgatókönyvhöz, amelyek biztosítják ezt a működést.</span><span class="sxs-lookup"><span data-stu-id="54d80-209">We will now add input parameters to the runbook to provide that functionality.</span></span>

1. <span data-ttu-id="54d80-210">Adja hozzá a *VMName* és a *ResourceGroupName* paramétereket a forgatókönyvhöz, és használja ezeket a változókat a **Start-AzureRmVM** parancsmaggal, amint az az alábbi példában látható.</span><span class="sxs-lookup"><span data-stu-id="54d80-210">Add parameters for *VMName* and *ResourceGroupName* to the runbook and use these variables with the **Start-AzureRmVM** cmdlet as in the example below.</span></span>  
   
   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
2. <span data-ttu-id="54d80-211">Mentse a forgatókönyvet, és nyissa meg a Teszt panelt.</span><span class="sxs-lookup"><span data-stu-id="54d80-211">Save the runbook and open the Test pane.</span></span> <span data-ttu-id="54d80-212">Most már megadhat értékeket a teszt során használt két bemeneti változóhoz.</span><span class="sxs-lookup"><span data-stu-id="54d80-212">You can now provide values for the two input variables that are used in the test.</span></span>
3. <span data-ttu-id="54d80-213">Zárja be a Teszt panelt.</span><span class="sxs-lookup"><span data-stu-id="54d80-213">Close the Test pane.</span></span>
4. <span data-ttu-id="54d80-214">A forgatókönyv új verziójának közzétételéhez kattintson a **Közzététel** lehetőségre.</span><span class="sxs-lookup"><span data-stu-id="54d80-214">Click **Publish** to publish the new version of the runbook.</span></span>
5. <span data-ttu-id="54d80-215">Állítsa le az előző lépésben elindított virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="54d80-215">Stop the virtual machine that you started in the previous step.</span></span>
6. <span data-ttu-id="54d80-216">Kattintson az **Indítás** gombra a forgatókönyv elindításához.</span><span class="sxs-lookup"><span data-stu-id="54d80-216">Click **Start** to start the runbook.</span></span> <span data-ttu-id="54d80-217">Írja be a **VMName** és a **ResourceGroupName** értéket az elindítani kívánt virtuális géphez.</span><span class="sxs-lookup"><span data-stu-id="54d80-217">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span></span><br><br> <span data-ttu-id="54d80-218">![Paraméter átadása](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="54d80-218">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="54d80-219">Ha a forgatókönyv kész, ellenőrizze, hogy a virtuális gép elindult-e.</span><span class="sxs-lookup"><span data-stu-id="54d80-219">When the runbook completes, check that the virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="54d80-220">Eltérések a PowerShell-munkafolyamattól</span><span class="sxs-lookup"><span data-stu-id="54d80-220">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="54d80-221">A PowerShell-runbookok életciklusa, képességei és felügyelete megegyezik a PowerShell-alapú munkafolyamat-runbookokéval, de van néhány eltérés és korlátozás:</span><span class="sxs-lookup"><span data-stu-id="54d80-221">PowerShell runbooks have the same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="54d80-222">A PowerShell-forgatókönyvek a munkafolyamat-forgatókönyvekhez képest gyorsabban futnak, mert nem szerepel bennük a fordítási lépés.</span><span class="sxs-lookup"><span data-stu-id="54d80-222">PowerShell runbooks run fast compared to PowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="54d80-223">A PowerShell-alapú munkafolyamat-forgatókönyvek támogatják az ellenőrzőpontokat, és az ellenőrzőpontok segítségével a PowerShell-alapú munkafolyamat-forgatókönyvek a forgatókönyv bármely pontjától folytathatók, ezzel szemben egy PowerShell-forgatókönyv csak az elejéről indítható újra.</span><span class="sxs-lookup"><span data-stu-id="54d80-223">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in the runbook whereas PowerShell runbooks can only resume from the beginning.</span></span>
3. <span data-ttu-id="54d80-224">A PowerShell-alapú munkafolyamat-forgatókönyvek támogatják a párhuzamos és soros végrehajtást is, míg a PowerShell-forgatókönyvek csak sorosan képesek végrehajtani a parancsokat.</span><span class="sxs-lookup"><span data-stu-id="54d80-224">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="54d80-225">Egy PowerShell-alapú munkafolyamat-runbookban egy tevékenység-, parancs- vagy parancsfájlblokk rendelkezhet saját futási térrel, míg a PowerShell-runbookokban minden parancsfájl egyetlen futási térben fut.</span><span class="sxs-lookup"><span data-stu-id="54d80-225">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="54d80-226">Van néhány [szintaktikai eltérés](https://technet.microsoft.com/magazine/dn151046.aspx) is a natív PowerShell-forgatókönyvek és a PowerShell-alapú munkafolyamat-forgatókönyvek között.</span><span class="sxs-lookup"><span data-stu-id="54d80-226">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="54d80-227">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="54d80-227">Next steps</span></span>
* <span data-ttu-id="54d80-228">A grafikus forgatókönyvekkel való ismerkedéshez tekintse meg a következőt: [Az első grafikus forgatókönyvem](automation-first-runbook-graphical.md).</span><span class="sxs-lookup"><span data-stu-id="54d80-228">To get started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="54d80-229">A PowerShell-alapú munkafolyamat-forgatókönyvekkel való ismerkedéshez tekintse meg a következőt: [Az első PowerShell-alapú munkafolyamat-forgatókönyvem](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="54d80-229">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="54d80-230">További információk a forgatókönyvek típusairól, az előnyeikről és a korlátaikról: [Az Azure Automation forgatókönyveinek típusai](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="54d80-230">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="54d80-231">További információk a PowerShell-parancsprogramok támogatásáról: [PowerShell-parancsprogramok natív támogatása az Azure Automationben](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="54d80-231">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

