---
title: "felhő adatbázisok aaaDistributed tranzakcióiból"
description: "Az Azure SQL Database rugalmas adatbázis-tranzakciók áttekintése"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: 9a18f2749108d337bf115b3dc21dd0c7828dd9c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="b9bab-103">Elosztott tranzakciók több felhőalapú adatbázisban</span><span class="sxs-lookup"><span data-stu-id="b9bab-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="b9bab-104">Az Azure SQL Database (SQL-adatbázis a) rugalmas adatbázis-tranzakciók engedélyezése toorun tranzakciók, amelyek több adatbázisok SQL DB több.</span><span class="sxs-lookup"><span data-stu-id="b9bab-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you toorun transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="b9bab-105">Az SQL Database rugalmas adatbázis tranzakciók érhetők el a .NET-alkalmazásokban ADO .NET használatával, és hello megszokott programozási környezetet hello segítségével integrálja [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) osztályok.</span><span class="sxs-lookup"><span data-stu-id="b9bab-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with hello familiar programming experience using hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="b9bab-106">tooget hello könyvtár, lásd: [.NET-keretrendszer 4.6.1 (webes telepítő)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="b9bab-106">tooget hello library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="b9bab-107">A helyszíni ilyen esetben általában szükséges fut a Microsoft elosztott tranzakciók koordinátora (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="b9bab-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="b9bab-108">Platform,--szolgáltatás alkalmazás az Azure-ban MSDTC nem érhető el, mert hello képességét toocoordinate elosztott tranzakciók mostantól közvetlenül integrálva lett SQL-adatbázis.</span><span class="sxs-lookup"><span data-stu-id="b9bab-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, hello ability toocoordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="b9bab-109">Alkalmazások csatlakozhat tooany SQL-adatbázis toolaunch elosztott tranzakciók, valamint hello adatbázisok közül az egyik transzparens módon összehangolják hello elosztott tranzakció, ahogy az ábra a következő hello.</span><span class="sxs-lookup"><span data-stu-id="b9bab-109">Applications can connect tooany SQL Database toolaunch distributed transactions, and one of hello databases will transparently coordinate hello distributed transaction, as shown in hello following figure.</span></span> 

  ![<span data-ttu-id="b9bab-110">Az elosztott tranzakciók az Azure SQL Database rugalmas adatbázis-tranzakció használatával</span><span class="sxs-lookup"><span data-stu-id="b9bab-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="b9bab-111">Gyakori forgatókönyvek</span><span class="sxs-lookup"><span data-stu-id="b9bab-111">Common scenarios</span></span>
<span data-ttu-id="b9bab-112">Az SQL-adatbázis a rugalmas adatbázis-tranzakciók engedélyezése alkalmazások toomake atomi módosítások toodata számos különböző SQL-adatbázisban tárolja.</span><span class="sxs-lookup"><span data-stu-id="b9bab-112">Elastic database transactions for SQL DB enable applications toomake atomic changes toodata stored in several different SQL Databases.</span></span> <span data-ttu-id="b9bab-113">hello preview ügyféloldali fejlesztés élmény a C# és .NET összpontosít.</span><span class="sxs-lookup"><span data-stu-id="b9bab-113">hello preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="b9bab-114">A T-SQL használatával kiszolgálóoldali élmény tervezünk-e egy későbbi időpontra.</span><span class="sxs-lookup"><span data-stu-id="b9bab-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="b9bab-115">A rugalmas adatbázis tranzakciók célok hello a következő esetekben:</span><span class="sxs-lookup"><span data-stu-id="b9bab-115">Elastic database transactions targets hello following scenarios:</span></span>

* <span data-ttu-id="b9bab-116">Több adatbázis-alkalmazások az Azure-ban: Ebben a forgatókönyvben az adatok függőleges particionálása SQL DB több adatbázisok között úgy, hogy a különböző típusú adatok legyen elhelyezve a különböző adatbázisokhoz.</span><span class="sxs-lookup"><span data-stu-id="b9bab-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="b9bab-117">Egyes műveletek módosítások toodata, amelyet a két vagy több adatbázis szükséges.</span><span class="sxs-lookup"><span data-stu-id="b9bab-117">Some operations require changes toodata which is kept in two or more databases.</span></span> <span data-ttu-id="b9bab-118">hello alkalmazás rugalmas adatbázis-tranzakciók toocoordinate hello változások használja az adatbázisok közötti és atomicity biztosítása.</span><span class="sxs-lookup"><span data-stu-id="b9bab-118">hello application uses elastic database transactions toocoordinate hello changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="b9bab-119">Horizontálisan skálázott adatbázis-alkalmazások az Azure-ban: Ebben a forgatókönyvben a hello adatrétegbeli használja hello [Elastic Database ügyféloldali kódtárának](sql-database-elastic-database-client-library.md) vagy önkiszolgáló-horizontális toohorizontally partíció hello adatokat az Adatbázisba az SQL több adatbázis közötti.</span><span class="sxs-lookup"><span data-stu-id="b9bab-119">Sharded database applications in Azure: With this scenario, hello data tier uses hello [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding toohorizontally partition hello data across many databases in SQL DB.</span></span> <span data-ttu-id="b9bab-120">Egy jól láthatóan elhelyezett használati eset hello kell tooperform atomi módosítások szilánkos több-bérlős alkalmazások esetén módosítások span bérlők.</span><span class="sxs-lookup"><span data-stu-id="b9bab-120">One prominent use case is hello need tooperform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="b9bab-121">Egy átvitelét egy bérlő tooanother, mind a különböző adatbázisokhoz elhelyezkedhet gondol példányhoz.</span><span class="sxs-lookup"><span data-stu-id="b9bab-121">Think for instance of a transfer from one tenant tooanother, both residing on different databases.</span></span> <span data-ttu-id="b9bab-122">A második esetben minden részletre kiterjedő horizontális tooaccommodate kapacitási igényeihez a nagy bérlőhöz, amely viszont általában azt jelenti, hogy néhány atomi műveletek igények toostretch hello használt több adatbázisok között ugyanazt a bérlői.</span><span class="sxs-lookup"><span data-stu-id="b9bab-122">A second case is fine-grained sharding tooaccommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs toostretch across several databases used for hello same tenant.</span></span> <span data-ttu-id="b9bab-123">Egy harmadik esetben az adatbázisok közötti replikált tooreference adatokat atomi frissíti.</span><span class="sxs-lookup"><span data-stu-id="b9bab-123">A third case is atomic updates tooreference data that are replicated across databases.</span></span> <span data-ttu-id="b9bab-124">Ezek a sorok mentén atomi, a tranzakciós, műveletek most is koordinált hello preview több adatbázis közötti.</span><span class="sxs-lookup"><span data-stu-id="b9bab-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using hello preview.</span></span>
  <span data-ttu-id="b9bab-125">A rugalmas adatbázis-tranzakció kétfázisú végrehajtási tooensure tranzakció atomicity használja az adatbázisok.</span><span class="sxs-lookup"><span data-stu-id="b9bab-125">Elastic database transactions use two-phase commit tooensure transaction atomicity across databases.</span></span> <span data-ttu-id="b9bab-126">Remekül beválik, ha egy tranzakción belül egyszerre legfeljebb 100 adatbázisok tranzakciók is.</span><span class="sxs-lookup"><span data-stu-id="b9bab-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="b9bab-127">Ezek nem lesz korlátozva, de egy kell látnia teljesítmény és a rugalmas adatbázis-tranzakciók toosuffer sikerességéről működés felső korlátjának túllépésekor.</span><span class="sxs-lookup"><span data-stu-id="b9bab-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions toosuffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="b9bab-128">Telepítés és áttelepítés</span><span class="sxs-lookup"><span data-stu-id="b9bab-128">Installation and migration</span></span>
<span data-ttu-id="b9bab-129">SQL Database rugalmas adatbázis-tranzakciókhoz hello képességek szolgáltatáson keresztül frissítések toohello .NET-kódtárakra System.Data.dll és System.Transactions.dll.</span><span class="sxs-lookup"><span data-stu-id="b9bab-129">hello capabilities for elastic database transactions in SQL DB are provided through updates toohello .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="b9bab-130">hello DLL-ek győződjön meg arról, hogy kétfázisú végrehajtási használatos, ahol szükséges tooensure atomicity.</span><span class="sxs-lookup"><span data-stu-id="b9bab-130">hello DLLs ensure that two-phase commit is used where necessary tooensure atomicity.</span></span> <span data-ttu-id="b9bab-131">a rugalmas adatbázis-tranzakció használó toostart fejlesztését alkalmazások telepítése [.NET-keretrendszer 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) vagy újabb verziója.</span><span class="sxs-lookup"><span data-stu-id="b9bab-131">toostart developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="b9bab-132">Amikor hello .NET-keretrendszer egy korábbi verzióját futtatja, a tranzakciók toopromote tooa elosztott tranzakció sikertelen lesz, és kivételt generál.</span><span class="sxs-lookup"><span data-stu-id="b9bab-132">When running on an earlier version of hello .NET framework, transactions will fail toopromote tooa distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="b9bab-133">A telepítés után használható hello elosztott tranzakció API-k a System.Transactions kapcsolatok tooSQL DB.</span><span class="sxs-lookup"><span data-stu-id="b9bab-133">After installation, you can use hello distributed transaction APIs in System.Transactions with connections tooSQL DB.</span></span> <span data-ttu-id="b9bab-134">Ha ezen API-k használata meglévő MSDTC alkalmazásai, egyszerűen építse újra a meglévő alkalmazások .NET 4.6 hello 4.6.1 telepítése után keretrendszer.</span><span class="sxs-lookup"><span data-stu-id="b9bab-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing hello 4.6.1 Framework.</span></span> <span data-ttu-id="b9bab-135">A projektek .NET 4.6 célként, ha azok automatikusan használja frissítése hello DLL-eket hello új keretrendszer és az elosztott tranzakciók API-hívások, valamint a kapcsolatok tooSQL DB most már sikeres lesz.</span><span class="sxs-lookup"><span data-stu-id="b9bab-135">If your projects target .NET 4.6, they will automatically use hello updated DLLs from hello new Framework version and distributed transaction API calls in combination with connections tooSQL DB will now succeed.</span></span>

<span data-ttu-id="b9bab-136">Ne feledje, hogy a rugalmas adatbázis-tranzakció szükséges MSDTC telepítése.</span><span class="sxs-lookup"><span data-stu-id="b9bab-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="b9bab-137">Rugalmas adatbázis-tranzakció ehelyett közvetlenül kezelt által és az SQL DB belül.</span><span class="sxs-lookup"><span data-stu-id="b9bab-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="b9bab-138">Ez jelentősen leegyszerűsíti az felhős rendszerekben mivel MSDTC telepítése nem szükséges toouse elosztott tranzakciók az SQL-Adatbázist.</span><span class="sxs-lookup"><span data-stu-id="b9bab-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary toouse distributed transactions with SQL DB.</span></span> <span data-ttu-id="b9bab-139">Szakasz 4 részletesebben ismerteti, hogyan toodeploy rugalmas adatbázis-tranzakció és hello kötelező .NET-keretrendszer a felhőalapú alkalmazások tooAzure együtt.</span><span class="sxs-lookup"><span data-stu-id="b9bab-139">Section 4 explains in more detail how toodeploy elastic database transactions and hello required .NET framework together with your cloud applications tooAzure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="b9bab-140">Fejlesztési felület</span><span class="sxs-lookup"><span data-stu-id="b9bab-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="b9bab-141">Több adatbázis-alkalmazások</span><span class="sxs-lookup"><span data-stu-id="b9bab-141">Multi-database applications</span></span>
<span data-ttu-id="b9bab-142">hello alábbi mintakód használ hello megszokott programozási környezetet .NET System.Transactions.</span><span class="sxs-lookup"><span data-stu-id="b9bab-142">hello following sample code uses hello familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="b9bab-143">hello TransactionScope osztály a .NET környezeti tranzakció hoz létre.</span><span class="sxs-lookup"><span data-stu-id="b9bab-143">hello TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="b9bab-144">("Környezeti tranzakció" egyike, hogy él, az aktuális szál hello.) Az összes kapcsolat megnyitni a TransactionScope-objektum hello belül hello tranzakció részt.</span><span class="sxs-lookup"><span data-stu-id="b9bab-144">(An “ambient transaction” is one that lives in hello current thread.) All connections opened within hello TransactionScope participate in hello transaction.</span></span> <span data-ttu-id="b9bab-145">Ha a különböző adatbázisokhoz, hello tranzakció automatikusan emelt szintű tooa elosztott tranzakciót.</span><span class="sxs-lookup"><span data-stu-id="b9bab-145">If different databases participate, hello transaction is automatically elevated tooa distributed transaction.</span></span> <span data-ttu-id="b9bab-146">hello tranzakció eredményét hello beállítása hello hatókör toocomplete tooindicate egy véglegesítési szabályozza.</span><span class="sxs-lookup"><span data-stu-id="b9bab-146">hello outcome of hello transaction is controlled by setting hello scope toocomplete tooindicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="b9bab-147">Horizontálisan skálázott adatbázis-alkalmazások</span><span class="sxs-lookup"><span data-stu-id="b9bab-147">Sharded database applications</span></span>
<span data-ttu-id="b9bab-148">Az SQL Database rugalmas adatbázis tranzakciók is támogatja az elosztott tranzakciók, ahol a módszert hello OpenConnectionForKey hello rugalmas adatbázis könyvtár tooopen az ügyfélkapcsolatok méretezett kimenő adatok koordinációs réteg.</span><span class="sxs-lookup"><span data-stu-id="b9bab-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use hello OpenConnectionForKey method of hello elastic database client library tooopen connections for a scaled out data tier.</span></span> <span data-ttu-id="b9bab-149">Vegye figyelembe a esetben, amikor meg kell tooguarantee egységessége módosítások több különböző horizontális értékek között.</span><span class="sxs-lookup"><span data-stu-id="b9bab-149">Consider cases where you need tooguarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="b9bab-150">Kapcsolatok toohello szilánkok hello különböző horizontális kulcsértékei futtató rendszer közvetítőalapú OpenConnectionForKey használatával.</span><span class="sxs-lookup"><span data-stu-id="b9bab-150">Connections toohello shards hosting hello different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="b9bab-151">Hello általános esetben hello kapcsolatok lehet toodifferent szilánkok úgy, hogy tranzakciós garanciák biztosítása elosztott tranzakciót igényel.</span><span class="sxs-lookup"><span data-stu-id="b9bab-151">In hello general case, hello connections can be toodifferent shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="b9bab-152">a következő példakód hello szemlélteti ezt a módszert használja.</span><span class="sxs-lookup"><span data-stu-id="b9bab-152">hello following code sample illustrates this approach.</span></span> <span data-ttu-id="b9bab-153">Azt feltételezi, hogy a shardmap nevű változóra a shard képezze le az hello elastic database ügyféloldali kódtárának használt toorepresent:</span><span class="sxs-lookup"><span data-stu-id="b9bab-153">It assumes that a variable called shardmap is used toorepresent a shard map from hello elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="b9bab-154">A .NET telepítése Azure Cloud Services csomag</span><span class="sxs-lookup"><span data-stu-id="b9bab-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="b9bab-155">Azure biztosít több ajánlatok toohost .NET-alkalmazások.</span><span class="sxs-lookup"><span data-stu-id="b9bab-155">Azure provides several offerings toohost .NET applications.</span></span> <span data-ttu-id="b9bab-156">Hello különböző ajánlatok összehasonlítása érhető el [Azure App Service, a Cloud Services és a virtuális gépek összevetése](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="b9bab-156">A comparison of hello different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="b9bab-157">Ha hello Vendég-Operációsrendszert az hello ajánlat kisebb, mint a .NET 4.6.1 rugalmas tranzakciók szükséges, akkor tooupgrade hello vendég operációs rendszer too4.6.1.</span><span class="sxs-lookup"><span data-stu-id="b9bab-157">If hello guest OS of hello offering is smaller than .NET 4.6.1 required for elastic transactions, you need tooupgrade hello guest OS too4.6.1.</span></span> 

<span data-ttu-id="b9bab-158">Az Azure App Service szolgáltatások frissíti a toohello vendég operációs rendszer jelenleg nem támogatottak.</span><span class="sxs-lookup"><span data-stu-id="b9bab-158">For Azure App Services, upgrades toohello guest OS are currently not supported.</span></span> <span data-ttu-id="b9bab-159">Az Azure Virtual Machines, egyszerűen jelentkezzen be a virtuális gép hello, és futtassa a telepítőt hello hello legújabb .NET-keretrendszer.</span><span class="sxs-lookup"><span data-stu-id="b9bab-159">For Azure Virtual Machines, simply log into hello VM and run hello installer for hello latest .NET framework.</span></span> <span data-ttu-id="b9bab-160">Azure Cloud Services van szüksége a hello indítási feladatok a központi telepítés egy újabb .NET tooinclude hello telepítését.</span><span class="sxs-lookup"><span data-stu-id="b9bab-160">For Azure Cloud Services, you need tooinclude hello installation of a newer .NET version into hello startup tasks of your deployment.</span></span> <span data-ttu-id="b9bab-161">hello fogalmakat és lépéseket ismertetett [felhőalapú szolgáltatás szerepkör telepítése .NET](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="b9bab-161">hello concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="b9bab-162">Figyelje meg, hogy a telepítő hello a .NET 4.6.1 szükség lehet a további ideiglenes tároló rendszerindítása folyamat Azure felhőszolgáltatások, mint .NET 4.6 telepítőjéhez hello hello során.</span><span class="sxs-lookup"><span data-stu-id="b9bab-162">Note that hello installer for .NET 4.6.1 may require more temporary storage during hello bootstrapping process on Azure cloud services than hello installer for .NET 4.6.</span></span> <span data-ttu-id="b9bab-163">a sikeres telepítés tooensure, szüksége tooincrease ideiglenes tárolóra az Azure-felhőszolgáltatásban hello LocalResources szakaszban és hello környezeti beállítások az indítási feladat a ServiceDefinition.csdef fájlban hello alábbi ábrán Példa:</span><span class="sxs-lookup"><span data-stu-id="b9bab-163">tooensure a successful installation, you need tooincrease temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in hello LocalResources section and hello environment settings of your startup task, as shown in hello following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="b9bab-164">Tranzakciók több kiszolgáló között</span><span class="sxs-lookup"><span data-stu-id="b9bab-164">Transactions across multiple servers</span></span>
<span data-ttu-id="b9bab-165">A rugalmas adatbázis-tranzakció támogatottak az Azure SQL Database különböző logikai kiszolgáló között.</span><span class="sxs-lookup"><span data-stu-id="b9bab-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="b9bab-166">Ha tranzakciók logikai kiszolgáló határokat, hello részt vevő kiszolgálók először kell toobe kölcsönös kommunikációs kapcsolat létrejött.</span><span class="sxs-lookup"><span data-stu-id="b9bab-166">When transactions cross logical server boundaries, hello participating servers first need toobe entered into a mutual communication relationship.</span></span> <span data-ttu-id="b9bab-167">Hello kommunikációs kapcsolat létrehozása után bármely adatbázis két kiszolgáló részt vehetnek-adatbázisok rugalmas tranzakciók hello valamelyikében hello tároló más kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="b9bab-167">Once hello communication relationship has been established, any database in any of hello two servers can participate in elastic transactions with databases from hello other server.</span></span> <span data-ttu-id="b9bab-168">Több mint két logikai kiszolgáló átfedés tranzakciókkal kommunikációs kapcsolatot kell toobe helyen bármely két logikai kiszolgálók között.</span><span class="sxs-lookup"><span data-stu-id="b9bab-168">With transactions spanning more than two logical servers, a communication relationship needs toobe in place for any pair of logical servers.</span></span>

<span data-ttu-id="b9bab-169">A következő PowerShell parancsmagok toomanage a kiszolgálók közötti kommunikációhoz kapcsolatok rugalmas adatbázis-tranzakciókhoz hello használata:</span><span class="sxs-lookup"><span data-stu-id="b9bab-169">Use hello following PowerShell cmdlets toomanage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="b9bab-170">**Új AzureRmSqlServerCommunicationLink**: Ez a parancsmag toocreate kommunikációs új Azure SQL Database logikai két kiszolgálója közötti kapcsolatot használjon.</span><span class="sxs-lookup"><span data-stu-id="b9bab-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet toocreate a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="b9bab-171">hello egy kapcsolat szimmetrikus ami azt jelenti, hogy mindkét kiszolgálón is kezdeményezhető a tranzakciót hello és más kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="b9bab-171">hello relationship is symmetric which means both servers can initiate transactions with hello other server.</span></span>
* <span data-ttu-id="b9bab-172">**Get-AzureRmSqlServerCommunicationLink**: Ez a parancsmag meglévő tooretrieve-kommunikációt használnak a kapcsolatok és azok tulajdonságait.</span><span class="sxs-lookup"><span data-stu-id="b9bab-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooretrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="b9bab-173">**Remove-AzureRmSqlServerCommunicationLink**: Ez a parancsmag tooremove egy már meglévő kommunikációs kapcsolat használata.</span><span class="sxs-lookup"><span data-stu-id="b9bab-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooremove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="b9bab-174">Tranzakció állapotának figyelése</span><span class="sxs-lookup"><span data-stu-id="b9bab-174">Monitoring transaction status</span></span>
<span data-ttu-id="b9bab-175">SQL-adatbázis a toomonitor status and progress a folyamatban lévő rugalmas adatbázis-tranzakció és dinamikus felügyeleti nézetek (dinamikus felügyeleti nézetek) használja.</span><span class="sxs-lookup"><span data-stu-id="b9bab-175">Use Dynamic Management Views (DMVs) in SQL DB toomonitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="b9bab-176">Az összes dinamikus felügyeleti nézetek kapcsolódó tootransactions szükségesek az SQL-adatbázis az elosztott tranzakciók.</span><span class="sxs-lookup"><span data-stu-id="b9bab-176">All DMVs related tootransactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="b9bab-177">Hello megfelelő listája dinamikus felügyeleti nézetek itt találja: [tranzakció kapcsolódó dinamikus felügyeleti nézetek és függvények (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9bab-177">You can find hello corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="b9bab-178">A dinamikus felügyeleti nézetek különösen hasznosak:</span><span class="sxs-lookup"><span data-stu-id="b9bab-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="b9bab-179">**sys.DM\_tran\_aktív\_tranzakciók**: a jelenleg aktív tranzakciók és azok állapotát tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="b9bab-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="b9bab-180">hello UOW-Értékkel (munkaegység) oszlop azonosíthatja hello különböző alárendelt tranzakciók toohello tartozó azonos elosztott tranzakció.</span><span class="sxs-lookup"><span data-stu-id="b9bab-180">hello UOW (Unit Of Work) column can identify hello different child transactions that belong toohello same distributed transaction.</span></span> <span data-ttu-id="b9bab-181">Minden tranzakció belül ugyanaz az elosztott tranzakciók lebonyolítására hello hello azonos UOW-értékkel.</span><span class="sxs-lookup"><span data-stu-id="b9bab-181">All transactions within hello same distributed transaction carry hello same UOW value.</span></span> <span data-ttu-id="b9bab-182">Lásd: hello [DMV dokumentáció](https://msdn.microsoft.com/library/ms174302.aspx) további részleteket.</span><span class="sxs-lookup"><span data-stu-id="b9bab-182">See hello [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="b9bab-183">**sys.DM\_tran\_adatbázis\_tranzakciók**: tranzakciók, például hello tranzakció hello naplóban elhelyezésének további információkkal szolgál.</span><span class="sxs-lookup"><span data-stu-id="b9bab-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of hello transaction in hello log.</span></span> <span data-ttu-id="b9bab-184">Lásd: hello [DMV dokumentáció](https://msdn.microsoft.com/library/ms186957.aspx) további részleteket.</span><span class="sxs-lookup"><span data-stu-id="b9bab-184">See hello [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="b9bab-185">**sys.DM\_tran\_zárolások**: hello megtalálható zárolt jelenleg folyamatban lévő tranzakciók által információkat nyújt.</span><span class="sxs-lookup"><span data-stu-id="b9bab-185">**sys.dm\_tran\_locks**: Provides information about hello locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="b9bab-186">Lásd: hello [DMV dokumentáció](https://msdn.microsoft.com/library/ms190345.aspx) további részleteket.</span><span class="sxs-lookup"><span data-stu-id="b9bab-186">See hello [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="b9bab-187">Korlátozások</span><span class="sxs-lookup"><span data-stu-id="b9bab-187">Limitations</span></span>
<span data-ttu-id="b9bab-188">hello jelenleg a következő korlátozások vonatkoznak az SQL-adatbázis adatbázis-tranzakció tooelastic vonatkoznak:</span><span class="sxs-lookup"><span data-stu-id="b9bab-188">hello following limitations currently apply tooelastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="b9bab-189">Csak az SQL-adatbázis az adatbázisok közötti tranzakciók támogatottak.</span><span class="sxs-lookup"><span data-stu-id="b9bab-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="b9bab-190">Más [X / nyissa meg a XA](https://en.wikipedia.org/wiki/X/Open_XA) rugalmas adatbázis-tranzakció erőforrás-szolgáltatók és az adatbázisok SQL DB kívül nem szerepelhet.</span><span class="sxs-lookup"><span data-stu-id="b9bab-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="b9bab-191">Ez azt jelenti, hogy a rugalmas adatbázis-tranzakció nem a a helyszíni SQL Server és az Azure SQL-adatbázisok között stretch.</span><span class="sxs-lookup"><span data-stu-id="b9bab-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="b9bab-192">Az elosztott tranzakciók a helyszíni továbbra is toouse MSDTC.</span><span class="sxs-lookup"><span data-stu-id="b9bab-192">For distributed transactions on premises, continue toouse MSDTC.</span></span> 
* <span data-ttu-id="b9bab-193">Csak ügyfél egyeztetett .NET-alkalmazás tranzakciók használata támogatott.</span><span class="sxs-lookup"><span data-stu-id="b9bab-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="b9bab-194">T-SQL, például a BEGIN TRANSACTION ELOSZTOTT kiszolgálóoldali támogatása, tervezett, de még nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="b9bab-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="b9bab-195">WCF-szolgáltatások között nem támogatottak.</span><span class="sxs-lookup"><span data-stu-id="b9bab-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="b9bab-196">Például hogy egy WCF-szolgáltatás metódus, amely végrehajtja a tranzakciót.</span><span class="sxs-lookup"><span data-stu-id="b9bab-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="b9bab-197">A tranzakció hatókörén belül hello hívás befoglaló meghiúsul, mint egy [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="b9bab-197">Enclosing hello call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="b9bab-198">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="b9bab-198">Next steps</span></span>
<span data-ttu-id="b9bab-199">A kérdésekhez, lépjen kapcsolatba a hello toous [SQL-adatbázis fórum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) a funkciókra vonatkozó kérések, adjon hozzá toohello [SQL adatbázis-visszajelzési fórumon](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="b9bab-199">For questions, please reach out toous on hello [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them toohello [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



