---
title: "Elosztott tranzakciók több felhőalapú adatbázisban"
description: "Az Azure SQL Database rugalmas adatbázis-tranzakciók áttekintése"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: f7f1ad3f1933b39a0030a784cae40521254037d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="db7fe-103">Elosztott tranzakciók több felhőalapú adatbázisban</span><span class="sxs-lookup"><span data-stu-id="db7fe-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="db7fe-104">Az Azure SQL Database (SQL-adatbázis a) rugalmas adatbázis-tranzakciók teszik tranzakciók, amelyek több adatbázisok az SQL-adatbázis futtatását.</span><span class="sxs-lookup"><span data-stu-id="db7fe-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you to run transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="db7fe-105">Az SQL-adatbázis a rugalmas adatbázis-tranzakciók érhetők el a .NET-alkalmazásokban ADO .NET használatával, és a megszokott programozási élmény segítségével integrálja a [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) osztályok.</span><span class="sxs-lookup"><span data-stu-id="db7fe-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with the familiar programming experience using the [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="db7fe-106">Ahhoz, hogy a könyvtárban, lásd: [.NET-keretrendszer 4.6.1 (webes telepítő)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="db7fe-106">To get the library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="db7fe-107">A helyszíni ilyen esetben általában szükséges fut a Microsoft elosztott tranzakciók koordinátora (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="db7fe-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="db7fe-108">Azure Platform,--szolgáltatás alkalmazásának MSDTC nem érhető el, mert képes koordinálni elosztott tranzakciók mostantól közvetlenül integrálva lett SQL-adatbázis.</span><span class="sxs-lookup"><span data-stu-id="db7fe-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, the ability to coordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="db7fe-109">Alkalmazások is csatlakoznak bármely SQL-adatbázis indítsa el az elosztott tranzakciók, és egy adatbázis transzparens módon összehangolják elosztott tranzakció, az alábbi ábrán látható módon.</span><span class="sxs-lookup"><span data-stu-id="db7fe-109">Applications can connect to any SQL Database to launch distributed transactions, and one of the databases will transparently coordinate the distributed transaction, as shown in the following figure.</span></span> 

  ![<span data-ttu-id="db7fe-110">Az elosztott tranzakciók az Azure SQL Database rugalmas adatbázis-tranzakció használatával</span><span class="sxs-lookup"><span data-stu-id="db7fe-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="db7fe-111">Gyakori forgatókönyvek</span><span class="sxs-lookup"><span data-stu-id="db7fe-111">Common scenarios</span></span>
<span data-ttu-id="db7fe-112">Az SQL Database rugalmas adatbázis tranzakciók lehetővé teszik az alkalmazások számos különböző SQL-adatbázisban tárolt adatok atomi módosítja.</span><span class="sxs-lookup"><span data-stu-id="db7fe-112">Elastic database transactions for SQL DB enable applications to make atomic changes to data stored in several different SQL Databases.</span></span> <span data-ttu-id="db7fe-113">Az előzetes ügyféloldali fejlesztés élmény a C# és .NET összpontosít.</span><span class="sxs-lookup"><span data-stu-id="db7fe-113">The preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="db7fe-114">A T-SQL használatával kiszolgálóoldali élmény tervezünk-e egy későbbi időpontra.</span><span class="sxs-lookup"><span data-stu-id="db7fe-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="db7fe-115">A rugalmas adatbázis-tranzakció célozza az alábbi esetekben:</span><span class="sxs-lookup"><span data-stu-id="db7fe-115">Elastic database transactions targets the following scenarios:</span></span>

* <span data-ttu-id="db7fe-116">Több adatbázis-alkalmazások az Azure-ban: Ebben a forgatókönyvben az adatok függőleges particionálása SQL DB több adatbázisok között úgy, hogy a különböző típusú adatok legyen elhelyezve a különböző adatbázisokhoz.</span><span class="sxs-lookup"><span data-stu-id="db7fe-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="db7fe-117">Egyes műveletek szükséges adatok, amelyet a két vagy több adatbázis módosításait.</span><span class="sxs-lookup"><span data-stu-id="db7fe-117">Some operations require changes to data which is kept in two or more databases.</span></span> <span data-ttu-id="db7fe-118">Az alkalmazás rugalmas adatbázis-tranzakció koordinálja a módosításokat az adatbázisok közötti, és atomicity használja.</span><span class="sxs-lookup"><span data-stu-id="db7fe-118">The application uses elastic database transactions to coordinate the changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="db7fe-119">Horizontálisan skálázott adatbázis-alkalmazások az Azure-ban: Ebben a forgatókönyvben az adatréteg használ a [Elastic Database ügyféloldali kódtárának](sql-database-elastic-database-client-library.md) vagy önkiszolgáló-horizontális vízszintesen particionálásához az adatokat az Adatbázisba az SQL több adatbázis közötti.</span><span class="sxs-lookup"><span data-stu-id="db7fe-119">Sharded database applications in Azure: With this scenario, the data tier uses the [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding to horizontally partition the data across many databases in SQL DB.</span></span> <span data-ttu-id="db7fe-120">Egy jól láthatóan elhelyezett használati eset atomi változtatások végrehajtani szilánkos több-bérlős alkalmazáshoz, ha módosítások span bérlők szükség.</span><span class="sxs-lookup"><span data-stu-id="db7fe-120">One prominent use case is the need to perform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="db7fe-121">Egy bérlő átvitelét egy másikra, mind a különböző adatbázisokhoz elhelyezkedhet gondol példányhoz.</span><span class="sxs-lookup"><span data-stu-id="db7fe-121">Think for instance of a transfer from one tenant to another, both residing on different databases.</span></span> <span data-ttu-id="db7fe-122">A második esetben az részletes horizontális lemezkapacitási igényekről, ami viszont általában azt jelenti, hogy néhány atomi műveletek között használt ugyanannak a bérlőnek több adatbázisok Nyújtás kell-e nagy bérlőhöz befogadásához.</span><span class="sxs-lookup"><span data-stu-id="db7fe-122">A second case is fine-grained sharding to accommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs to stretch across several databases used for the same tenant.</span></span> <span data-ttu-id="db7fe-123">Egy harmadik esetben atomi frissítéseit az adatbázisok közötti replikált adatokra hivatkoztak.</span><span class="sxs-lookup"><span data-stu-id="db7fe-123">A third case is atomic updates to reference data that are replicated across databases.</span></span> <span data-ttu-id="db7fe-124">Ezek a sorok mentén atomi, a tranzakciós, műveletek most már az előzetes több adatbázis közötti kell koordinált.</span><span class="sxs-lookup"><span data-stu-id="db7fe-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using the preview.</span></span>
  <span data-ttu-id="db7fe-125">A rugalmas adatbázis-tranzakció használja kétfázisú végrehajtási tranzakció atomicity adatbázisok között.</span><span class="sxs-lookup"><span data-stu-id="db7fe-125">Elastic database transactions use two-phase commit to ensure transaction atomicity across databases.</span></span> <span data-ttu-id="db7fe-126">Remekül beválik, ha egy tranzakción belül egyszerre legfeljebb 100 adatbázisok tranzakciók is.</span><span class="sxs-lookup"><span data-stu-id="db7fe-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="db7fe-127">Ezek a korlátozások nem lépnek érvénybe, de egy számíthat teljesítményt és rugalmas adatbázis tranzakciók a működés felső korlátjának túllépésekor küzdenek sikerességéről.</span><span class="sxs-lookup"><span data-stu-id="db7fe-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions to suffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="db7fe-128">Telepítés és áttelepítés</span><span class="sxs-lookup"><span data-stu-id="db7fe-128">Installation and migration</span></span>
<span data-ttu-id="db7fe-129">Az SQL Database rugalmas adatbázis-tranzakciókhoz képességeket keresztül a .NET-kódtárakra System.Data.dll és System.Transactions.dll frissítések állnak rendelkezésre.</span><span class="sxs-lookup"><span data-stu-id="db7fe-129">The capabilities for elastic database transactions in SQL DB are provided through updates to the .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="db7fe-130">A DLL-ek győződjön meg arról, hogy kétfázisú végrehajtási használatos, ahol atomicity biztosításához szükséges.</span><span class="sxs-lookup"><span data-stu-id="db7fe-130">The DLLs ensure that two-phase commit is used where necessary to ensure atomicity.</span></span> <span data-ttu-id="db7fe-131">Rugalmas adatbázis-tranzakció használatával alkalmazások fejlesztésének megkezdéséhez telepítse [.NET-keretrendszer 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) vagy újabb verziója.</span><span class="sxs-lookup"><span data-stu-id="db7fe-131">To start developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="db7fe-132">A .NET-keretrendszer egy korábbi verzióját futtatja, ha tranzakció elosztott tranzakcióvá történő előléptetése sikertelen lesz, és kivételt generál.</span><span class="sxs-lookup"><span data-stu-id="db7fe-132">When running on an earlier version of the .NET framework, transactions will fail to promote to a distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="db7fe-133">A telepítés után az elosztott tranzakció API-k használhatja a System.Transactions kapcsolatokkal az SQL-Adatbázishoz.</span><span class="sxs-lookup"><span data-stu-id="db7fe-133">After installation, you can use the distributed transaction APIs in System.Transactions with connections to SQL DB.</span></span> <span data-ttu-id="db7fe-134">Ha ezen API-k használata meglévő MSDTC alkalmazásai, egyszerűen építse újra a meglévő .NET 4.6-alkalmazások a 4.6.1 telepítése után keretrendszer.</span><span class="sxs-lookup"><span data-stu-id="db7fe-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing the 4.6.1 Framework.</span></span> <span data-ttu-id="db7fe-135">A projektek .NET 4.6 célként, ha azok automatikusan használja az új keretrendszer verzióját a frissített DLL-eket, és API és az SQL Adatbázishoz kapcsolatok együttes meghívja az elosztott tranzakciók mostantól sikeres lesz.</span><span class="sxs-lookup"><span data-stu-id="db7fe-135">If your projects target .NET 4.6, they will automatically use the updated DLLs from the new Framework version and distributed transaction API calls in combination with connections to SQL DB will now succeed.</span></span>

<span data-ttu-id="db7fe-136">Ne feledje, hogy a rugalmas adatbázis-tranzakció szükséges MSDTC telepítése.</span><span class="sxs-lookup"><span data-stu-id="db7fe-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="db7fe-137">Rugalmas adatbázis-tranzakció ehelyett közvetlenül kezelt által és az SQL DB belül.</span><span class="sxs-lookup"><span data-stu-id="db7fe-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="db7fe-138">Ez jelentősen leegyszerűsíti az felhős rendszerekben mivel MSDTC telepítése nem szükséges az elosztott tranzakciók használata az SQL-adatbázis.</span><span class="sxs-lookup"><span data-stu-id="db7fe-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary to use distributed transactions with SQL DB.</span></span> <span data-ttu-id="db7fe-139">A szakasz 4 részletesebben ismerteti, hogyan rugalmas adatbázis-tranzakció és a kötelező .NET-keretrendszer együtt az Azure felhőalapú alkalmazások központi telepítését.</span><span class="sxs-lookup"><span data-stu-id="db7fe-139">Section 4 explains in more detail how to deploy elastic database transactions and the required .NET framework together with your cloud applications to Azure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="db7fe-140">Fejlesztési felület</span><span class="sxs-lookup"><span data-stu-id="db7fe-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="db7fe-141">Több adatbázis-alkalmazások</span><span class="sxs-lookup"><span data-stu-id="db7fe-141">Multi-database applications</span></span>
<span data-ttu-id="db7fe-142">Az alábbi példakód .NET System.Transactions a megszokott programozási környezetet használ.</span><span class="sxs-lookup"><span data-stu-id="db7fe-142">The following sample code uses the familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="db7fe-143">A TransactionScope-objektum osztály a .NET környezeti tranzakció hoz létre.</span><span class="sxs-lookup"><span data-stu-id="db7fe-143">The TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="db7fe-144">("Környezeti tranzakció" egyike az aktuális szál.) A TransactionScope-objektum belül megnyitott összes kapcsolat a tranzakció részt.</span><span class="sxs-lookup"><span data-stu-id="db7fe-144">(An “ambient transaction” is one that lives in the current thread.) All connections opened within the TransactionScope participate in the transaction.</span></span> <span data-ttu-id="db7fe-145">Ha a különböző adatbázisokhoz, a tranzakció automatikusan át elosztott tranzakcióra emelt szintű.</span><span class="sxs-lookup"><span data-stu-id="db7fe-145">If different databases participate, the transaction is automatically elevated to a distributed transaction.</span></span> <span data-ttu-id="db7fe-146">A tranzakció eredményét jelzi egy véglegesítési befejezéséhez hatókör beállítása szabályozza.</span><span class="sxs-lookup"><span data-stu-id="db7fe-146">The outcome of the transaction is controlled by setting the scope to complete to indicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="db7fe-147">Horizontálisan skálázott adatbázis-alkalmazások</span><span class="sxs-lookup"><span data-stu-id="db7fe-147">Sharded database applications</span></span>
<span data-ttu-id="db7fe-148">Az SQL Database rugalmas adatbázis tranzakciók is támogatja az elosztott tranzakciók, ahol a OpenConnectionForKey a módszert használja az elastic database ügyféloldali kódtár nyitott kapcsolatot méretezett kimenő adatok koordinációs réteg.</span><span class="sxs-lookup"><span data-stu-id="db7fe-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use the OpenConnectionForKey method of the elastic database client library to open connections for a scaled out data tier.</span></span> <span data-ttu-id="db7fe-149">Vegye figyelembe a esetben, amikor kell között számos különböző horizontális kulcsértékei módosítások tranzakciós konzisztencia biztosításához.</span><span class="sxs-lookup"><span data-stu-id="db7fe-149">Consider cases where you need to guarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="db7fe-150">A szilánkok különböző horizontális értékek üzemeltetési kapcsolat van közvetítőalapú OpenConnectionForKey használatával.</span><span class="sxs-lookup"><span data-stu-id="db7fe-150">Connections to the shards hosting the different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="db7fe-151">A kapcsolatok az általános esetben lehet a különböző szilánkok úgy, hogy tranzakciós garanciák biztosítása elosztott tranzakciót igényel.</span><span class="sxs-lookup"><span data-stu-id="db7fe-151">In the general case, the connections can be to different shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="db7fe-152">A következő példakód azt szemlélteti, hogy ezt a módszert használja.</span><span class="sxs-lookup"><span data-stu-id="db7fe-152">The following code sample illustrates this approach.</span></span> <span data-ttu-id="db7fe-153">Feltételezi, hogy használja-e shardmap nevű változó, amely képviseli az elastic database ügyféloldali kódtár shard térképre:</span><span class="sxs-lookup"><span data-stu-id="db7fe-153">It assumes that a variable called shardmap is used to represent a shard map from the elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="db7fe-154">A .NET telepítése Azure Cloud Services csomag</span><span class="sxs-lookup"><span data-stu-id="db7fe-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="db7fe-155">Azure biztosít a .NET-alkalmazások üzemeltetését több ajánlatokat.</span><span class="sxs-lookup"><span data-stu-id="db7fe-155">Azure provides several offerings to host .NET applications.</span></span> <span data-ttu-id="db7fe-156">A különböző ajánlatok összehasonlítása érhető el [Azure App Service, a Cloud Services és a virtuális gépek összevetése](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="db7fe-156">A comparison of the different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="db7fe-157">Ha a vendég operációs rendszer, az elérhető .NET 4.6.1 rugalmas tranzakciók szükséges kisebb, a vendég operációs rendszer frissítéséhez 4.6.1 szüksége.</span><span class="sxs-lookup"><span data-stu-id="db7fe-157">If the guest OS of the offering is smaller than .NET 4.6.1 required for elastic transactions, you need to upgrade the guest OS to 4.6.1.</span></span> 

<span data-ttu-id="db7fe-158">Az Azure App Service szolgáltatások frissítéseket a vendég operációs rendszer jelenleg nem támogatottak.</span><span class="sxs-lookup"><span data-stu-id="db7fe-158">For Azure App Services, upgrades to the guest OS are currently not supported.</span></span> <span data-ttu-id="db7fe-159">Az Azure Virtual Machines, egyszerűen jelentkezzen be a virtuális Gépet, majd futtassa a telepítőt a legújabb .NET-keretrendszer.</span><span class="sxs-lookup"><span data-stu-id="db7fe-159">For Azure Virtual Machines, simply log into the VM and run the installer for the latest .NET framework.</span></span> <span data-ttu-id="db7fe-160">Azure-szolgáltatásokhoz meg kell adnia azokat a központi telepítés indítási feladatainak egy újabb .NET telepítése.</span><span class="sxs-lookup"><span data-stu-id="db7fe-160">For Azure Cloud Services, you need to include the installation of a newer .NET version into the startup tasks of your deployment.</span></span> <span data-ttu-id="db7fe-161">A fogalmakat és lépéseket ismertetett [felhőalapú szolgáltatás szerepkör telepítése .NET](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="db7fe-161">The concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="db7fe-162">Vegye figyelembe, hogy a telepítő a .NET 4.6.1 során szüksége lehet további ideiglenes tárolási a bootstrapping az Azure felhőszolgáltatások mint a telepítő a .NET 4.6.</span><span class="sxs-lookup"><span data-stu-id="db7fe-162">Note that the installer for .NET 4.6.1 may require more temporary storage during the bootstrapping process on Azure cloud services than the installer for .NET 4.6.</span></span> <span data-ttu-id="db7fe-163">A sikeres telepítés érdekében növelnie kell ideiglenes tárhely az Azure felhőalapú szolgáltatás a LocalResources szakaszban és a környezet beállításokat az indítási feladat a ServiceDefinition.csdef fájlban a következő mintában látható módon:</span><span class="sxs-lookup"><span data-stu-id="db7fe-163">To ensure a successful installation, you need to increase temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in the LocalResources section and the environment settings of your startup task, as shown in the following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="db7fe-164">Tranzakciók több kiszolgáló között</span><span class="sxs-lookup"><span data-stu-id="db7fe-164">Transactions across multiple servers</span></span>
<span data-ttu-id="db7fe-165">A rugalmas adatbázis-tranzakció támogatottak az Azure SQL Database különböző logikai kiszolgáló között.</span><span class="sxs-lookup"><span data-stu-id="db7fe-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="db7fe-166">Ha tranzakciók logikai kiszolgáló határokat, a programban részt vevő kiszolgálók először kell kölcsönös kommunikációs kapcsolatot kell adni.</span><span class="sxs-lookup"><span data-stu-id="db7fe-166">When transactions cross logical server boundaries, the participating servers first need to be entered into a mutual communication relationship.</span></span> <span data-ttu-id="db7fe-167">A kommunikációs kapcsolat létrehozása után a másik kiszolgáló az adatbázisok rugalmas tranzakciók egyetlen adatbázis sem a két kiszolgáló részt.</span><span class="sxs-lookup"><span data-stu-id="db7fe-167">Once the communication relationship has been established, any database in any of the two servers can participate in elastic transactions with databases from the other server.</span></span> <span data-ttu-id="db7fe-168">Több mint két logikai kiszolgáló átfedés tranzakciókkal egy kommunikációs viszonyt kell biztosítani a logikai kiszolgáló bármely két.</span><span class="sxs-lookup"><span data-stu-id="db7fe-168">With transactions spanning more than two logical servers, a communication relationship needs to be in place for any pair of logical servers.</span></span>

<span data-ttu-id="db7fe-169">A következő PowerShell-parancsmagok segítségével kezelheti a kiszolgálók közötti kommunikációhoz kapcsolatok rugalmas adatbázis-tranzakciókhoz:</span><span class="sxs-lookup"><span data-stu-id="db7fe-169">Use the following PowerShell cmdlets to manage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="db7fe-170">**Új AzureRmSqlServerCommunicationLink**: Ez a parancsmag segítségével hozzon létre egy új kommunikációs kapcsolat Azure SQL Database logikai két kiszolgálója között.</span><span class="sxs-lookup"><span data-stu-id="db7fe-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet to create a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="db7fe-171">A kapcsolat szimmetrikus ami azt jelenti, hogy mindkét kiszolgáló a másik kiszolgálóval tranzakciók is kezdeményezhető.</span><span class="sxs-lookup"><span data-stu-id="db7fe-171">The relationship is symmetric which means both servers can initiate transactions with the other server.</span></span>
* <span data-ttu-id="db7fe-172">**Get-AzureRmSqlServerCommunicationLink**: ezt a parancsmagot használja a meglévő kommunikációs kapcsolatok és azok tulajdonságaival lekérdezéséhez.</span><span class="sxs-lookup"><span data-stu-id="db7fe-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet to retrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="db7fe-173">**Remove-AzureRmSqlServerCommunicationLink**: Ez a parancsmag segítségével távolítsa el a meglévő kommunikációs kapcsolat.</span><span class="sxs-lookup"><span data-stu-id="db7fe-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet to remove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="db7fe-174">Tranzakció állapotának figyelése</span><span class="sxs-lookup"><span data-stu-id="db7fe-174">Monitoring transaction status</span></span>
<span data-ttu-id="db7fe-175">Az SQL-adatbázis a dinamikus felügyeleti nézetek (dinamikus felügyeleti nézetek) segítségével a figyelő állapotának és előrehaladtának a folyamatban lévő rugalmas adatbázis-tranzakció.</span><span class="sxs-lookup"><span data-stu-id="db7fe-175">Use Dynamic Management Views (DMVs) in SQL DB to monitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="db7fe-176">Az SQL-adatbázis az elosztott tranzakciók tranzakciókhoz kapcsolódó összes dinamikus felügyeleti nézetek szükségesek.</span><span class="sxs-lookup"><span data-stu-id="db7fe-176">All DMVs related to transactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="db7fe-177">Dinamikus felügyeleti nézetek megfelelő listáját itt találja: [tranzakció kapcsolódó dinamikus felügyeleti nézetek és függvények (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="db7fe-177">You can find the corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="db7fe-178">A dinamikus felügyeleti nézetek különösen hasznosak:</span><span class="sxs-lookup"><span data-stu-id="db7fe-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="db7fe-179">**sys.DM\_tran\_aktív\_tranzakciók**: a jelenleg aktív tranzakciók és azok állapotát tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="db7fe-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="db7fe-180">A UOW-Értékkel (munkaegység) oszlop azonosíthatja a különböző alárendelt tranzakciók, amelyek azonos elosztott tranzakció.</span><span class="sxs-lookup"><span data-stu-id="db7fe-180">The UOW (Unit Of Work) column can identify the different child transactions that belong to the same distributed transaction.</span></span> <span data-ttu-id="db7fe-181">Ugyanazon elosztott tranzakción belül minden tranzakciók lebonyolítására UOW ugyanazt az értéket.</span><span class="sxs-lookup"><span data-stu-id="db7fe-181">All transactions within the same distributed transaction carry the same UOW value.</span></span> <span data-ttu-id="db7fe-182">Tekintse meg a [DMV dokumentáció](https://msdn.microsoft.com/library/ms174302.aspx) további részleteket.</span><span class="sxs-lookup"><span data-stu-id="db7fe-182">See the [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="db7fe-183">**sys.DM\_tran\_adatbázis\_tranzakciók**: tranzakciók, például a naplóban a tranzakció elhelyezésének további információkkal szolgál.</span><span class="sxs-lookup"><span data-stu-id="db7fe-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of the transaction in the log.</span></span> <span data-ttu-id="db7fe-184">Tekintse meg a [DMV dokumentáció](https://msdn.microsoft.com/library/ms186957.aspx) további részleteket.</span><span class="sxs-lookup"><span data-stu-id="db7fe-184">See the [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="db7fe-185">**sys.DM\_tran\_zárolások**: információkat nyújt azokról a zárolásokat, amelyek jelenleg folyamatban lévő tranzakció tartja fenn.</span><span class="sxs-lookup"><span data-stu-id="db7fe-185">**sys.dm\_tran\_locks**: Provides information about the locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="db7fe-186">Tekintse meg a [DMV dokumentáció](https://msdn.microsoft.com/library/ms190345.aspx) további részleteket.</span><span class="sxs-lookup"><span data-stu-id="db7fe-186">See the [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="db7fe-187">Korlátozások</span><span class="sxs-lookup"><span data-stu-id="db7fe-187">Limitations</span></span>
<span data-ttu-id="db7fe-188">SQL Database rugalmas adatbázis-tranzakciók jelenleg alkalmazása a következő korlátozások vonatkoznak:</span><span class="sxs-lookup"><span data-stu-id="db7fe-188">The following limitations currently apply to elastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="db7fe-189">Csak az SQL-adatbázis az adatbázisok közötti tranzakciók támogatottak.</span><span class="sxs-lookup"><span data-stu-id="db7fe-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="db7fe-190">Más [X / nyissa meg a XA](https://en.wikipedia.org/wiki/X/Open_XA) rugalmas adatbázis-tranzakció erőforrás-szolgáltatók és az adatbázisok SQL DB kívül nem szerepelhet.</span><span class="sxs-lookup"><span data-stu-id="db7fe-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="db7fe-191">Ez azt jelenti, hogy a rugalmas adatbázis-tranzakció nem a a helyszíni SQL Server és az Azure SQL-adatbázisok között stretch.</span><span class="sxs-lookup"><span data-stu-id="db7fe-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="db7fe-192">Az elosztott tranzakciók a helyszíni továbbra is használhatja az MSDTC.</span><span class="sxs-lookup"><span data-stu-id="db7fe-192">For distributed transactions on premises, continue to use MSDTC.</span></span> 
* <span data-ttu-id="db7fe-193">Csak ügyfél egyeztetett .NET-alkalmazás tranzakciók használata támogatott.</span><span class="sxs-lookup"><span data-stu-id="db7fe-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="db7fe-194">T-SQL, például a BEGIN TRANSACTION ELOSZTOTT kiszolgálóoldali támogatása, tervezett, de még nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="db7fe-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="db7fe-195">WCF-szolgáltatások között nem támogatottak.</span><span class="sxs-lookup"><span data-stu-id="db7fe-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="db7fe-196">Például hogy egy WCF-szolgáltatás metódus, amely végrehajtja a tranzakciót.</span><span class="sxs-lookup"><span data-stu-id="db7fe-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="db7fe-197">A hívás a tranzakció hatókörén belül befoglaló meghiúsul, mint egy [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="db7fe-197">Enclosing the call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="db7fe-198">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="db7fe-198">Next steps</span></span>
<span data-ttu-id="db7fe-199">A kérdésekhez, lépjen kapcsolatba velünk a a [SQL-adatbázis fórum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) és a szolgáltatás kéréseket, adja hozzá őket a [SQL adatbázis-visszajelzési fórumon](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="db7fe-199">For questions, please reach out to us on the [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them to the [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



