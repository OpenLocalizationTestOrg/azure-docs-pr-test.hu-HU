---
title: "Azure SQL-adatbázis aaaCopy |} Microsoft Docs"
description: "Azure SQL-adatbázis másolatának létrehozása"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 64a297d819d6da89600fda60abe8394ae405abfe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="42b0e-103">Azure SQL-adatbázis másolása</span><span class="sxs-lookup"><span data-stu-id="42b0e-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="42b0e-104">Az Azure SQL Database is tartalmaz több módszerét tranzakciós úton konzisztens másolat készítését egy meglévő Azure SQL adatbázis-vagy hello az azonos vagy egy másik kiszolgálóhoz.</span><span class="sxs-lookup"><span data-stu-id="42b0e-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either hello same server or a different server.</span></span> <span data-ttu-id="42b0e-105">SQL-adatbázis hello Azure-portálon, a PowerShell vagy a T-SQL használatával másolhatja.</span><span class="sxs-lookup"><span data-stu-id="42b0e-105">You can copy a SQL database by using hello Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="42b0e-106">Áttekintés</span><span class="sxs-lookup"><span data-stu-id="42b0e-106">Overview</span></span>

<span data-ttu-id="42b0e-107">Egy adatbázis-példány hello forrásadatbázis hello időpontban hello kérelmet a meglévő pillanatkép.</span><span class="sxs-lookup"><span data-stu-id="42b0e-107">A database copy is a snapshot of hello source database as of hello time of hello copy request.</span></span> <span data-ttu-id="42b0e-108">Kiválaszthatja ugyanarra a kiszolgálóra vagy egy másik kiszolgálót, a szolgáltatás és teljesítményszintet szintje vagy hello belül különböző teljesítményszintet hello azonos szolgáltatási réteg (kiadás).</span><span class="sxs-lookup"><span data-stu-id="42b0e-108">You can select hello same server or a different server, its service tier and performance level, or a different performance level within hello same service tier (edition).</span></span> <span data-ttu-id="42b0e-109">Hello Másolás befejezése után egy teljesen működőképes, független adatbázis válik.</span><span class="sxs-lookup"><span data-stu-id="42b0e-109">After hello copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="42b0e-110">Ezen a ponton frissítése vagy tooany edition használni azt.</span><span class="sxs-lookup"><span data-stu-id="42b0e-110">At this point, you can upgrade or downgrade it tooany edition.</span></span> <span data-ttu-id="42b0e-111">hello bejelentkezéseket, felhasználók és engedélyek függetlenül is kezelhetők.</span><span class="sxs-lookup"><span data-stu-id="42b0e-111">hello logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-hello-database-copy"></a><span data-ttu-id="42b0e-112">Az adatbázis-másolat hello bejelentkezések</span><span class="sxs-lookup"><span data-stu-id="42b0e-112">Logins in hello database copy</span></span>

<span data-ttu-id="42b0e-113">Egy adatbázis toohello másolásakor azonos logikai kiszolgáló, hello azonos bejelentkezések mindkét adatbázissal is használhatók.</span><span class="sxs-lookup"><span data-stu-id="42b0e-113">When you copy a database toohello same logical server, hello same logins can be used on both databases.</span></span> <span data-ttu-id="42b0e-114">hello rendszerbiztonsági tag toocopy hello adatbázist használ hello új adatbázis hello adatbázis tulajdonosa lesz.</span><span class="sxs-lookup"><span data-stu-id="42b0e-114">hello security principal you use toocopy hello database becomes hello database owner on hello new database.</span></span> <span data-ttu-id="42b0e-115">Minden adatbázis-felhasználók, az engedélyek és a biztonsági azonosítók (SID) másolt toohello adatbázis-másolat.</span><span class="sxs-lookup"><span data-stu-id="42b0e-115">All database users, their permissions, and their security identifiers (SIDs) are copied toohello database copy.</span></span>  

<span data-ttu-id="42b0e-116">Egy adatbázis tooa másik logikai kiszolgáló másolásakor a hello rendszerbiztonsági tag hello új kiszolgálóra lesz hello adatbázis tulajdonosa hello új adatbázis.</span><span class="sxs-lookup"><span data-stu-id="42b0e-116">When you copy a database tooa different logical server, hello security principal on hello new server becomes hello database owner on hello new database.</span></span> <span data-ttu-id="42b0e-117">Használatakor [tartalmazott adatbázis-felhasználók](sql-database-manage-logins.md) adatelérési, győződjön meg arról, hogy mindkét hello elsődleges és másodlagos adatbázisok mindig hello ugyanazon felhasználó hitelesítő adatait, így az, hogy hello másolás után végezhető el, azonnal férhetnek hozzá a hello azonos hitelesítő adatok.</span><span class="sxs-lookup"><span data-stu-id="42b0e-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both hello primary and secondary databases always have hello same user credentials, so that after hello copy is complete you can immediately access it with hello same credentials.</span></span> 

<span data-ttu-id="42b0e-118">Ha [Azure Active Directory](../active-directory/active-directory-whatis.md), teljesen megszüntetheti hello másolatot a hitelesítő adatok kezelése hello szükségességét.</span><span class="sxs-lookup"><span data-stu-id="42b0e-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate hello need for managing credentials in hello copy.</span></span> <span data-ttu-id="42b0e-119">Azonban hello adatbázis tooa új kiszolgáló másolásakor hello bejelentkezés-alapú hozzáférés előfordulhat, hogy nem működik, mert hello bejelentkezések nem léteznek hello új kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="42b0e-119">However, when you copy hello database tooa new server, hello login-based access might not work, because hello logins do not exist on hello new server.</span></span> <span data-ttu-id="42b0e-120">bejelentkezések kezelése adatbázis tooa másik logikai kiszolgálót, másolásakor toolearn lásd [hogyan toomanage Azure SQL-adatbázis biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="42b0e-120">toolearn about managing logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="42b0e-121">Sikeres hello másolását követően, és mielőtt más felhasználók újra vannak társítva, csak hello bejelentkezési, másolása, hello kezdeményezett hello adatbázis-tulajdonos, bejelentkezhet toohello új adatbázist.</span><span class="sxs-lookup"><span data-stu-id="42b0e-121">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span> <span data-ttu-id="42b0e-122">tooresolve bejelentkezések hello másolása művelet befejezése után, lásd: [bejelentkezések megoldásához](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="42b0e-122">tooresolve logins after hello copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-hello-azure-portal"></a><span data-ttu-id="42b0e-123">Adatbázis másolása hello Azure-portál használatával</span><span class="sxs-lookup"><span data-stu-id="42b0e-123">Copy a database by using hello Azure portal</span></span>

<span data-ttu-id="42b0e-124">egy adatbázis használatával hello Azure portál, az adatbázis megnyitása hello oldaláról, és kattintson a toocopy **másolási**.</span><span class="sxs-lookup"><span data-stu-id="42b0e-124">toocopy a database by using hello Azure portal, open hello page for your database, and then click **Copy**.</span></span> 

   ![Az adatbázis másolása](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="42b0e-126">Adatbázis másolása a PowerShell használatával</span><span class="sxs-lookup"><span data-stu-id="42b0e-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="42b0e-127">a PowerShell használata hello adatbázis toocopy [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) parancsmag.</span><span class="sxs-lookup"><span data-stu-id="42b0e-127">toocopy a database by using PowerShell, use hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="42b0e-128">Tekintse meg a teljes minta parancsfájlt [adatbázis tooa új kiszolgáló másolása](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="42b0e-128">For a complete sample script, see [Copy a database tooa new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="42b0e-129">Adatbázis másolása Transact-SQL használatával</span><span class="sxs-lookup"><span data-stu-id="42b0e-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="42b0e-130">Jelentkezzen be toohello master adatbázis hello kiszolgálószintű fő bejelentkezéssel vagy hello bejelentkezési azonosítót, amely a létrehozni kívánt toocopy hello adatbázis.</span><span class="sxs-lookup"><span data-stu-id="42b0e-130">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="42b0e-131">-Adatbázis másolása toosucceed bejelentkezéseket, amelyek nincsenek hello kiszolgálószintű egyszerű hello dbmanager szerepkör tagjának kell lennie.</span><span class="sxs-lookup"><span data-stu-id="42b0e-131">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span> <span data-ttu-id="42b0e-132">További információ a bejelentkezési és kapcsolódó toohello kiszolgáló: [bejelentkezések kezelése](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="42b0e-132">For more information about logins and connecting toohello server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="42b0e-133">Hello forrásadatbázis hello másolásának megkezdése [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) utasítást.</span><span class="sxs-lookup"><span data-stu-id="42b0e-133">Start copying hello source database with hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="42b0e-134">Az utasítás végrehajtása kezdeményezi hello adatbázis másolása folyamat.</span><span class="sxs-lookup"><span data-stu-id="42b0e-134">Executing this statement initiates hello database copying process.</span></span> <span data-ttu-id="42b0e-135">Mivel az adatbázis másolása egy aszinkron folyamat, hello CREATE DATABASE utasítás hello adatbázis-Másolás befejezése előtt adja vissza.</span><span class="sxs-lookup"><span data-stu-id="42b0e-135">Because copying a database is an asynchronous process, hello CREATE DATABASE statement returns before hello database copying is complete.</span></span>

### <a name="copy-a-sql-database-toohello-same-server"></a><span data-ttu-id="42b0e-136">Másolja át egy SQL-adatbázis toohello ugyanarra a kiszolgálóra</span><span class="sxs-lookup"><span data-stu-id="42b0e-136">Copy a SQL database toohello same server</span></span>
<span data-ttu-id="42b0e-137">Jelentkezzen be toohello master adatbázis hello kiszolgálószintű fő bejelentkezéssel vagy hello bejelentkezési azonosítót, amely a létrehozni kívánt toocopy hello adatbázis.</span><span class="sxs-lookup"><span data-stu-id="42b0e-137">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="42b0e-138">-Adatbázis másolása toosucceed bejelentkezéseket, amelyek nincsenek hello kiszolgálószintű egyszerű hello dbmanager szerepkör tagjának kell lennie.</span><span class="sxs-lookup"><span data-stu-id="42b0e-138">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span>

<span data-ttu-id="42b0e-139">Ez a parancs átmásolja Database1 tooa új adatbázis Database2 megnevezett hello ugyanarra a kiszolgálóra.</span><span class="sxs-lookup"><span data-stu-id="42b0e-139">This command copies Database1 tooa new database named Database2 on hello same server.</span></span> <span data-ttu-id="42b0e-140">Attól függően, hogy az adatbázis hello méretét a művelet másolása hello is igénybe vehet néhány alkalommal toocomplete.</span><span class="sxs-lookup"><span data-stu-id="42b0e-140">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-tooa-different-server"></a><span data-ttu-id="42b0e-141">SQL adatbázis tooa másik kiszolgálót másolása</span><span class="sxs-lookup"><span data-stu-id="42b0e-141">Copy a SQL database tooa different server</span></span>

<span data-ttu-id="42b0e-142">Jelentkezzen be toohello master adatbázis hello célkiszolgáló, hello SQL adatbázis-kiszolgáló létrehozása toobe hello új adatbázis esetén.</span><span class="sxs-lookup"><span data-stu-id="42b0e-142">Log in toohello master database of hello destination server, hello SQL database server where hello new database is toobe created.</span></span> <span data-ttu-id="42b0e-143">Használjon olyan bejelentkezési azonosítót, rendelkezik hello ugyanazt a nevet és jelszót az hello forrásadatbázis forráskiszolgálón hello SQL adatbázis hello adatbázis tulajdonosa.</span><span class="sxs-lookup"><span data-stu-id="42b0e-143">Use a login that has hello same name and password as hello database owner of hello source database on hello source SQL database server.</span></span> <span data-ttu-id="42b0e-144">hello bejelentkezési hello célkiszolgálón kell hello dbmanager szerepkör tagjai vagy is hello kiszolgálószintű fő bejelentkezéssel.</span><span class="sxs-lookup"><span data-stu-id="42b0e-144">hello login on hello destination server must also be a member of hello dbmanager role or be hello server-level principal login.</span></span>

<span data-ttu-id="42b0e-145">Ez a parancs Database1 kiszolgáló1 tooa új adatbázis Database2 nevű kiszolgáló2 másolja át.</span><span class="sxs-lookup"><span data-stu-id="42b0e-145">This command copies Database1 on server1 tooa new database named Database2 on server2.</span></span> <span data-ttu-id="42b0e-146">Attól függően, hogy az adatbázis hello méretét a művelet másolása hello is igénybe vehet néhány alkalommal toocomplete.</span><span class="sxs-lookup"><span data-stu-id="42b0e-146">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database of hello target server (server2)
    -- Start copying from Server1 tooServer2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-hello-progress-of-hello-copying-operation"></a><span data-ttu-id="42b0e-147">A Másolás művelet hello hello előrehaladást</span><span class="sxs-lookup"><span data-stu-id="42b0e-147">Monitor hello progress of hello copying operation</span></span>

<span data-ttu-id="42b0e-148">Hello másolási folyamat figyelése hello sys.databases és sys.dm_database_copies nézet lekérdezésével.</span><span class="sxs-lookup"><span data-stu-id="42b0e-148">Monitor hello copying process by querying hello sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="42b0e-149">Amíg hello másolása folyamatban van, hello **state_desc** hello sys.databases nézetben hello új adatbázis oszlop értéke túl**MÁSOLÁSA**.</span><span class="sxs-lookup"><span data-stu-id="42b0e-149">While hello copying is in progress, hello **state_desc** column of hello sys.databases view for hello new database is set too**COPYING**.</span></span>

* <span data-ttu-id="42b0e-150">Ha hello másolása sikertelen, hello **state_desc** hello sys.databases nézetben hello új adatbázis oszlop értéke túl**FELTÉTELEZHETŐ**.</span><span class="sxs-lookup"><span data-stu-id="42b0e-150">If hello copying fails, hello **state_desc** column of hello sys.databases view for hello new database is set too**SUSPECT**.</span></span> <span data-ttu-id="42b0e-151">Új adatbázis hello hello DROP utasítást hajt végre, és próbálkozzon újra később.</span><span class="sxs-lookup"><span data-stu-id="42b0e-151">Execute hello DROP statement on hello new database, and try again later.</span></span>
* <span data-ttu-id="42b0e-152">Ha hello másolása sikeres, hello **state_desc** hello sys.databases nézetben hello új adatbázis oszlop értéke túl**ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="42b0e-152">If hello copying succeeds, hello **state_desc** column of hello sys.databases view for hello new database is set too**ONLINE**.</span></span> <span data-ttu-id="42b0e-153">hello másolása befejeződött, és új adatbázis hello rendszeres adatbázis független hello forrásadatbázis módosítható.</span><span class="sxs-lookup"><span data-stu-id="42b0e-153">hello copying is complete, and hello new database is a regular database that can be changed independent of hello source database.</span></span>

> [!NOTE]
> <span data-ttu-id="42b0e-154">Ha úgy dönt, hogy toocancel az hello másolja, amíg folyamatban van, a végrehajtást hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) hello új adatbázis utasítást.</span><span class="sxs-lookup"><span data-stu-id="42b0e-154">If you decide toocancel hello copying while it is in progress, execute hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on hello new database.</span></span> <span data-ttu-id="42b0e-155">Másik lehetőségként hello forrásadatbázison hello DROP DATABASE utasítás végrehajtása is visszavonja hello másolása folyamat.</span><span class="sxs-lookup"><span data-stu-id="42b0e-155">Alternatively, executing hello DROP DATABASE statement on hello source database also cancels hello copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="42b0e-156">Oldja meg a bejelentkezési adatok</span><span class="sxs-lookup"><span data-stu-id="42b0e-156">Resolve logins</span></span>

<span data-ttu-id="42b0e-157">Miután új adatbázis hello hello célkiszolgálón online állapotban, a hello [ALTER felhasználói](https://msdn.microsoft.com/library/ms176060.aspx) utasítás tooremap hello felhasználók hello új adatbázis-toologins hello célkiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="42b0e-157">After hello new database is online on hello destination server, use hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement tooremap hello users from hello new database toologins on hello destination server.</span></span> <span data-ttu-id="42b0e-158">tooresolve árva felhasználók [árva felhasználók hibaelhárítása](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="42b0e-158">tooresolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="42b0e-159">Lásd még: [hogyan toomanage Azure SQL-adatbázis biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="42b0e-159">See also [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="42b0e-160">Hello új adatbázisban lévő összes felhasználó számára, hogy a hello forrásadatbázis hello engedélyek megőrzése mellett.</span><span class="sxs-lookup"><span data-stu-id="42b0e-160">All users in hello new database retain hello permissions that they had in hello source database.</span></span> <span data-ttu-id="42b0e-161">adatbázis-másolat hello elindító felhasználó hello hello adatbázis hello új adatbázis tulajdonosa lesz, és hozzá van rendelve egy új biztonsági azonosítóval (SID).</span><span class="sxs-lookup"><span data-stu-id="42b0e-161">hello user who initiated hello database copy becomes hello database owner of hello new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="42b0e-162">Sikeres hello másolását követően, és mielőtt más felhasználók újra vannak társítva, csak hello bejelentkezési, másolása, hello kezdeményezett hello adatbázis-tulajdonos, bejelentkezhet toohello új adatbázist.</span><span class="sxs-lookup"><span data-stu-id="42b0e-162">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span>

<span data-ttu-id="42b0e-163">Tekintse meg a felhasználók és bejelentkezések kezelése, adatbázis tooa másik logikai kiszolgálót, másolásakor toolearn [hogyan toomanage Azure SQL-adatbázis biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="42b0e-163">toolearn about managing users and logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="42b0e-164">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="42b0e-164">Next steps</span></span>

* <span data-ttu-id="42b0e-165">Bejelentkezések kapcsolatos információkért lásd: [bejelentkezések kezelése](sql-database-manage-logins.md) és [hogyan toomanage Azure SQL-adatbázis biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="42b0e-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="42b0e-166">tooexport adatbázisba, lásd: [hello adatbázis tooa BACPAC exportálása](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="42b0e-166">tooexport a database, see [Export hello database tooa BACPAC](sql-database-export.md).</span></span>
