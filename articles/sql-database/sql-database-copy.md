---
title: "Azure SQL-adatbázis másolása |} Microsoft Docs"
description: "Azure SQL-adatbázis másolatának létrehozása"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 8c1e3c80b9f24089dc99463d6ea8ae5d0ea7b19d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="02876-103">Azure SQL-adatbázis másolása</span><span class="sxs-lookup"><span data-stu-id="02876-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="02876-104">Az Azure SQL-adatbázis létrehozásához egy meglévő Azure SQL adatbázis tranzakciós úton konzisztens másolatot ugyanarra a kiszolgálóra vagy egy másik kiszolgálóra több módszert biztosít.</span><span class="sxs-lookup"><span data-stu-id="02876-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either the same server or a different server.</span></span> <span data-ttu-id="02876-105">SQL-adatbázis másolása az Azure-portálon, a PowerShell vagy a T-SQL.</span><span class="sxs-lookup"><span data-stu-id="02876-105">You can copy a SQL database by using the Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="02876-106">Áttekintés</span><span class="sxs-lookup"><span data-stu-id="02876-106">Overview</span></span>

<span data-ttu-id="02876-107">Egy adatbázis-példány a source adatbázis időpontjában a a másolási kérés.</span><span class="sxs-lookup"><span data-stu-id="02876-107">A database copy is a snapshot of the source database as of the time of the copy request.</span></span> <span data-ttu-id="02876-108">Kiválaszthatja, hogy ugyanazon a kiszolgálón vagy egy másik kiszolgáló, a szolgáltatási rétegben és teljesítményszintet vagy egy másik teljesítményszintet belül az azonos szolgáltatási réteg (kiadás).</span><span class="sxs-lookup"><span data-stu-id="02876-108">You can select the same server or a different server, its service tier and performance level, or a different performance level within the same service tier (edition).</span></span> <span data-ttu-id="02876-109">A másolás után egy teljesen működőképes, független adatbázis válik.</span><span class="sxs-lookup"><span data-stu-id="02876-109">After the copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="02876-110">Ezen a ponton frissítése vagy visszaminősítését a bármely verzióra.</span><span class="sxs-lookup"><span data-stu-id="02876-110">At this point, you can upgrade or downgrade it to any edition.</span></span> <span data-ttu-id="02876-111">A bejelentkezési adatok, a felhasználók és az engedélyek függetlenül is kezelhetők.</span><span class="sxs-lookup"><span data-stu-id="02876-111">The logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-the-database-copy"></a><span data-ttu-id="02876-112">Az adatbázis-másolat bejelentkezésekre</span><span class="sxs-lookup"><span data-stu-id="02876-112">Logins in the database copy</span></span>

<span data-ttu-id="02876-113">Egy adatbázis ugyanazon a logikai kiszolgálón történő másolásakor a azonos bejelentkezések mindkét adatbázissal is használhatók.</span><span class="sxs-lookup"><span data-stu-id="02876-113">When you copy a database to the same logical server, the same logins can be used on both databases.</span></span> <span data-ttu-id="02876-114">A rendszerbiztonsági tag használatával másolja az adatbázist az új adatbázis az adatbázis tulajdonosa lesz.</span><span class="sxs-lookup"><span data-stu-id="02876-114">The security principal you use to copy the database becomes the database owner on the new database.</span></span> <span data-ttu-id="02876-115">Minden adatbázis-felhasználó, az engedélyek és a biztonsági azonosítók (SID) az adatbázis-másolat lesz másolva.</span><span class="sxs-lookup"><span data-stu-id="02876-115">All database users, their permissions, and their security identifiers (SIDs) are copied to the database copy.</span></span>  

<span data-ttu-id="02876-116">Adatbázis másolása egy másik logikai kiszolgálóhoz, ha a rendszerbiztonsági tag az új kiszolgáló lesz az adatbázis tulajdonosának az új adatbázis.</span><span class="sxs-lookup"><span data-stu-id="02876-116">When you copy a database to a different logical server, the security principal on the new server becomes the database owner on the new database.</span></span> <span data-ttu-id="02876-117">Ha [tartalmazott adatbázis-felhasználók](sql-database-manage-logins.md) adatelérés, biztosítja, hogy az elsődleges és másodlagos adatbázisok mindig a felhasználói hitelesítő adatokkal, így a másolás után azonnal elérhetőségét azokkal a hitelesítő adatokkal .</span><span class="sxs-lookup"><span data-stu-id="02876-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both the primary and secondary databases always have the same user credentials, so that after the copy is complete you can immediately access it with the same credentials.</span></span> 

<span data-ttu-id="02876-118">Ha [Azure Active Directory](../active-directory/active-directory-whatis.md), akkor is teljesen szükségtelenné teszik a hitelesítő adatokat, a Másolás kezelése.</span><span class="sxs-lookup"><span data-stu-id="02876-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate the need for managing credentials in the copy.</span></span> <span data-ttu-id="02876-119">Azonban az adatbázis új kiszolgálóra történő másolásakor a bejelentkezés-alapú hozzáférés előfordulhat, hogy nem működik, mert a bejelentkezési adatok nem léteznek az új kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="02876-119">However, when you copy the database to a new server, the login-based access might not work, because the logins do not exist on the new server.</span></span> <span data-ttu-id="02876-120">Bejelentkezések kezelése, ha az adatbázis másolása egy másik logikai kiszolgáló kapcsolatos további tudnivalókért lásd: [kezelése az Azure SQL database biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="02876-120">To learn about managing logins when you copy a database to a different logical server, see [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="02876-121">A másolási sikeres követően, és mielőtt más felhasználók újra vannak társítva, csak a bejelentkezési azonosítót, a másolás, az adatbázis tulajdonosának kezdeményezett bejelentkezhet az új adatbázishoz.</span><span class="sxs-lookup"><span data-stu-id="02876-121">After the copying succeeds and before other users are remapped, only the login that initiated the copying, the database owner, can log in to the new database.</span></span> <span data-ttu-id="02876-122">A másolási művelet befejezése után bejelentkezések megoldását lásd [bejelentkezések megoldásához](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="02876-122">To resolve logins after the copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-the-azure-portal"></a><span data-ttu-id="02876-123">Adatbázis másolása az Azure portál használatával</span><span class="sxs-lookup"><span data-stu-id="02876-123">Copy a database by using the Azure portal</span></span>

<span data-ttu-id="02876-124">Adatbázis másolása az Azure portál használatával, nyissa meg az adatbázis lapját, és kattintson **másolási**.</span><span class="sxs-lookup"><span data-stu-id="02876-124">To copy a database by using the Azure portal, open the page for your database, and then click **Copy**.</span></span> 

   ![Az adatbázis másolása](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="02876-126">Adatbázis másolása a PowerShell használatával</span><span class="sxs-lookup"><span data-stu-id="02876-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="02876-127">Adatbázis másolása a PowerShell használatával, használja a [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) parancsmag.</span><span class="sxs-lookup"><span data-stu-id="02876-127">To copy a database by using PowerShell, use the [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="02876-128">Tekintse meg a teljes minta parancsfájlt [adatbázis másolása egy új kiszolgálót](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="02876-128">For a complete sample script, see [Copy a database to a new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="02876-129">Adatbázis másolása Transact-SQL használatával</span><span class="sxs-lookup"><span data-stu-id="02876-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="02876-130">Jelentkezzen be a kiszolgálószintű fő bejelentkezéssel vagy a bejelentkezés által létrehozott át kívánja másolni az adatbázist a fő adatbázist.</span><span class="sxs-lookup"><span data-stu-id="02876-130">Log in to the master database with the server-level principal login or the login that created the database you want to copy.</span></span> <span data-ttu-id="02876-131">Az adatbázis másolása sikeres, bejelentkezési adatok, amelyek nincsenek a kiszolgálói szintű rendszerbiztonsági tag a dbmanager szerepkör tagjának kell lennie.</span><span class="sxs-lookup"><span data-stu-id="02876-131">For database copying to succeed, logins that are not the server-level principal must be members of the dbmanager role.</span></span> <span data-ttu-id="02876-132">Bejelentkezéseket és a kiszolgálóhoz való kapcsolódás kapcsolatos további információkért lásd: [bejelentkezések kezelése](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="02876-132">For more information about logins and connecting to the server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="02876-133">A forrásadatbázis másolásának megkezdése a [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) utasítást.</span><span class="sxs-lookup"><span data-stu-id="02876-133">Start copying the source database with the [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="02876-134">Az utasítás végrehajtása indít el az adatbázis másolása folyamat.</span><span class="sxs-lookup"><span data-stu-id="02876-134">Executing this statement initiates the database copying process.</span></span> <span data-ttu-id="02876-135">Mivel az adatbázis másolása egy aszinkron folyamat, a CREATE DATABASE utasítás adja vissza, az adatbázis-Másolás befejezése előtt.</span><span class="sxs-lookup"><span data-stu-id="02876-135">Because copying a database is an asynchronous process, the CREATE DATABASE statement returns before the database copying is complete.</span></span>

### <a name="copy-a-sql-database-to-the-same-server"></a><span data-ttu-id="02876-136">Egy SQL-adatbázis másolása ugyanarra a kiszolgálóra</span><span class="sxs-lookup"><span data-stu-id="02876-136">Copy a SQL database to the same server</span></span>
<span data-ttu-id="02876-137">Jelentkezzen be a kiszolgálószintű fő bejelentkezéssel vagy a bejelentkezés által létrehozott át kívánja másolni az adatbázist a fő adatbázist.</span><span class="sxs-lookup"><span data-stu-id="02876-137">Log in to the master database with the server-level principal login or the login that created the database you want to copy.</span></span> <span data-ttu-id="02876-138">Az adatbázis másolása sikeres, bejelentkezési adatok, amelyek nincsenek a kiszolgálói szintű rendszerbiztonsági tag a dbmanager szerepkör tagjának kell lennie.</span><span class="sxs-lookup"><span data-stu-id="02876-138">For database copying to succeed, logins that are not the server-level principal must be members of the dbmanager role.</span></span>

<span data-ttu-id="02876-139">Ez a parancs egy új adatbázist ugyanazon a kiszolgálón Database2 nevű Database1 másolja.</span><span class="sxs-lookup"><span data-stu-id="02876-139">This command copies Database1 to a new database named Database2 on the same server.</span></span> <span data-ttu-id="02876-140">Az adatbázis méretétől függően a másolási művelet eltarthat egy ideig.</span><span class="sxs-lookup"><span data-stu-id="02876-140">Depending on the size of your database, the copying operation might take some time to complete.</span></span>

    -- Execute on the master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-to-a-different-server"></a><span data-ttu-id="02876-141">Egy SQL-adatbázis másolása egy másik kiszolgálóra</span><span class="sxs-lookup"><span data-stu-id="02876-141">Copy a SQL database to a different server</span></span>

<span data-ttu-id="02876-142">Jelentkezzen be a célkiszolgáló, ahol az új adatbázisnak van-e létrehozni SQL-adatbáziskiszolgáló a fő adatbázist.</span><span class="sxs-lookup"><span data-stu-id="02876-142">Log in to the master database of the destination server, the SQL database server where the new database is to be created.</span></span> <span data-ttu-id="02876-143">Használjon olyan bejelentkezési azonosítót, amely rendelkezik az adatbázis tulajdonosának a forráskiszolgálón SQL adatbázis a forrásadatbázis ugyanazt a nevet és jelszót.</span><span class="sxs-lookup"><span data-stu-id="02876-143">Use a login that has the same name and password as the database owner of the source database on the source SQL database server.</span></span> <span data-ttu-id="02876-144">A bejelentkezés a célkiszolgálón is kell a dbmanager szerepkör tagjának vagy a kiszolgálószintű fő bejelentkezéssel kell.</span><span class="sxs-lookup"><span data-stu-id="02876-144">The login on the destination server must also be a member of the dbmanager role or be the server-level principal login.</span></span>

<span data-ttu-id="02876-145">Ez a parancs átmásolja Database1 kiszolgáló1 kiszolgáló2 Database2 nevű új adatbázis.</span><span class="sxs-lookup"><span data-stu-id="02876-145">This command copies Database1 on server1 to a new database named Database2 on server2.</span></span> <span data-ttu-id="02876-146">Az adatbázis méretétől függően a másolási művelet eltarthat egy ideig.</span><span class="sxs-lookup"><span data-stu-id="02876-146">Depending on the size of your database, the copying operation might take some time to complete.</span></span>

    -- Execute on the master database of the target server (server2)
    -- Start copying from Server1 to Server2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-the-progress-of-the-copying-operation"></a><span data-ttu-id="02876-147">A másolási művelet előrehaladásának figyeléséhez</span><span class="sxs-lookup"><span data-stu-id="02876-147">Monitor the progress of the copying operation</span></span>

<span data-ttu-id="02876-148">A másolási folyamat figyelése a sys.databases és sys.dm_database_copies nézet lekérdezésével.</span><span class="sxs-lookup"><span data-stu-id="02876-148">Monitor the copying process by querying the sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="02876-149">Miközben folyamatban van. a Másolás a **state_desc** a sys.databases nézetben az új adatbázis oszlop értéke **MÁSOLÁSA**.</span><span class="sxs-lookup"><span data-stu-id="02876-149">While the copying is in progress, the **state_desc** column of the sys.databases view for the new database is set to **COPYING**.</span></span>

* <span data-ttu-id="02876-150">Ha a másolás nem sikerül, a **state_desc** a sys.databases nézetben az új adatbázis oszlop értéke **FELTÉTELEZHETŐ**.</span><span class="sxs-lookup"><span data-stu-id="02876-150">If the copying fails, the **state_desc** column of the sys.databases view for the new database is set to **SUSPECT**.</span></span> <span data-ttu-id="02876-151">Hajtsa végre a DROP utasítást az új adatbázis, és próbálkozzon újra később.</span><span class="sxs-lookup"><span data-stu-id="02876-151">Execute the DROP statement on the new database, and try again later.</span></span>
* <span data-ttu-id="02876-152">Ha a másolás sikeres, a **state_desc** a sys.databases nézetben az új adatbázis oszlop értéke **ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="02876-152">If the copying succeeds, the **state_desc** column of the sys.databases view for the new database is set to **ONLINE**.</span></span> <span data-ttu-id="02876-153">A másolási befejeződött, és az új adatbázis rendszeres adatbázis a forrásadatbázis független módosítható.</span><span class="sxs-lookup"><span data-stu-id="02876-153">The copying is complete, and the new database is a regular database that can be changed independent of the source database.</span></span>

> [!NOTE]
> <span data-ttu-id="02876-154">Ha úgy dönt, hogy megszakítja a a másolást, amíg folyamatban van, a végrehajtást a [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) utasítás az új adatbázishoz.</span><span class="sxs-lookup"><span data-stu-id="02876-154">If you decide to cancel the copying while it is in progress, execute the [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on the new database.</span></span> <span data-ttu-id="02876-155">Alternatív megoldásként a DROP DATABASE utasítás végrehajtása a forrásadatbázison is visszavonja a másolási folyamat.</span><span class="sxs-lookup"><span data-stu-id="02876-155">Alternatively, executing the DROP DATABASE statement on the source database also cancels the copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="02876-156">Oldja meg a bejelentkezési adatok</span><span class="sxs-lookup"><span data-stu-id="02876-156">Resolve logins</span></span>

<span data-ttu-id="02876-157">Miután az új adatbázis a célkiszolgálón online állapotban, a [ALTER felhasználói](https://msdn.microsoft.com/library/ms176060.aspx) adja meg a felhasználók az új adatbázis bejelentkezések a célkiszolgálón újból az utasítást.</span><span class="sxs-lookup"><span data-stu-id="02876-157">After the new database is online on the destination server, use the [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement to remap the users from the new database to logins on the destination server.</span></span> <span data-ttu-id="02876-158">Árva felhasználók megoldása érdekében tekintse meg a [árva felhasználók hibaelhárítása](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="02876-158">To resolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="02876-159">Lásd még: [kezelése az Azure SQL database biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="02876-159">See also [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="02876-160">Minden felhasználó az új adatbázis a forrásadatbázis rendelkeztek engedélyeket megőrzése mellett.</span><span class="sxs-lookup"><span data-stu-id="02876-160">All users in the new database retain the permissions that they had in the source database.</span></span> <span data-ttu-id="02876-161">Az adatbázis-másolat elindító felhasználó az új adatbázis tulajdonosa lesz, és hozzá van rendelve egy új biztonsági azonosítóval (SID).</span><span class="sxs-lookup"><span data-stu-id="02876-161">The user who initiated the database copy becomes the database owner of the new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="02876-162">A másolási sikeres követően, és mielőtt más felhasználók újra vannak társítva, csak a bejelentkezési azonosítót, a másolás, az adatbázis tulajdonosának kezdeményezett bejelentkezhet az új adatbázishoz.</span><span class="sxs-lookup"><span data-stu-id="02876-162">After the copying succeeds and before other users are remapped, only the login that initiated the copying, the database owner, can log in to the new database.</span></span>

<span data-ttu-id="02876-163">Felhasználók és bejelentkezések kezelése, ha az adatbázis másolása egy másik logikai kiszolgáló kapcsolatos további tudnivalókért lásd: [kezelése az Azure SQL database biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="02876-163">To learn about managing users and logins when you copy a database to a different logical server, see [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="02876-164">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="02876-164">Next steps</span></span>

* <span data-ttu-id="02876-165">Bejelentkezések kapcsolatos információkért lásd: [bejelentkezések kezelése](sql-database-manage-logins.md) és [kezelése az Azure SQL database biztonsági katasztrófa utáni helyreállítás után](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="02876-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="02876-166">Egy adatbázis-exportálási, lásd: [exportálja az adatbázis egy BACPAC](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="02876-166">To export a database, see [Export the database to a BACPAC](sql-database-export.md).</span></span>
