---
title: "Azure SQL Database használata magas rendelkezésre állású szolgáltatás kialakítása |} Microsoft Docs"
description: "További tudnivalók az Azure SQL Database használata magas rendelkezésre állású szolgáltatások alkalmazás tervét."
keywords: "a felhő vész-helyreállítási, a vész-helyreállítási megoldások, az alkalmazás az adatok biztonsági mentése, a georeplikáció, üzleti folytonossági tervezése"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: e8a346ac-dd08-41e7-9685-46cebca04582
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-management
ms.date: 04/21/2017
ms.author: sashan
ms.openlocfilehash: 40fe0ae04eb94322356ed19773512e3bc383639c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="designing-highly-available-services-using-azure-sql-database"></a><span data-ttu-id="d08cd-104">Azure SQL Database használata magas rendelkezésre állású szolgáltatások tervezése</span><span class="sxs-lookup"><span data-stu-id="d08cd-104">Designing highly available services using Azure SQL Database</span></span>

<span data-ttu-id="d08cd-105">Összeállításakor, és az Azure SQL Database-magas rendelkezésre állású szolgáltatások telepítése, használata [feladatátvételi csoportok és aktív georeplikáció](sql-database-geo-replication-overview.md) regionális meghibásodásokkal és katasztrofális kimaradások tűrőképességet biztosít, és gyors helyreállítás engedélyezéséhez a másodlagos adatbázisok.</span><span class="sxs-lookup"><span data-stu-id="d08cd-105">When building and deploying highly available services on Azure SQL Database, you use [failover groups and active geo-replication](sql-database-geo-replication-overview.md) to provide resilience to regional failures and catastrophic outages and enable fast recovery to the secondary databases.</span></span> <span data-ttu-id="d08cd-106">Ez a cikk általános alkalmazás-minták összpontosít, és az előnyöket és kompromisszumot alakítson ki az egyes beállítások attól függően, hogy az alkalmazás központi telepítési követelményei, a szolgáltatásiszint-szerződés rendszerre ismerteti forgalom késleltetés és a költségeket.</span><span class="sxs-lookup"><span data-stu-id="d08cd-106">This article focuses on common application patterns and discusses the benefits and trade-offs of each option depending on the application deployment requirements, the service level agreement you are targeting, traffic latency, and costs.</span></span> <span data-ttu-id="d08cd-107">Aktív georeplikáció a rugalmas készletek kapcsolatos információkért lásd: [rugalmas készlet vész-helyreállítási stratégiák](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="d08cd-107">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

## <a name="design-pattern-1-active-passive-deployment-for-cloud-disaster-recovery-with-a-co-located-database"></a><span data-ttu-id="d08cd-108">1 a kialakítási mintában: aktív-passzív telepítési felhő vész-helyreállítási egy közös elhelyezésű adatbázis</span><span class="sxs-lookup"><span data-stu-id="d08cd-108">Design pattern 1: Active-passive deployment for cloud disaster recovery with a co-located database</span></span>
<span data-ttu-id="d08cd-109">Ez a beállítás akkor legmegfelelőbb alkalmazásokat az alábbi adatokkal:</span><span class="sxs-lookup"><span data-stu-id="d08cd-109">This option is best suited for applications with the following characteristics:</span></span>

* <span data-ttu-id="d08cd-110">Egy Azure-régió aktív példány</span><span class="sxs-lookup"><span data-stu-id="d08cd-110">Active instance in a single Azure region</span></span>
* <span data-ttu-id="d08cd-111">Erős függőségi adatokhoz való hozzáférés olvasási és írási (RW)</span><span class="sxs-lookup"><span data-stu-id="d08cd-111">Strong dependency on read-write (RW) access to data</span></span>
* <span data-ttu-id="d08cd-112">A webalkalmazás és az adatbázis közötti-régió összekapcsolását érvénytelen miatt a késés és a forgalom költség</span><span class="sxs-lookup"><span data-stu-id="d08cd-112">Cross-region connectivity between the web application and the database is not acceptable due to latency and traffic cost</span></span>    

<span data-ttu-id="d08cd-113">Ebben az esetben az alkalmazás üzembe helyezési topológia regionális katasztrófák kezelésére, az összes alkalmazás-összetevők érintett és feladatátvételi egységként kell megfelelően lett optimalizálva.</span><span class="sxs-lookup"><span data-stu-id="d08cd-113">In this case, the application deployment topology is optimized for handling regional disasters when all application components are impacted and need to failover as a unit.</span></span> <span data-ttu-id="d08cd-114">A földrajzi redundancia céljából az alkalmazás logikáját és az adatbázis egy másik régióban replikálódnak, de nem használhatók az alkalmazás terhelés a normál körülmények között.</span><span class="sxs-lookup"><span data-stu-id="d08cd-114">For geographic redundancy, the application logic and the database are replicated to another region but they are not used for the application workload under the normal conditions.</span></span> <span data-ttu-id="d08cd-115">Az alkalmazást a másodlagos régióban a másodlagos adatbázis SQL kapcsolati karakterláncának használatára kell konfigurálni.</span><span class="sxs-lookup"><span data-stu-id="d08cd-115">The application in the secondary region should be configured to use a SQL connection string to the secondary database.</span></span> <span data-ttu-id="d08cd-116">A TRAFFIC manager használatára van beállítva [feladatátvételi útválasztási módszer](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="d08cd-116">Traffic manager is set up to use [failover routing method](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span></span>  

> [!NOTE]
> <span data-ttu-id="d08cd-117">[Az Azure traffic manager](../traffic-manager/traffic-manager-overview.md) használja a rendszer keresztül ez a cikk csak illusztrációs célokat szolgálnak.</span><span class="sxs-lookup"><span data-stu-id="d08cd-117">[Azure traffic manager](../traffic-manager/traffic-manager-overview.md) is used throughout this article for illustration purposes only.</span></span> <span data-ttu-id="d08cd-118">Minden terheléselosztási megoldás, amely támogatja a feladatátvételi útválasztási módszer használható.</span><span class="sxs-lookup"><span data-stu-id="d08cd-118">You can use any load-balancing solution that supports failover routing method.</span></span>    
>

<span data-ttu-id="d08cd-119">Az alábbi ábrán látható az ebben a konfigurációban, nem tervezett kimaradás előtt.</span><span class="sxs-lookup"><span data-stu-id="d08cd-119">The following diagram shows this configuration before an outage.</span></span>

![SQL-adatbázis georeplikáció konfigurációs.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-1.png)

<span data-ttu-id="d08cd-122">Az elsődleges régióban kimaradás után a az SQL Database szolgáltatás észleli, hogy az elsődleges adatbázis nem érhető el, és elindítani a feladatátvételt a másodlagos adatbázist, a paraméterek az Automatikus feladatátvétel házirend alapján.</span><span class="sxs-lookup"><span data-stu-id="d08cd-122">After an outage in the primary region, the SQL Database service detects that the primary database is not accessible and trigger a failover to the secondary database based on the parameters of the automatic failover policy.</span></span> <span data-ttu-id="d08cd-123">Attól függően, hogy az alkalmazás SLA-t dönthet úgy is konfigurálhatja a türelmi időszak kimutatását a szolgáltatáskimaradás és a feladatátvételi maga között.</span><span class="sxs-lookup"><span data-stu-id="d08cd-123">Depending on your application SLA, you can decide to configure a grace period between the detection of the outage and the failover itself.</span></span> <span data-ttu-id="d08cd-124">Adatvesztés kockázata türelmi idő beállításának csökkenti az esetekre, ahol a szolgáltatáskimaradás katasztrofális, és rendelkezésre állás biztosításához az a régió nem gyorsan vissza.</span><span class="sxs-lookup"><span data-stu-id="d08cd-124">Configuring a grace period reduces the risk of data loss to the cases where the outage is catastrophic and availability in the region cannot be quickly restored.</span></span> <span data-ttu-id="d08cd-125">A végpont feladatátvételt kezdeményez a traffic manager előtt a feladatátvételi csoport elindítja a feladatátvételt, az adatbázis, a webes alkalmazás nem nem tud csatlakozni az adatbázishoz.</span><span class="sxs-lookup"><span data-stu-id="d08cd-125">If the endpoint failover is initiated by the traffic manager before the failover group triggers the failover of the database, the web application is not able to reconnect to the database.</span></span> <span data-ttu-id="d08cd-126">Az alkalmazás automatikusan újra megkísérli sikeres, amint az adatbázis feladatátvétel befejezését.</span><span class="sxs-lookup"><span data-stu-id="d08cd-126">The application’s attempt to reconnect automatically succeeds as soon as the database failover completes.</span></span> 

> [!NOTE]
> <span data-ttu-id="d08cd-127">Az alkalmazás és az adatbázisok teljes koordinált feladatátvételi eléréséhez kell megtervezi a saját figyelési módszert, és a webes alkalmazás végpontok és az adatbázisok kézi feladatátvételt használnak.</span><span class="sxs-lookup"><span data-stu-id="d08cd-127">To achieve fully coordinated failover of the application and the databases, you should devise your own monitoring method and use manual failover of the web application endpoints and the databases.</span></span>
>

<span data-ttu-id="d08cd-128">Az alkalmazási végpontokat és az adatbázis a feladatátvétel befejezése után az alkalmazás újraindul a régióban B felhasználói kérelmek feldolgozásának, és együtt az adatbázisban marad, mert az elsődleges adatbázis jelenleg régióban a b kiszolgálóra. Ebben a forgatókönyvben az alábbi ábrán látható.</span><span class="sxs-lookup"><span data-stu-id="d08cd-128">After the failover of both the application’s endpoints and the database completes, the application will re-start processing the user requests in the region B and will remain co-located with the database because the primary database is now in region B. This scenario is illustrated in the following diagram.</span></span> <span data-ttu-id="d08cd-129">Az összes diagramokon folytonos vonal jelzi az aktív kapcsolatok, pontozott vonal jelzi felfüggesztett kapcsolatok és leállítási jelet művelet eseményindítók jelzi.</span><span class="sxs-lookup"><span data-stu-id="d08cd-129">In all diagrams, solid lines indicate active connections, dotted lines indicate suspended connections, and stop signs indicate action triggers.</span></span>

![Georeplikáció: Feladatátvételi másodlagos adatbázishoz.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-2.png)

<span data-ttu-id="d08cd-132">Ha kimaradás történik, a másodlagos régióban, az elsődleges és a másodlagos adatbázis közötti replikációs hivatkozást fel van függesztve, de a feladatátvétel a rendszer nem indulnak el, mivel az elsődleges adatbázis nem változik.</span><span class="sxs-lookup"><span data-stu-id="d08cd-132">If an outage happens in the secondary region, the replication link between the primary and the secondary database is suspended but the failover is not triggered because the primary database is not impacted.</span></span> <span data-ttu-id="d08cd-133">Az alkalmazás rendelkezésre állásának ebben az esetben nem változik, de az alkalmazás működik kitett, és ezért nagyobb a veszélye esetben mindkét régió sikertelen egymás után.</span><span class="sxs-lookup"><span data-stu-id="d08cd-133">The application's availability is not changed in this case, but the application operates exposed and therefore at higher risk in case both regions fail in succession.</span></span>

> [!NOTE]
> <span data-ttu-id="d08cd-134">Vész-helyreállítási alkalmazástelepítéshez korlátozott konfiguráció két régió ajánlott.</span><span class="sxs-lookup"><span data-stu-id="d08cd-134">For disaster recovery we recommend the configuration with application deployment limited to two regions.</span></span> <span data-ttu-id="d08cd-135">Ennek az az oka az Azure földrajzi többsége csak két régióban.</span><span class="sxs-lookup"><span data-stu-id="d08cd-135">This is because most of the Azure geographies have only two regions.</span></span> <span data-ttu-id="d08cd-136">Ez a konfiguráció számára nem nyújt védelmet az alkalmazás mindkét régió egyidejű katasztrofális hibája esetén.</span><span class="sxs-lookup"><span data-stu-id="d08cd-136">This configuration will not protect your application from a simultaneous catastrophic failure of both regions.</span></span>  <span data-ttu-id="d08cd-137">Ilyen hiba valószínű esetben helyreállíthatja az adatbázisokat egy harmadik régiót használva [georedundáns helyreállítás művelet](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="d08cd-137">In an unlikely event of such a failure, you can recover your databases in a third region using [geo-restore operation](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span>
>

<span data-ttu-id="d08cd-138">A leállás elhárítására, ha a másodlagos adatbázist a rendszer automatikusan újra szinkronizálja az elsődleges.</span><span class="sxs-lookup"><span data-stu-id="d08cd-138">Once the outage is mitigated, the secondary database will automatically re-synchronize with the primary.</span></span> <span data-ttu-id="d08cd-139">A szinkronizálás során az elsődleges teljesítményének sikerült némileg negatív hatással lehet, amelyet a szinkronizálható adatok mennyiségétől függően.</span><span class="sxs-lookup"><span data-stu-id="d08cd-139">During synchronization, performance of the primary could be slightly impacted depending on the amount of data that needs to be synchronized.</span></span> <span data-ttu-id="d08cd-140">A következő ábra szemlélteti a másodlagos régióban kimaradás.</span><span class="sxs-lookup"><span data-stu-id="d08cd-140">The following diagram illustrates an outage in the secondary region.</span></span>

![Másodlagos adatbázis elsődleges szinkronizálva.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-3.png)

<span data-ttu-id="d08cd-143">A kulcs **előnyeit** ebben a kialakítási mintában a rendszer:</span><span class="sxs-lookup"><span data-stu-id="d08cd-143">The key **advantages** of this design pattern are:</span></span>

* <span data-ttu-id="d08cd-144">Mindkét régió nélkül régióspecifikus beállításra, és nincs további logikát reagálni a feladatátvételi azonos a webes alkalmazás telepítve van.</span><span class="sxs-lookup"><span data-stu-id="d08cd-144">The same web application is deployed to both regions without any region-specific configuration and no additional logic to react to the failover.</span></span> 
* <span data-ttu-id="d08cd-145">Az alkalmazások teljesítménye nincs hatással a feladatátvétel, a webes alkalmazás és az adatbázis mindig közös elhelyezésű.</span><span class="sxs-lookup"><span data-stu-id="d08cd-145">The application's performance is not impacted by failover as the web application and the database are always co-located.</span></span>

<span data-ttu-id="d08cd-146">A fő **kompromisszumot** a, hogy a redundáns alkalmazáspéldányt másodlagos régióban csak használt vész-helyreállítási.</span><span class="sxs-lookup"><span data-stu-id="d08cd-146">The main **tradeoff** is that the redundant application instance in the secondary region is only used for disaster recovery.</span></span>

## <a name="design-pattern-2-active-active-deployment-for-application-load-balancing"></a><span data-ttu-id="d08cd-147">A kialakításban 2: aktív-aktív központi telepítés alkalmazás terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="d08cd-147">Design pattern 2: Active-active deployment for application load balancing</span></span>
<span data-ttu-id="d08cd-148">A felhő vész helyreállítási lehetőség olyan környezethez a legalkalmasabb az alkalmazások a következő jellemzőkkel:</span><span class="sxs-lookup"><span data-stu-id="d08cd-148">This cloud disaster recovery option is best suited for applications with the following characteristics:</span></span>

* <span data-ttu-id="d08cd-149">Adatbázis olvasási és írási műveletek nagy aránya</span><span class="sxs-lookup"><span data-stu-id="d08cd-149">High ratio of database reads to writes</span></span>
* <span data-ttu-id="d08cd-150">Adatbázis olvasási késése lényegesebb a végfelhasználói élményt biztosít, mint a írási késése</span><span class="sxs-lookup"><span data-stu-id="d08cd-150">Database read latency is more critical for the end-user experience than the write latency</span></span> 
* <span data-ttu-id="d08cd-151">Csak olvasható logika elkülöníthető írható-olvasható logika különböző kapcsolati karakterlánc használatával</span><span class="sxs-lookup"><span data-stu-id="d08cd-151">Read-only logic can be separated from read-write logic by using a different connection string</span></span>
* <span data-ttu-id="d08cd-152">Csak olvasható logika nem függ a teljes szinkronizálás folyik a legújabb adatok</span><span class="sxs-lookup"><span data-stu-id="d08cd-152">Read-only logic does not depend on data being fully synchronized with the latest updates</span></span>  

<span data-ttu-id="d08cd-153">Ha az alkalmazások a következő jellemzőkkel rendelkezik, terheléselosztásának a végfelhasználói kapcsolatok különböző régiókban több alkalmazáspéldányt jelentősen javíthatja a teljes végfelhasználói élményt biztosít.</span><span class="sxs-lookup"><span data-stu-id="d08cd-153">If your applications have these characteristics, load balancing the end-user connections across multiple application instances in different regions can substantially improve the overall end-user experience.</span></span> <span data-ttu-id="d08cd-154">Két, régiók, a vész-Helyreállítási pár kell kiválasztani, és a feladatátvételi csoport e régiók bele kell foglalni az adatbázisokat.</span><span class="sxs-lookup"><span data-stu-id="d08cd-154">Two of the regions should be selected as the DR pair and the failover group should include the databases in these regions.</span></span> <span data-ttu-id="d08cd-155">Terheléselosztás alkalmazásához minden egyes régió az olvasási és írási (RW) logikával az olvasási és írási figyelő végpont a feladatátvételi csoport csatlakoztatva kell rendelkeznie az alkalmazás aktív példány.</span><span class="sxs-lookup"><span data-stu-id="d08cd-155">To implement load-balancing, each region should have an active instance of the application with the read-write (RW) logic connected to the read-write listener endpoint of the failover group.</span></span> <span data-ttu-id="d08cd-156">Ez garantálja, hogy a rendszer automatikusan kezdeményezni a feladatátvételt, ha az elsődleges adatbázis kimaradás van hatással.</span><span class="sxs-lookup"><span data-stu-id="d08cd-156">It will guarantee that the failover will be automatically initiated if the primary database is impacted by an outage.</span></span> <span data-ttu-id="d08cd-157">A csak olvasható programot (RO) a webes alkalmazás közvetlenül az adott régióban adatbázis csatlakozzon.</span><span class="sxs-lookup"><span data-stu-id="d08cd-157">The read-only logic (RO) in the web application should connect directly to the database in that region.</span></span> <span data-ttu-id="d08cd-158">A TRAFFIC manager használatára kell beállítani [teljesítmény útválasztási](../traffic-manager/traffic-manager-configure-performance-routing-method.md) rendelkező [végpont figyelési](../traffic-manager/traffic-manager-monitoring.md) minden egyes alkalmazás-példány engedélyezve van.</span><span class="sxs-lookup"><span data-stu-id="d08cd-158">Traffic manager should be set up to use [performance routing](../traffic-manager/traffic-manager-configure-performance-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for each application instance.</span></span>

<span data-ttu-id="d08cd-159">Mint #1 mintát érdemes lehet hasonló figyelési kérelem telepítése.</span><span class="sxs-lookup"><span data-stu-id="d08cd-159">As in pattern #1, you should consider deploying a similar monitoring application.</span></span> <span data-ttu-id="d08cd-160">De eltérően mintát #1, a figyelési alkalmazás nem lesz a végpont feladatátvételi kiváltásáért felelős.</span><span class="sxs-lookup"><span data-stu-id="d08cd-160">But unlike pattern #1, the monitoring application will not be responsible for triggering the end-point failover.</span></span>

> [!NOTE]
> <span data-ttu-id="d08cd-161">Amíg ez a minta egynél több másodlagos adatbázist használ, csak a másodlagos régióban b. a feladatátvételre használni, és a feladatátvételi csoport részének kell lennie.</span><span class="sxs-lookup"><span data-stu-id="d08cd-161">While this pattern uses more than one secondary database, only the secondary in Region B  would be used for failover and should be part of the failover group.</span></span>
>

<span data-ttu-id="d08cd-162">A TRAFFIC manager útválasztási át tudja irányítani a felhasználói kapcsolatok legközelebb a felhasználó földrajzi helye alkalmazáspéldány teljesítmény kell konfigurálni.</span><span class="sxs-lookup"><span data-stu-id="d08cd-162">Traffic manager should be configured for performance routing to direct the user connections to the application instance closest to the user's geographic location.</span></span> <span data-ttu-id="d08cd-163">A következő ábra szemlélteti ezt a konfigurációt nem tervezett kimaradás előtt.</span><span class="sxs-lookup"><span data-stu-id="d08cd-163">The following diagram illustrates this configuration before an outage.</span></span>

![Nincs leállás: Teljesítmény alkalmazás legközelebbi történő továbbítást.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-1.png)

<span data-ttu-id="d08cd-166">Ha egy adatbázis leállás észlel A régióban, a feladatátvételi csoport automatikusan indít el feladatátvétel az elsődleges adatbázis A régióban a másodlagos régióban a b kiszolgálóra. Azt is automatikusan frissíti az olvasási és írási figyelő végpont B régióban, írási és olvasási kapcsolatokat a webes alkalmazás nem csökkenhet.</span><span class="sxs-lookup"><span data-stu-id="d08cd-166">If a database outage is detected in the region A, the failover group will automatically initiate failover of the primary database in region A to the secondary in region B. It will also automatically update the read-write listener endpoint to region B so read-write connections in the web application will not be impacted.</span></span> <span data-ttu-id="d08cd-167">A traffic manager a kapcsolat nélküli végpontot fog kizárása az útválasztási táblában, de továbbra is a végfelhasználói forgalom a fennmaradó online példányok történő továbbítást.</span><span class="sxs-lookup"><span data-stu-id="d08cd-167">The traffic manager will exclude the offline end-point from the routing table but will continue routing the end-user traffic to the remaining online instances.</span></span> <span data-ttu-id="d08cd-168">A csak olvasható SQL kapcsolati karakterláncok nem befolyásolja a, ezek mindig pontot ugyanabban a régióban az adatbázishoz.</span><span class="sxs-lookup"><span data-stu-id="d08cd-168">The read-only SQL connection strings will not be impacted as they always point to the database in the same region.</span></span> 

<span data-ttu-id="d08cd-169">A következő ábra szemlélteti a feladatátvétel után az új konfigurációt.</span><span class="sxs-lookup"><span data-stu-id="d08cd-169">The following diagram illustrates the new configuration after the failover.</span></span>

![Konfigurációs feladatátvételt követően.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-2.png)

<span data-ttu-id="d08cd-172">A másodlagos régiók egyikében kimaradás esetén a traffic manager automatikusan eltávolítja a kapcsolat nélküli végpontot az adott régióban az útválasztási táblázatban.</span><span class="sxs-lookup"><span data-stu-id="d08cd-172">In case of an outage in one of the secondary regions, the traffic manager will automatically remove the offline end-point in that region from the routing table.</span></span> <span data-ttu-id="d08cd-173">A replikációs csatornát a másodlagos adatbázist, az adott régióban fel lesz függesztve.</span><span class="sxs-lookup"><span data-stu-id="d08cd-173">The replication channel to the secondary database in that region will be suspended.</span></span> <span data-ttu-id="d08cd-174">A fennmaradó régiók további felhasználói forgalom beolvasása ebben a forgatókönyvben, mert az alkalmazás teljesítményének a szolgáltatáskimaradás alatt csökkenhet.</span><span class="sxs-lookup"><span data-stu-id="d08cd-174">Because the remaining regions get additional user traffic in this scenario, the application's performance will be impacted during the outage.</span></span> <span data-ttu-id="d08cd-175">Miután a szolgáltatáskimaradás elhárítására, a másodlagos adatbázist, az érintett területen azonnal szinkronizálható az elsődleges.</span><span class="sxs-lookup"><span data-stu-id="d08cd-175">Once the outage is mitigated, the secondary database in the impacted region will be immediately synchronized with the primary.</span></span> <span data-ttu-id="d08cd-176">A szinkronizálás során az elsődleges teljesítményének sikerült némileg negatív hatással lehet, amelyet a szinkronizálható adatok mennyiségétől függően.</span><span class="sxs-lookup"><span data-stu-id="d08cd-176">During the synchronization performance of the primary could be slightly impacted depending on the amount of data that needs to be synchronized.</span></span> <span data-ttu-id="d08cd-177">A következő ábra szemlélteti a nem tervezett kimaradás régióban a b kiszolgálóra.</span><span class="sxs-lookup"><span data-stu-id="d08cd-177">The following diagram illustrates an outage in region B.</span></span>

![Ezen kívül az másodlagos régióba.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-3.png)

<span data-ttu-id="d08cd-180">A kulcs **előny** Ez a kialakítás minta az, hogy az alkalmazás munkaterhelés méretezheti a végfelhasználói optimális teljesítményének eléréséhez több másodlagos adatbázis között.</span><span class="sxs-lookup"><span data-stu-id="d08cd-180">The key **advantage** of this design pattern is that you can scale the application workload across multiple secondaries to achieve the optimal end-user performance.</span></span> <span data-ttu-id="d08cd-181">A **mellékhatásokkal** ezt a beállítást a rendszer:</span><span class="sxs-lookup"><span data-stu-id="d08cd-181">The **tradeoffs** of this option are:</span></span>

* <span data-ttu-id="d08cd-182">Az alkalmazáspéldányok és az adatbázis írható-olvasható kapcsolatainak rendelkezik változó késés és a költséghatékonyság</span><span class="sxs-lookup"><span data-stu-id="d08cd-182">Read-write connections between the application instances and database have varying latency and cost</span></span>
* <span data-ttu-id="d08cd-183">Az alkalmazások teljesítményének kihatással van a szolgáltatáskimaradás elhárítása során</span><span class="sxs-lookup"><span data-stu-id="d08cd-183">Application performance is impacted during the outage</span></span>

> [!NOTE]
> <span data-ttu-id="d08cd-184">A hasonló megközelítést speciális munkaterhelések esetén, mint jelentéskészítési feladatok, a business intelligence eszközök vagy a biztonsági mentések kiszervezéséhez használható.</span><span class="sxs-lookup"><span data-stu-id="d08cd-184">A similar approach can be used to offload specialized workloads such as reporting jobs, business intelligence tools, or backups.</span></span> <span data-ttu-id="d08cd-185">Általában az ilyen terhelések jelentős adatbázis erőforrások kihasználásához ezért javasoljuk, hogy jelöljön ki egy másodlagos adatbázis azokat a teljesítmény szintű egyeztetni kell a várható terhelést.</span><span class="sxs-lookup"><span data-stu-id="d08cd-185">Typically, these workloads consume significant database resources therefore it is recommended that you designate one of the secondary databases for them with the performance level matched to the anticipated workload.</span></span>
>

## <a name="design-pattern-3-active-passive-deployment-for-data-preservation"></a><span data-ttu-id="d08cd-186">A kialakításban 3: aktív-passzív telepítési az adatok megőrzése</span><span class="sxs-lookup"><span data-stu-id="d08cd-186">Design pattern 3: Active-passive deployment for data preservation</span></span>
<span data-ttu-id="d08cd-187">Ez a beállítás akkor legmegfelelőbb alkalmazásokat az alábbi adatokkal:</span><span class="sxs-lookup"><span data-stu-id="d08cd-187">This option is best suited for applications with the following characteristics:</span></span>

* <span data-ttu-id="d08cd-188">Az adatvesztés nagy üzleti áll.</span><span class="sxs-lookup"><span data-stu-id="d08cd-188">Any data loss is high business risk.</span></span> <span data-ttu-id="d08cd-189">Az adatbázis feladatátvételi csak használható utolsó lehetőségként a szolgáltatáskimaradás katasztrófa esetén is.</span><span class="sxs-lookup"><span data-stu-id="d08cd-189">The database failover can only be used as a last resort if the outage is catastrophic.</span></span>
* <span data-ttu-id="d08cd-190">Az alkalmazás műveletek csak olvasható és írható-olvasható módot támogat, és egy ideig működhet "csak olvasható módban".</span><span class="sxs-lookup"><span data-stu-id="d08cd-190">The application supports read-only and read-write modes of operations and can operate in "read-only mode" for a period of time.</span></span>

<span data-ttu-id="d08cd-191">Ebben a mintában az alkalmazás csak olvasható módra vált az olvasási és írási kapcsolatok az időtúllépési hibák első indításakor.</span><span class="sxs-lookup"><span data-stu-id="d08cd-191">In this pattern, the application switches to read-only mode when the read-write connections start getting time-out errors.</span></span> <span data-ttu-id="d08cd-192">A webes alkalmazás mindkét régió telepít, és az olvasási és írási figyelő végpont kapcsolat és a csak olvasható figyelő másik kapcsolat.</span><span class="sxs-lookup"><span data-stu-id="d08cd-192">The Web Application is deployed to both regions and include a connection to the read-write listener endpoint and different connection to the read-only listener endpoint.</span></span> <span data-ttu-id="d08cd-193">A Traffic manager használatára kell beállítani [feladatátvételi útválasztási](../traffic-manager/traffic-manager-configure-failover-routing-method.md) rendelkező [végpont figyelési](../traffic-manager/traffic-manager-monitoring.md) engedélyezve van az alkalmazás végpont minden régióban.</span><span class="sxs-lookup"><span data-stu-id="d08cd-193">The Traffic manager should be set up to use [failover routing](../traffic-manager/traffic-manager-configure-failover-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for the application endpoint in each region.</span></span>

<span data-ttu-id="d08cd-194">A következő ábra szemlélteti ezt a konfigurációt nem tervezett kimaradás előtt.</span><span class="sxs-lookup"><span data-stu-id="d08cd-194">The following diagram illustrates this configuration before an outage.</span></span>

![Aktív-passzív telepítési feladatátvétel előtt.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-1.png)

<span data-ttu-id="d08cd-197">Ha a traffic manager régiónak A kapcsolat hibát észlel, automatikusan vált felhasználói forgalom az alkalmazáspéldány régióban a b kiszolgálóra. Ebben a mintában fontos, hogy megadta a türelmi időszak adatvesztéssel elég magas értékre, például 24 óra.</span><span class="sxs-lookup"><span data-stu-id="d08cd-197">When the traffic manager detects a connectivity failure to region A, it automatically switches user traffic to the application instance in region B. With this pattern, it is important that you set the grace period with data loss to a sufficiently high value, e.g. 24 hours.</span></span> <span data-ttu-id="d08cd-198">Biztosítja, hogy adatvesztés megakadályozta, ha a szolgáltatáskimaradás elhárítására adott időn belül.</span><span class="sxs-lookup"><span data-stu-id="d08cd-198">It will ensure that data loss is prevented if the outage is mitigated within that time.</span></span> <span data-ttu-id="d08cd-199">A webalkalmazás a régióban B aktiválásakor az olvasási és írási műveletek indul sikertelenek lesznek.</span><span class="sxs-lookup"><span data-stu-id="d08cd-199">When the Web application in the region B is activated the read-write operations will start failing.</span></span> <span data-ttu-id="d08cd-200">Ezen a ponton akkor át kell váltania a csak olvasható módra.</span><span class="sxs-lookup"><span data-stu-id="d08cd-200">At that point, it should switch to the read-only mode.</span></span> <span data-ttu-id="d08cd-201">Ebben a módban a kérelmeket a rendszer automatikus irányítsa a másodlagos adatbázis.</span><span class="sxs-lookup"><span data-stu-id="d08cd-201">In this mode the requests will be automatically routed to the secondary database.</span></span> <span data-ttu-id="d08cd-202">Végzetes hiba esetén a szolgáltatáskimaradás nem szüntethető a türelmi időszak, és a feladatátvételi csoport akkor indul el, a feladatátvételt.</span><span class="sxs-lookup"><span data-stu-id="d08cd-202">In the case of a catastrophic failure the outage will not be mitigated within the grace period and the failover group will trigger the failover.</span></span> <span data-ttu-id="d08cd-203">Követően, hogy az írható-olvasható figyelő is elérhető lesz, és a hívások nem tesz további sikertelenek lesznek.</span><span class="sxs-lookup"><span data-stu-id="d08cd-203">After that the read-write listener will become available and the calls to it will stop failing.</span></span> <span data-ttu-id="d08cd-204">Ezt az alábbi ábra szemlélteti.</span><span class="sxs-lookup"><span data-stu-id="d08cd-204">This is illustrated by the following diagram.</span></span>

![Kimaradás: Alkalmazás csak olvasható módban.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-2.png)

<span data-ttu-id="d08cd-207">Ha az elsődleges régióban a szolgáltatáskimaradás elhárítására a türelmi időszak, a traffic manager észleli a kapcsolat visszaállítása az elsődleges régióban, felhasználói forgalom vissza az alkalmazáspéldány régióban azonosítójához. Adott alkalmazáspéldány után folytatja működését, és az elsődleges adatbázis használata a régióban A. írható-olvasható módban működik</span><span class="sxs-lookup"><span data-stu-id="d08cd-207">If the outage in the primary region is mitigated within the grace period, traffic manager detects the restoration of connectivity in the primary region and switches user traffic back to the application instance in region A. That application instance resumes and operates in read-write mode using the primary database in region A.</span></span>

<span data-ttu-id="d08cd-208">A régióban B kimaradás esetén a traffic manager azt észleli, az alkalmazás végpont régióban B hibája és a feladatátvételi csoport kapcsolók a csak olvasható figyelő régióban A. A leállás nem befolyásolja a végfelhasználói élményt biztosít, de az elsődleges adatbázis elérhetővé tehető a szolgáltatáskimaradás elhárítása során.</span><span class="sxs-lookup"><span data-stu-id="d08cd-208">In case of an outage in the region B, the traffic manager detects the failure of the application end-point in region B and the failover group switches the read-only listener to region A. This outage does not impact the end-user experience but the primary database will be exposed during the outage.</span></span> <span data-ttu-id="d08cd-209">Ezt az alábbi ábra szemlélteti.</span><span class="sxs-lookup"><span data-stu-id="d08cd-209">This is illustrated by the following diagram.</span></span>

![Kimaradás: Másodlagos adatbázishoz.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-3.png)

<span data-ttu-id="d08cd-212">A leállás elhárítására, ha a másodlagos adatbázis azonnal szinkronizálja az elsődleges és a csak olvasható figyelő át lett váltva vissza a másodlagos adatbázis régióban a b kiszolgálóra. A szinkronizálás során az elsődleges teljesítményének sikerült némileg negatív hatással lehet, amelyet a szinkronizálható adatok mennyiségétől függően.</span><span class="sxs-lookup"><span data-stu-id="d08cd-212">Once the outage is mitigated, the secondary database is immediately synchronized with the primary and the read-only listener is switched back to the secondary database in region B. During synchronization performance of the primary could be slightly impacted depending on the amount of data that needs to be synchronized.</span></span>

<span data-ttu-id="d08cd-213">Ebben a kialakításban van több **előnyeit**:</span><span class="sxs-lookup"><span data-stu-id="d08cd-213">This design pattern has several **advantages**:</span></span>

* <span data-ttu-id="d08cd-214">Adatvesztés Ezzel elkerülheti a átmeneti kimaradásainak során.</span><span class="sxs-lookup"><span data-stu-id="d08cd-214">It avoids data loss during the temporary outages.</span></span>
* <span data-ttu-id="d08cd-215">Állásidő csak milyen gyorsan a traffic manager észleli a csatlakozási hiba, amely konfigurálható függ.</span><span class="sxs-lookup"><span data-stu-id="d08cd-215">Downtime depends only on how quickly traffic manager detects the connectivity failure, which is configurable.</span></span>

<span data-ttu-id="d08cd-216">A **kompromisszumot** van:</span><span class="sxs-lookup"><span data-stu-id="d08cd-216">The **tradeoff** is:</span></span>

* <span data-ttu-id="d08cd-217">Alkalmazás csak olvasható módban képesnek kell lennie.</span><span class="sxs-lookup"><span data-stu-id="d08cd-217">Application must be able to operate in read-only mode.</span></span>

> [!NOTE]
> <span data-ttu-id="d08cd-218">Állandó szolgáltatáskimaradás régióban esetén manuálisan aktiválásakor adatbázis feladatátvétel és fogadja el az adatvesztés.</span><span class="sxs-lookup"><span data-stu-id="d08cd-218">In case of a permanent service outage in the region, you manually activate database failover and accept the data loss.</span></span> <span data-ttu-id="d08cd-219">Az alkalmazás olvasási és írási hozzáféréssel az adatbázishoz a másodlagos régióban fog működni.</span><span class="sxs-lookup"><span data-stu-id="d08cd-219">The application will be functional in the secondary region with read-write access to the database.</span></span>
>

## <a name="business-continuity-planning-choose-an-application-design-for-cloud-disaster-recovery"></a><span data-ttu-id="d08cd-220">Üzleti folytonosság tervezési: Válasszon egy alkalmazás tervét felhő katasztrófa utáni helyreállítás</span><span class="sxs-lookup"><span data-stu-id="d08cd-220">Business continuity planning: Choose an application design for cloud disaster recovery</span></span>
<span data-ttu-id="d08cd-221">Egyes adott felhőalapú vész-helyreállítási stratégiát kombinálhatja, vagy az alkalmazás igényeinek leginkább megfelelő ezek a kialakítási minták kiterjesztése.</span><span class="sxs-lookup"><span data-stu-id="d08cd-221">Your specific cloud disaster recovery strategy can combine or extend these design patterns to best meet the needs of your application.</span></span>  <span data-ttu-id="d08cd-222">A korábban említett stratégia az SLA-t szeretne ajánlani az ügyfelek és az alkalmazás üzembe helyezési topológia alapul.</span><span class="sxs-lookup"><span data-stu-id="d08cd-222">As mentioned earlier, the strategy you choose is based on the SLA you want to offer to your customers and the application deployment topology.</span></span> <span data-ttu-id="d08cd-223">A következő részekben talál a döntést, hogy az alábbi táblázat összehasonlítja a választási lehetőségek alapján a becsült adatvesztés vagy a helyreállítási időkorlát (RPO) pontot, majd becsült helyreállítási idő (Beszúrása).</span><span class="sxs-lookup"><span data-stu-id="d08cd-223">To help guide your decision, the following table compares the choices based on the estimated data loss or recovery point objective (RPO) and estimated recovery time (ERT).</span></span>

| <span data-ttu-id="d08cd-224">Minta</span><span class="sxs-lookup"><span data-stu-id="d08cd-224">Pattern</span></span> | <span data-ttu-id="d08cd-225">A HELYREÁLLÍTÁSI IDŐKORLÁT</span><span class="sxs-lookup"><span data-stu-id="d08cd-225">RPO</span></span> | <span data-ttu-id="d08cd-226">BESZÚRÁSA</span><span class="sxs-lookup"><span data-stu-id="d08cd-226">ERT</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="d08cd-227">Aktív-passzív telepítési közös elhelyezésű adatbázis-hozzáférést katasztrófa utáni helyreállítás</span><span class="sxs-lookup"><span data-stu-id="d08cd-227">Active-passive deployment for disaster recovery with co-located database access</span></span> |<span data-ttu-id="d08cd-228">Olvasási és írási hozzáférése < 5 másodperc</span><span class="sxs-lookup"><span data-stu-id="d08cd-228">Read-write access < 5 sec</span></span> |<span data-ttu-id="d08cd-229">Hiba észlelése időpontja + a DNS-élettartam</span><span class="sxs-lookup"><span data-stu-id="d08cd-229">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="d08cd-230">Aktív-aktív központi telepítés alkalmazás terheléselosztás</span><span class="sxs-lookup"><span data-stu-id="d08cd-230">Active-active deployment for application load balancing</span></span> |<span data-ttu-id="d08cd-231">Olvasási és írási hozzáférése < 5 másodperc</span><span class="sxs-lookup"><span data-stu-id="d08cd-231">Read-write access < 5 sec</span></span> |<span data-ttu-id="d08cd-232">Hiba észlelése időpontja + a DNS-élettartam</span><span class="sxs-lookup"><span data-stu-id="d08cd-232">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="d08cd-233">Aktív-passzív telepítési az adatok megőrzése</span><span class="sxs-lookup"><span data-stu-id="d08cd-233">Active-passive deployment for data preservation</span></span> |<span data-ttu-id="d08cd-234">Csak olvasási hozzáféréssel < 5 másodperc</span><span class="sxs-lookup"><span data-stu-id="d08cd-234">Read-only access < 5 sec</span></span> | <span data-ttu-id="d08cd-235">Csak olvasási hozzáféréssel = 0</span><span class="sxs-lookup"><span data-stu-id="d08cd-235">Read-only access = 0</span></span> |
||<span data-ttu-id="d08cd-236">Olvasási és írási hozzáférése = nulla</span><span class="sxs-lookup"><span data-stu-id="d08cd-236">Read-write access = zero</span></span> | <span data-ttu-id="d08cd-237">Olvasási és írási hozzáférése = hiba észlelés ideje + adatvesztéssel türelmi időszak</span><span class="sxs-lookup"><span data-stu-id="d08cd-237">Read-write access = Failure detection time + grace period with data loss</span></span> |
|||

## <a name="next-steps"></a><span data-ttu-id="d08cd-238">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="d08cd-238">Next steps</span></span>
* <span data-ttu-id="d08cd-239">További tudnivalók az Azure SQL adatbázis automatikus biztonsági mentés című [SQL-adatbázis automatikus biztonsági mentés](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="d08cd-239">To learn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="d08cd-240">Egy üzleti folytonosság – áttekintés és forgatókönyvek: [üzleti folytonosság – áttekintés](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="d08cd-240">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="d08cd-241">A helyreállítás automatikus biztonsági mentés használatával kapcsolatos további tudnivalókért lásd: [adatbázis visszaállítása a szolgáltatás által kezdeményezett biztonsági másolatból](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="d08cd-241">To learn about using automated backups for recovery, see [restore a database from the service-initiated backups](sql-database-recovery-using-backups.md)</span></span>
* <span data-ttu-id="d08cd-242">Gyorsabb helyreállítási beállításokkal kapcsolatos további tudnivalókért lásd: [aktív georeplikáció](sql-database-geo-replication-overview.md)</span><span class="sxs-lookup"><span data-stu-id="d08cd-242">To learn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md)</span></span>  
* <span data-ttu-id="d08cd-243">Automatikus biztonsági mentés az Archiválás használatával kapcsolatos további tudnivalókért lásd: [adatbázis másolása](sql-database-copy.md)</span><span class="sxs-lookup"><span data-stu-id="d08cd-243">To learn about using automated backups for archiving, see [database copy](sql-database-copy.md)</span></span>
* <span data-ttu-id="d08cd-244">Aktív georeplikáció a rugalmas készletek kapcsolatos információkért lásd: [rugalmas készlet vész-helyreállítási stratégiák](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="d08cd-244">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
