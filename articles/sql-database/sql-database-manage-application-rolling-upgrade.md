---
title: "aaaRolling alkalmazásfrissítések - Azure SQL Database |} Microsoft Docs"
description: "Megtudhatja, hogyan toouse Azure SQL Database georeplikációja toosupport online frissítései a felhőalapú alkalmazásnál."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 58f42859-1e37-463c-a3d8-a3ca2e867148
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 07/16/2016
ms.author: sashan
ms.openlocfilehash: 18c56300916d129bff141624cc5c416b500408d4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="managing-rolling-upgrades-of-cloud-applications-using-sql-database-active-geo-replication"></a><span data-ttu-id="aea90-103">Az SQL-adatbázis aktív georeplikáció használatával a felhőalapú alkalmazásokhoz működés közbeni frissítések kezelése</span><span class="sxs-lookup"><span data-stu-id="aea90-103">Managing rolling upgrades of cloud applications using SQL Database active geo-replication</span></span>
> [!NOTE]
> <span data-ttu-id="aea90-104">[Aktív georeplikáció](sql-database-geo-replication-overview.md) érhető el az összes olyan adatbázis az összes rétege.</span><span class="sxs-lookup"><span data-stu-id="aea90-104">[Active geo-replication](sql-database-geo-replication-overview.md) is now available for all databases in all tiers.</span></span>
> 

<span data-ttu-id="aea90-105">Megtudhatja, hogyan toouse [georeplikáció](sql-database-geo-replication-overview.md) az SQL-adatbázis tooenable működés közbeni frissítés a felhő alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="aea90-105">Learn how toouse [geo-replication](sql-database-geo-replication-overview.md) in SQL Database tooenable rolling upgrades of your cloud application.</span></span> <span data-ttu-id="aea90-106">Mivel a frissítés egy zavaró művelet, azt az üzleti folytonossági tervezési és kialakítási részének kell lennie.</span><span class="sxs-lookup"><span data-stu-id="aea90-106">Because upgrade is a disruptive operation, it should be part of your business continuity planning and design.</span></span> <span data-ttu-id="aea90-107">Ebben a cikkben úgy tekintünk kétféleképpen koordinálása hello frissítési folyamat, és hello előnyei és az egyes lehetőségek kompromisszumot ismertetik.</span><span class="sxs-lookup"><span data-stu-id="aea90-107">In this article we look at two different methods of orchestrating hello upgrade process, and discuss hello benefits and trade-offs of each option.</span></span> <span data-ttu-id="aea90-108">Ez a cikk hello alkalmazásában egy egyszerű alkalmazást alkotó webhely csatlakoztatott tooa egy adatbázist, az adatok rétegként használjuk.</span><span class="sxs-lookup"><span data-stu-id="aea90-108">For hello purposes of this article we will use a simple application that consists of a web site connected tooa single database as its data tier.</span></span> <span data-ttu-id="aea90-109">Célunk tooupgrade 1 hello alkalmazás tooversion 2 bármely jelentős befolyásolása nélkül futó verziójával hello végfelhasználói élmény.</span><span class="sxs-lookup"><span data-stu-id="aea90-109">Our goal is tooupgrade version 1 of hello application tooversion 2 without any significant impact on hello end-user experience.</span></span> 

<span data-ttu-id="aea90-110">Frissítési beállítások hello kiértékelésekor hello a következő tényezőket kell figyelembe vennie:</span><span class="sxs-lookup"><span data-stu-id="aea90-110">When evaluating hello upgrade options you should consider hello following factors:</span></span>

* <span data-ttu-id="aea90-111">Érintő forgalomkiesés alkalmazás frissítéskor.</span><span class="sxs-lookup"><span data-stu-id="aea90-111">Impact on application availability during upgrades.</span></span> <span data-ttu-id="aea90-112">Mennyi ideig hello alkalmazás függvény korlátozható vagy csökkentett teljesítményű.</span><span class="sxs-lookup"><span data-stu-id="aea90-112">How long hello application function may be limited or degraded.</span></span>
* <span data-ttu-id="aea90-113">Egy frissítési hiba esetén vissza tooroll képességét.</span><span class="sxs-lookup"><span data-stu-id="aea90-113">Ability tooroll back in case of an upgrade failure.</span></span>
* <span data-ttu-id="aea90-114">A biztonsági rés hello alkalmazás hello frissítés során nem végzetes hiba esetén.</span><span class="sxs-lookup"><span data-stu-id="aea90-114">Vulnerability of hello application if an unrelated catastrophic failure occurs during hello upgrade.</span></span>
* <span data-ttu-id="aea90-115">Amerikai dollár teljes költsége.</span><span class="sxs-lookup"><span data-stu-id="aea90-115">Total dollar cost.</span></span>  <span data-ttu-id="aea90-116">Ez magában foglalja a további redundancia és többletköltségei hello hello frissítési folyamat által használt ideiglenes összetevőket.</span><span class="sxs-lookup"><span data-stu-id="aea90-116">This includes additional redundancy and incremental costs of hello temporary components  used by hello upgrade process.</span></span> 

## <a name="upgrading-applications-that-rely-on-database-backups-for-disaster-recovery"></a><span data-ttu-id="aea90-117">A vész-helyreállítási mentéseket használó alkalmazások frissítése</span><span class="sxs-lookup"><span data-stu-id="aea90-117">Upgrading applications that rely on database backups for disaster recovery</span></span>
<span data-ttu-id="aea90-118">Az alkalmazás automatikus mentését alapul, és vész-helyreállítási georedundáns helyreállítás használ, célszerű általában telepített tooa egyetlen Azure-régiót.</span><span class="sxs-lookup"><span data-stu-id="aea90-118">If your application relies on automatic database backups and uses geo-restore for disaster recovery, it is usually deployed tooa single Azure region.</span></span> <span data-ttu-id="aea90-119">Ebben az esetben hello frissítési magában foglalja a biztonsági mentési központi telepítés összes alkalmazás-összetevő hello frissítés részt.</span><span class="sxs-lookup"><span data-stu-id="aea90-119">In this case hello upgrade process involves creating a backup deployment of all application components involved in hello upgrade.</span></span> <span data-ttu-id="aea90-120">toominimize hello végfelhasználói megszűnésének hello feladatátvételi profillal fogja használni a Azure Traffic Manager (WATM).</span><span class="sxs-lookup"><span data-stu-id="aea90-120">toominimize hello end-user disruption you will leverage Azure Traffic Manager (WATM) with hello failover profile.</span></span>  <span data-ttu-id="aea90-121">a következő diagram hello hello működési környezetbe előzetes toohello frissítési folyamatát mutatja be.</span><span class="sxs-lookup"><span data-stu-id="aea90-121">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="aea90-122">végpont hello <i>contoso-1.azurewebsites.net</i> hello alkalmazás, amelyet a frissített toobe éles helyét jelöli.</span><span class="sxs-lookup"><span data-stu-id="aea90-122">hello endpoint <i>contoso-1.azurewebsites.net</i> represents a production slot of hello application that needs toobe upgraded.</span></span> <span data-ttu-id="aea90-123">tooenable hello képességét tooroll vissza hello frissítését, szakasz tárhely hello alkalmazás teljesen szinkronizált másolatát kell létrehozása.</span><span class="sxs-lookup"><span data-stu-id="aea90-123">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="aea90-124">hello következő lépések végrehajtására szükség tooprepare hello alkalmazás hello frissítésre:</span><span class="sxs-lookup"><span data-stu-id="aea90-124">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="aea90-125">Hello frissítési fázis tárhely létrehozása.</span><span class="sxs-lookup"><span data-stu-id="aea90-125">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="aea90-126">Hozzon létre egy másodlagos adatbázist (1), és az azonos webhelyen hello telepítését toodo azonos Azure-régiót.</span><span class="sxs-lookup"><span data-stu-id="aea90-126">toodo that create a secondary database (1) and deploy an identical web site in hello same Azure region.</span></span> <span data-ttu-id="aea90-127">Ha hello összehangolása folyamat befejeződött, figyelje a hello másodlagos toosee.</span><span class="sxs-lookup"><span data-stu-id="aea90-127">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="aea90-128">Hozzon létre egy feladatátvevő profilt az WATM a <i>contoso-1.azurewebsites.net</i> online végpontként és <i>contoso-2.azurewebsites.net</i> offline állapotúként.</span><span class="sxs-lookup"><span data-stu-id="aea90-128">Create a failover profile in WATM with <i>contoso-1.azurewebsites.net</i> as online endpoint and <i>contoso-2.azurewebsites.net</i> as offline.</span></span> 

> [!NOTE]
> <span data-ttu-id="aea90-129">Megjegyzés: hello előkészítő lépések nem befolyásolja az éles tárolóhelyre hello hello alkalmazás, és teljes hozzáférési módban működéséhez.</span><span class="sxs-lookup"><span data-stu-id="aea90-129">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
>  

![SQL adatbázis Ugrás-replikációs konfiguráció.](media/sql-database-manage-application-rolling-upgrade/Option1-1.png)

<span data-ttu-id="aea90-132">Ha megadta hello előkészítő lépések hello alkalmazás készen áll a hello tényleges frissítés.</span><span class="sxs-lookup"><span data-stu-id="aea90-132">Once hello preparation steps are completed hello application is ready for hello actual upgrade.</span></span> <span data-ttu-id="aea90-133">a következő diagram hello hello lépéseit hello frissítési folyamatát mutatja be.</span><span class="sxs-lookup"><span data-stu-id="aea90-133">hello following diagram illustrates hello steps involved in hello upgrade process.</span></span> 

1. <span data-ttu-id="aea90-134">Állítsa be az elsődleges adatbázis hello hello éles tárhely tooread csak módban (3).</span><span class="sxs-lookup"><span data-stu-id="aea90-134">Set hello primary database in hello production slot tooread-only mode (3).</span></span> <span data-ttu-id="aea90-135">Ez garantálja, hogy hello hello alkalmazás (V1) éles példánya marad írásvédett megelőzve hello adateltérésekkel hello V1 és V2 adatbázis-példány között hello frissítés során.</span><span class="sxs-lookup"><span data-stu-id="aea90-135">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="aea90-136">Válassza le a másodlagos adatbázis hello hello tervezett lezárást módban (4).</span><span class="sxs-lookup"><span data-stu-id="aea90-136">Disconnect hello secondary database using hello planned termination mode (4).</span></span> <span data-ttu-id="aea90-137">Hello elsődleges adatbázis teljesen szinkronizált független másolatot hoz létre.</span><span class="sxs-lookup"><span data-stu-id="aea90-137">It will create a fully synchronized independent copy of hello primary database.</span></span> <span data-ttu-id="aea90-138">Ez az adatbázis lesz frissítve.</span><span class="sxs-lookup"><span data-stu-id="aea90-138">This database will be upgraded.</span></span>
3. <span data-ttu-id="aea90-139">Hello elsődleges adatbázis tooread-írási üzemmód és parancsprogrammal hello frissítési hello szakasz tárolóhelye (5).</span><span class="sxs-lookup"><span data-stu-id="aea90-139">Turn hello primary database tooread-write mode and run hello upgrade script in hello stage slot  (5).</span></span>     

![SQL-adatbázis georeplikáció konfigurációs.](media/sql-database-manage-application-rolling-upgrade/Option1-2.png)

<span data-ttu-id="aea90-142">Ha hello frissítése sikeresen befejeződött, most már áll készen tooswitch hello végfelhasználók előkészített toohello másolási hello alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="aea90-142">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello staged copy hello application.</span></span> <span data-ttu-id="aea90-143">Most válik hello alkalmazás hello éles tárolóhelyre.</span><span class="sxs-lookup"><span data-stu-id="aea90-143">It will now become hello production slot of hello application.</span></span>  <span data-ttu-id="aea90-144">Ebbe beletartozik a következő diagram hello módon néhány további lépéseket.</span><span class="sxs-lookup"><span data-stu-id="aea90-144">This involves a few more steps as illustrated on hello following diagram.</span></span>

1. <span data-ttu-id="aea90-145">Túl kapcsoló hello online végpont hello WATM profil<i>contoso-2.azurewebsites.net</i>, milyen pontok toohello V2 verziójú hello webhely (6).</span><span class="sxs-lookup"><span data-stu-id="aea90-145">Switch hello online endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which points toohello V2 version of hello web site (6).</span></span> <span data-ttu-id="aea90-146">Változik a hello V2 alkalmazás hello éles tárolóhelyre és hello végfelhasználói forgalma irányított tooit.</span><span class="sxs-lookup"><span data-stu-id="aea90-146">It now becomes hello production slot with hello V2 application and hello end-user traffic is directed tooit.</span></span>  
2. <span data-ttu-id="aea90-147">Ha már nincs szüksége hello V1-es alkalmazás-összetevők, nyugodtan távolítsa el őket (7).</span><span class="sxs-lookup"><span data-stu-id="aea90-147">If you no longer need hello V1 application components so you can safely remove them (7).</span></span>   

![SQL-adatbázis georeplikáció konfigurációs.](media/sql-database-manage-application-rolling-upgrade/Option1-3.png)

<span data-ttu-id="aea90-150">Ha hello frissítési folyamat sikertelen, például hello frissítési parancsfájl, a tooan hiba miatt hello szakasz tárolóhely tekintendő sérült.</span><span class="sxs-lookup"><span data-stu-id="aea90-150">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="aea90-151">tooroll biztonsági hello toohello frissítés előtti alkalmazásállapot hello alkalmazás hello éles tárhely toofull Access egyszerűen állítsa vissza.</span><span class="sxs-lookup"><span data-stu-id="aea90-151">tooroll back hello application toohello pre-upgrade state you simply revert hello application in hello production slot toofull access.</span></span> <span data-ttu-id="aea90-152">hello lépéseit hello következő diagramon láthatók.</span><span class="sxs-lookup"><span data-stu-id="aea90-152">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="aea90-153">Állítsa be a hello adatbázis másolása tooread-írási módban (8).</span><span class="sxs-lookup"><span data-stu-id="aea90-153">Set hello database copy tooread-write mode (8).</span></span> <span data-ttu-id="aea90-154">A művelettel visszaállítja hello teljes V1 funkcionálisan a hello éles tárolóhelyre.</span><span class="sxs-lookup"><span data-stu-id="aea90-154">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="aea90-155">Hajtsa végre a hello kiváltó okának elemzése, és távolítsa el a sérült hello összetevők hello szakasz tárolóhelye (9).</span><span class="sxs-lookup"><span data-stu-id="aea90-155">Perform hello root cause analysis and remove hello compromised components in hello stage slot (9).</span></span> 

<span data-ttu-id="aea90-156">Ezen a ponton hello alkalmazás teljesen működőképes és hello frissítési lépések megismételhető.</span><span class="sxs-lookup"><span data-stu-id="aea90-156">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="aea90-157">hello visszaállítása nem szükséges WATM profil változásait, már mutat túl<i>contoso-1.azurewebsites.net</i> , hello aktív végpontot.</span><span class="sxs-lookup"><span data-stu-id="aea90-157">hello rollback does not require changes in WATM profile as it already points too<i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![SQL-adatbázis georeplikáció konfigurációs.](media/sql-database-manage-application-rolling-upgrade/Option1-4.png)

<span data-ttu-id="aea90-160">hello kulcs **előny** ezt a beállítást az, hogy egy alkalmazás egyszerű ismertetett lépések segítségével egy régió frissítheti.</span><span class="sxs-lookup"><span data-stu-id="aea90-160">hello key **advantage** of this option is that you can upgrade an application in a single region using a set of simple steps.</span></span> <span data-ttu-id="aea90-161">hello dollár költség hello frissítés viszonylag alacsony.</span><span class="sxs-lookup"><span data-stu-id="aea90-161">hello dollar cost of hello upgrade is relatively low.</span></span> <span data-ttu-id="aea90-162">fő hello **kompromisszumot** , amely hello frissítési hello helyreállítási toohello frissítés előtti állapotot során végzetes hiba esetén tartalmazzon hello alkalmazás egy másik régióban található és a visszaállítási hello adatbázis újbóli telepítése biztonsági mentés georedundáns helyreállítás.</span><span class="sxs-lookup"><span data-stu-id="aea90-162">hello main **tradeoff** is that if a catastrophic failure occurs during hello upgrade hello recovery toohello pre-upgrade state will involve re-deployment of hello application in a different region and restoring hello database from backup using geo-restore.</span></span> <span data-ttu-id="aea90-163">Ez a folyamat jelentős állásidőt eredményez.</span><span class="sxs-lookup"><span data-stu-id="aea90-163">This process will result in significant downtime.</span></span>   

## <a name="upgrading-applications-that-rely-on-database-geo-replication-for-disaster-recovery"></a><span data-ttu-id="aea90-164">A database georeplikációja a vész-helyreállítási használó alkalmazások frissítése</span><span class="sxs-lookup"><span data-stu-id="aea90-164">Upgrading applications that rely on database geo-replication for disaster recovery</span></span>
<span data-ttu-id="aea90-165">Ha az alkalmazás kihasználja az üzletmenet folytonossága érdekében georeplikáció, telepített tooat legalább két különböző régiókban az elsődleges régióban egy aktív központi telepítés és a készenléti biztonsági mentés a régióban.</span><span class="sxs-lookup"><span data-stu-id="aea90-165">If your application leverages geo-replication for business continuity, it is deployed  tooat least two different regions with an active deployment in Primary region and a standby deployment in Backup region.</span></span> <span data-ttu-id="aea90-166">Ezenkívül toohello tényezők a korábban említett hello frissítési folyamat garantálnia kell, hogy:</span><span class="sxs-lookup"><span data-stu-id="aea90-166">In addition toohello factors mentioned earlier, hello upgrade process must guarantee that:</span></span>

* <span data-ttu-id="aea90-167">hello alkalmazás védve marad az végzetes hibák mindig hello frissítési folyamat során</span><span class="sxs-lookup"><span data-stu-id="aea90-167">hello application remains protected from catastrophic failures at all times during hello upgrade process</span></span>
* <span data-ttu-id="aea90-168">hello georedundáns összetevő hello alkalmazás párhuzamosan hello aktív összetevők frissítésének</span><span class="sxs-lookup"><span data-stu-id="aea90-168">hello geo-redundant components of hello application are upgraded in parallel with hello active components</span></span>

<span data-ttu-id="aea90-169">Ezen célok fogja használni, Azure Traffic Manager (WATM) használatával hello feladatátvételi profil egy aktív és három biztonsági mentés végpontok tooachieve.</span><span class="sxs-lookup"><span data-stu-id="aea90-169">tooachieve these goals you will leverage Azure Traffic Manager (WATM) using hello failover profile with one active and three backup endpoints.</span></span>  <span data-ttu-id="aea90-170">a következő diagram hello hello működési környezetbe előzetes toohello frissítési folyamatát mutatja be.</span><span class="sxs-lookup"><span data-stu-id="aea90-170">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="aea90-171">webhelyek hello <i>contoso-1.azurewebsites.net</i> és <i>contoso-dr.azurewebsites.net</i> egy éles tárolóhelyre hello alkalmazás teljes földrajzi redundanciával képviseli.</span><span class="sxs-lookup"><span data-stu-id="aea90-171">hello web sites <i>contoso-1.azurewebsites.net</i> and <i>contoso-dr.azurewebsites.net</i> represent a production slot of hello application with full geographic redundancy.</span></span> <span data-ttu-id="aea90-172">tooenable hello képességét tooroll vissza hello frissítését, szakasz tárhely hello alkalmazás teljesen szinkronizált másolatát kell létrehozása.</span><span class="sxs-lookup"><span data-stu-id="aea90-172">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="aea90-173">Tooensure, amely hello alkalmazás gyorsan helyreállíthatja, ha egy végzetes hiba bekövetkezése hello frissítési folyamat során van szükség, mert hello szakasz tárolóhely kell toobe georedundáns is.</span><span class="sxs-lookup"><span data-stu-id="aea90-173">Because you need tooensure that hello application can quickly recover in case a catastrophic failure occurs during hello upgrade process, hello stage slot needs toobe geo-redundant as well.</span></span> <span data-ttu-id="aea90-174">hello következő lépések végrehajtására szükség tooprepare hello alkalmazás hello frissítésre:</span><span class="sxs-lookup"><span data-stu-id="aea90-174">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="aea90-175">Hello frissítési fázis tárhely létrehozása.</span><span class="sxs-lookup"><span data-stu-id="aea90-175">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="aea90-176">Hozzon létre egy másodlagos adatbázist (1), és a webhely hello hello azonos példányának telepítését toodo azonos Azure-régiót.</span><span class="sxs-lookup"><span data-stu-id="aea90-176">toodo that create a secondary database (1) and deploy an identical copy of hello web site in hello same Azure region.</span></span> <span data-ttu-id="aea90-177">Ha hello összehangolása folyamat befejeződött, figyelje a hello másodlagos toosee.</span><span class="sxs-lookup"><span data-stu-id="aea90-177">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="aea90-178">Hozzon létre egy georedundáns másodlagos adatbázist hello szakasz tárolóhelye földrajzi replikálása hello másodlagos adatbázis toohello biztonsági mentési terület (Ez a lehetőség "kapcsolt georeplikáció").</span><span class="sxs-lookup"><span data-stu-id="aea90-178">Create a geo-redundant secondary database in hello stage slot by geo-replicating hello secondary database toohello backup region (this is called "chained geo-replication").</span></span> <span data-ttu-id="aea90-179">Ha folyamat összehangolása hello befejezett (3) a biztonsági mentés másodlagos toosee hello figyelése</span><span class="sxs-lookup"><span data-stu-id="aea90-179">Monitor hello backup secondary toosee if hello seeding process is completed (3).</span></span>
3. <span data-ttu-id="aea90-180">Hello biztonsági mentési régióban hello webhely készenléti másolatának létrehozása hozzákapcsolja azt toohello georedundáns másodlagos (4).</span><span class="sxs-lookup"><span data-stu-id="aea90-180">Create a standby copy of hello web site in hello backup region and link it toohello geo-redundant secondary (4).</span></span>  
4. <span data-ttu-id="aea90-181">Hello további végpontok hozzáadása <i>contoso-2.azurewebsites.net</i> és <i>contoso-3.azurewebsites.net</i> toohello feladatátvételi profil WATM a kapcsolat nélküli végpontként (5).</span><span class="sxs-lookup"><span data-stu-id="aea90-181">Add hello additional endpoints <i>contoso-2.azurewebsites.net</i> and <i>contoso-3.azurewebsites.net</i> toohello failover profile in WATM as offline endpoints (5).</span></span> 

> [!NOTE]
> <span data-ttu-id="aea90-182">Megjegyzés: hello előkészítő lépések nem befolyásolja az éles tárolóhelyre hello hello alkalmazás, és teljes hozzáférési módban működéséhez.</span><span class="sxs-lookup"><span data-stu-id="aea90-182">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
> 
> 

![SQL-adatbázis georeplikáció konfigurációs.](media/sql-database-manage-application-rolling-upgrade/Option2-1.png)

<span data-ttu-id="aea90-185">Hello előkészítő lépések elvégzése után hello szakasz tárolóhely hello frissítés készen áll.</span><span class="sxs-lookup"><span data-stu-id="aea90-185">Once hello preparation steps are completed, hello stage slot is ready for hello upgrade.</span></span> <span data-ttu-id="aea90-186">a következő diagram hello hello frissítés lépéseit mutatja be.</span><span class="sxs-lookup"><span data-stu-id="aea90-186">hello following diagram illustrates hello upgrade steps.</span></span>

1. <span data-ttu-id="aea90-187">Hello elsődleges adatbázis hello éles tárhely csak tooread módra beállítva (6).</span><span class="sxs-lookup"><span data-stu-id="aea90-187">Set hello primary database in hello production slot tooread-only mode (6).</span></span> <span data-ttu-id="aea90-188">Ez garantálja, hogy hello hello alkalmazás (V1) éles példánya marad írásvédett megelőzve hello adateltérésekkel hello V1 és V2 adatbázis-példány között hello frissítés során.</span><span class="sxs-lookup"><span data-stu-id="aea90-188">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="aea90-189">Válassza le a másodlagos adatbázis hello hello a ugyanabban a régióban használatával hello tervezett lezárást mód (7).</span><span class="sxs-lookup"><span data-stu-id="aea90-189">Disconnect hello secondary database in hello same region using hello planned termination mode (7).</span></span> <span data-ttu-id="aea90-190">Hello elsődleges adatbázis, amely egy elsődleges automatikusan válik hello leállása után teljesen szinkronizált független másolatot hoz létre.</span><span class="sxs-lookup"><span data-stu-id="aea90-190">It will create a fully synchronized independent copy of hello primary database, which will automatically become a primary after hello termination.</span></span> <span data-ttu-id="aea90-191">Ez az adatbázis lesz frissítve.</span><span class="sxs-lookup"><span data-stu-id="aea90-191">This database will be upgraded.</span></span>
3. <span data-ttu-id="aea90-192">Kapcsolja be az elsődleges adatbázis hello hello szakasz tárolóhely tooread-írási módban, és futtassa a hello frissítési parancsfájl (8).</span><span class="sxs-lookup"><span data-stu-id="aea90-192">Turn hello primary database in hello stage slot tooread-write mode and run hello upgrade script (8).</span></span>    

![SQL-adatbázis georeplikáció konfigurációs.](media/sql-database-manage-application-rolling-upgrade/Option2-2.png)

<span data-ttu-id="aea90-195">Ha hello frissítése sikeresen befejeződött áll készen tooswitch hello végfelhasználók toohello V2 hello alkalmazás verziója.</span><span class="sxs-lookup"><span data-stu-id="aea90-195">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello V2 version of hello application.</span></span> <span data-ttu-id="aea90-196">a következő diagram hello hello lépéseit mutatja be.</span><span class="sxs-lookup"><span data-stu-id="aea90-196">hello following diagram illustrates hello steps involved.</span></span>

1. <span data-ttu-id="aea90-197">Túl kapcsoló hello aktív végpontja hello WATM profil<i>contoso-2.azurewebsites.net</i>, mely most mutat toohello V2 verziójú hello webhely (9).</span><span class="sxs-lookup"><span data-stu-id="aea90-197">Switch hello active endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which now points toohello V2 version of hello web site (9).</span></span> <span data-ttu-id="aea90-198">Most válik hello V2-alkalmazás az éles tárhely és végfelhasználói forgalma irányított tooit.</span><span class="sxs-lookup"><span data-stu-id="aea90-198">It now becomes a production slot with hello V2 application and end-user traffic is directed tooit.</span></span> 
2. <span data-ttu-id="aea90-199">Ha már nincs szüksége hello V1-es alkalmazás így biztonságosan eltávolíthatja (10-es és 11).</span><span class="sxs-lookup"><span data-stu-id="aea90-199">If you no longer need hello V1 application so you can safely remove it (10 and 11).</span></span>  

![SQL-adatbázis georeplikáció konfigurációs.](media/sql-database-manage-application-rolling-upgrade/Option2-3.png)

<span data-ttu-id="aea90-202">Ha hello frissítési folyamat sikertelen, például hello frissítési parancsfájl, a tooan hiba miatt hello szakasz tárolóhely tekintendő sérült.</span><span class="sxs-lookup"><span data-stu-id="aea90-202">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="aea90-203">tooroll biztonsági hello toohello frissítés előtti alkalmazásállapot egyszerűen állítsa vissza toousing hello alkalmazás teljes hozzáféréssel rendelkező hello éles tárolóhelyre.</span><span class="sxs-lookup"><span data-stu-id="aea90-203">tooroll back hello application toohello pre-upgrade state you simply revert toousing hello application in hello production slot with full access.</span></span> <span data-ttu-id="aea90-204">hello lépéseit hello következő diagramon láthatók.</span><span class="sxs-lookup"><span data-stu-id="aea90-204">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="aea90-205">Set hello elsődleges adatbázis-másolat hello éles tárhely tooread-írási módban (12).</span><span class="sxs-lookup"><span data-stu-id="aea90-205">Set hello primary database copy in hello production slot tooread-write mode (12).</span></span> <span data-ttu-id="aea90-206">A művelettel visszaállítja hello teljes V1 funkcionálisan a hello éles tárolóhelyre.</span><span class="sxs-lookup"><span data-stu-id="aea90-206">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="aea90-207">Hajtsa végre a hello kiváltó okának elemzése, és távolítsa el a sérült hello összetevők hello szakasz tárolóhelye (13 és 14).</span><span class="sxs-lookup"><span data-stu-id="aea90-207">Perform hello root cause analysis and remove hello compromised components in hello stage slot (13 and 14).</span></span> 

<span data-ttu-id="aea90-208">Ezen a ponton hello alkalmazás teljesen működőképes és hello frissítési lépések megismételhető.</span><span class="sxs-lookup"><span data-stu-id="aea90-208">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="aea90-209">hello visszaállítása nem szükséges WATM profil változásait, már mutat túl <i>contoso-1.azurewebsites.net</i> , hello aktív végpontot.</span><span class="sxs-lookup"><span data-stu-id="aea90-209">hello rollback does not require changes in WATM profile as it already points too <i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![SQL-adatbázis georeplikáció konfigurációs.](media/sql-database-manage-application-rolling-upgrade/Option2-4.png)

<span data-ttu-id="aea90-212">hello kulcs **előny** ezt a beállítást az, hogy frissíteni hello alkalmazás és is a georedundáns párhuzamosan hello frissítés során az üzletmenet folytonossága veszélyeztetése nélkül.</span><span class="sxs-lookup"><span data-stu-id="aea90-212">hello key **advantage** of this option is that you can upgrade both hello application and its geo-redundant copy in parallel without compromising your business continuity during hello upgrade.</span></span> <span data-ttu-id="aea90-213">fő hello **kompromisszumot** igényel minden egyes alkalmazás-összetevő dupla redundanciát, így ezért költséget az magasabb dollár áll.</span><span class="sxs-lookup"><span data-stu-id="aea90-213">hello main **tradeoff** is that it requires double redundancy of each application component and therefore incurs higher dollar cost.</span></span> <span data-ttu-id="aea90-214">A bonyolultabb munkafolyamat is magában foglalja.</span><span class="sxs-lookup"><span data-stu-id="aea90-214">It also involves a more complicated workflow.</span></span> 

## <a name="summary"></a><span data-ttu-id="aea90-215">Összefoglalás</span><span class="sxs-lookup"><span data-stu-id="aea90-215">Summary</span></span>
<span data-ttu-id="aea90-216">hello két frissítési módszerek hello cikkben ismertetett költség összetettségét és hello dollár különböznek, de mindkettő összpontosítani minimalizálja a hello időpontot, amikor a végfelhasználó hello korlátozott csak tooread műveleteket.</span><span class="sxs-lookup"><span data-stu-id="aea90-216">hello two upgrade methods described in hello article differ in complexity and hello dollar cost but they both focus on minimizing hello time when hello end user is limited tooread-only operations.</span></span> <span data-ttu-id="aea90-217">Ideje közvetlenül hello frissítési parancsfájl hello időtartamát határozza meg.</span><span class="sxs-lookup"><span data-stu-id="aea90-217">That time is directly defined by hello duration of hello upgrade script.</span></span> <span data-ttu-id="aea90-218">Hello adatbázis mérete nem függ, hello szolgáltatásiréteg-akkor válassza, hello webhely konfigurációja és egyéb tényezőkkel, amelyek könnyen nem tudja beállítani.</span><span class="sxs-lookup"><span data-stu-id="aea90-218">It does not depend on hello database size, hello service tier you chose, hello web site configuration and other factors that you cannot easily control.</span></span> <span data-ttu-id="aea90-219">Ennek az az oka az összes hello előkészítő lépések vannak különválik hello frissítési lépések és hello termelési alkalmazások befolyásolása nélkül végezheti.</span><span class="sxs-lookup"><span data-stu-id="aea90-219">This is because all hello preparation steps are decoupled from hello upgrade steps and can be done without impacting hello production application.</span></span> <span data-ttu-id="aea90-220">frissítési parancsprogram hello hello hatékonyságát hello kulcsfontosságú tényező, amely meghatározza egy hello végfelhasználói élmény frissítéskor.</span><span class="sxs-lookup"><span data-stu-id="aea90-220">hello efficiency of hello upgrade script is hello key factor that determines hello end-user experience during upgrades.</span></span> <span data-ttu-id="aea90-221">Ezért hello fejlesztheti azt legkönnyebben a próbálkozások összpontosító így hello frissítési parancsfájl felhasználását.</span><span class="sxs-lookup"><span data-stu-id="aea90-221">So hello best way you can improve it is by focusing your efforts on making hello upgrade script as efficient as possible.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="aea90-222">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="aea90-222">Next steps</span></span>
* <span data-ttu-id="aea90-223">Egy üzleti folytonosság – áttekintés és forgatókönyvek: [üzleti folytonosság – áttekintés](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="aea90-223">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md).</span></span>
* <span data-ttu-id="aea90-224">tudnivalók Azure SQL adatbázis automatikus biztonsági mentés, toolearn lásd: [SQL-adatbázis biztonsági mentések automatikus](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="aea90-224">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="aea90-225">toolearn a helyreállításhoz, az automatikus biztonsági mentés használatával kapcsolatban lásd: [adatbázis visszaállítása biztonsági másolatból automatizált](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="aea90-225">toolearn about using automated backups for recovery, see [restore a database from automated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="aea90-226">toolearn gyorsabb helyreállítási beállításokkal kapcsolatban lásd: [aktív georeplikáció](sql-database-geo-replication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="aea90-226">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md).</span></span>


