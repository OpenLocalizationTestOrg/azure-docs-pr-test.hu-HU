---
title: "Azure SQL-adatbázisban található Lekérdezéstár aaaOperating"
description: "Ismerje meg, hogyan toooperate hello Azure SQL-adatbázisban található Lekérdezéstár"
keywords: 
services: sql-database
documentationcenter: 
author: bonova
manager: jhubbard
editor: 
ms.assetid: 0cccf6bd-1327-44f7-a6f9-8eff0c210463
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: sqldb-performance
ms.workload: data-management
ms.date: 11/08/2016
ms.author: bonova
ms.openlocfilehash: ab741e49685bf6df3bceab219aaf57ea51cdb25d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="operating-hello-query-store-in-azure-sql-database"></a><span data-ttu-id="66902-103">Működési hello Azure SQL-adatbázisban található Lekérdezéstár</span><span class="sxs-lookup"><span data-stu-id="66902-103">Operating hello Query Store in Azure SQL Database</span></span>
<span data-ttu-id="66902-104">A Lekérdezéstár az Azure-ban érhető el egy teljes körűen felügyelt adatbázis-szolgáltatás, amely folyamatosan gyűjti, és minden lekérdezést előzménymodell részletes adatait jeleníti meg.</span><span class="sxs-lookup"><span data-stu-id="66902-104">Query Store in Azure is a fully managed database feature that continuously collects and presents detailed historic information about all queries.</span></span> <span data-ttu-id="66902-105">Információ a Lekérdezéstárról, hasonló tooan repülőgép felé továbbított adatok író, amely jelentősen leegyszerűsíti a lekérdezési teljesítmény hibaelhárítási mind a felhőalapú és helyszíni felhasználók gondolja.</span><span class="sxs-lookup"><span data-stu-id="66902-105">You can think about Query Store as similar tooan airplane's flight data recorder that significantly simplifies query performance troubleshooting both for cloud and on-premises customers.</span></span> <span data-ttu-id="66902-106">Ez a cikk ismerteti a Lekérdezéstár az Azure-ban működő adott aspektusait.</span><span class="sxs-lookup"><span data-stu-id="66902-106">This article explains specific aspects of operating Query Store in Azure.</span></span> <span data-ttu-id="66902-107">Ez előtti gyűjtött adatait használja, gyorsan diagnosztizálhatja és teljesítménybeli problémák megoldásához és így az üzleti összpontosító több időt tölt.</span><span class="sxs-lookup"><span data-stu-id="66902-107">Using this pre-collected query data, you can quickly diagnose and resolve performance problems and thus spend more time focusing on their business.</span></span> 

<span data-ttu-id="66902-108">A Lekérdezéstár le lett [világszerte elérhető](https://azure.microsoft.com/updates/general-availability-azure-sql-database-query-store/) az Azure SQL Database, 2015. November óta.</span><span class="sxs-lookup"><span data-stu-id="66902-108">Query Store has been [globally available](https://azure.microsoft.com/updates/general-availability-azure-sql-database-query-store/) in Azure SQL Database since November, 2015.</span></span> <span data-ttu-id="66902-109">A Lekérdezéstár szolgáltatás hello alapja Teljesítményelemzés és a szolgáltatások, például a hangolása [SQL Database Advisor és teljesítmény irányítópult](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span><span class="sxs-lookup"><span data-stu-id="66902-109">Query Store is hello foundation for performance analysis and tuning features, such as [SQL Database Advisor and Performance Dashboard](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span></span> <span data-ttu-id="66902-110">Ez a cikk közzétételi hello pillanatban Lekérdezéstár fut a több mint 200 000 felhasználói adatbázisokat az Azure, több hónapig megszakítás nélkül lekérdezéssel kapcsolatos adatok gyűjtése.</span><span class="sxs-lookup"><span data-stu-id="66902-110">At hello moment of publishing this article, Query Store is running in more than 200,000 user databases in Azure, collecting query-related information for several months, without interruption.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="66902-111">A Microsoft aktiválási Lekérdezéstár az összes Azure SQL-adatbázisok (meglévő és új) hello folyamatban van.</span><span class="sxs-lookup"><span data-stu-id="66902-111">Microsoft is in hello process of activating Query Store for all Azure SQL databases (existing and new).</span></span> 
> 
> 

## <a name="optimal-query-store-configuration"></a><span data-ttu-id="66902-112">A Lekérdezéstár optimális konfiguráció</span><span class="sxs-lookup"><span data-stu-id="66902-112">Optimal Query Store Configuration</span></span>
<span data-ttu-id="66902-113">Ez a szakasz ismerteti, amelyek a tervezett tooensure megbízható művelet hello Lekérdezéstár és a függő szolgáltatások, például a optimális konfigurációs alapértelmezéseinek [SQL Database Advisor és teljesítmény irányítópult](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span><span class="sxs-lookup"><span data-stu-id="66902-113">This section describes optimal configuration defaults that are designed tooensure reliable operation of hello Query Store and dependent features, such as [SQL Database Advisor and Performance Dashboard](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span></span> <span data-ttu-id="66902-114">Alapértelmezett konfiguráció folyamatos az adatgyűjtés, a minimális OFF/READ_ONLY állapotban töltött ideje van optimalizálva.</span><span class="sxs-lookup"><span data-stu-id="66902-114">Default configuration is optimized for continuous data collection, that is minimal time spent in OFF/READ_ONLY states.</span></span>

| <span data-ttu-id="66902-115">Konfiguráció</span><span class="sxs-lookup"><span data-stu-id="66902-115">Configuration</span></span> | <span data-ttu-id="66902-116">Leírás</span><span class="sxs-lookup"><span data-stu-id="66902-116">Description</span></span> | <span data-ttu-id="66902-117">Alapértelmezett</span><span class="sxs-lookup"><span data-stu-id="66902-117">Default</span></span> | <span data-ttu-id="66902-118">Megjegyzés</span><span class="sxs-lookup"><span data-stu-id="66902-118">Comment</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="66902-119">MAX_STORAGE_SIZE_MB</span><span class="sxs-lookup"><span data-stu-id="66902-119">MAX_STORAGE_SIZE_MB</span></span> |<span data-ttu-id="66902-120">Megadja a Lekérdezéstár is igénybe vehet, z ügyféladatbázis belül hello adatterülethez hello korlátja</span><span class="sxs-lookup"><span data-stu-id="66902-120">Specifies hello limit for hello data space that Query Store can take inside z customer database</span></span> |<span data-ttu-id="66902-121">100</span><span class="sxs-lookup"><span data-stu-id="66902-121">100</span></span> |<span data-ttu-id="66902-122">Az új adatbázisokat kényszerítése</span><span class="sxs-lookup"><span data-stu-id="66902-122">Enforced for new databases</span></span> |
| <span data-ttu-id="66902-123">AZ INTERVAL_LENGTH_MINUTES</span><span class="sxs-lookup"><span data-stu-id="66902-123">INTERVAL_LENGTH_MINUTES</span></span> |<span data-ttu-id="66902-124">Határozza meg az időtartományt, amely során összegyűjtött futásidejű statisztikája lekérdezésterveket összesített értéket és megőrzött méretét.</span><span class="sxs-lookup"><span data-stu-id="66902-124">Defines size of time window during which collected runtime statistics for query plans are aggregated and persisted.</span></span> <span data-ttu-id="66902-125">Minden aktív lekérdezésterv legfeljebb egy sor rendelkezik ezzel a konfigurációval meghatározott ideig</span><span class="sxs-lookup"><span data-stu-id="66902-125">Every active query plan has at most one row for a period of time defined with this configuration</span></span> |<span data-ttu-id="66902-126">60</span><span class="sxs-lookup"><span data-stu-id="66902-126">60</span></span> |<span data-ttu-id="66902-127">Az új adatbázisokat kényszerítése</span><span class="sxs-lookup"><span data-stu-id="66902-127">Enforced for new databases</span></span> |
| <span data-ttu-id="66902-128">AZ STALE_QUERY_THRESHOLD_DAYS</span><span class="sxs-lookup"><span data-stu-id="66902-128">STALE_QUERY_THRESHOLD_DAYS</span></span> |<span data-ttu-id="66902-129">Időalapú törlési házirend, amely a megőrzött futásidejű statisztikák és inaktív lekérdezések hello megőrzési időtartam</span><span class="sxs-lookup"><span data-stu-id="66902-129">Time-based cleanup policy that controls hello retention period of persisted runtime statistics and inactive queries</span></span> |<span data-ttu-id="66902-130">30</span><span class="sxs-lookup"><span data-stu-id="66902-130">30</span></span> |<span data-ttu-id="66902-131">Az új adatbázisokat és adatbázisokat az előző alapértelmezetten (367) érvényes</span><span class="sxs-lookup"><span data-stu-id="66902-131">Enforced for new databases and databases with previous default (367)</span></span> |
| <span data-ttu-id="66902-132">A SIZE_BASED_CLEANUP_MODE BEÁLLÍTÁST</span><span class="sxs-lookup"><span data-stu-id="66902-132">SIZE_BASED_CLEANUP_MODE</span></span> |<span data-ttu-id="66902-133">Megadja, hogy automatikus adatok karbantartása kerül sor a Lekérdezéstár adatok mérete megközelíti hello korlátot</span><span class="sxs-lookup"><span data-stu-id="66902-133">Specifies whether automatic data cleanup takes place when Query Store data size approaches hello limit</span></span> |<span data-ttu-id="66902-134">AUTOMATIKUS</span><span class="sxs-lookup"><span data-stu-id="66902-134">AUTO</span></span> |<span data-ttu-id="66902-135">Az összes adatbázisra érvényes</span><span class="sxs-lookup"><span data-stu-id="66902-135">Enforced for all databases</span></span> |
| <span data-ttu-id="66902-136">A QUERY_CAPTURE_MODE BEÁLLÍTÁST</span><span class="sxs-lookup"><span data-stu-id="66902-136">QUERY_CAPTURE_MODE</span></span> |<span data-ttu-id="66902-137">Megadja, hogy lekérdezések csak egy részhalmazát vagy az összes lekérdezés követi</span><span class="sxs-lookup"><span data-stu-id="66902-137">Specifies whether all queries or only a subset of queries are tracked</span></span> |<span data-ttu-id="66902-138">AUTOMATIKUS</span><span class="sxs-lookup"><span data-stu-id="66902-138">AUTO</span></span> |<span data-ttu-id="66902-139">Az összes adatbázisra érvényes</span><span class="sxs-lookup"><span data-stu-id="66902-139">Enforced for all databases</span></span> |
| <span data-ttu-id="66902-140">FLUSH_INTERVAL_SECONDS</span><span class="sxs-lookup"><span data-stu-id="66902-140">FLUSH_INTERVAL_SECONDS</span></span> |<span data-ttu-id="66902-141">Meghatározza a maximális időtartamot, ameddig rögzített futásidejű statisztikája tárolják a memóriában, toodisk kiürítése előtt</span><span class="sxs-lookup"><span data-stu-id="66902-141">Specifies maximum period during which captured runtime statistics are kept in memory, before flushing toodisk</span></span> |<span data-ttu-id="66902-142">900</span><span class="sxs-lookup"><span data-stu-id="66902-142">900</span></span> |<span data-ttu-id="66902-143">Az új adatbázisokat kényszerítése</span><span class="sxs-lookup"><span data-stu-id="66902-143">Enforced for new databases</span></span> |
|  | | | |

> [!IMPORTANT]
> <span data-ttu-id="66902-144">Minden Azure SQL-adatbázisban (lásd az előző fontos megjegyzés) Lekérdezéstár aktiválási utolsó szakasza hello automatikusan alkalmazza ezeket az alapértelmezett értékeket.</span><span class="sxs-lookup"><span data-stu-id="66902-144">These defaults are automatically applied in hello final stage of Query Store activation in all Azure SQL databases (see preceding important note).</span></span> <span data-ttu-id="66902-145">A ritka be, miután az Azure SQL Database nem módosítják, az ügyfelek által beállított konfigurációs értékeket kivéve, ha negatív hatással elsődleges munkaterhelésére vagy hello Lekérdezéstár megbízható működésére.</span><span class="sxs-lookup"><span data-stu-id="66902-145">After this light up, Azure SQL Database won’t be changing configuration values set by customers, unless they negatively impact primary workload or reliable operations of hello Query Store.</span></span>
> 
> 

<span data-ttu-id="66902-146">Az egyéni beállításokkal toostay programmal, [ALTER DATABASE a Lekérdezéstár beállításokkal](https://msdn.microsoft.com/library/bb522682.aspx) toorevert konfigurációs toohello korábbi állapotába.</span><span class="sxs-lookup"><span data-stu-id="66902-146">If you want toostay with your custom settings, use [ALTER DATABASE with Query Store options](https://msdn.microsoft.com/library/bb522682.aspx) toorevert configuration toohello previous state.</span></span> <span data-ttu-id="66902-147">Tekintse meg [gyakorlati tanácsok a Lekérdezéstár hello](https://msdn.microsoft.com/library/mt604821.aspx) ahhoz, hogyan felső toolearn döntött, hogy optimális konfigurációs paramétereket.</span><span class="sxs-lookup"><span data-stu-id="66902-147">Check out [Best Practices with hello Query Store](https://msdn.microsoft.com/library/mt604821.aspx) in order toolearn how top chose optimal configuration parameters.</span></span>

## <a name="next-steps"></a><span data-ttu-id="66902-148">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="66902-148">Next steps</span></span>
[<span data-ttu-id="66902-149">SQL adatbázis elemzéséhez</span><span class="sxs-lookup"><span data-stu-id="66902-149">SQL Database Performance Insight</span></span>](sql-database-performance.md)

## <a name="additional-resources"></a><span data-ttu-id="66902-150">További források</span><span class="sxs-lookup"><span data-stu-id="66902-150">Additional resources</span></span>
<span data-ttu-id="66902-151">A további információkat kivételét hello a következő cikkeket:</span><span class="sxs-lookup"><span data-stu-id="66902-151">For more information check out hello following articles:</span></span>

* [<span data-ttu-id="66902-152">A felhőszolgáltató közötti átviteléhez rögzítő az adatbázis számára</span><span class="sxs-lookup"><span data-stu-id="66902-152">A flight data recorder for your database</span></span>](https://azure.microsoft.com/blog/query-store-a-flight-data-recorder-for-your-database) 
* [<span data-ttu-id="66902-153">Hello Lekérdezéstár használatával teljesítmény figyelése</span><span class="sxs-lookup"><span data-stu-id="66902-153">Monitoring Performance By Using hello Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="66902-154">A Lekérdezéstár használati forgatókönyvek</span><span class="sxs-lookup"><span data-stu-id="66902-154">Query Store Usage Scenarios</span></span>](https://msdn.microsoft.com/library/mt614796.aspx)
* [<span data-ttu-id="66902-155">Hello Lekérdezéstár használatával teljesítmény figyelése</span><span class="sxs-lookup"><span data-stu-id="66902-155">Monitoring Performance By Using hello Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx) 

