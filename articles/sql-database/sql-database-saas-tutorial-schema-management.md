---
title: "Azure SQL Database-séma kezelése több-bérlős alkalmazásban | Microsoft Docs"
description: "Több bérlő sémájának kezelése Azure SQL Database-t használó több-bérlős alkalmazásban"
keywords: "sql database-oktatóanyag"
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/28/2017
ms.author: billgib; sstein
ms.openlocfilehash: 78d76efb88bf11fa18a416b59e6f881539141232
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/03/2017
---
# <a name="manage-schema-for-multiple-tenants-in-the-wingtip-saas-application"></a><span data-ttu-id="dda76-104">A több bérlő a Wingtip SaaS-alkalmazás a séma kezelése</span><span class="sxs-lookup"><span data-stu-id="dda76-104">Manage schema for multiple tenants in the Wingtip SaaS application</span></span>

<span data-ttu-id="dda76-105">A [első Wingtip Szolgáltatottszoftver-oktatóanyag](sql-database-saas-tutorial.md) bemutatja, hogyan az alkalmazás egy bérlő adatbázis létesítéséhez és regisztrálja a katalógusban.</span><span class="sxs-lookup"><span data-stu-id="dda76-105">The [first Wingtip SaaS tutorial](sql-database-saas-tutorial.md) shows how the app can provision a tenant database and register it in the catalog.</span></span> <span data-ttu-id="dda76-106">Bármely alkalmazás, például a Wingtip SaaS-alkalmazás verzióinformációk lesz, és esetenként esetén a módosítások adatbázisba.</span><span class="sxs-lookup"><span data-stu-id="dda76-106">Like any application, the Wingtip SaaS app will evolve over time, and at times will require changes to the database.</span></span> <span data-ttu-id="dda76-107">A módosítások a következők lehetnek: új vagy módosított séma, új vagy módosított referenciaadatok és rutin adatbázis-karbantartási feladatok az alkalmazás optimális teljesítményének biztosítása érdekében.</span><span class="sxs-lookup"><span data-stu-id="dda76-107">Changes may include new or changed schema, new or changed reference data, and routine database maintenance tasks to ensure optimal app performance.</span></span> <span data-ttu-id="dda76-108">A SaaS-alkalmazásokkal ezeket a módosításokat koordinált módon kell üzembe helyezni valószínűleg nagyszámú bérlői adatbázison.</span><span class="sxs-lookup"><span data-stu-id="dda76-108">With a SaaS application, these changes need to be deployed in a coordinated manner across a potentially massive fleet of tenant databases.</span></span> <span data-ttu-id="dda76-109">A módosítások lehet a jövőben bérlői adatbázisok van szükségük a kiépítési folyamat szóló.</span><span class="sxs-lookup"><span data-stu-id="dda76-109">For these changes to be in future tenant databases, they need to be incorporated into the provisioning process.</span></span>

<span data-ttu-id="dda76-110">Ez az oktatóanyag két forgatókönyvet ismertet: referenciaadat-frissítések üzembe helyezése az összes bérlőhöz, és index visszaadása a referenciaadatokat tartalmazó táblázathoz.</span><span class="sxs-lookup"><span data-stu-id="dda76-110">This tutorial explores two scenarios - deploying reference data updates for all tenants, and retuning an index on the table containing the reference data.</span></span> <span data-ttu-id="dda76-111">A [rugalmas feladatok](sql-database-elastic-jobs-overview.md) szolgáltatás hajthatók végre ezeket a műveleteket között egyetlen bérlő számára, és a *arany* bérlői adatbázis, amely sablonként szolgál, az új adatbázisokat.</span><span class="sxs-lookup"><span data-stu-id="dda76-111">The [Elastic jobs](sql-database-elastic-jobs-overview.md) feature is used to execute these operations across all tenants, and the *golden* tenant database that is used as a template for new databases.</span></span>

<span data-ttu-id="dda76-112">Ezen oktatóanyag segítségével megtanulhatja a következőket:</span><span class="sxs-lookup"><span data-stu-id="dda76-112">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="dda76-113">Feladat-fiók létrehozása</span><span class="sxs-lookup"><span data-stu-id="dda76-113">Create a job account</span></span>
> * <span data-ttu-id="dda76-114">Több bérlő átfogó lekérdezése</span><span class="sxs-lookup"><span data-stu-id="dda76-114">Query across multiple tenants</span></span>
> * <span data-ttu-id="dda76-115">Az összes bérlői adatbázis adatainak frissítése</span><span class="sxs-lookup"><span data-stu-id="dda76-115">Update data in all tenant databases</span></span>
> * <span data-ttu-id="dda76-116">Index létrehozása a táblához az összes bérlői adatbázisban</span><span class="sxs-lookup"><span data-stu-id="dda76-116">Create an index on a table in all tenant databases</span></span>


<span data-ttu-id="dda76-117">Az oktatóanyag teljesítéséhez meg kell felelnie az alábbi előfeltételeknek:</span><span class="sxs-lookup"><span data-stu-id="dda76-117">To complete this tutorial, make sure the following prerequisites are met:</span></span>

* <span data-ttu-id="dda76-118">A Wingtip SaaS-alkalmazás telepítve van.</span><span class="sxs-lookup"><span data-stu-id="dda76-118">The Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="dda76-119">Kevesebb mint öt perc alatt telepítéséhez lásd: [központi telepítése és vizsgálja meg a Wingtip SaaS-alkalmazáshoz](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="dda76-119">To deploy in less than five minutes, see [Deploy and explore the Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="dda76-120">Az Azure PowerShell telepítve van.</span><span class="sxs-lookup"><span data-stu-id="dda76-120">Azure PowerShell is installed.</span></span> <span data-ttu-id="dda76-121">A részletekért lásd: [Ismerkedés az Azure PowerShell-lel](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="dda76-121">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>
* <span data-ttu-id="dda76-122">Telepítve van az SQL Server Management Studio (SSMS) legújabb verziója.</span><span class="sxs-lookup"><span data-stu-id="dda76-122">The latest version of SQL Server Management Studio (SSMS) is installed.</span></span> [<span data-ttu-id="dda76-123">Az SSMS letöltése és telepítése</span><span class="sxs-lookup"><span data-stu-id="dda76-123">Download and Install SSMS</span></span>](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms)

<span data-ttu-id="dda76-124">*Ez az oktatóanyag az SQL Database szolgáltatás egy korlátozott előzetes verziójának funkcióit használja (Elastic Database-feladatok). Ha szeretné elvégezni ezt az oktatóanyagot, küldje el az előfizetés-azonosítóját az SaaSFeedback@microsoft.com címre, tárgyként megadva a subject=Elastic Jobs Preview szöveget. Miután megkapta a megerősítést az előfizetésének engedélyezéséről, [töltse le és telepítse a legújabb kiadás előtti feladatok parancsmagjait](https://github.com/jaredmoo/azure-powershell/releases). Ez az előnézet korlátozva, így forduljon SaaSFeedback@microsoft.com kapcsolatos kérdésekre, vagy a támogatási szolgálathoz.*</span><span class="sxs-lookup"><span data-stu-id="dda76-124">*This tutorial uses features of the SQL Database service that are in a limited preview (Elastic Database jobs). If you wish to do this tutorial, provide your subscription id to SaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install the latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>


## <a name="introduction-to-saas-schema-management-patterns"></a><span data-ttu-id="dda76-125">Az SaaS-sémakezelési minták bemutatása</span><span class="sxs-lookup"><span data-stu-id="dda76-125">Introduction to SaaS Schema Management patterns</span></span>

<span data-ttu-id="dda76-126">Az adatbázisonkénti egyetlen bérlőt alkalmazó SaaS-mintából fakadó adatelkülönítésnek számos előnye van, ugyanakkor a sok adatbázis karbantartása és kezelése miatt tovább növeli a bonyolultságot.</span><span class="sxs-lookup"><span data-stu-id="dda76-126">The single tenant per database SaaS pattern benefits in many ways from the data isolation that results, but at the same time introduces the additional complexity of maintaining and managing many databases.</span></span> <span data-ttu-id="dda76-127">[Rugalmas feladatok](sql-database-elastic-jobs-overview.md) elősegíti az SQL-adatréteg felügyeletét és kezelését.</span><span class="sxs-lookup"><span data-stu-id="dda76-127">[Elastic Jobs](sql-database-elastic-jobs-overview.md) facilitates administration and management of the SQL data tier.</span></span> <span data-ttu-id="dda76-128">A feladatok lehetővé teszik a feladatok (T-SQL-szkriptek) adatbáziscsoportokon történő, felhasználói interakciótól vagy beviteltől független biztonságos és megbízható futtatását.</span><span class="sxs-lookup"><span data-stu-id="dda76-128">Jobs enable you to securely and reliably, run tasks (T-SQL scripts) independent of user interaction or input, against a group of databases.</span></span> <span data-ttu-id="dda76-129">Ez a módszer használható a séma és a közös referenciaadat-változások üzembe helyezésére egy alkalmazás összes bérlőjében.</span><span class="sxs-lookup"><span data-stu-id="dda76-129">This method can be used to deploy schema and common reference data changes across all tenants in an application.</span></span> <span data-ttu-id="dda76-130">Az Elastic Jobs feladatok az új bérlők létrehozására használt adatbázis *arany* másolatának karbantartására is használhatók, hogy mindig a legújabb sémával és referenciaadatokkal rendelkezzen.</span><span class="sxs-lookup"><span data-stu-id="dda76-130">Elastic Jobs can also be used to maintain a *golden* copy of the database used to create new tenants, ensuring it always has the latest schema and reference data.</span></span>

![képernyő](media/sql-database-saas-tutorial-schema-management/schema-management.png)


## <a name="elastic-jobs-limited-preview"></a><span data-ttu-id="dda76-132">Az Elastic Jobs korlátozott előzetes verziója</span><span class="sxs-lookup"><span data-stu-id="dda76-132">Elastic Jobs limited preview</span></span>

<span data-ttu-id="dda76-133">Megjelent az Elastic Jobs új verziója, amely most az Azure SQL Database integrált funkciója (nincs szükség hozzá további szolgáltatásokra vagy összetevőkre).</span><span class="sxs-lookup"><span data-stu-id="dda76-133">There is a new version of Elastic Jobs that is now an integrated feature of Azure SQL Database (that requires no additional services or components).</span></span> <span data-ttu-id="dda76-134">Ez Elastic Jobs-nak ez az új verziója jelenleg korlátozott előzetes verzió.</span><span class="sxs-lookup"><span data-stu-id="dda76-134">This new version of Elastic Jobs is currently in limited preview.</span></span> <span data-ttu-id="dda76-135">Ez a korlátozott előzetes verzió jelenleg a PowerShellt támogatja feladatfiókok létrehozásához és a T-SQL-t a feladatok létrehozásához és kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="dda76-135">This limited preview currently supports PowerShell to create job accounts, and T-SQL to create and manage jobs.</span></span>

> [!NOTE]
> <span data-ttu-id="dda76-136">*Ez az oktatóanyag az SQL Database szolgáltatás egy korlátozott előzetes verziójának funkcióit használja (Elastic Database-feladatok). Ha szeretné elvégezni ezt az oktatóanyagot, küldje el az előfizetés-azonosítóját az SaaSFeedback@microsoft.com címre, tárgyként megadva a subject=Elastic Jobs Preview szöveget. Miután megkapta a megerősítést az előfizetésének engedélyezéséről, [töltse le és telepítse a legújabb kiadás előtti feladatok parancsmagjait](https://github.com/jaredmoo/azure-powershell/releases). Ez az előnézet korlátozva, így forduljon SaaSFeedback@microsoft.com kapcsolatos kérdésekre, vagy a támogatási szolgálathoz.*</span><span class="sxs-lookup"><span data-stu-id="dda76-136">*This tutorial uses features of the SQL Database service that are in a limited preview (Elastic Database jobs). If you wish to do this tutorial, provide your subscription id to SaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install the latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>

## <a name="get-the-wingtip-application-scripts"></a><span data-ttu-id="dda76-137">A Wingtip alkalmazásszkriptek beolvasása</span><span class="sxs-lookup"><span data-stu-id="dda76-137">Get the Wingtip application scripts</span></span>

<span data-ttu-id="dda76-138">A Wingtip Szolgáltatottszoftver-parancsfájlok és az alkalmazás forráskódjához érhetők el a [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github-tárház.</span><span class="sxs-lookup"><span data-stu-id="dda76-138">The Wingtip SaaS scripts and application source code are available in the [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="dda76-139">[Töltse le a Wingtip Szolgáltatottszoftver-parancsfájlok lépéseket](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="dda76-139">[Steps to download the Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="create-a-job-account-database-and-new-job-account"></a><span data-ttu-id="dda76-140">Feladatfiók-adatbázis és új feladatfiók létrehozása</span><span class="sxs-lookup"><span data-stu-id="dda76-140">Create a job account database and new job account</span></span>

<span data-ttu-id="dda76-141">Ennek az oktatóanyagnak a használatához a PowerShell-lel létre kell hoznia a feladatfiók-adatbázis és a feladatfiókot.</span><span class="sxs-lookup"><span data-stu-id="dda76-141">This tutorial requires you use PowerShell to create the job account database and job account.</span></span> <span data-ttu-id="dda76-142">Az Elastic Jobs az MSDB-hez és a SQL-ügynökhöz hasonlóan az Azure SQL Database-t használja a feladatdefiníciók, feladatállapotok és -előzmények tárolására.</span><span class="sxs-lookup"><span data-stu-id="dda76-142">Like MSDB and SQL Agent, Elastic Jobs uses an Azure SQL database to store job definitions, job status, and history.</span></span> <span data-ttu-id="dda76-143">A feladatfiók létrehozása után azonnal létrehozhatja és figyelheti a feladatokat.</span><span class="sxs-lookup"><span data-stu-id="dda76-143">Once the job account is created, you can create and monitor jobs immediately.</span></span>

1. <span data-ttu-id="dda76-144">Nyissa meg a ...\\Tanulási modulok\\Sémakezelés\\*Demo-SchemaManagement.ps1* fájlt a **PowerShell ISE** parancssorában.</span><span class="sxs-lookup"><span data-stu-id="dda76-144">Open …\\Learning Modules\\Schema Management\\*Demo-SchemaManagement.ps1* in the **PowerShell ISE**.</span></span>
1. <span data-ttu-id="dda76-145">A szkriptek futtatásához nyomja le az **F5** billentyűt.</span><span class="sxs-lookup"><span data-stu-id="dda76-145">Press **F5** to run the script.</span></span>

<span data-ttu-id="dda76-146">A *Demo-SchemaManagement.ps1* szkript a *Deploy-SchemaManagement.ps1* szkriptet hívja a **jobaccount** nevű *S2* adatbázis katalóguskiszolgálón történő létrehozásához.</span><span class="sxs-lookup"><span data-stu-id="dda76-146">The *Demo-SchemaManagement.ps1* script calls the *Deploy-SchemaManagement.ps1* script to create an *S2* database named **jobaccount** on the catalog server.</span></span> <span data-ttu-id="dda76-147">Ezután létrehozza a feladatfiókot, paraméterként átadva a feladatfiók nevű adatbázist a feladatfiók-létrehozási hívásnak.</span><span class="sxs-lookup"><span data-stu-id="dda76-147">It then creates the job account, passing the jobaccount database as a parameter to the job account creation call.</span></span>

## <a name="create-a-job-to-deploy-new-reference-data-to-all-tenants"></a><span data-ttu-id="dda76-148">Feladat létrehozása új referenciaadatok bevezetéséhez az összes bérlőn</span><span class="sxs-lookup"><span data-stu-id="dda76-148">Create a job to deploy new reference data to all tenants</span></span>

<span data-ttu-id="dda76-149">Az egyes bérlői adatbázisok helyszíntípuskészleteket tartalmaznak, amelyek a helyszínen üzemeltetett eseménytípusokat határozzák meg.</span><span class="sxs-lookup"><span data-stu-id="dda76-149">Each tenant database includes a set of venue types that define the kind of events that are hosted at a venue.</span></span> <span data-ttu-id="dda76-150">Ebben a gyakorlatban frissítést helyezhet üzembe az összes bérlői adatbázison két további helyszíntípus hozzáadásához: *Motorkerékpár-verseny* és *Úszóklub*.</span><span class="sxs-lookup"><span data-stu-id="dda76-150">In this exercise, you deploy an update to all the tenant databases to add two additional venue types: *Motorcycle Racing* and *Swimming Club*.</span></span> <span data-ttu-id="dda76-151">Ezek a helyszíntípusok megfelelnek a bérlő eseményalkalmazásában látható háttérképnek.</span><span class="sxs-lookup"><span data-stu-id="dda76-151">These venue types correspond to the background image you see in the tenant events app.</span></span>

<span data-ttu-id="dda76-152">Kattintson a Helyszíntípus legördülő menüre, és ellenőrizze, hogy csak 10 helyszíntípus-lehetőség legyen elérhető, és hogy a „Motorkerékpár-verseny” és az „Úszóklub” ne szerepeljen a listán.</span><span class="sxs-lookup"><span data-stu-id="dda76-152">Click the Venue Type drop down menu and validate that only 10 venue type options are available, and specifically that ‘Motorcycle Racing’ and ‘Swimming Club’ are not included in the list.</span></span>

<span data-ttu-id="dda76-153">Most hozzon létre egy feladatot, amely frissíti a *VenueTypes* táblát az összes bérlői adatbázisban, és adja hozzá az új helyszíntípusokat.</span><span class="sxs-lookup"><span data-stu-id="dda76-153">Now let’s create a job to update the *VenueTypes* table in all the tenant databases and add the new venue types.</span></span>

<span data-ttu-id="dda76-154">Új feladat létrehozásához a feladatfiók létrehozásakor a feladatfiók adatbázisban létrehozott feladatkészletek rendszer által tárolt folyamatait használjuk.</span><span class="sxs-lookup"><span data-stu-id="dda76-154">To create a new job, we use a set of jobs system stored procedures created in the jobaccount database when the job account was created.</span></span>

1. <span data-ttu-id="dda76-155">Nyissa meg az SSMS-t, és kapcsolódjon a katalóguskiszolgálóhoz: catalog-\<user\>.database.windows.net kiszolgáló</span><span class="sxs-lookup"><span data-stu-id="dda76-155">Open SSMS and connect to the catalog server: catalog-\<user\>.database.windows.net server</span></span>
1. <span data-ttu-id="dda76-156">Kapcsolódjon a bérlői kiszolgálóhoz is: tenants1-\<user\>.database.windows.net</span><span class="sxs-lookup"><span data-stu-id="dda76-156">Also connect to the tenant server: tenants1-\<user\>.database.windows.net</span></span>
1. <span data-ttu-id="dda76-157">Keresse meg a *contosoconcerthall* adatbázist a *tenants1* kiszolgálón, és kérdezze le a *VenueTypes* táblát annak a megerősítéséhez, hogy a *Motorkerékpár-verseny* és az *Úszóklub* **nem szerepel** az eredménylistán.</span><span class="sxs-lookup"><span data-stu-id="dda76-157">Browse to the *contosoconcerthall* database on the *tenants1* server and query the *VenueTypes* table to confirm that *Motorcycle Racing* and *Swimming Club* **are not** in the results list.</span></span>
1. <span data-ttu-id="dda76-158">Nyissa meg a ... \\Tanulási modulok\\Sémakezelés\\DeployReferenceData.sql fájlt</span><span class="sxs-lookup"><span data-stu-id="dda76-158">Open the file …\\Learning Modules\\Schema Management\\DeployReferenceData.sql</span></span>
1. <span data-ttu-id="dda76-159">Az utasítás módosítása: beállítása @wtpUser = &lt;felhasználói&gt; és a Wingtip alkalmazás telepítésekor használt felhasználói helyettesítésére</span><span class="sxs-lookup"><span data-stu-id="dda76-159">Modify the statement: SET @wtpUser = &lt;user&gt; and substitute the User value used when you deployed the Wingtip app</span></span>
1. <span data-ttu-id="dda76-160">Ellenőrizze, hogy kapcsolódik-e a feladatfiók adatbázishoz, és nyomja le az **F5** billentyűt a szkript futtatásához</span><span class="sxs-lookup"><span data-stu-id="dda76-160">Ensure you are connected to the jobaccount database and press **F5** to run the script</span></span>

* <span data-ttu-id="dda76-161">Az **sp\_add\_target\_group** létrehozza a DemoServerGroup nevű célcsoportot, most hozzá kell adnunk a céltagokat.</span><span class="sxs-lookup"><span data-stu-id="dda76-161">**sp\_add\_target\_group** creates the target group name DemoServerGroup, now we need to add target members.</span></span>
* <span data-ttu-id="dda76-162">**SP\_hozzáadása\_cél\_csoport\_tag** ad hozzá egy *server* céltípust tag, amely úgy ítéli meg, hogy a kiszolgálón belüli összes adatbázis (Megjegyzés: Ez a tenants1 -&lt;felhasználói&gt; a bérlő adatbázisokat tartalmazó kiszolgáló) időpontban feladat végrehajtási szerepelnie kell a feladatot, a második hozzáadásával egy *adatbázis* tagtípus, kifejezetten a "arany" adatbázis (basetenantdb) a katalógus - található cél&lt;felhasználói&gt; kiszolgáló, és végül egy másik *adatbázis* csoport tagja céltípust egy újabb oktatóanyagban használt adhocanalytics-adatbázist tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="dda76-162">**sp\_add\_target\_group\_member** adds a *server* target member type, which deems all databases within that server (note this is the tenants1-&lt;User&gt; server containing the tenant databases) at time of job execution should be included in the job, the second is adding a *database* target member type, specifically the ‘golden’ database (basetenantdb) that resides on catalog-&lt;User&gt; server, and lastly another *database* target group member type to include the adhocanalytics database that is used in a later tutorial.</span></span>
* <span data-ttu-id="dda76-163">Az **sp\_add\_job** létrehoz egy „Referenciaadat-telepítés” nevű feladatot</span><span class="sxs-lookup"><span data-stu-id="dda76-163">**sp\_add\_job** creates a job called “Reference Data Deployment”</span></span>
* <span data-ttu-id="dda76-164">**SP\_hozzáadása\_feladatlépés használja** hoz létre a T-SQL parancs szövege a referenciatábla VenueTypes frissítése tartalmazó feladat lépésének</span><span class="sxs-lookup"><span data-stu-id="dda76-164">**sp\_add\_jobstep** creates the job step containing T-SQL command text to update the reference table, VenueTypes</span></span>
* <span data-ttu-id="dda76-165">A szkript fennmaradó nézetei megjelenítik, hogy léteznek-e az objektumok, és figyelik a feladat-végrehajtást.</span><span class="sxs-lookup"><span data-stu-id="dda76-165">The remaining views in the script display the existence of the objects and monitor job execution.</span></span> <span data-ttu-id="dda76-166">Tekintse át a értéket használja ezeket a lekérdezéseket a **életciklus** határozza meg, ha a feladat sikeresen befejeződött az összes bérlői és a két további adatbázisait a referenciatábla tartalmazó oszlop.</span><span class="sxs-lookup"><span data-stu-id="dda76-166">Use these queries to review the status value in the **lifecycle** column to determine when the job has successfully finished on all tenant databases and the two additional databases containing the reference table.</span></span>

1. <span data-ttu-id="dda76-167">Keresse meg az SSMS-ben a *contosoconcerthall* adatbázist a *tenants1* kiszolgálón, és kérdezze le a *VenueTypes* táblát annak a megerősítéséhez, hogy a *Motorkerékpár-verseny* és az *Úszóklub* **most már szerepel** az eredménylistán.</span><span class="sxs-lookup"><span data-stu-id="dda76-167">In SSMS, browse to the *contosoconcerthall* database on the *tenants1* server and query the *VenueTypes* table to confirm that *Motorcycle Racing* and *Swimming Club* **are** now in the results list.</span></span>


## <a name="create-a-job-to-manage-the-reference-table-index"></a><span data-ttu-id="dda76-168">Feladat létrehozása a referenciatábla indexének kezeléséhez</span><span class="sxs-lookup"><span data-stu-id="dda76-168">Create a job to manage the reference table index</span></span>

<span data-ttu-id="dda76-169">Az előző gyakorlathoz hasonlóan, ebben a gyakorlatban létrehoz egy feladatot a referenciatábla elsődleges kulcsához tartozó index újraépítéséhez, amely a rendszergazda gyakori adatbázis-kezelési művelete, miután nagy mennyiségű adat töltődött be a táblába.</span><span class="sxs-lookup"><span data-stu-id="dda76-169">Similar to the previous exercise, this exercise creates a job to rebuild the index on the reference table primary key, a typical database management operation an administrator might perform after a large data load into a table.</span></span>

<span data-ttu-id="dda76-170">Hozzon létre egy feladatot ugyanannak a feladatnak a „system” által tárolt eljárásait használva.</span><span class="sxs-lookup"><span data-stu-id="dda76-170">Create a job using the same jobs 'system' stored procedures.</span></span>

1. <span data-ttu-id="dda76-171">Nyissa meg a szolgáltatáshoz az SSMS és kapcsolódjon a katalógus -&lt;felhasználói&gt;. database.windows.net kiszolgáló</span><span class="sxs-lookup"><span data-stu-id="dda76-171">Open SSMS and connect to the catalog-&lt;User&gt;.database.windows.net server</span></span>
1. <span data-ttu-id="dda76-172">Nyissa meg a ...\\Tanulási modulok\\Sémakezelés\\.sql fájlt</span><span class="sxs-lookup"><span data-stu-id="dda76-172">Open the file …\\Learning Modules\\Schema Management\\OnlineReindex.sql</span></span>
1. <span data-ttu-id="dda76-173">Kattintson a jobb gombbal, válassza ki a kapcsolat, és kapcsolódjon a katalógus -&lt;felhasználói&gt;. database.windows.net kiszolgáló, ha még nincs csatlakoztatva</span><span class="sxs-lookup"><span data-stu-id="dda76-173">Right click, select Connection, and connect to the catalog-&lt;User&gt;.database.windows.net server, if not already connected</span></span>
1. <span data-ttu-id="dda76-174">Ellenőrizze, hogy kapcsolódik-e a jobaccount adatbázishoz, és nyomja le az F5 billentyűt a parancsprogram futtatásához</span><span class="sxs-lookup"><span data-stu-id="dda76-174">Ensure you are connected to the jobaccount database and press F5 to run the script</span></span>

* <span data-ttu-id="dda76-175">Az sp\_add\_job létrehoz egy „Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885” nevű új feladatot</span><span class="sxs-lookup"><span data-stu-id="dda76-175">sp\_add\_job creates a new job called “Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885”</span></span>
* <span data-ttu-id="dda76-176">Az sp\_add\_jobstep létrehozza a T-SQL-parancsszöveget tartalmazó feladatlépést az index frissítéséhez</span><span class="sxs-lookup"><span data-stu-id="dda76-176">sp\_add\_jobstep creates the job step containing T-SQL command text to update the index</span></span>




## <a name="next-steps"></a><span data-ttu-id="dda76-177">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="dda76-177">Next steps</span></span>

<span data-ttu-id="dda76-178">Ennek az oktatóanyagnak a segítségével megtanulta a következőket:</span><span class="sxs-lookup"><span data-stu-id="dda76-178">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="dda76-179">Feladatfiók létrehozása több bérlőben történő lekérdezéshez</span><span class="sxs-lookup"><span data-stu-id="dda76-179">Create a job account to query across multiple tenants</span></span>
> * <span data-ttu-id="dda76-180">Az összes bérlői adatbázis adatainak frissítése</span><span class="sxs-lookup"><span data-stu-id="dda76-180">Update data in all tenant databases</span></span>
> * <span data-ttu-id="dda76-181">Index létrehozása a táblához az összes bérlői adatbázisban</span><span class="sxs-lookup"><span data-stu-id="dda76-181">Create an index on a table in all tenant databases</span></span>

[<span data-ttu-id="dda76-182">Oktatóanyag alkalmi elemzéshez</span><span class="sxs-lookup"><span data-stu-id="dda76-182">Ad-hoc analytics tutorial</span></span>](sql-database-saas-tutorial-adhoc-analytics.md)


## <a name="additional-resources"></a><span data-ttu-id="dda76-183">További források</span><span class="sxs-lookup"><span data-stu-id="dda76-183">Additional resources</span></span>

* [<span data-ttu-id="dda76-184">További oktatóprogramot kínál, amelyek a Wingtip SaaS-alkalmazás telepítésében épül</span><span class="sxs-lookup"><span data-stu-id="dda76-184">Additional tutorials that build upon the Wingtip SaaS application deployment</span></span>](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)
* [<span data-ttu-id="dda76-185">Kiterjesztett felhőalapú adatbázisok kezelése</span><span class="sxs-lookup"><span data-stu-id="dda76-185">Managing scaled-out cloud databases</span></span>](sql-database-elastic-jobs-overview.md)
* [<span data-ttu-id="dda76-186">Horizontálisan felskálázott felhőalapú adatbázisok létrehozása és kezelése</span><span class="sxs-lookup"><span data-stu-id="dda76-186">Create and manage scaled-out cloud databases</span></span>](sql-database-elastic-jobs-create-and-manage.md)
