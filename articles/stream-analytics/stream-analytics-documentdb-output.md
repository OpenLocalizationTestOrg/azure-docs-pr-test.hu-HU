---
title: "A Stream Analytics JSON-kimenetét |} Microsoft Docs"
description: "Ismerje meg, hogyan Stream Analytics egy célcsoport kijelölésével az Azure Cosmos DB JSON kimeneti adatok archiválása és alacsony késésű lekérdezései strukturálatlan JSON-adatokat."
keywords: JSON kimeneti
documentationcenter: 
services: stream-analytics,documentdb
author: samacha
manager: jhubbard
editor: cgronlun
ms.assetid: 5d2a61a6-0dbf-4f1b-80af-60a80eb25dd1
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: samacha
ms.openlocfilehash: cc80b0080c806541362a1ef2d71b95862bd51ca2
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/29/2017
---
# <a name="target-azure-cosmos-db-for-json-output-from-stream-analytics"></a><span data-ttu-id="edc24-104">Cél Azure Cosmos DB JSON-kimenetét a Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="edc24-104">Target Azure Cosmos DB for JSON output from Stream Analytics</span></span>
<span data-ttu-id="edc24-105">A Stream Analytics célba [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) JSON-kimenetét, engedélyezi az archiválási és alacsony késésű kérelmek strukturálatlan JSON-adatokat.</span><span class="sxs-lookup"><span data-stu-id="edc24-105">Stream Analytics can target [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) for JSON output, enabling data archiving and low-latency queries on unstructured JSON data.</span></span> <span data-ttu-id="edc24-106">Ez a dokumentum ismertet néhány gyakorlati tanácsok a konfiguráció alkalmazásához.</span><span class="sxs-lookup"><span data-stu-id="edc24-106">This document covers some best practices for implementing this configuration.</span></span>

<span data-ttu-id="edc24-107">Azok számára, akiknek nem ismeri az Cosmos DB, vessen egy pillantást [Azure Cosmos DB képzési terv](https://azure.microsoft.com/documentation/learning-paths/documentdb/) a kezdéshez.</span><span class="sxs-lookup"><span data-stu-id="edc24-107">For those who are unfamiliar with Cosmos DB, take a look at [Azure Cosmos DB’s learning path](https://azure.microsoft.com/documentation/learning-paths/documentdb/) to get started.</span></span> 

<span data-ttu-id="edc24-108">Megjegyzés: A Mongo DB API alapú Cosmos DB gyűjtemények jelenleg nem támogatott.</span><span class="sxs-lookup"><span data-stu-id="edc24-108">Note: Mongo DB API based Cosmos DB collections is currently not supported.</span></span> 

## <a name="basics-of-cosmos-db-as-an-output-target"></a><span data-ttu-id="edc24-109">Egy kimeneti célként Cosmos DB alapjai</span><span class="sxs-lookup"><span data-stu-id="edc24-109">Basics of Cosmos DB as an output target</span></span>
<span data-ttu-id="edc24-110">Az Azure Cosmos DB kimeneti a Stream Analytics lehetővé teszi, hogy írása a streamfeldolgozási eredmények JSON kimenetként a Cosmos DB következő gyűjtemény(ek) készleteit szinkronizálja azokat.</span><span class="sxs-lookup"><span data-stu-id="edc24-110">The Azure Cosmos DB output in Stream Analytics enables writing your stream processing results as JSON output into your Cosmos DB collection(s).</span></span> <span data-ttu-id="edc24-111">A Stream Analytics nem gyűjtemények létrehozása az adatbázis ehelyett nincs szükség kell létrehoznia őket előzetes megfizetése esetén.</span><span class="sxs-lookup"><span data-stu-id="edc24-111">Stream Analytics does not create collections in your database, instead requiring you to create them upfront.</span></span> <span data-ttu-id="edc24-112">Ez az, hogy a számlázási költségek Cosmos DB gyűjtemények nem érzékelhető, és úgy, hogy a teljesítmény, a konzisztencia és a kapacitás közvetlenül a gyűjtemények észlelheti a [Cosmos DB API-k](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span><span class="sxs-lookup"><span data-stu-id="edc24-112">This is so that the billing costs of Cosmos DB collections are transparent to you, and so that you can tune the performance, consistency and capacity of your collections directly using the [Cosmos DB APIs](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span></span> <span data-ttu-id="edc24-113">A folyamatos átviteli feladat gyűjtemények logikailag külön egy Cosmos adatfolyam-feladatot DB adatbázishoz használatát javasoljuk.</span><span class="sxs-lookup"><span data-stu-id="edc24-113">We recommend using one Cosmos DB Database per streaming job to logically separate your collections for a streaming job.</span></span>

<span data-ttu-id="edc24-114">A Cosmos DB adatgyűjtési beállítások némelyike részleteket lejjebb olvashatja.</span><span class="sxs-lookup"><span data-stu-id="edc24-114">Some of the Cosmos DB collection options are detailed below.</span></span>

## <a name="tune-consistency-availability-and-latency"></a><span data-ttu-id="edc24-115">Konzisztencia, a rendelkezésre állás és a késleltetés hangolása</span><span class="sxs-lookup"><span data-stu-id="edc24-115">Tune consistency, availability, and latency</span></span>
<span data-ttu-id="edc24-116">Saját alkalmazás igényeinek Cosmos DB lehetővé teszi, hogy jól hangolja az adatbázis és a gyűjtemények és konzisztencia, a rendelkezésre állás és a késleltetés közötti kompromisszumot.</span><span class="sxs-lookup"><span data-stu-id="edc24-116">To match your application requirements, Cosmos DB allows you to fine tune the database and collections and make trade-offs between consistency, availability and latency.</span></span> <span data-ttu-id="edc24-117">Attól függően, hogy milyen szintű olvasási konzisztenciát elleni forgatókönyv igényeinek és olvasási késés, kiválaszthatja a konzisztenciaszint adatbázis fiókja.</span><span class="sxs-lookup"><span data-stu-id="edc24-117">Depending on what levels of read consistency your scenario needs against read and write latency, you can choose a consistency level on your database account.</span></span> <span data-ttu-id="edc24-118">Alapértelmezés szerint is Cosmos DB engedélyezi szinkron indexelő minden CRUD-műveletnek a gyűjteményhez.</span><span class="sxs-lookup"><span data-stu-id="edc24-118">Also by default, Cosmos DB enables synchronous indexing on each CRUD operation to your collection.</span></span> <span data-ttu-id="edc24-119">Ez a beállítás egy másik hasznos az írási/olvasási teljesítményt Cosmos DB szabályozására.</span><span class="sxs-lookup"><span data-stu-id="edc24-119">This is another useful option to control the write/read performance in Cosmos DB.</span></span> <span data-ttu-id="edc24-120">A témakörrel kapcsolatos további információkért tekintse át a [módosítsa az adatbázis és a lekérdezés konzisztenciaszintek](../documentdb/documentdb-consistency-levels.md) cikk.</span><span class="sxs-lookup"><span data-stu-id="edc24-120">For further information on this topic, review the [change your database and query consistency levels](../documentdb/documentdb-consistency-levels.md) article.</span></span>

## <a name="upserts-from-stream-analytics"></a><span data-ttu-id="edc24-121">A Stream Analytics Upserts</span><span class="sxs-lookup"><span data-stu-id="edc24-121">Upserts from Stream Analytics</span></span>
<span data-ttu-id="edc24-122">Cosmos DB Stream Analytics integrációja lehetővé teszi beszúrásához vagy frissítéséhez rögzíti a megadott azonosító oszlop alapján Cosmos DB gyűjteményben.</span><span class="sxs-lookup"><span data-stu-id="edc24-122">Stream Analytics integration with Cosmos DB allows you to insert or update records in your Cosmos DB collection based on a given Document ID column.</span></span> <span data-ttu-id="edc24-123">Ez más néven a egy *Upsert*.</span><span class="sxs-lookup"><span data-stu-id="edc24-123">This is also referred to as an *Upsert*.</span></span>

<span data-ttu-id="edc24-124">A Stream Analytics használja az optimista Upsert módszert használja, ha frissítések csak végzett amikor insert Dokumentumazonosítója ütközés miatt sikertelen.</span><span class="sxs-lookup"><span data-stu-id="edc24-124">Stream Analytics utilizes an optimistic Upsert approach, where updates are only done when insert fails due to a Document ID conflict.</span></span> <span data-ttu-id="edc24-125">A frissítés végzi el a Stream Analytics, a javítás, lehetővé teszi, hogy a dokumentumhoz, azaz hozzáadása új tulajdonságok vagy cseréje a meglévő tulajdonságot Növekményesen történik részleges frissítések.</span><span class="sxs-lookup"><span data-stu-id="edc24-125">This update is performed by Stream Analytics as a PATCH, so it enables partial updates to the document, i.e. addition of new properties or replacing an existing property is performed incrementally.</span></span> <span data-ttu-id="edc24-126">Vegye figyelembe, hogy megváltoztatja a tömb tulajdonságok a JSON-dokumentum eredményben a tömbben teljes első felülírja, azaz a tömb értékei nem egyesített.</span><span class="sxs-lookup"><span data-stu-id="edc24-126">Note that changes in the values of array properties in your JSON document result in the entire array getting overwritten, i.e. the array is not merged.</span></span>

## <a name="data-partitioning-in-cosmos-db"></a><span data-ttu-id="edc24-127">A Cosmos DB adatparticionálás</span><span class="sxs-lookup"><span data-stu-id="edc24-127">Data partitioning in Cosmos DB</span></span>
<span data-ttu-id="edc24-128">A cosmos DB [particionált gyűjtemények](../cosmos-db/partition-data.md) az ajánlott módszer az adatok felosztásának vannak.</span><span class="sxs-lookup"><span data-stu-id="edc24-128">Cosmos DB [partitioned collections](../cosmos-db/partition-data.md) are the recommended approach for partitioning your data.</span></span> 

<span data-ttu-id="edc24-129">Egyetlen Cosmos DB gyűjtemények Stream Analytics továbbra is lehetővé teszi az adatok a lekérdezési mintáknak és a teljesítménye az alkalmazás igényeinek alapuló particionálásához.</span><span class="sxs-lookup"><span data-stu-id="edc24-129">For single Cosmos DB collections, Stream Analytics still allows you to partition your data based on both the query patterns and performance needs of your application.</span></span> <span data-ttu-id="edc24-130">Minden gyűjtemény legfeljebb 10GB adatot (maximum) tartalmazhat, és jelenleg nincs mód vertikális felskálázás (vagy túlcsordulás) egy gyűjtemény.</span><span class="sxs-lookup"><span data-stu-id="edc24-130">Each collection may contain up to 10GB of data (maximum) and currently there is no way to scale up (or overflow) a collection.</span></span> <span data-ttu-id="edc24-131">Kiterjesztése, a Stream Analytics lehetővé teszi több gyűjtemény egy adott előtaggal rendelkező írni (használati részleteit lásd alább).</span><span class="sxs-lookup"><span data-stu-id="edc24-131">For scaling out, Stream Analytics allows you to write to multiple collections with a given prefix (see usage details below).</span></span> <span data-ttu-id="edc24-132">A Stream Analytics használ a konzisztens [kivonatoló partíció feloldó](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) stratégia alapján a felhasználó a megadott kimeneti rekordjai particionálásához PartitionKey oszlop.</span><span class="sxs-lookup"><span data-stu-id="edc24-132">Stream Analytics uses the consistent [Hash Partition Resolver](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) strategy based on the user provided PartitionKey column to partition its output records.</span></span> <span data-ttu-id="edc24-133">A folyamatos átviteli feladat kezdési időpontban a megadott előtaggal rendelkező gyűjtemények száma használatos a kimeneti partíciók száma, amelyre párhuzamosan ír a feladat (Cosmos DB gyűjtemények = kimeneti partíciók).</span><span class="sxs-lookup"><span data-stu-id="edc24-133">The number of collections with the given prefix at the streaming job’s start time is used as the output partition count, to which the job writes to in parallel (Cosmos DB Collections = Output Partitions).</span></span> <span data-ttu-id="edc24-134">A lusta indexelési ezzel együtt egyetlen gyűjtemény csak szúrja be, kapcsolatos 0,4 MB/s teljesítménye várhatók.</span><span class="sxs-lookup"><span data-stu-id="edc24-134">For a single collection with lazy indexing doing only inserts, about 0.4 MB/s write throughput can be expected.</span></span> <span data-ttu-id="edc24-135">Több gyűjteményt használ lehetővé teszi, nagyobb átviteli sebesség és a nagyobb kapacitás elérése érdekében.</span><span class="sxs-lookup"><span data-stu-id="edc24-135">Using multiple collections can allow you to achieve higher throughput and increased capacity.</span></span>

<span data-ttu-id="edc24-136">Ha azt tervezi, a partíciók száma növelésére a jövőben, szükség lehet a feladat leállítása, a meglévő gyűjtemények új gyűjteményekbe adatait újraparticionálása, és indítsa újra a Stream Analytics-feladat.</span><span class="sxs-lookup"><span data-stu-id="edc24-136">If you intend to increase the partition count in the future, you may need to stop your job, repartition the data from your existing collections into new collections and then restart the Stream Analytics job.</span></span> <span data-ttu-id="edc24-137">További részleteket a PartitionResolver használatával, és újra particionálás mintakód, valamint követő post fognak szerepelni.</span><span class="sxs-lookup"><span data-stu-id="edc24-137">More details on using PartitionResolver and re-partitioning along with sample code, will be included in a follow-up post.</span></span> <span data-ttu-id="edc24-138">A cikk [particionálás és Cosmos DB skálázás](../documentdb/documentdb-partition-data.md) is részletesen itt.</span><span class="sxs-lookup"><span data-stu-id="edc24-138">The article [Partitioning and scaling in Cosmos DB](../documentdb/documentdb-partition-data.md) also provides details on this.</span></span>

## <a name="cosmos-db-settings-for-json-output"></a><span data-ttu-id="edc24-139">JSON kimeneti cosmos DB beállításai</span><span class="sxs-lookup"><span data-stu-id="edc24-139">Cosmos DB settings for JSON output</span></span>
<span data-ttu-id="edc24-140">Az alább látható információt adatkérést Cosmos-adatbázis létrehozása a Stream Analytics kimenetként állít elő.</span><span class="sxs-lookup"><span data-stu-id="edc24-140">Creating Cosmos DB as an output in Stream Analytics generates a prompt for information as seen below.</span></span> <span data-ttu-id="edc24-141">Ez a szakasz a Tulajdonságok definíció magyarázattal szolgál.</span><span class="sxs-lookup"><span data-stu-id="edc24-141">This section provides an explanation of the properties definition.</span></span>

<span data-ttu-id="edc24-142">Particionált gyűjtemény</span><span class="sxs-lookup"><span data-stu-id="edc24-142">Partitioned Collection</span></span> | <span data-ttu-id="edc24-143">Több "Egypartíciós" gyűjtemény</span><span class="sxs-lookup"><span data-stu-id="edc24-143">Multiple “Single Partition” collections</span></span>
---|---
![a documentdb stream analytics kimeneti képernyő](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-1.png) |  ![a documentdb stream analytics kimeneti képernyő](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-2.png)


  
> [!NOTE]
> <span data-ttu-id="edc24-146">A **több "Egypartíciós" gyűjtemény** forgatókönyv partíciós kulcs használatát igényli, és a támogatott konfiguráció.</span><span class="sxs-lookup"><span data-stu-id="edc24-146">The **Multiple “Single Partition” collections** scenario requires a partition key and is a supported configuration.</span></span> 

* <span data-ttu-id="edc24-147">**A kimeneti Alias** – tekintse meg a kimenetet a ASA lekérdezés alias egy</span><span class="sxs-lookup"><span data-stu-id="edc24-147">**Output Alias** – An alias to refer this output in your ASA query</span></span>  
* <span data-ttu-id="edc24-148">**A fiók neve** – a név vagy a végpont URI-azonosítója a Cosmos DB fiók.</span><span class="sxs-lookup"><span data-stu-id="edc24-148">**Account Name** – The name or endpoint URI of the Cosmos DB account.</span></span>  
* <span data-ttu-id="edc24-149">**Kulcs fiók** – Cosmos DB fiók a megosztott elérési kulcsot.</span><span class="sxs-lookup"><span data-stu-id="edc24-149">**Account Key** – The shared access key for the Cosmos DB account.</span></span>  
* <span data-ttu-id="edc24-150">**Adatbázis** – Cosmos-adatbázis az adatbázis nevét.</span><span class="sxs-lookup"><span data-stu-id="edc24-150">**Database** – The Cosmos DB database name.</span></span>  
* <span data-ttu-id="edc24-151">**Gyűjteménynévmintája** – a gyűjtemény nevét vagy a használandó gyűjtemények gyűjteménynévmintája.</span><span class="sxs-lookup"><span data-stu-id="edc24-151">**Collection Name Pattern** – The collection name or their pattern for the collections to be used.</span></span> <span data-ttu-id="edc24-152">A gyűjteménynév-formátum az opcionális {partition} token használatával, ahol a partíciók 0-tól kezdődnek lehet létrehozni.</span><span class="sxs-lookup"><span data-stu-id="edc24-152">The collection name format can be constructed using the optional {partition} token, where partitions start from 0.</span></span> <span data-ttu-id="edc24-153">Minta érvényes bemenetei a következők:</span><span class="sxs-lookup"><span data-stu-id="edc24-153">Following are sample valid inputs:</span></span>  
  <span data-ttu-id="edc24-154">1\) MyCollection – egy gyűjteményt a következő "MyCollection" néven már léteznie kell.</span><span class="sxs-lookup"><span data-stu-id="edc24-154">1\) MyCollection – One collection named “MyCollection” must exist.</span></span>  
  <span data-ttu-id="edc24-155">2\) MyCollection {partition} – ilyen gyűjteményeknek létezniük kell – "MyCollection0", "MyCollection1", "MyCollection2" és így tovább.</span><span class="sxs-lookup"><span data-stu-id="edc24-155">2\) MyCollection{partition} – Such collections must exist– "MyCollection0”, “MyCollection1”, “MyCollection2” and so on.</span></span>  
* <span data-ttu-id="edc24-156">**Kulcs partícióazonosító** – nem kötelező.</span><span class="sxs-lookup"><span data-stu-id="edc24-156">**Partition Key** – Optional.</span></span> <span data-ttu-id="edc24-157">Ez csak akkor van szükség, ha a gyűjteménynévmintája {particionáló} jogkivonatot használ.</span><span class="sxs-lookup"><span data-stu-id="edc24-157">This is only needed if you are using a {parition} token in your collection name pattern.</span></span> <span data-ttu-id="edc24-158">A kimeneti eseményekben a kimenet gyűjtemények közötti particionálására szolgáló kulcs megadásához használt mező neve.</span><span class="sxs-lookup"><span data-stu-id="edc24-158">The name of the field in output events used to specify the key for partitioning output across collections.</span></span> <span data-ttu-id="edc24-159">Egyetlen gyűjtemény kimeneti bármilyen tetszőleges kimeneti oszlop lehet például PartitionId használt.</span><span class="sxs-lookup"><span data-stu-id="edc24-159">For single collection output, any arbitrary output column can be used e.g. PartitionId.</span></span>  
* <span data-ttu-id="edc24-160">**Dokumentálja azonosító** – nem kötelező.</span><span class="sxs-lookup"><span data-stu-id="edc24-160">**Document ID** – Optional.</span></span> <span data-ttu-id="edc24-161">A kimeneti eseményekben a mely Beszúrás vagy frissítés műveletek alapuló elsődleges kulcs megadásához használt mező neve.</span><span class="sxs-lookup"><span data-stu-id="edc24-161">The name of the field in output events used to specify the primary key on which insert or update operations are based.</span></span>  
