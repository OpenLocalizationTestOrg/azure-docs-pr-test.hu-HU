---
title: a Stream Analytics aaaJSON kimeneti |} Microsoft Docs
description: "Ismerje meg, hogyan Stream Analytics egy célcsoport kijelölésével az Azure Cosmos DB JSON kimeneti adatok archiválása és alacsony késésű lekérdezései strukturálatlan JSON-adatokat."
keywords: JSON kimeneti
documentationcenter: 
services: stream-analytics,documentdb
author: samacha
manager: jhubbard
editor: cgronlun
ms.assetid: 5d2a61a6-0dbf-4f1b-80af-60a80eb25dd1
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: samacha
ms.openlocfilehash: fa717818c839ecd7a60fcee33d22011990fd5878
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="target-azure-cosmos-db-for-json-output-from-stream-analytics"></a><span data-ttu-id="b4242-104">Cél Azure Cosmos DB JSON-kimenetét a Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="b4242-104">Target Azure Cosmos DB for JSON output from Stream Analytics</span></span>
<span data-ttu-id="b4242-105">A Stream Analytics célba [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) JSON-kimenetét, engedélyezi az archiválási és alacsony késésű kérelmek strukturálatlan JSON-adatokat.</span><span class="sxs-lookup"><span data-stu-id="b4242-105">Stream Analytics can target [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) for JSON output, enabling data archiving and low-latency queries on unstructured JSON data.</span></span> <span data-ttu-id="b4242-106">Ez a dokumentum ismertet néhány gyakorlati tanácsok a konfiguráció alkalmazásához.</span><span class="sxs-lookup"><span data-stu-id="b4242-106">This document covers some best practices for implementing this configuration.</span></span>

<span data-ttu-id="b4242-107">Azok számára, akiknek nem ismeri az Cosmos DB, vessen egy pillantást [Azure Cosmos DB képzési terv](https://azure.microsoft.com/documentation/learning-paths/documentdb/) tooget elindult.</span><span class="sxs-lookup"><span data-stu-id="b4242-107">For those who are unfamiliar with Cosmos DB, take a look at [Azure Cosmos DB’s learning path](https://azure.microsoft.com/documentation/learning-paths/documentdb/) tooget started.</span></span> 

<span data-ttu-id="b4242-108">Megjegyzés: A Mongo DB API alapú Cosmos DB gyűjtemények jelenleg nem támogatott.</span><span class="sxs-lookup"><span data-stu-id="b4242-108">Note: Mongo DB API based Cosmos DB collections is currently not supported.</span></span> 

## <a name="basics-of-cosmos-db-as-an-output-target"></a><span data-ttu-id="b4242-109">Egy kimeneti célként Cosmos DB alapjai</span><span class="sxs-lookup"><span data-stu-id="b4242-109">Basics of Cosmos DB as an output target</span></span>
<span data-ttu-id="b4242-110">hello Azure Cosmos DB kimenetet a Stream Analytics lehetővé teszi, hogy írása a streamfeldolgozási eredmények JSON kimenetként a Cosmos DB következő gyűjtemény(ek) készleteit szinkronizálja azokat.</span><span class="sxs-lookup"><span data-stu-id="b4242-110">hello Azure Cosmos DB output in Stream Analytics enables writing your stream processing results as JSON output into your Cosmos DB collection(s).</span></span> <span data-ttu-id="b4242-111">A Stream Analytics nem hoz létre gyűjteményeket az adatbázis ehelyett nincs szükség toocreate őket előzetes megfizetése esetén.</span><span class="sxs-lookup"><span data-stu-id="b4242-111">Stream Analytics does not create collections in your database, instead requiring you toocreate them upfront.</span></span> <span data-ttu-id="b4242-112">Ez azért, hogy hello számlázási költségek Cosmos DB gyűjtemények átlátszó tooyou, és így hello teljesítmény hangolás konzisztencia és a gyűjtemények közvetlenül kapacitásának hello [Cosmos DB API-k](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span><span class="sxs-lookup"><span data-stu-id="b4242-112">This is so that hello billing costs of Cosmos DB collections are transparent tooyou, and so that you can tune hello performance, consistency and capacity of your collections directly using hello [Cosmos DB APIs](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span></span> <span data-ttu-id="b4242-113">Azt javasoljuk, egy Cosmos DB adatbázishoz folyamatos átviteli feladat toologically külön a folyamatos átviteli feladat-gyűjteményekben.</span><span class="sxs-lookup"><span data-stu-id="b4242-113">We recommend using one Cosmos DB Database per streaming job toologically separate your collections for a streaming job.</span></span>

<span data-ttu-id="b4242-114">Hello Cosmos DB adatgyűjtési beállítások némelyike részleteket lejjebb olvashatja.</span><span class="sxs-lookup"><span data-stu-id="b4242-114">Some of hello Cosmos DB collection options are detailed below.</span></span>

## <a name="tune-consistency-availability-and-latency"></a><span data-ttu-id="b4242-115">Konzisztencia, a rendelkezésre állás és a késleltetés hangolása</span><span class="sxs-lookup"><span data-stu-id="b4242-115">Tune consistency, availability, and latency</span></span>
<span data-ttu-id="b4242-116">toomatch alkalmazás igényeinek, Cosmos DB lehetővé teszi toofine hangolási hello adatbázis és a gyűjtemények és a ellenőrizze kompromisszumot konzisztencia, a rendelkezésre állás és a késleltetés között.</span><span class="sxs-lookup"><span data-stu-id="b4242-116">toomatch your application requirements, Cosmos DB allows you toofine tune hello database and collections and make trade-offs between consistency, availability and latency.</span></span> <span data-ttu-id="b4242-117">Attól függően, hogy milyen szintű olvasási konzisztenciát elleni forgatókönyv igényeinek és olvasási késés, kiválaszthatja a konzisztenciaszint adatbázis fiókja.</span><span class="sxs-lookup"><span data-stu-id="b4242-117">Depending on what levels of read consistency your scenario needs against read and write latency, you can choose a consistency level on your database account.</span></span> <span data-ttu-id="b4242-118">Alapértelmezés szerint is Cosmos DB engedélyezi szinkron indexelő minden CRUD művelet tooyour gyűjteményen.</span><span class="sxs-lookup"><span data-stu-id="b4242-118">Also by default, Cosmos DB enables synchronous indexing on each CRUD operation tooyour collection.</span></span> <span data-ttu-id="b4242-119">Ez az egy másik kapcsolót toocontrol hello írási/olvasási Cosmos DB teljesítményét.</span><span class="sxs-lookup"><span data-stu-id="b4242-119">This is another useful option toocontrol hello write/read performance in Cosmos DB.</span></span> <span data-ttu-id="b4242-120">A témakörrel kapcsolatos további információkért tekintse át a hello [módosítsa az adatbázis és a lekérdezés konzisztenciaszintek](../documentdb/documentdb-consistency-levels.md) cikk.</span><span class="sxs-lookup"><span data-stu-id="b4242-120">For further information on this topic, review hello [change your database and query consistency levels](../documentdb/documentdb-consistency-levels.md) article.</span></span>

## <a name="upserts-from-stream-analytics"></a><span data-ttu-id="b4242-121">A Stream Analytics Upserts</span><span class="sxs-lookup"><span data-stu-id="b4242-121">Upserts from Stream Analytics</span></span>
<span data-ttu-id="b4242-122">Cosmos DB Stream Analytics integrációja lehetővé teszi tooinsert vagy frissítés rögzíti a Cosmos DB gyűjtemény egy adott dokumentum azonosító oszlop alapján.</span><span class="sxs-lookup"><span data-stu-id="b4242-122">Stream Analytics integration with Cosmos DB allows you tooinsert or update records in your Cosmos DB collection based on a given Document ID column.</span></span> <span data-ttu-id="b4242-123">Ez a hivatkozott tooas is egy *Upsert*.</span><span class="sxs-lookup"><span data-stu-id="b4242-123">This is also referred tooas an *Upsert*.</span></span>

<span data-ttu-id="b4242-124">A Stream Analytics használja az optimista Upsert módszert használja, ha frissítések csak végzett amikor insert tooa Dokumentumazonosítója ütközés miatt sikertelen.</span><span class="sxs-lookup"><span data-stu-id="b4242-124">Stream Analytics utilizes an optimistic Upsert approach, where updates are only done when insert fails due tooa Document ID conflict.</span></span> <span data-ttu-id="b4242-125">A frissítés végzi el a Stream Analytics, a javítás, lehetővé teszi, hogy a részleges frissítési toohello dokumentum, azaz hozzáadása új tulajdonságok vagy cseréje a meglévő tulajdonságot Növekményesen történik.</span><span class="sxs-lookup"><span data-stu-id="b4242-125">This update is performed by Stream Analytics as a PATCH, so it enables partial updates toohello document, i.e. addition of new properties or replacing an existing property is performed incrementally.</span></span> <span data-ttu-id="b4242-126">Vegye figyelembe, hogy hello értékek tömb-tulajdonságokat a JSON-dokumentum változásait hello teljes tömb első felül eredményez, azaz nem egyesített hello tömb.</span><span class="sxs-lookup"><span data-stu-id="b4242-126">Note that changes in hello values of array properties in your JSON document result in hello entire array getting overwritten, i.e. hello array is not merged.</span></span>

## <a name="data-partitioning-in-cosmos-db"></a><span data-ttu-id="b4242-127">A Cosmos DB adatparticionálás</span><span class="sxs-lookup"><span data-stu-id="b4242-127">Data partitioning in Cosmos DB</span></span>
<span data-ttu-id="b4242-128">A cosmos DB [particionált gyűjtemények](../cosmos-db/partition-data.md) ajánlott módszer az adatok felosztásának hello.</span><span class="sxs-lookup"><span data-stu-id="b4242-128">Cosmos DB [partitioned collections](../cosmos-db/partition-data.md) are hello recommended approach for partitioning your data.</span></span> 

<span data-ttu-id="b4242-129">Egyetlen Cosmos DB gyűjtemények Stream Analytics továbbra is lehetővé teszi az adatok alapján hello lekérdezési mintáknak és a teljesítménye az alkalmazás igényeinek toopartition.</span><span class="sxs-lookup"><span data-stu-id="b4242-129">For single Cosmos DB collections, Stream Analytics still allows you toopartition your data based on both hello query patterns and performance needs of your application.</span></span> <span data-ttu-id="b4242-130">Minden lehetséges, hogy too10GB adatok (maximum), és jelenleg nincs módja tooscale fel van másolatot tartalmaz (vagy túlcsordulás) gyűjtemény.</span><span class="sxs-lookup"><span data-stu-id="b4242-130">Each collection may contain up too10GB of data (maximum) and currently there is no way tooscale up (or overflow) a collection.</span></span> <span data-ttu-id="b4242-131">Kiterjesztése, a Stream Analytics lehetővé teszi egy adott előtaggal rendelkező toowrite toomultiple gyűjtemények (használati részleteit lásd alább).</span><span class="sxs-lookup"><span data-stu-id="b4242-131">For scaling out, Stream Analytics allows you toowrite toomultiple collections with a given prefix (see usage details below).</span></span> <span data-ttu-id="b4242-132">A Stream Analytics használ konzisztens hello [kivonatoló partíció feloldó](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) hello felhasználó alapján stratégia megadott PartitionKey oszlop toopartition a kimeneti rögzíti.</span><span class="sxs-lookup"><span data-stu-id="b4242-132">Stream Analytics uses hello consistent [Hash Partition Resolver](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) strategy based on hello user provided PartitionKey column toopartition its output records.</span></span> <span data-ttu-id="b4242-133">hello előtag megadott folyamatos átviteli feladat kezdési ideje hello hello gyűjtemények száma vettük hello kimeneti partíciószám toowhich hello feladat ír tooin párhuzamos (Cosmos DB gyűjtemények = kimeneti partíciók).</span><span class="sxs-lookup"><span data-stu-id="b4242-133">hello number of collections with hello given prefix at hello streaming job’s start time is used as hello output partition count, toowhich hello job writes tooin parallel (Cosmos DB Collections = Output Partitions).</span></span> <span data-ttu-id="b4242-134">A lusta indexelési ezzel együtt egyetlen gyűjtemény csak szúrja be, kapcsolatos 0,4 MB/s teljesítménye várhatók.</span><span class="sxs-lookup"><span data-stu-id="b4242-134">For a single collection with lazy indexing doing only inserts, about 0.4 MB/s write throughput can be expected.</span></span> <span data-ttu-id="b4242-135">Több gyűjteményt használ lehetővé tehetik, hogy tooachieve nagyobb átviteli teljesítményt és nagyobb kapacitást.</span><span class="sxs-lookup"><span data-stu-id="b4242-135">Using multiple collections can allow you tooachieve higher throughput and increased capacity.</span></span>

<span data-ttu-id="b4242-136">Ha a jövőben hello tooincrease hello partíciók száma, szükség lehet toostop a feladatot, a meglévő gyűjtemények új gyűjtemények, majd indítsa újra hello Stream Analytics-feladat újraparticionálása hello adatait.</span><span class="sxs-lookup"><span data-stu-id="b4242-136">If you intend tooincrease hello partition count in hello future, you may need toostop your job, repartition hello data from your existing collections into new collections and then restart hello Stream Analytics job.</span></span> <span data-ttu-id="b4242-137">További részleteket a PartitionResolver használatával, és újra particionálás mintakód, valamint követő post fognak szerepelni.</span><span class="sxs-lookup"><span data-stu-id="b4242-137">More details on using PartitionResolver and re-partitioning along with sample code, will be included in a follow-up post.</span></span> <span data-ttu-id="b4242-138">hello cikk [particionálás és Cosmos DB skálázás](../documentdb/documentdb-partition-data.md) is részletesen itt.</span><span class="sxs-lookup"><span data-stu-id="b4242-138">hello article [Partitioning and scaling in Cosmos DB](../documentdb/documentdb-partition-data.md) also provides details on this.</span></span>

## <a name="cosmos-db-settings-for-json-output"></a><span data-ttu-id="b4242-139">JSON kimeneti cosmos DB beállításai</span><span class="sxs-lookup"><span data-stu-id="b4242-139">Cosmos DB settings for JSON output</span></span>
<span data-ttu-id="b4242-140">Az alább látható információt adatkérést Cosmos-adatbázis létrehozása a Stream Analytics kimenetként állít elő.</span><span class="sxs-lookup"><span data-stu-id="b4242-140">Creating Cosmos DB as an output in Stream Analytics generates a prompt for information as seen below.</span></span> <span data-ttu-id="b4242-141">Ez a szakasz hello tulajdonságok definíció magyarázattal szolgál.</span><span class="sxs-lookup"><span data-stu-id="b4242-141">This section provides an explanation of hello properties definition.</span></span>

<span data-ttu-id="b4242-142">Particionált gyűjtemény</span><span class="sxs-lookup"><span data-stu-id="b4242-142">Partitioned Collection</span></span> | <span data-ttu-id="b4242-143">Több "Egypartíciós" gyűjtemény</span><span class="sxs-lookup"><span data-stu-id="b4242-143">Multiple “Single Partition” collections</span></span>
---|---
![a documentdb stream analytics kimeneti képernyő](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-1.png) |  ![a documentdb stream analytics kimeneti képernyő](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-2.png)


  
> [!NOTE]
> <span data-ttu-id="b4242-146">Hello **több "Egypartíciós" gyűjtemény** forgatókönyv partíciós kulcs használatát igényli, és a támogatott konfiguráció.</span><span class="sxs-lookup"><span data-stu-id="b4242-146">hello **Multiple “Single Partition” collections** scenario requires a partition key and is a supported configuration.</span></span> 

* <span data-ttu-id="b4242-147">**A kimeneti Alias** – egy alias toorefer ezt a kimenetet a ASA lekérdezés</span><span class="sxs-lookup"><span data-stu-id="b4242-147">**Output Alias** – An alias toorefer this output in your ASA query</span></span>  
* <span data-ttu-id="b4242-148">**A fiók neve** – hello nevét vagy a végpont URI-jának hello Cosmos DB fiók.</span><span class="sxs-lookup"><span data-stu-id="b4242-148">**Account Name** – hello name or endpoint URI of hello Cosmos DB account.</span></span>  
* <span data-ttu-id="b4242-149">**Kulcs fiók** – Cosmos DB fiók hello hello megosztott hozzáférési kulcsot.</span><span class="sxs-lookup"><span data-stu-id="b4242-149">**Account Key** – hello shared access key for hello Cosmos DB account.</span></span>  
* <span data-ttu-id="b4242-150">**Adatbázis** – hello Cosmos DB adatbázis neve.</span><span class="sxs-lookup"><span data-stu-id="b4242-150">**Database** – hello Cosmos DB database name.</span></span>  
* <span data-ttu-id="b4242-151">**Gyűjteménynévmintája** – hello gyűjtemény neve vagy a használt hello gyűjtemények toobe mintát.</span><span class="sxs-lookup"><span data-stu-id="b4242-151">**Collection Name Pattern** – hello collection name or their pattern for hello collections toobe used.</span></span> <span data-ttu-id="b4242-152">hello gyűjteménynév-formátum használatával hello opcionális {partition} token, ahol a partíciók 0-tól kezdődnek lehet létrehozni.</span><span class="sxs-lookup"><span data-stu-id="b4242-152">hello collection name format can be constructed using hello optional {partition} token, where partitions start from 0.</span></span> <span data-ttu-id="b4242-153">Minta érvényes bemenetei a következők:</span><span class="sxs-lookup"><span data-stu-id="b4242-153">Following are sample valid inputs:</span></span>  
  <span data-ttu-id="b4242-154">1\) MyCollection – egy gyűjteményt a következő "MyCollection" néven már léteznie kell.</span><span class="sxs-lookup"><span data-stu-id="b4242-154">1\) MyCollection – One collection named “MyCollection” must exist.</span></span>  
  <span data-ttu-id="b4242-155">2\) MyCollection {partition} – ilyen gyűjteményeknek létezniük kell – "MyCollection0", "MyCollection1", "MyCollection2" és így tovább.</span><span class="sxs-lookup"><span data-stu-id="b4242-155">2\) MyCollection{partition} – Such collections must exist– "MyCollection0”, “MyCollection1”, “MyCollection2” and so on.</span></span>  
* <span data-ttu-id="b4242-156">**Kulcs partícióazonosító** – nem kötelező.</span><span class="sxs-lookup"><span data-stu-id="b4242-156">**Partition Key** – Optional.</span></span> <span data-ttu-id="b4242-157">Ez csak akkor van szükség, ha a gyűjteménynévmintája {particionáló} jogkivonatot használ.</span><span class="sxs-lookup"><span data-stu-id="b4242-157">This is only needed if you are using a {parition} token in your collection name pattern.</span></span> <span data-ttu-id="b4242-158">a kimeneti használt események toospecify hello kulcsban a kimenet gyűjtemények közötti particionálására hello mező hello nevét.</span><span class="sxs-lookup"><span data-stu-id="b4242-158">hello name of hello field in output events used toospecify hello key for partitioning output across collections.</span></span> <span data-ttu-id="b4242-159">Egyetlen gyűjtemény kimeneti bármilyen tetszőleges kimeneti oszlop lehet például PartitionId használt.</span><span class="sxs-lookup"><span data-stu-id="b4242-159">For single collection output, any arbitrary output column can be used e.g. PartitionId.</span></span>  
* <span data-ttu-id="b4242-160">**Dokumentálja azonosító** – nem kötelező.</span><span class="sxs-lookup"><span data-stu-id="b4242-160">**Document ID** – Optional.</span></span> <span data-ttu-id="b4242-161">a kimeneti eseményekben a hello mező hello nevét használja toospecify hello elsődleges kulcs mely Beszúrás vagy frissítés műveletek alapulnak.</span><span class="sxs-lookup"><span data-stu-id="b4242-161">hello name of hello field in output events used toospecify hello primary key on which insert or update operations are based.</span></span>  
