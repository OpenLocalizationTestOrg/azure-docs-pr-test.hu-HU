---
title: "az Active Directory aaaAzure 2.0 hatókörök, engedélyek és hozzájárulási |} Microsoft Docs"
description: "Engedélyezés hello Azure AD v2.0-végpontra, beleértve a hatókörök, engedélyek és beleegyezése leírását."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 8f98cbf0-a71d-4e34-babf-e644ad9ff423
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/07/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 5721d368c435868bfb4ae91cff7fbb9bc4a79b66
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="scopes-permissions-and-consent-in-hello-azure-active-directory-v20-endpoint"></a><span data-ttu-id="01555-103">Hatókörök, engedélyek és hello Azure Active Directory v2.0-végponttól jóváhagyása</span><span class="sxs-lookup"><span data-stu-id="01555-103">Scopes, permissions, and consent in hello Azure Active Directory v2.0 endpoint</span></span>
<span data-ttu-id="01555-104">Alkalmazásokat, amelyekbe beépül az Azure Active Directory (Azure AD) hajtsa végre az olyan engedélyezési modell, amely lehetőséget ad a felhasználók szabályozhatják, hogyan az alkalmazások is hozzáférjenek az adataikhoz.</span><span class="sxs-lookup"><span data-stu-id="01555-104">Apps that integrate with Azure Active Directory (Azure AD) follow an authorization model that gives users control over how an app can access their data.</span></span> <span data-ttu-id="01555-105">hello v2.0 végrehajtásának hello engedélyezési modellt már frissítve van, és hogyan kapcsolatba kell lépnie egy alkalmazást az Azure ad-val változik.</span><span class="sxs-lookup"><span data-stu-id="01555-105">hello v2.0 implementation of hello authorization model has been updated, and it changes how an app must interact with Azure AD.</span></span> <span data-ttu-id="01555-106">Ez a cikk ismerteti az engedélyezési modellt, beleértve a hatókörök, engedélyek és beleegyezése hello alapvető fogalmait.</span><span class="sxs-lookup"><span data-stu-id="01555-106">This article covers hello basic concepts of this authorization model, including scopes, permissions, and consent.</span></span>

> [!NOTE]
> <span data-ttu-id="01555-107">hello v2.0-végpontra nem támogatja az összes Azure Active Directory forgatókönyvek és funkciók.</span><span class="sxs-lookup"><span data-stu-id="01555-107">hello v2.0 endpoint does not support all Azure Active Directory scenarios and features.</span></span> <span data-ttu-id="01555-108">toodetermine kell használnia a hello v2.0-végpontra, hogy olvassa el [v2.0 korlátozások](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="01555-108">toodetermine whether you should use hello v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>
>

## <a name="scopes-and-permissions"></a><span data-ttu-id="01555-109">Hatókörök és engedélyek</span><span class="sxs-lookup"><span data-stu-id="01555-109">Scopes and permissions</span></span>
<span data-ttu-id="01555-110">Az Azure AD megvalósítja hello [OAuth 2.0](active-directory-v2-protocols.md) hitelesítési protokoll.</span><span class="sxs-lookup"><span data-stu-id="01555-110">Azure AD implements hello [OAuth 2.0](active-directory-v2-protocols.md) authorization protocol.</span></span> <span data-ttu-id="01555-111">OAuth 2.0 egy metódust, amelyen keresztül a külső alkalmazások hozzáférhetnek a webkiszolgáló által szolgáltatott erőforrásokhoz egy felhasználó nevében.</span><span class="sxs-lookup"><span data-stu-id="01555-111">OAuth 2.0 is a method through which a third-party app can access web-hosted resources on behalf of a user.</span></span> <span data-ttu-id="01555-112">A webkiszolgáló által szolgáltatott erőforrás, amely az Azure AD tartalmaz egy erőforrás-azonosítót, vagy *Application ID URI*.</span><span class="sxs-lookup"><span data-stu-id="01555-112">Any web-hosted resource that integrates with Azure AD has a resource identifier, or *Application ID URI*.</span></span> <span data-ttu-id="01555-113">Például a Microsoft web által szolgáltatott erőforrások közé:</span><span class="sxs-lookup"><span data-stu-id="01555-113">For example, some of Microsoft's web-hosted resources include:</span></span>

* <span data-ttu-id="01555-114">Office 365 egyesített Mail API hello:`https://outlook.office.com`</span><span class="sxs-lookup"><span data-stu-id="01555-114">hello Office 365 Unified Mail API: `https://outlook.office.com`</span></span>
* <span data-ttu-id="01555-115">hello Azure AD Graph API:`https://graph.windows.net`</span><span class="sxs-lookup"><span data-stu-id="01555-115">hello Azure AD Graph API: `https://graph.windows.net`</span></span>
* <span data-ttu-id="01555-116">A Microsoft Graph:`https://graph.microsoft.com`</span><span class="sxs-lookup"><span data-stu-id="01555-116">Microsoft Graph: `https://graph.microsoft.com`</span></span>

<span data-ttu-id="01555-117">hello esetében, amely integrálva van az Azure AD külső erőforrásokat is igaz.</span><span class="sxs-lookup"><span data-stu-id="01555-117">hello same is true for any third-party resources that have integrated with Azure AD.</span></span> <span data-ttu-id="01555-118">Ezeket az erőforrásokat is definiálhat az engedélyeket, lehet használt toodivide hello funkciókat erőforrás kisebb csoportjai.</span><span class="sxs-lookup"><span data-stu-id="01555-118">Any of these resources also can define a set of permissions that can be used toodivide hello functionality of that resource into smaller chunks.</span></span> <span data-ttu-id="01555-119">Tegyük fel [Microsoft Graph](https://graph.microsoft.io) feladatokat, többek között a következő engedélyek toodo hello definiálva van:</span><span class="sxs-lookup"><span data-stu-id="01555-119">As an example, [Microsoft Graph](https://graph.microsoft.io) has defined permissions toodo hello following tasks, among others:</span></span>

* <span data-ttu-id="01555-120">A felhasználó naptár olvasása</span><span class="sxs-lookup"><span data-stu-id="01555-120">Read a user's calendar</span></span>
* <span data-ttu-id="01555-121">Írási tooa felhasználói naptár</span><span class="sxs-lookup"><span data-stu-id="01555-121">Write tooa user's calendar</span></span>
* <span data-ttu-id="01555-122">E-mailek küldése más felhasználó nevében</span><span class="sxs-lookup"><span data-stu-id="01555-122">Send mail as a user</span></span>

<span data-ttu-id="01555-123">Az ilyen típusú engedélyek megadásával hello erőforrás rendelkezik részletes szabályozhatják, az adatokat, és hogyan hello adatok ki van téve.</span><span class="sxs-lookup"><span data-stu-id="01555-123">By defining these types of permissions, hello resource has fine-grained control over its data and how hello data is exposed.</span></span> <span data-ttu-id="01555-124">A külső alkalmazások is azokat az engedélyeket kérhet egy alkalmazás felhasználói.</span><span class="sxs-lookup"><span data-stu-id="01555-124">A third-party app can request these permissions from an app user.</span></span> <span data-ttu-id="01555-125">hello app felhasználó működhet-e hello app hello felhasználó nevében előtt jóvá kell hagynia hello engedélyek.</span><span class="sxs-lookup"><span data-stu-id="01555-125">hello app user must approve hello permissions before hello app can act on hello user's behalf.</span></span> <span data-ttu-id="01555-126">Kisebb engedélycsoportok hello erőforrás funkciókat adattömbösítő, harmadik felek alkalmazásaihoz lehetnek beépített toorequest csak hello konkrét engedélyeket, hogy be kell tooperform működésére.</span><span class="sxs-lookup"><span data-stu-id="01555-126">By chunking hello resource's functionality into smaller permission sets, third-party apps can be built toorequest only hello specific permissions that they need tooperform their function.</span></span> <span data-ttu-id="01555-127">Alkalmazás felhasználói tudhatja, pontosan egy alkalmazás általi felhasználásának módja az adatokat, és azok lehet több abban, hogy hello app rosszindulatú viselkedik.</span><span class="sxs-lookup"><span data-stu-id="01555-127">App users can know exactly how an app will use their data, and they can be more confident that hello app is not behaving with malicious intent.</span></span>

<span data-ttu-id="01555-128">Az Azure AD és az OAuth, ezek az engedélyek nevezik *hatókörök*.</span><span class="sxs-lookup"><span data-stu-id="01555-128">In Azure AD and OAuth, these types of permissions are called *scopes*.</span></span> <span data-ttu-id="01555-129">Néha is hivatkozott tooas *oAuth2Permissions*.</span><span class="sxs-lookup"><span data-stu-id="01555-129">They also sometimes are referred tooas *oAuth2Permissions*.</span></span> <span data-ttu-id="01555-130">A hatókör karakterlánc-érték jelzi az Azure ad-ben.</span><span class="sxs-lookup"><span data-stu-id="01555-130">A scope is represented in Azure AD as a string value.</span></span> <span data-ttu-id="01555-131">Hello Microsoft Graph példát folytatva, hello hatókör minden engedély értéke:</span><span class="sxs-lookup"><span data-stu-id="01555-131">Continuing with hello Microsoft Graph example, hello scope value for each permission is:</span></span>

* <span data-ttu-id="01555-132">Olvassa el a felhasználó naptár használatával`Calendar.Read`</span><span class="sxs-lookup"><span data-stu-id="01555-132">Read a user's calendar by using `Calendar.Read`</span></span>
* <span data-ttu-id="01555-133">Írási tooa felhasználói naptár használatával`Mail.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="01555-133">Write tooa user's calendar by using `Mail.ReadWrite`</span></span>
* <span data-ttu-id="01555-134">Egy felhasználó használt által e-maileket küldjön`Mail.Send`</span><span class="sxs-lookup"><span data-stu-id="01555-134">Send mail as a user using by `Mail.Send`</span></span>

<span data-ttu-id="01555-135">Egy alkalmazás ezeket az engedélyeket kérhet kérelmek toohello v2.0-végponttól hello hatókörök megadásával.</span><span class="sxs-lookup"><span data-stu-id="01555-135">An app can request these permissions by specifying hello scopes in requests toohello v2.0 endpoint.</span></span>

## <a name="openid-connect-scopes"></a><span data-ttu-id="01555-136">Hatókörök OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="01555-136">OpenID Connect scopes</span></span>
<span data-ttu-id="01555-137">az OpenID Connect hello v2.0 végrehajtása rendelkezik néhány jól meghatározott hatókörök tooa megadott erőforrás nem alkalmazható: `openid`, `email`, `profile`, és `offline_access`.</span><span class="sxs-lookup"><span data-stu-id="01555-137">hello v2.0 implementation of OpenID Connect has a few well-defined scopes that do not apply tooa specific resource: `openid`, `email`, `profile`, and `offline_access`.</span></span>

### <a name="openid"></a><span data-ttu-id="01555-138">openid</span><span class="sxs-lookup"><span data-stu-id="01555-138">openid</span></span>
<span data-ttu-id="01555-139">Ha egy alkalmazás segítségével hajtja végre a bejelentkezési [OpenID Connect](active-directory-v2-protocols.md), azt kell igényelnie hello `openid` hatókör.</span><span class="sxs-lookup"><span data-stu-id="01555-139">If an app performs sign-in by using [OpenID Connect](active-directory-v2-protocols.md), it must request hello `openid` scope.</span></span> <span data-ttu-id="01555-140">Hello `openid` hatókörét jelzi a hello munkahelyi fiókot lap hozzájárulás engedély "Bejelentkezés" hello, és hello személyes Microsoft-fiókjában hozzájárulás lap, hello "Profilját és tooapps és a Microsoft-fiókjával szolgáltatások" engedéllyel.</span><span class="sxs-lookup"><span data-stu-id="01555-140">hello `openid` scope shows on hello work account consent page as hello "Sign you in" permission, and on hello personal Microsoft account consent page as hello "View your profile and connect tooapps and services using your Microsoft account" permission.</span></span> <span data-ttu-id="01555-141">Ezzel az engedéllyel, egy alkalmazás hello felhasználó egyedi azonosítóját fogadhat hello hello formájában `sub` jogcímek.</span><span class="sxs-lookup"><span data-stu-id="01555-141">With this permission, an app can receive a unique identifier for hello user in hello form of hello `sub` claim.</span></span> <span data-ttu-id="01555-142">Emellett a hello app hozzáférés toohello UserInfo végpont segítségével.</span><span class="sxs-lookup"><span data-stu-id="01555-142">It also gives hello app access toohello UserInfo endpoint.</span></span> <span data-ttu-id="01555-143">Hello `openid` hatókör hello v2.0 token-végpont tooacquire azonosító-jogkivonatokat, amelyek az alkalmazások összetevői között használt toosecure HTTP-hívások is lehet használni.</span><span class="sxs-lookup"><span data-stu-id="01555-143">hello `openid` scope can be used at hello v2.0 token endpoint tooacquire ID tokens, which can be used toosecure HTTP calls between different components of an app.</span></span>

### <a name="email"></a><span data-ttu-id="01555-144">E-mailek</span><span class="sxs-lookup"><span data-stu-id="01555-144">email</span></span>
<span data-ttu-id="01555-145">Hello `email` hatókör használható hello `openid` hatókörben és bármely más.</span><span class="sxs-lookup"><span data-stu-id="01555-145">hello `email` scope can be used with hello `openid` scope and any others.</span></span> <span data-ttu-id="01555-146">Hello app hozzáférés toohello a felhasználó elsődleges e-mail címét hello hello formájában biztosít `email` jogcímek.</span><span class="sxs-lookup"><span data-stu-id="01555-146">It gives hello app access toohello user's primary email address in hello form of hello `email` claim.</span></span> <span data-ttu-id="01555-147">Hello `email` jogcím szerepel egy token csak akkor, ha az e-mail címet helyzet nem mindig hello hello felhasználói fiókhoz társítva.</span><span class="sxs-lookup"><span data-stu-id="01555-147">hello `email` claim is included in a token only if an email address is associated with hello user account, which is not always hello case.</span></span> <span data-ttu-id="01555-148">Ha hello használ `email` hatókör, az alkalmazás kell toohandle eset melyik hello az előkészített `email` jogcím hello jogkivonat nem létezik.</span><span class="sxs-lookup"><span data-stu-id="01555-148">If it uses hello `email` scope, your app should be prepared toohandle a case in which hello `email` claim does not exist in hello token.</span></span>

### <a name="profile"></a><span data-ttu-id="01555-149">Profil</span><span class="sxs-lookup"><span data-stu-id="01555-149">profile</span></span>
<span data-ttu-id="01555-150">Hello `profile` hatókör használható hello `openid` hatókörben és bármely más.</span><span class="sxs-lookup"><span data-stu-id="01555-150">hello `profile` scope can be used with hello `openid` scope and any others.</span></span> <span data-ttu-id="01555-151">Hello app hozzáférés tooa jelentős mennyiségű hello felhasználói kapcsolatos információkat biztosít.</span><span class="sxs-lookup"><span data-stu-id="01555-151">It gives hello app access tooa substantial amount of information about hello user.</span></span> <span data-ttu-id="01555-152">hozzáférhet hello információkat tartalmaz, de nem korlátozódik, felhasználó által megadott névvel, a Vezetéknév, az elsődleges felhasználónév hello, és objektum-azonosítót.</span><span class="sxs-lookup"><span data-stu-id="01555-152">hello information it can access includes, but is not limited to, hello user's given name, surname, preferred username, and object ID.</span></span> <span data-ttu-id="01555-153">Hello profil jogcímek hello id_tokens paraméter elérhető egy adott felhasználó teljes listáját lásd: hello [v2.0 jogkivonatok hivatkozás](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="01555-153">For a complete list of hello profile claims available in hello id_tokens parameter for a specific user, see hello [v2.0 tokens reference](active-directory-v2-tokens.md).</span></span>

### <a name="offlineaccess"></a><span data-ttu-id="01555-154">offline_access</span><span class="sxs-lookup"><span data-stu-id="01555-154">offline_access</span></span>
<span data-ttu-id="01555-155">Hello [ `offline_access` hatókör](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) hosszú ideig tartó ad az alkalmazás hozzáférési tooresources hello felhasználó nevében.</span><span class="sxs-lookup"><span data-stu-id="01555-155">hello [`offline_access` scope](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) gives your app access tooresources on behalf of hello user for an extended time.</span></span> <span data-ttu-id="01555-156">Hello munkahelyi fiók hozzájárulási lapon a hatókör jelenik meg, hello "Az adatok elérése bármikor" engedéllyel.</span><span class="sxs-lookup"><span data-stu-id="01555-156">On hello work account consent page, this scope appears as hello "Access your data anytime" permission.</span></span> <span data-ttu-id="01555-157">Hello személyes Microsoft fiók hozzájárulási lapon akkor jelenik meg, hello hozzáférés-adataihoz bármikor"engedéllyel.</span><span class="sxs-lookup"><span data-stu-id="01555-157">On hello personal Microsoft account consent page, it appears as hello "Access your info anytime" permission.</span></span> <span data-ttu-id="01555-158">Amikor egy felhasználó jóvá hello `offline_access` hatókör, az alkalmazás fogadhat frissítési jogkivonatokat hello v2.0 jogkivonat végpontjához.</span><span class="sxs-lookup"><span data-stu-id="01555-158">When a user approves hello `offline_access` scope, your app can receive refresh tokens from hello v2.0 token endpoint.</span></span> <span data-ttu-id="01555-159">Frissítési jogkivonatok hosszú élettartamú.</span><span class="sxs-lookup"><span data-stu-id="01555-159">Refresh tokens are long-lived.</span></span> <span data-ttu-id="01555-160">Az alkalmazás kérheti le új jogkivonatot, ahogyan a régieket érvényessége lejár.</span><span class="sxs-lookup"><span data-stu-id="01555-160">Your app can get new access tokens as older ones expire.</span></span>

<span data-ttu-id="01555-161">Ha az alkalmazás nem kér hello `offline_access` hatókör, hogy nem kapja a frissítési jogkivonatokat.</span><span class="sxs-lookup"><span data-stu-id="01555-161">If your app does not request hello `offline_access` scope, it won't receive refresh tokens.</span></span> <span data-ttu-id="01555-162">Ez azt jelenti, hogy ha egy engedélyezési kódot hello beváltja [OAuth 2.0 hitelesítésikód-folyamata](active-directory-v2-protocols.md), csak olyan hozzáférési jogkivonatot kap a hello `/token` végpont.</span><span class="sxs-lookup"><span data-stu-id="01555-162">This means that when you redeem an authorization code in hello [OAuth 2.0 authorization code flow](active-directory-v2-protocols.md), you'll receive only an access token from hello `/token` endpoint.</span></span> <span data-ttu-id="01555-163">hello hozzáférési jogkivonat érvénytelen rövid időre.</span><span class="sxs-lookup"><span data-stu-id="01555-163">hello access token is valid for a short time.</span></span> <span data-ttu-id="01555-164">hello hozzáférési jogkivonat általában egy óra múlva lejár.</span><span class="sxs-lookup"><span data-stu-id="01555-164">hello access token usually expires in one hour.</span></span> <span data-ttu-id="01555-165">Ezen a ponton a kell tooredirect hello felhasználói hátsó toohello `/authorize` végpont tooget egy új hitelesítési kódot.</span><span class="sxs-lookup"><span data-stu-id="01555-165">At that point, your app needs tooredirect hello user back toohello `/authorize` endpoint tooget a new authorization code.</span></span> <span data-ttu-id="01555-166">Az átirányítás, attól függően, hogy hello típusú alkalmazás során hello felhasználói előfordulhat, hogy kell tooenter hitelesítő adataikkal újra vagy hozzájárulás újra toopermissions.</span><span class="sxs-lookup"><span data-stu-id="01555-166">During this redirect, depending on hello type of app, hello user might need tooenter their credentials again or consent again toopermissions.</span></span>

<span data-ttu-id="01555-167">Hogyan tooget és -felhasználási frissítési jogkivonatok kapcsolatos további információkért lásd: hello [v2.0 protokoll referenciái](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="01555-167">For more information about how tooget and use refresh tokens, see hello [v2.0 protocol reference](active-directory-v2-protocols.md).</span></span>

## <a name="requesting-individual-user-consent"></a><span data-ttu-id="01555-168">Egyéni felhasználói hozzájárulás kérése</span><span class="sxs-lookup"><span data-stu-id="01555-168">Requesting individual user consent</span></span>
<span data-ttu-id="01555-169">Az egy [OpenID Connect vagy OAuth 2.0](active-directory-v2-protocols.md) engedélyt kér, egy alkalmazás kérheti hello segítségével kell hello engedélyek `scope` lekérdezési paraméter.</span><span class="sxs-lookup"><span data-stu-id="01555-169">In an [OpenID Connect or OAuth 2.0](active-directory-v2-protocols.md) authorization request, an app can request hello permissions it needs by using hello `scope` query parameter.</span></span> <span data-ttu-id="01555-170">Például egy felhasználó bejelentkezik tooan app, hello app kérést küld például hello példa (az olvashatóságot hozzá sortörést) a következő:</span><span class="sxs-lookup"><span data-stu-id="01555-170">For example, when a user signs in tooan app, hello app sends a request like hello following example (with line breaks added for legibility):</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&response_mode=query
&scope=
https%3A%2F%2Fgraph.microsoft.com%2Fcalendar.read%20
https%3A%2F%2Fgraph.microsoft.com%2Fmail.send
&state=12345
```

<span data-ttu-id="01555-171">Hello `scope` paraméter kér az alkalmazás hello hatókörök szóközökkel elválasztott listáját.</span><span class="sxs-lookup"><span data-stu-id="01555-171">hello `scope` parameter is a space-separated list of scopes that hello app is requesting.</span></span> <span data-ttu-id="01555-172">Minden hatókör hello hatókör érték toohello erőforrás-azonosító (hello Application ID URI) hozzáfűzésével jelzi.</span><span class="sxs-lookup"><span data-stu-id="01555-172">Each scope is indicated by appending hello scope value toohello resource's identifier (hello Application ID URI).</span></span> <span data-ttu-id="01555-173">Hello kérelem példában hello kell alkalmazást engedély tooread hello felhasználói naptár és; e-mail hello felhasználóként.</span><span class="sxs-lookup"><span data-stu-id="01555-173">In hello request example, hello app needs permission tooread hello user's calendar and send mail as hello user.</span></span>

<span data-ttu-id="01555-174">Hello felhasználó megadja a hitelesítő adatokat, miután hello v2.0-végponttól ellenőrzi egy egyező rekordot *felhasználói hozzájárulás*.</span><span class="sxs-lookup"><span data-stu-id="01555-174">After hello user enters their credentials, hello v2.0 endpoint checks for a matching record of *user consent*.</span></span> <span data-ttu-id="01555-175">Ha hello felhasználó nem hozzájárult tooany hello a kért engedélyek hello korábbi, a v2.0-végponttól hello kéri hello felhasználói toogrant hello kért engedélyeket.</span><span class="sxs-lookup"><span data-stu-id="01555-175">If hello user has not consented tooany of hello requested permissions in hello past, hello v2.0 endpoint asks hello user toogrant hello requested permissions.</span></span>

![Munkahelyi fiók hozzájárulás](../../media/active-directory-v2-flows/work_account_consent.png)

<span data-ttu-id="01555-177">Hello felhasználói jóvá hello engedéllyel, amikor hello hozzájárulási, hogy hello a felhasználó nem rendelkezik tooconsent újra a későbbi bejelentkezések rögzíti.</span><span class="sxs-lookup"><span data-stu-id="01555-177">When hello user approves hello permission, hello consent is recorded so that hello user doesn't have tooconsent again on subsequent account sign-ins.</span></span>

## <a name="requesting-consent-for-an-entire-tenant"></a><span data-ttu-id="01555-178">Egy teljes bérlő hozzájárulás kérése</span><span class="sxs-lookup"><span data-stu-id="01555-178">Requesting consent for an entire tenant</span></span>
<span data-ttu-id="01555-179">Gyakran Ha egy szervezet vásárol egy licenc- vagy egy alkalmazás-előfizetés, a hello szervezet által toofully rendelkezés hello alkalmazás az alkalmazottait.</span><span class="sxs-lookup"><span data-stu-id="01555-179">Often, when an organization purchases a license or subscription for an application, hello organization wants toofully provision hello application for its employees.</span></span> <span data-ttu-id="01555-180">Ez a folyamat részeként a rendszergazda biztosíthat bármely alkalmazott nevében hello alkalmazás tooact kapcsolatos jóváhagyásról.</span><span class="sxs-lookup"><span data-stu-id="01555-180">As part of this process, an administrator can grant consent for hello application tooact on behalf of any employee.</span></span> <span data-ttu-id="01555-181">Üdvözöljük a rendszergazdákat a hozzájárulási hello teljes bérlő számára biztosít, ha az hello szervezet alkalmazottai hello alkalmazás hozzájárulási lap nem jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="01555-181">If hello admin grants consent for hello entire tenant, hello organization's employees won't see a consent page for hello application.</span></span>

<span data-ttu-id="01555-182">a bérlőt, az alkalmazás összes felhasználója számára toorequest hozzájárulási hello rendszergazda jóváhagyását végpont használhatja.</span><span class="sxs-lookup"><span data-stu-id="01555-182">toorequest consent for all users in a tenant, your app can use hello admin consent endpoint.</span></span>

## <a name="admin-restricted-scopes"></a><span data-ttu-id="01555-183">Rendszergazda által korlátozott hatókör</span><span class="sxs-lookup"><span data-stu-id="01555-183">Admin-restricted scopes</span></span>
<span data-ttu-id="01555-184">Néhány magas szintű jogosultságokkal a hello Microsoft ökoszisztéma túl beállítható*admin korlátozott*.</span><span class="sxs-lookup"><span data-stu-id="01555-184">Some high-privilege permissions in hello Microsoft ecosystem can be set too*admin-restricted*.</span></span> <span data-ttu-id="01555-185">Az ilyen típusú hatókörök például hello alábbi engedélyek használata:</span><span class="sxs-lookup"><span data-stu-id="01555-185">Examples of these kinds of scopes include hello following permissions:</span></span>

* <span data-ttu-id="01555-186">Segítségével a szervezetek címtáradatok olvasása`Directory.Read`</span><span class="sxs-lookup"><span data-stu-id="01555-186">Read an organization's directory data by using `Directory.Read`</span></span>
* <span data-ttu-id="01555-187">Írási adatok tooan szervezet címtárához használatával`Directory.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="01555-187">Write data tooan organization's directory by using `Directory.ReadWrite`</span></span>
* <span data-ttu-id="01555-188">Olvassa el a munkahely biztonsági csoportok segítségével`Groups.Read.All`</span><span class="sxs-lookup"><span data-stu-id="01555-188">Read security groups in an organization's directory by using `Groups.Read.All`</span></span>

<span data-ttu-id="01555-189">Bár a fogyasztói felhasználó milyen adatokat adhat egy alkalmazás-hozzáférés toothis, szervezeti felhasználók nem állhatnak ugyanaz a bizalmas vállalati adatok készletét hozzáférés toohello megadása.</span><span class="sxs-lookup"><span data-stu-id="01555-189">Although a consumer user might grant an application access toothis kind of data, organizational users are restricted from granting access toohello same set of sensitive company data.</span></span> <span data-ttu-id="01555-190">Ha az alkalmazás kér egy szervezeti felhasználói hozzáférés tooone ezek az engedélyek, hello üzenet egy hiba, amely szerint a nem hitelesített tooconsent tooyour app-engedélyek.</span><span class="sxs-lookup"><span data-stu-id="01555-190">If your application requests access tooone of these permissions from an organizational user, hello user receives an error message that says they are not authorized tooconsent tooyour app's permissions.</span></span>

<span data-ttu-id="01555-191">Ha az alkalmazás hozzáférési tooadmin korlátozott hatókörök a szervezet számára szükséges, igényeljen őket a vállalati rendszergazda közvetlenül a is hello rendszergazda jóváhagyását végpont, leírtak alapján használatával.</span><span class="sxs-lookup"><span data-stu-id="01555-191">If your app requires access tooadmin-restricted scopes for organizations, you should request them directly from a company administrator, also by using hello admin consent endpoint, described next.</span></span>

<span data-ttu-id="01555-192">Ha a rendszergazda engedélyezi ezeket az engedélyeket keresztül Üdvözöljük a rendszergazdákat hozzájárulás végpont, hozzájárulási kapnak a hello bérlő összes felhasználója számára.</span><span class="sxs-lookup"><span data-stu-id="01555-192">When an administrator grants these permissions via hello admin consent endpoint, consent is granted for all users in hello tenant.</span></span>

## <a name="using-hello-admin-consent-endpoint"></a><span data-ttu-id="01555-193">Hello rendszergazda jóváhagyását végpont használatával</span><span class="sxs-lookup"><span data-stu-id="01555-193">Using hello admin consent endpoint</span></span>
<span data-ttu-id="01555-194">Kövesse az alábbi lépéseket, ha az alkalmazás gyűjthet bérlőjében, beleértve a rendszergazda által korlátozott hatókörök minden felhasználó engedélyeit.</span><span class="sxs-lookup"><span data-stu-id="01555-194">If you follow these steps, your app can gather permissions for all users in a tenant, including admin-restricted scopes.</span></span> <span data-ttu-id="01555-195">toosee egy kódminta, amely megvalósítja az hello lépéseiért lásd: hello [admin korlátozott hatókörök minta](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span><span class="sxs-lookup"><span data-stu-id="01555-195">toosee a code sample that implements hello steps, see hello [admin-restricted scopes sample](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span></span>

### <a name="request-hello-permissions-in-hello-app-registration-portal"></a><span data-ttu-id="01555-196">Hello app regisztrációs portálon hello engedélyek kéréséhez</span><span class="sxs-lookup"><span data-stu-id="01555-196">Request hello permissions in hello app registration portal</span></span>
1. <span data-ttu-id="01555-197">Nyissa meg a hello tooyour alkalmazás [alkalmazásregisztrációs portálra](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), vagy [hozzon létre egy alkalmazást](active-directory-v2-app-registration.md) Ha még nem tette meg.</span><span class="sxs-lookup"><span data-stu-id="01555-197">Go tooyour application in hello [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), or [create an app](active-directory-v2-app-registration.md) if you haven't already.</span></span>
2. <span data-ttu-id="01555-198">Keresse meg a hello **Microsoft Graph engedélyek** szakaszt, és adja hozzá a hello az engedélyeket, az alkalmazás használatához.</span><span class="sxs-lookup"><span data-stu-id="01555-198">Locate hello **Microsoft Graph Permissions** section, and then add hello permissions that your app requires.</span></span>
3. <span data-ttu-id="01555-199">Győződjön meg arról, hogy **mentése** hello alkalmazás regisztrációja.</span><span class="sxs-lookup"><span data-stu-id="01555-199">Make sure you **Save** hello app registration.</span></span>

### <a name="recommended-sign-hello-user-in-tooyour-app"></a><span data-ttu-id="01555-200">Ajánlott: Bejelentkezési hello felhasználói tooyour alkalmazásban</span><span class="sxs-lookup"><span data-stu-id="01555-200">Recommended: Sign hello user in tooyour app</span></span>
<span data-ttu-id="01555-201">Általában az alkalmazás építésekor hello rendszergazda jóváhagyását végpont használó, hello alkalmazásnak kell lapon vagy a mely hello admin jóváhagyhatja hello app engedélyek nézetben.</span><span class="sxs-lookup"><span data-stu-id="01555-201">Typically, when you build an application that uses hello admin consent endpoint, hello app needs a page or view in which hello admin can approve hello app's permissions.</span></span> <span data-ttu-id="01555-202">Ezen a lapon lehet hello alkalmazás-előfizetési folyamat része, hello alkalmazás beállításai, vagy egy dedikált "Csatlakozás" folyamat lehet.</span><span class="sxs-lookup"><span data-stu-id="01555-202">This page can be part of hello app's sign-up flow, part of hello app's settings, or it can be a dedicated "connect" flow.</span></span> <span data-ttu-id="01555-203">Sok esetben érdemes a hello app tooshow a "Csatlakozás" nézetben, csak azt követően a felhasználó a munkahelyi vagy iskolai Microsoft-fiókkal van bejelentkezve.</span><span class="sxs-lookup"><span data-stu-id="01555-203">In many cases, it makes sense for hello app tooshow this "connect" view only after a user has signed in with a work or school Microsoft account.</span></span>

<span data-ttu-id="01555-204">Tooyour alkalmazásban hello felhasználói bejelentkezéskor hello szervezet kiválaszthat toowhich Üdvözöljük a rendszergazdákat tartozik előtt tooapprove hello szükséges engedélyek kéri a felhasználót.</span><span class="sxs-lookup"><span data-stu-id="01555-204">When you sign hello user in tooyour app, you can identify hello organization toowhich hello admin belongs before asking them tooapprove hello necessary permissions.</span></span> <span data-ttu-id="01555-205">Bár nem feltétlenül szükséges, ez segíthet a szervezeti felhasználók intuitívabb környezetet.</span><span class="sxs-lookup"><span data-stu-id="01555-205">Although not strictly necessary, it can help you create a more intuitive experience for your organizational users.</span></span> <span data-ttu-id="01555-206">toosign hello felhasználó, hajtsa végre a [v2.0 protokoll oktatóanyagok](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="01555-206">toosign hello user in, follow our [v2.0 protocol tutorials](active-directory-v2-protocols.md).</span></span>

### <a name="request-hello-permissions-from-a-directory-admin"></a><span data-ttu-id="01555-207">Hello engedélyeket kérhet a directory-rendszergazda</span><span class="sxs-lookup"><span data-stu-id="01555-207">Request hello permissions from a directory admin</span></span>
<span data-ttu-id="01555-208">Amikor készen áll a toorequest engedélyek az Ön szervezetének rendszergazdájával, átirányítja a hello felhasználói toohello v2.0 *rendszergazda jóváhagyását végpont*.</span><span class="sxs-lookup"><span data-stu-id="01555-208">When you're ready toorequest permissions from your organization's admin, you can redirect hello user toohello v2.0 *admin consent endpoint*.</span></span>

```
// Line breaks are for legibility only.

GET https://login.microsoftonline.com/{tenant}/adminconsent?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&state=12345
&redirect_uri=http://localhost/myapp/permissions
```

```
// Pro tip: Try pasting hello below request in a browser!
```

```
https://login.microsoftonline.com/common/adminconsent?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&state=12345&redirect_uri=http://localhost/myapp/permissions
```

| <span data-ttu-id="01555-209">Paraméter</span><span class="sxs-lookup"><span data-stu-id="01555-209">Parameter</span></span> | <span data-ttu-id="01555-210">Az állapot</span><span class="sxs-lookup"><span data-stu-id="01555-210">Condition</span></span> | <span data-ttu-id="01555-211">Leírás</span><span class="sxs-lookup"><span data-stu-id="01555-211">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="01555-212">Bérlői</span><span class="sxs-lookup"><span data-stu-id="01555-212">tenant</span></span> |<span data-ttu-id="01555-213">Szükséges</span><span class="sxs-lookup"><span data-stu-id="01555-213">Required</span></span> |<span data-ttu-id="01555-214">hello directory-bérlőt, amelyet toorequest engedélyt.</span><span class="sxs-lookup"><span data-stu-id="01555-214">hello directory tenant that you want toorequest permission from.</span></span> <span data-ttu-id="01555-215">Megadható a GUID vagy rövid név formátumban.</span><span class="sxs-lookup"><span data-stu-id="01555-215">Can be provided in GUID or friendly name format.</span></span> |
| <span data-ttu-id="01555-216">client_id</span><span class="sxs-lookup"><span data-stu-id="01555-216">client_id</span></span> |<span data-ttu-id="01555-217">Szükséges</span><span class="sxs-lookup"><span data-stu-id="01555-217">Required</span></span> |<span data-ttu-id="01555-218">hello alkalmazás azonosító adott hello [alkalmazásregisztrációs portálra](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) tooyour app rendelve.</span><span class="sxs-lookup"><span data-stu-id="01555-218">hello Application ID that hello [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) assigned tooyour app.</span></span> |
| <span data-ttu-id="01555-219">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="01555-219">redirect_uri</span></span> |<span data-ttu-id="01555-220">Szükséges</span><span class="sxs-lookup"><span data-stu-id="01555-220">Required</span></span> |<span data-ttu-id="01555-221">hello átirányítási URI, ahol azt szeretné, hogy az alkalmazás toohandle küldött hello válasz toobe.</span><span class="sxs-lookup"><span data-stu-id="01555-221">hello redirect URI where you want hello response toobe sent for your app toohandle.</span></span> <span data-ttu-id="01555-222">Ez pontosan egyeznie kell hello átirányítási URI-azonosítók hello app regisztrációs portálon regisztrált.</span><span class="sxs-lookup"><span data-stu-id="01555-222">It must exactly match one of hello redirect URIs that you registered in hello app registration portal.</span></span> |
| <span data-ttu-id="01555-223">state</span><span class="sxs-lookup"><span data-stu-id="01555-223">state</span></span> |<span data-ttu-id="01555-224">Ajánlott</span><span class="sxs-lookup"><span data-stu-id="01555-224">Recommended</span></span> |<span data-ttu-id="01555-225">Hello token válaszul is visszaadott hello kérelemben szereplő érték.</span><span class="sxs-lookup"><span data-stu-id="01555-225">A value included in hello request that will also be returned in hello token response.</span></span> <span data-ttu-id="01555-226">Bármilyen tartalmat karakterlánc lehet.</span><span class="sxs-lookup"><span data-stu-id="01555-226">It can be a string of any content you want.</span></span> <span data-ttu-id="01555-227">Hello hitelesítési kérelem történt, például hello lap vagy nézet, amilyenek korábban voltak a hello alkalmazásban hello felhasználói állapotával kapcsolatos információkat használatára hello tooencode állapotadatait.</span><span class="sxs-lookup"><span data-stu-id="01555-227">Use hello state tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page or view they were on.</span></span> |

<span data-ttu-id="01555-228">Ezen a ponton az Azure AD egy Bérlői rendszergazda toosign toocomplete hello kérés van szükség.</span><span class="sxs-lookup"><span data-stu-id="01555-228">At this point, Azure AD requires a tenant administrator toosign in toocomplete hello request.</span></span> <span data-ttu-id="01555-229">hello rendszergazdai engedélyek, az alkalmazás hello app regisztrációs portálon kért hello összes tooapprove kéri.</span><span class="sxs-lookup"><span data-stu-id="01555-229">hello administrator is asked tooapprove all hello permissions that you have requested for your app in hello app registration portal.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="01555-230">A sikeres válasz</span><span class="sxs-lookup"><span data-stu-id="01555-230">Successful response</span></span>
<span data-ttu-id="01555-231">Üdvözöljük a rendszergazdákat jóvá hello engedélyek beállítása az alkalmazáshoz, ha a sikeres válasz hello néz ki:</span><span class="sxs-lookup"><span data-stu-id="01555-231">If hello admin approves hello permissions for your app, hello successful response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?tenant=a8990e1f-ff32-408a-9f8e-78d3b9139b95&state=state=12345&admin_consent=True
```

| <span data-ttu-id="01555-232">Paraméter</span><span class="sxs-lookup"><span data-stu-id="01555-232">Parameter</span></span> | <span data-ttu-id="01555-233">Leírás</span><span class="sxs-lookup"><span data-stu-id="01555-233">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="01555-234">Bérlői</span><span class="sxs-lookup"><span data-stu-id="01555-234">tenant</span></span> |<span data-ttu-id="01555-235">hello directory-bérlő tartozik, amely az alkalmazás hello engedélyeket azt kérte, GUID formátumban.</span><span class="sxs-lookup"><span data-stu-id="01555-235">hello directory tenant that granted your application hello permissions it requested, in GUID format.</span></span> |
| <span data-ttu-id="01555-236">state</span><span class="sxs-lookup"><span data-stu-id="01555-236">state</span></span> |<span data-ttu-id="01555-237">Hello kérelem is visszaadott hello biztonságijogkivonat-válaszban szereplő érték.</span><span class="sxs-lookup"><span data-stu-id="01555-237">A value included in hello request that also will be returned in hello token response.</span></span> <span data-ttu-id="01555-238">Bármilyen tartalmat karakterlánc lehet.</span><span class="sxs-lookup"><span data-stu-id="01555-238">It can be a string of any content you want.</span></span> <span data-ttu-id="01555-239">hello állapota hello felhasználói állapot hello alkalmazásban használt tooencode információ hello hitelesítési kérelem történt, például hello lap vagy amilyenek korábban voltak a megtekintése előtt.</span><span class="sxs-lookup"><span data-stu-id="01555-239">hello state is used tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page or view they were on.</span></span> |
| <span data-ttu-id="01555-240">admin_consent</span><span class="sxs-lookup"><span data-stu-id="01555-240">admin_consent</span></span> |<span data-ttu-id="01555-241">Lesz beállítva, túl**igaz**.</span><span class="sxs-lookup"><span data-stu-id="01555-241">Will be set too**true**.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="01555-242">Hibaválaszba</span><span class="sxs-lookup"><span data-stu-id="01555-242">Error response</span></span>
<span data-ttu-id="01555-243">Üdvözöljük a rendszergazdákat nem hagyja jóvá az alkalmazás hello engedélyeit, ha a hello válasz néz sikertelen volt:</span><span class="sxs-lookup"><span data-stu-id="01555-243">If hello admin does not approve hello permissions for your app, hello failed response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?error=permission_denied&error_description=The+admin+canceled+the+request
```

| <span data-ttu-id="01555-244">Paraméter</span><span class="sxs-lookup"><span data-stu-id="01555-244">Parameter</span></span> | <span data-ttu-id="01555-245">Leírás</span><span class="sxs-lookup"><span data-stu-id="01555-245">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="01555-246">error</span><span class="sxs-lookup"><span data-stu-id="01555-246">error</span></span> |<span data-ttu-id="01555-247">Egy hiba kód karakterlánc, amely lehet használt tooclassify típusú előforduló hibákat, és a használt tooreact tooerrors lehet.</span><span class="sxs-lookup"><span data-stu-id="01555-247">An error code string that can be used tooclassify types of errors that occur, and can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="01555-248">error_description</span><span class="sxs-lookup"><span data-stu-id="01555-248">error_description</span></span> |<span data-ttu-id="01555-249">Egy adott hibaüzenet, amelyek segítségével a fejlesztők hello hiba okának azonosításához.</span><span class="sxs-lookup"><span data-stu-id="01555-249">A specific error message that can help a developer identify hello root cause of an error.</span></span> |

<span data-ttu-id="01555-250">Miután hello rendszergazda jóváhagyását végpont már a sikeres válasz érkezett, az alkalmazás köszönhetően a kért hello engedélyeket.</span><span class="sxs-lookup"><span data-stu-id="01555-250">After you've received a successful response from hello admin consent endpoint, your app has gained hello permissions it requested.</span></span> <span data-ttu-id="01555-251">A következő kívánt hello erőforrás jogkivonatot kérhet.</span><span class="sxs-lookup"><span data-stu-id="01555-251">Next, you can request a token for hello resource you want.</span></span>

## <a name="using-permissions"></a><span data-ttu-id="01555-252">Engedélyek használata</span><span class="sxs-lookup"><span data-stu-id="01555-252">Using permissions</span></span>
<span data-ttu-id="01555-253">Miután hello felhasználó hozzájárul az alkalmazás toopermissions, az alkalmazás szerezhetnek be a hozzáférési jogkivonatok, amelyek megfelelnek az alkalmazás engedélyt tooaccess néhány kapacitás az erőforráshoz.</span><span class="sxs-lookup"><span data-stu-id="01555-253">After hello user consents toopermissions for your app, your app can acquire access tokens that represent your app's permission tooaccess a resource in some capacity.</span></span> <span data-ttu-id="01555-254">Olyan hozzáférési jogkivonatot csak egyetlen használható, de kódolású belül hello hozzáférési jogkivonatot minden engedélyt, hogy az alkalmazás rendelkezik az adott erőforráshoz.</span><span class="sxs-lookup"><span data-stu-id="01555-254">An access token can be used only for a single resource, but encoded inside hello access token is every permission that your app has been granted for that resource.</span></span> <span data-ttu-id="01555-255">tooacquire hozzáférési tokent, az alkalmazás a kérelem toohello v2.0 jogkivonat végpontjához ilyen létesíthetik:</span><span class="sxs-lookup"><span data-stu-id="01555-255">tooacquire an access token, your app can make a request toohello v2.0 token endpoint, like this:</span></span>

```
POST common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/json

{
    "grant_type": "authorization_code",
    "client_id": "6731de76-14a6-49ae-97bc-6eba6914391e",
    "scope": "https://outlook.office.com/mail.read https://outlook.office.com/mail.send",
    "code": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq..."
    "redirect_uri": "https://localhost/myapp",
    "client_secret": "zc53fwe80980293klaj9823"  // NOTE: Only required for web apps
}
```

<span data-ttu-id="01555-256">A HTTP-kérelmek toohello erőforrás hello eredményül kapott hozzáférési jogkivonat is használhatja.</span><span class="sxs-lookup"><span data-stu-id="01555-256">You can use hello resulting access token in HTTP requests toohello resource.</span></span> <span data-ttu-id="01555-257">Azt jelzi, hogy az alkalmazás rendelkezik megfelelő engedéllyel tooperform hello egy adott feladat toohello erőforrás megbízhatóan.</span><span class="sxs-lookup"><span data-stu-id="01555-257">It reliably indicates toohello resource that your app has hello proper permission tooperform a specific task.</span></span>  

<span data-ttu-id="01555-258">További információ a hello OAuth 2.0 protokoll, és hogyan tooget hozzáférési jogkivonatok, lásd: hello [v2.0 protokoll végponthivatkozás](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="01555-258">For more information about hello OAuth 2.0 protocol and how tooget access tokens, see hello [v2.0 endpoint protocol reference](active-directory-v2-protocols.md).</span></span>
