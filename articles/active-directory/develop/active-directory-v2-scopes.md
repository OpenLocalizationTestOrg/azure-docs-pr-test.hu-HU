---
title: "Az Azure Active Directory 2.0 hatókörök, engedélyek és hozzájárulási |} Microsoft Docs"
description: "Az Azure AD v2.0-végpontra, többek között a hatókörök, engedélyek és hozzájárulási engedélyezés leírását."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 8f98cbf0-a71d-4e34-babf-e644ad9ff423
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/07/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 04869a7627ecb3e6a0d11733fae7da2ecb04ed51
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/11/2017
---
# <a name="scopes-permissions-and-consent-in-the-azure-active-directory-v20-endpoint"></a><span data-ttu-id="97196-103">Hatókörök, engedélyek és az Azure Active Directory v2.0-végponttól jóváhagyása</span><span class="sxs-lookup"><span data-stu-id="97196-103">Scopes, permissions, and consent in the Azure Active Directory v2.0 endpoint</span></span>
<span data-ttu-id="97196-104">Alkalmazásokat, amelyekbe beépül az Azure Active Directory (Azure AD) hajtsa végre az olyan engedélyezési modell, amely lehetőséget ad a felhasználók szabályozhatják, hogyan az alkalmazások is hozzáférjenek az adataikhoz.</span><span class="sxs-lookup"><span data-stu-id="97196-104">Apps that integrate with Azure Active Directory (Azure AD) follow an authorization model that gives users control over how an app can access their data.</span></span> <span data-ttu-id="97196-105">A használt engedélyezési modellt v2.0 végrehajtásának már frissítve van, és módosítja, hogy kapcsolatba kell lépnie egy alkalmazást az Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97196-105">The v2.0 implementation of the authorization model has been updated, and it changes how an app must interact with Azure AD.</span></span> <span data-ttu-id="97196-106">Ez a cikk ismerteti a engedélyezési modell, beleértve a hatókörök, engedélyek és beleegyezése főbb fogalmait és kifejezéseit.</span><span class="sxs-lookup"><span data-stu-id="97196-106">This article covers the basic concepts of this authorization model, including scopes, permissions, and consent.</span></span>

> [!NOTE]
> <span data-ttu-id="97196-107">A v2.0-végpontra nem támogatja az összes Azure Active Directory forgatókönyvek és funkciók.</span><span class="sxs-lookup"><span data-stu-id="97196-107">The v2.0 endpoint does not support all Azure Active Directory scenarios and features.</span></span> <span data-ttu-id="97196-108">Annak megállapításához, hogy a v2.0-végponttal kell használnia, olvassa el [v2.0 korlátozások](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="97196-108">To determine whether you should use the v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>
>

## <a name="scopes-and-permissions"></a><span data-ttu-id="97196-109">Hatókörök és engedélyek</span><span class="sxs-lookup"><span data-stu-id="97196-109">Scopes and permissions</span></span>
<span data-ttu-id="97196-110">Az Azure AD valósít meg a [OAuth 2.0](active-directory-v2-protocols.md) hitelesítési protokoll.</span><span class="sxs-lookup"><span data-stu-id="97196-110">Azure AD implements the [OAuth 2.0](active-directory-v2-protocols.md) authorization protocol.</span></span> <span data-ttu-id="97196-111">OAuth 2.0 egy metódust, amelyen keresztül a külső alkalmazások hozzáférhetnek a webkiszolgáló által szolgáltatott erőforrásokhoz egy felhasználó nevében.</span><span class="sxs-lookup"><span data-stu-id="97196-111">OAuth 2.0 is a method through which a third-party app can access web-hosted resources on behalf of a user.</span></span> <span data-ttu-id="97196-112">A webkiszolgáló által szolgáltatott erőforrás, amely az Azure AD tartalmaz egy erőforrás-azonosítót, vagy *Application ID URI*.</span><span class="sxs-lookup"><span data-stu-id="97196-112">Any web-hosted resource that integrates with Azure AD has a resource identifier, or *Application ID URI*.</span></span> <span data-ttu-id="97196-113">Például a Microsoft web által szolgáltatott erőforrások közé:</span><span class="sxs-lookup"><span data-stu-id="97196-113">For example, some of Microsoft's web-hosted resources include:</span></span>

* <span data-ttu-id="97196-114">Az Office 365 levelezési API egységes:`https://outlook.office.com`</span><span class="sxs-lookup"><span data-stu-id="97196-114">The Office 365 Unified Mail API: `https://outlook.office.com`</span></span>
* <span data-ttu-id="97196-115">Az Azure AD Graph API:`https://graph.windows.net`</span><span class="sxs-lookup"><span data-stu-id="97196-115">The Azure AD Graph API: `https://graph.windows.net`</span></span>
* <span data-ttu-id="97196-116">A Microsoft Graph:`https://graph.microsoft.com`</span><span class="sxs-lookup"><span data-stu-id="97196-116">Microsoft Graph: `https://graph.microsoft.com`</span></span>

<span data-ttu-id="97196-117">Ugyanez vonatkozik, amely integrálva van az Azure AD külső erőforrásokat.</span><span class="sxs-lookup"><span data-stu-id="97196-117">The same is true for any third-party resources that have integrated with Azure AD.</span></span> <span data-ttu-id="97196-118">Ezeket az erőforrásokat is adhat meg, amelyek segítségével a funkciók erőforrás felosztani kisebb csoportjai engedélyekkel.</span><span class="sxs-lookup"><span data-stu-id="97196-118">Any of these resources also can define a set of permissions that can be used to divide the functionality of that resource into smaller chunks.</span></span> <span data-ttu-id="97196-119">Tegyük fel [Microsoft Graph](https://graph.microsoft.io) többek között a következő feladatok végrehajtására engedélyek definiálva van:</span><span class="sxs-lookup"><span data-stu-id="97196-119">As an example, [Microsoft Graph](https://graph.microsoft.io) has defined permissions to do the following tasks, among others:</span></span>

* <span data-ttu-id="97196-120">A felhasználó naptár olvasása</span><span class="sxs-lookup"><span data-stu-id="97196-120">Read a user's calendar</span></span>
* <span data-ttu-id="97196-121">A felhasználó naptár írása</span><span class="sxs-lookup"><span data-stu-id="97196-121">Write to a user's calendar</span></span>
* <span data-ttu-id="97196-122">E-mailek küldése más felhasználó nevében</span><span class="sxs-lookup"><span data-stu-id="97196-122">Send mail as a user</span></span>

<span data-ttu-id="97196-123">Ilyen típusú engedélyek megadásával az erőforrás adatait, és hogyan van téve az adatok minden részletre kiterjedő szabályozhatják rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="97196-123">By defining these types of permissions, the resource has fine-grained control over its data and how the data is exposed.</span></span> <span data-ttu-id="97196-124">A külső alkalmazások is azokat az engedélyeket kérhet egy alkalmazás felhasználói.</span><span class="sxs-lookup"><span data-stu-id="97196-124">A third-party app can request these permissions from an app user.</span></span> <span data-ttu-id="97196-125">Az alkalmazás felhasználó működhet-e az alkalmazás a felhasználó nevében előtt jóvá kell hagynia az engedélyeket.</span><span class="sxs-lookup"><span data-stu-id="97196-125">The app user must approve the permissions before the app can act on the user's behalf.</span></span> <span data-ttu-id="97196-126">Adattömbösítő kisebb engedélycsoportok funkciókat az erőforrás, amelyet csak a meghatározott engedélyek, hogy a művelet végrehajtására szolgál(nak) kell kéréséhez harmadik felek alkalmazásaihoz építhető ki.</span><span class="sxs-lookup"><span data-stu-id="97196-126">By chunking the resource's functionality into smaller permission sets, third-party apps can be built to request only the specific permissions that they need to perform their function.</span></span> <span data-ttu-id="97196-127">Alkalmazás felhasználói tudhatja, pontosan egy alkalmazás általi felhasználásának módja az adatokat, és azokat lehet több abban, hogy az alkalmazás viselkedik rosszindulatú.</span><span class="sxs-lookup"><span data-stu-id="97196-127">App users can know exactly how an app will use their data, and they can be more confident that the app is not behaving with malicious intent.</span></span>

<span data-ttu-id="97196-128">Az Azure AD és az OAuth, ezek az engedélyek nevezik *hatókörök*.</span><span class="sxs-lookup"><span data-stu-id="97196-128">In Azure AD and OAuth, these types of permissions are called *scopes*.</span></span> <span data-ttu-id="97196-129">Akkor is néha nevezzük *oAuth2Permissions*.</span><span class="sxs-lookup"><span data-stu-id="97196-129">They also sometimes are referred to as *oAuth2Permissions*.</span></span> <span data-ttu-id="97196-130">A hatókör karakterlánc-érték jelzi az Azure ad-ben.</span><span class="sxs-lookup"><span data-stu-id="97196-130">A scope is represented in Azure AD as a string value.</span></span> <span data-ttu-id="97196-131">A Microsoft Graph példát folytatva, a hatókör minden engedély értéke:</span><span class="sxs-lookup"><span data-stu-id="97196-131">Continuing with the Microsoft Graph example, the scope value for each permission is:</span></span>

* <span data-ttu-id="97196-132">Olvassa el a felhasználó naptár használatával`Calendar.Read`</span><span class="sxs-lookup"><span data-stu-id="97196-132">Read a user's calendar by using `Calendar.Read`</span></span>
* <span data-ttu-id="97196-133">A felhasználó naptár írni használatával`Mail.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="97196-133">Write to a user's calendar by using `Mail.ReadWrite`</span></span>
* <span data-ttu-id="97196-134">Egy felhasználó használt által e-maileket küldjön`Mail.Send`</span><span class="sxs-lookup"><span data-stu-id="97196-134">Send mail as a user using by `Mail.Send`</span></span>

<span data-ttu-id="97196-135">Egy alkalmazás kérhetnek ezeket az engedélyeket ad meg a hatókörök a kéréseket a v2.0-végponttól.</span><span class="sxs-lookup"><span data-stu-id="97196-135">An app can request these permissions by specifying the scopes in requests to the v2.0 endpoint.</span></span>

## <a name="openid-connect-scopes"></a><span data-ttu-id="97196-136">Hatókörök OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="97196-136">OpenID Connect scopes</span></span>
<span data-ttu-id="97196-137">Az OpenID Connect v2.0 végrehajtására van néhány jól meghatározott hatókörök nem alkalmazható egy adott erőforrás: `openid`, `email`, `profile`, és `offline_access`.</span><span class="sxs-lookup"><span data-stu-id="97196-137">The v2.0 implementation of OpenID Connect has a few well-defined scopes that do not apply to a specific resource: `openid`, `email`, `profile`, and `offline_access`.</span></span>

### <a name="openid"></a><span data-ttu-id="97196-138">openid</span><span class="sxs-lookup"><span data-stu-id="97196-138">openid</span></span>
<span data-ttu-id="97196-139">Ha egy alkalmazás segítségével hajtja végre a bejelentkezési [OpenID Connect](active-directory-v2-protocols.md), azt kell igényelnie a `openid` hatókör.</span><span class="sxs-lookup"><span data-stu-id="97196-139">If an app performs sign-in by using [OpenID Connect](active-directory-v2-protocols.md), it must request the `openid` scope.</span></span> <span data-ttu-id="97196-140">A `openid` hatókör jeleníti meg a munkahelyi fiók hozzájárulási oldalán a "Bejelentkezés" engedélyt, és a személyes Microsoft-fiók hozzájárulási oldalán "Profilját és alkalmazások és a Microsoft-fiókjával szolgáltatásokhoz való csatlakozás" engedélyt.</span><span class="sxs-lookup"><span data-stu-id="97196-140">The `openid` scope shows on the work account consent page as the "Sign you in" permission, and on the personal Microsoft account consent page as the "View your profile and connect to apps and services using your Microsoft account" permission.</span></span> <span data-ttu-id="97196-141">Ezzel az engedéllyel, az alkalmazás a felhasználó egyedi azonosítóját fogadhat formájában a `sub` jogcímek.</span><span class="sxs-lookup"><span data-stu-id="97196-141">With this permission, an app can receive a unique identifier for the user in the form of the `sub` claim.</span></span> <span data-ttu-id="97196-142">Az alkalmazásnak a hozzáférést a UserInfo végpontnak is biztosít.</span><span class="sxs-lookup"><span data-stu-id="97196-142">It also gives the app access to the UserInfo endpoint.</span></span> <span data-ttu-id="97196-143">A `openid` hatóköre lehet használni a v2.0 jogkivonat végpontjához azonosító-jogkivonatokat, amely biztonságos HTTP-hívásokat az alkalmazások különböző összetevői közötti megszerzésére.</span><span class="sxs-lookup"><span data-stu-id="97196-143">The `openid` scope can be used at the v2.0 token endpoint to acquire ID tokens, which can be used to secure HTTP calls between different components of an app.</span></span>

### <a name="email"></a><span data-ttu-id="97196-144">E-mailek</span><span class="sxs-lookup"><span data-stu-id="97196-144">email</span></span>
<span data-ttu-id="97196-145">A `email` hatókör használható a `openid` hatókörben és bármely más.</span><span class="sxs-lookup"><span data-stu-id="97196-145">The `email` scope can be used with the `openid` scope and any others.</span></span> <span data-ttu-id="97196-146">Az alkalmazásnak a hozzáférést biztosít a felhasználó elsődleges e-mail címéhez formájában a `email` jogcímek.</span><span class="sxs-lookup"><span data-stu-id="97196-146">It gives the app access to the user's primary email address in the form of the `email` claim.</span></span> <span data-ttu-id="97196-147">A `email` jogcím egy jogkivonatba tartalmazza, csak akkor, ha egy e-mail-címmel társítva a felhasználói fiók, amely nem mindig a helyzet.</span><span class="sxs-lookup"><span data-stu-id="97196-147">The `email` claim is included in a token only if an email address is associated with the user account, which is not always the case.</span></span> <span data-ttu-id="97196-148">Ha használja a `email` hatókör, kezelni olyan esetben, amikor az alkalmazás kell készíteni a `email` jogcímet a jogkivonat nem létezik.</span><span class="sxs-lookup"><span data-stu-id="97196-148">If it uses the `email` scope, your app should be prepared to handle a case in which the `email` claim does not exist in the token.</span></span>

### <a name="profile"></a><span data-ttu-id="97196-149">Profil</span><span class="sxs-lookup"><span data-stu-id="97196-149">profile</span></span>
<span data-ttu-id="97196-150">A `profile` hatókör használható a `openid` hatókörben és bármely más.</span><span class="sxs-lookup"><span data-stu-id="97196-150">The `profile` scope can be used with the `openid` scope and any others.</span></span> <span data-ttu-id="97196-151">Az alkalmazásnak a hozzáférést ad a felhasználó adatai jelentős mennyiségű.</span><span class="sxs-lookup"><span data-stu-id="97196-151">It gives the app access to a substantial amount of information about the user.</span></span> <span data-ttu-id="97196-152">Az adatokat, hogy elérhesse közé tartoznak, de nem kizárólag a felhasználó utóneve, Vezetéknév, elsődleges felhasználónév és objektum azonosítójával.</span><span class="sxs-lookup"><span data-stu-id="97196-152">The information it can access includes, but is not limited to, the user's given name, surname, preferred username, and object ID.</span></span> <span data-ttu-id="97196-153">Egy adott felhasználó a id_tokens paraméter elérhető profil jogcímek teljes listáját lásd: a [v2.0 jogkivonatok hivatkozás](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="97196-153">For a complete list of the profile claims available in the id_tokens parameter for a specific user, see the [v2.0 tokens reference](active-directory-v2-tokens.md).</span></span>

### <a name="offlineaccess"></a><span data-ttu-id="97196-154">offline_access</span><span class="sxs-lookup"><span data-stu-id="97196-154">offline_access</span></span>
<span data-ttu-id="97196-155">A [ `offline_access` hatókör](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) hozzáférést biztosít a az alkalmazás erőforrások a felhasználó nevében hosszabb ideig.</span><span class="sxs-lookup"><span data-stu-id="97196-155">The [`offline_access` scope](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) gives your app access to resources on behalf of the user for an extended time.</span></span> <span data-ttu-id="97196-156">Munkahelyi fiók hozzájárulási megjelenik a lapon, a hatókör "Az adatok elérése bármikor" engedélyt.</span><span class="sxs-lookup"><span data-stu-id="97196-156">On the work account consent page, this scope appears as the "Access your data anytime" permission.</span></span> <span data-ttu-id="97196-157">A személyes Microsoft fiók hozzájárulási lapon jelenik meg a hozzáférés-adataihoz bármikor"engedéllyel.</span><span class="sxs-lookup"><span data-stu-id="97196-157">On the personal Microsoft account consent page, it appears as the "Access your info anytime" permission.</span></span> <span data-ttu-id="97196-158">Amikor a felhasználó elfogadja a `offline_access` hatókör, az alkalmazás fogadhat frissítési jogkivonatokat a v2.0 jogkivonat végpontjához.</span><span class="sxs-lookup"><span data-stu-id="97196-158">When a user approves the `offline_access` scope, your app can receive refresh tokens from the v2.0 token endpoint.</span></span> <span data-ttu-id="97196-159">Frissítési jogkivonatok hosszú élettartamú.</span><span class="sxs-lookup"><span data-stu-id="97196-159">Refresh tokens are long-lived.</span></span> <span data-ttu-id="97196-160">Az alkalmazás kérheti le új jogkivonatot, ahogyan a régieket érvényessége lejár.</span><span class="sxs-lookup"><span data-stu-id="97196-160">Your app can get new access tokens as older ones expire.</span></span>

<span data-ttu-id="97196-161">Ha az alkalmazás nem kér a `offline_access` hatókör, hogy nem kapja a frissítési jogkivonatokat.</span><span class="sxs-lookup"><span data-stu-id="97196-161">If your app does not request the `offline_access` scope, it won't receive refresh tokens.</span></span> <span data-ttu-id="97196-162">Ez azt jelenti, hogy ha egy engedélyezési kódot beváltja az [OAuth 2.0 hitelesítésikód-folyamata](active-directory-v2-protocols.md), csak a hozzáférési tokent kap a `/token` végpont.</span><span class="sxs-lookup"><span data-stu-id="97196-162">This means that when you redeem an authorization code in the [OAuth 2.0 authorization code flow](active-directory-v2-protocols.md), you'll receive only an access token from the `/token` endpoint.</span></span> <span data-ttu-id="97196-163">A hozzáférési jogkivonat érvénytelen rövid időre.</span><span class="sxs-lookup"><span data-stu-id="97196-163">The access token is valid for a short time.</span></span> <span data-ttu-id="97196-164">A hozzáférési jogkivonat általában egy óra múlva lejár.</span><span class="sxs-lookup"><span data-stu-id="97196-164">The access token usually expires in one hour.</span></span> <span data-ttu-id="97196-165">Biztonsági at, hogy a pont, az alkalmazás kell átirányítja a felhasználót a `/authorize` végpontot, kérjen új hitelesítési kódot.</span><span class="sxs-lookup"><span data-stu-id="97196-165">At that point, your app needs to redirect the user back to the `/authorize` endpoint to get a new authorization code.</span></span> <span data-ttu-id="97196-166">Az átirányítás, attól függően, hogy az alkalmazás, típusa során a felhasználó előfordulhat, hogy szükség írja be újra a hitelesítő adataikat, vagy újra járul hozzá az engedélyeket.</span><span class="sxs-lookup"><span data-stu-id="97196-166">During this redirect, depending on the type of app, the user might need to enter their credentials again or consent again to permissions.</span></span>

<span data-ttu-id="97196-167">Kérheti le és használja a frissítési jogkivonatokat kapcsolatos további információkért lásd: a [v2.0 protokoll referenciái](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="97196-167">For more information about how to get and use refresh tokens, see the [v2.0 protocol reference](active-directory-v2-protocols.md).</span></span>

## <a name="requesting-individual-user-consent"></a><span data-ttu-id="97196-168">Egyéni felhasználói hozzájárulás kérése</span><span class="sxs-lookup"><span data-stu-id="97196-168">Requesting individual user consent</span></span>
<span data-ttu-id="97196-169">Az egy [OpenID Connect vagy OAuth 2.0](active-directory-v2-protocols.md) engedélyt kér, egy alkalmazás kérheti a szükséges engedélyekkel a `scope` lekérdezési paraméter.</span><span class="sxs-lookup"><span data-stu-id="97196-169">In an [OpenID Connect or OAuth 2.0](active-directory-v2-protocols.md) authorization request, an app can request the permissions it needs by using the `scope` query parameter.</span></span> <span data-ttu-id="97196-170">Például amikor egy felhasználó bejelentkezik egy alkalmazást, az alkalmazás küld kérelmet tetszés az alábbi példa (olvashatóságát hozzá sortörést):</span><span class="sxs-lookup"><span data-stu-id="97196-170">For example, when a user signs in to an app, the app sends a request like the following example (with line breaks added for legibility):</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&response_mode=query
&scope=
https%3A%2F%2Fgraph.microsoft.com%2Fcalendar.read%20
https%3A%2F%2Fgraph.microsoft.com%2Fmail.send
&state=12345
```

<span data-ttu-id="97196-171">A `scope` paraméter, amely az alkalmazás által kért hatókörök szóközökkel elválasztott listáját.</span><span class="sxs-lookup"><span data-stu-id="97196-171">The `scope` parameter is a space-separated list of scopes that the app is requesting.</span></span> <span data-ttu-id="97196-172">Minden hatókör jelzi a hatókör értéke Hozzáfűzés, az erőforrás-azonosítója (az alkalmazás azonosítója URI).</span><span class="sxs-lookup"><span data-stu-id="97196-172">Each scope is indicated by appending the scope value to the resource's identifier (the Application ID URI).</span></span> <span data-ttu-id="97196-173">A kérelem a példában az alkalmazás olvassa a felhasználói naptár és a felhasználó e-maileket küldjön engedélyre van szüksége.</span><span class="sxs-lookup"><span data-stu-id="97196-173">In the request example, the app needs permission to read the user's calendar and send mail as the user.</span></span>

<span data-ttu-id="97196-174">Után a felhasználó megadja a hitelesítő adatokat, a v2.0-végpontra keres egy egyező rekordot *felhasználói hozzájárulás*.</span><span class="sxs-lookup"><span data-stu-id="97196-174">After the user enters their credentials, the v2.0 endpoint checks for a matching record of *user consent*.</span></span> <span data-ttu-id="97196-175">Ha a felhasználó nem hozzájárult a kért engedélyek a múltban, a v2.0-végpontra megkérdezi a felhasználót, hogy a kért engedélyeket.</span><span class="sxs-lookup"><span data-stu-id="97196-175">If the user has not consented to any of the requested permissions in the past, the v2.0 endpoint asks the user to grant the requested permissions.</span></span>

![Munkahelyi fiók hozzájárulás](../../media/active-directory-v2-flows/work_account_consent.png)

<span data-ttu-id="97196-177">Amikor a felhasználó elfogadja az engedély, a hozzájárulási, hogy a felhasználó nem rendelkezik a későbbi bejelentkezések újra beleegyezését rögzíti.</span><span class="sxs-lookup"><span data-stu-id="97196-177">When the user approves the permission, the consent is recorded so that the user doesn't have to consent again on subsequent account sign-ins.</span></span>

## <a name="requesting-consent-for-an-entire-tenant"></a><span data-ttu-id="97196-178">Egy teljes bérlő hozzájárulás kérése</span><span class="sxs-lookup"><span data-stu-id="97196-178">Requesting consent for an entire tenant</span></span>
<span data-ttu-id="97196-179">Gyakran Ha egy szervezet vásárol egy licenc- vagy egy alkalmazás-előfizetés, a szervezet által az alkalmazottak számára az alkalmazás teljesen kiépítéséhez.</span><span class="sxs-lookup"><span data-stu-id="97196-179">Often, when an organization purchases a license or subscription for an application, the organization wants to fully provision the application for its employees.</span></span> <span data-ttu-id="97196-180">Ez a folyamat részeként egy rendszergazda biztosíthat az alkalmazás bármelyik munkavállaló nevében végezze a hozzájárulásukat adják.</span><span class="sxs-lookup"><span data-stu-id="97196-180">As part of this process, an administrator can grant consent for the application to act on behalf of any employee.</span></span> <span data-ttu-id="97196-181">Ha a rendszergazda a teljes bérlő hozzájárulási biztosít, az a szervezeti alkalmazottak számára az alkalmazás hozzájárulási lap nem jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="97196-181">If the admin grants consent for the entire tenant, the organization's employees won't see a consent page for the application.</span></span>

<span data-ttu-id="97196-182">A bérlő lévő összes felhasználó számára kérelmezni kér, az alkalmazás segítségével a rendszergazda jóváhagyását végpont.</span><span class="sxs-lookup"><span data-stu-id="97196-182">To request consent for all users in a tenant, your app can use the admin consent endpoint.</span></span>

## <a name="admin-restricted-scopes"></a><span data-ttu-id="97196-183">Rendszergazda által korlátozott hatókör</span><span class="sxs-lookup"><span data-stu-id="97196-183">Admin-restricted scopes</span></span>
<span data-ttu-id="97196-184">A Microsoft-ökoszisztéma az egyes magas szintű jogosultságokkal állítható be *admin korlátozott*.</span><span class="sxs-lookup"><span data-stu-id="97196-184">Some high-privilege permissions in the Microsoft ecosystem can be set to *admin-restricted*.</span></span> <span data-ttu-id="97196-185">Az ilyen típusú hatókörök például a következő engedélyekkel:</span><span class="sxs-lookup"><span data-stu-id="97196-185">Examples of these kinds of scopes include the following permissions:</span></span>

* <span data-ttu-id="97196-186">Segítségével a szervezetek címtáradatok olvasása`Directory.Read`</span><span class="sxs-lookup"><span data-stu-id="97196-186">Read an organization's directory data by using `Directory.Read`</span></span>
* <span data-ttu-id="97196-187">Adatokat írni egy szervezet címtárához használatával`Directory.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="97196-187">Write data to an organization's directory by using `Directory.ReadWrite`</span></span>
* <span data-ttu-id="97196-188">Olvassa el a munkahely biztonsági csoportok segítségével`Groups.Read.All`</span><span class="sxs-lookup"><span data-stu-id="97196-188">Read security groups in an organization's directory by using `Groups.Read.All`</span></span>

<span data-ttu-id="97196-189">Bár a fogyasztói felhasználó előfordulhat, hogy hozzáférést egy alkalmazáshoz ilyen típusú adat, ugyanazokat a bizalmas vállalati adatokhoz való hozzáférés biztosítása a szervezeti felhasználók korlátozza.</span><span class="sxs-lookup"><span data-stu-id="97196-189">Although a consumer user might grant an application access to this kind of data, organizational users are restricted from granting access to the same set of sensitive company data.</span></span> <span data-ttu-id="97196-190">Ha az alkalmazás a szervezeti felhasználó hozzáférést kér egy ezeket az engedélyeket, a felhasználó kap egy hibaüzenet, amely szerint nem jogosultak az Alkalmazásengedélyek engedélyezése.</span><span class="sxs-lookup"><span data-stu-id="97196-190">If your application requests access to one of these permissions from an organizational user, the user receives an error message that says they are not authorized to consent to your app's permissions.</span></span>

<span data-ttu-id="97196-191">Ha az alkalmazás szervezetek hatókört felügyeleti korlátozott hozzáférésre van szüksége, igényeljen őket a vállalati rendszergazda közvetlenül a is leírtak alapján. az admin jóváhagyását végpont használatával.</span><span class="sxs-lookup"><span data-stu-id="97196-191">If your app requires access to admin-restricted scopes for organizations, you should request them directly from a company administrator, also by using the admin consent endpoint, described next.</span></span>

<span data-ttu-id="97196-192">A rendszergazda engedélyezi ezeket az engedélyeket a rendszergazda jóváhagyását végpont keresztül, hozzájárulási jár a bérlő összes felhasználója számára.</span><span class="sxs-lookup"><span data-stu-id="97196-192">When an administrator grants these permissions via the admin consent endpoint, consent is granted for all users in the tenant.</span></span>

## <a name="using-the-admin-consent-endpoint"></a><span data-ttu-id="97196-193">A rendszergazda jóváhagyását végpont használatával</span><span class="sxs-lookup"><span data-stu-id="97196-193">Using the admin consent endpoint</span></span>
<span data-ttu-id="97196-194">Kövesse az alábbi lépéseket, ha az alkalmazás gyűjthet bérlőjében, beleértve a rendszergazda által korlátozott hatókörök minden felhasználó engedélyeit.</span><span class="sxs-lookup"><span data-stu-id="97196-194">If you follow these steps, your app can gather permissions for all users in a tenant, including admin-restricted scopes.</span></span> <span data-ttu-id="97196-195">A kódminta, amely megvalósítja a lépéseket, olvassa el a [admin korlátozott hatókörök minta](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span><span class="sxs-lookup"><span data-stu-id="97196-195">To see a code sample that implements the steps, see the [admin-restricted scopes sample](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span></span>

### <a name="request-the-permissions-in-the-app-registration-portal"></a><span data-ttu-id="97196-196">Az alkalmazás regisztrációs portálon engedélyek kéréséhez</span><span class="sxs-lookup"><span data-stu-id="97196-196">Request the permissions in the app registration portal</span></span>
1. <span data-ttu-id="97196-197">Keresse fel az alkalmazást a [alkalmazásregisztrációs portálra](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), vagy [hozzon létre egy alkalmazást](active-directory-v2-app-registration.md) Ha még nem tette meg.</span><span class="sxs-lookup"><span data-stu-id="97196-197">Go to your application in the [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), or [create an app](active-directory-v2-app-registration.md) if you haven't already.</span></span>
2. <span data-ttu-id="97196-198">Keresse meg a **Microsoft Graph engedélyek** szakaszt, és adja meg az alkalmazáshoz szükséges engedélyeket.</span><span class="sxs-lookup"><span data-stu-id="97196-198">Locate the **Microsoft Graph Permissions** section, and then add the permissions that your app requires.</span></span>
3. <span data-ttu-id="97196-199">Győződjön meg arról, hogy **mentése** az alkalmazás regisztrálása.</span><span class="sxs-lookup"><span data-stu-id="97196-199">Make sure you **Save** the app registration.</span></span>

### <a name="recommended-sign-the-user-in-to-your-app"></a><span data-ttu-id="97196-200">Ajánlott: Beléptetni a felhasználót az alkalmazáshoz</span><span class="sxs-lookup"><span data-stu-id="97196-200">Recommended: Sign the user in to your app</span></span>
<span data-ttu-id="97196-201">Általában a rendszergazda jóváhagyását végpont használó alkalmazás építésekor az alkalmazás egy lap vagy igényel, amelyben a rendszergazda jóváhagyhatja a Alkalmazásengedélyek megtekintése.</span><span class="sxs-lookup"><span data-stu-id="97196-201">Typically, when you build an application that uses the admin consent endpoint, the app needs a page or view in which the admin can approve the app's permissions.</span></span> <span data-ttu-id="97196-202">Ezen a lapon lehet az alkalmazás-előfizetési folyamat, az alkalmazás beállításokban része, vagy egy dedikált "Csatlakozás" folyamat lehet.</span><span class="sxs-lookup"><span data-stu-id="97196-202">This page can be part of the app's sign-up flow, part of the app's settings, or it can be a dedicated "connect" flow.</span></span> <span data-ttu-id="97196-203">Sok esetben érdemes ezt az alkalmazást a "Csatlakozás" nézet csak, miután egy felhasználó a munkahelyi vagy iskolai Microsoft-fiókkal van bejelentkezve.</span><span class="sxs-lookup"><span data-stu-id="97196-203">In many cases, it makes sense for the app to show this "connect" view only after a user has signed in with a work or school Microsoft account.</span></span>

<span data-ttu-id="97196-204">Amikor bejelentkezik a felhasználó az alkalmazáshoz, azonosíthatja a szervezet, amelyhez a rendszergazda kéri a felhasználót a szükséges engedélyek jóváhagyása előtt tartozik.</span><span class="sxs-lookup"><span data-stu-id="97196-204">When you sign the user in to your app, you can identify the organization to which the admin belongs before asking them to approve the necessary permissions.</span></span> <span data-ttu-id="97196-205">Bár nem feltétlenül szükséges, ez segíthet a szervezeti felhasználók intuitívabb környezetet.</span><span class="sxs-lookup"><span data-stu-id="97196-205">Although not strictly necessary, it can help you create a more intuitive experience for your organizational users.</span></span> <span data-ttu-id="97196-206">Írja alá a felhasználót, hajtsa végre a [v2.0 protokoll oktatóanyagok](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="97196-206">To sign the user in, follow our [v2.0 protocol tutorials](active-directory-v2-protocols.md).</span></span>

### <a name="request-the-permissions-from-a-directory-admin"></a><span data-ttu-id="97196-207">Az engedélyeket kérhet a directory-rendszergazda</span><span class="sxs-lookup"><span data-stu-id="97196-207">Request the permissions from a directory admin</span></span>
<span data-ttu-id="97196-208">Amikor készen áll a szervezet felügyeleti engedélyeket kérhet, akkor is átirányítja a felhasználót a v2.0 *rendszergazda jóváhagyását végpont*.</span><span class="sxs-lookup"><span data-stu-id="97196-208">When you're ready to request permissions from your organization's admin, you can redirect the user to the v2.0 *admin consent endpoint*.</span></span>

```
// Line breaks are for legibility only.

GET https://login.microsoftonline.com/{tenant}/adminconsent?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&state=12345
&redirect_uri=http://localhost/myapp/permissions
```

```
// Pro tip: Try pasting the below request in a browser!
```

```
https://login.microsoftonline.com/common/adminconsent?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&state=12345&redirect_uri=http://localhost/myapp/permissions
```

| <span data-ttu-id="97196-209">Paraméter</span><span class="sxs-lookup"><span data-stu-id="97196-209">Parameter</span></span> | <span data-ttu-id="97196-210">Az állapot</span><span class="sxs-lookup"><span data-stu-id="97196-210">Condition</span></span> | <span data-ttu-id="97196-211">Leírás</span><span class="sxs-lookup"><span data-stu-id="97196-211">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="97196-212">Bérlői</span><span class="sxs-lookup"><span data-stu-id="97196-212">tenant</span></span> |<span data-ttu-id="97196-213">Szükséges</span><span class="sxs-lookup"><span data-stu-id="97196-213">Required</span></span> |<span data-ttu-id="97196-214">A directory-bérlőt, amelyet az engedélyt.</span><span class="sxs-lookup"><span data-stu-id="97196-214">The directory tenant that you want to request permission from.</span></span> <span data-ttu-id="97196-215">Megadható a GUID vagy rövid név formátumban.</span><span class="sxs-lookup"><span data-stu-id="97196-215">Can be provided in GUID or friendly name format.</span></span> |
| <span data-ttu-id="97196-216">client_id</span><span class="sxs-lookup"><span data-stu-id="97196-216">client_id</span></span> |<span data-ttu-id="97196-217">Szükséges</span><span class="sxs-lookup"><span data-stu-id="97196-217">Required</span></span> |<span data-ttu-id="97196-218">Az alkalmazás azonosítója, amely a [alkalmazásregisztrációs portálra](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) az alkalmazáshoz hozzárendelni.</span><span class="sxs-lookup"><span data-stu-id="97196-218">The Application ID that the [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) assigned to your app.</span></span> |
| <span data-ttu-id="97196-219">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="97196-219">redirect_uri</span></span> |<span data-ttu-id="97196-220">Szükséges</span><span class="sxs-lookup"><span data-stu-id="97196-220">Required</span></span> |<span data-ttu-id="97196-221">Az átirányítási URI, ha azt szeretné, hogy a válasz küldését az alkalmazások kezeléséhez.</span><span class="sxs-lookup"><span data-stu-id="97196-221">The redirect URI where you want the response to be sent for your app to handle.</span></span> <span data-ttu-id="97196-222">Ez pontosan egyeznie kell az átirányítási URI-k, az alkalmazás regisztrációs portálon regisztrált.</span><span class="sxs-lookup"><span data-stu-id="97196-222">It must exactly match one of the redirect URIs that you registered in the app registration portal.</span></span> |
| <span data-ttu-id="97196-223">state</span><span class="sxs-lookup"><span data-stu-id="97196-223">state</span></span> |<span data-ttu-id="97196-224">Ajánlott</span><span class="sxs-lookup"><span data-stu-id="97196-224">Recommended</span></span> |<span data-ttu-id="97196-225">A kérelemhez, amely a token válaszul is visszaadott szerepel érték.</span><span class="sxs-lookup"><span data-stu-id="97196-225">A value included in the request that will also be returned in the token response.</span></span> <span data-ttu-id="97196-226">Bármilyen tartalmat karakterlánc lehet.</span><span class="sxs-lookup"><span data-stu-id="97196-226">It can be a string of any content you want.</span></span> <span data-ttu-id="97196-227">Az állapot használata az alkalmazás a felhasználói állapot információt kódolására, előtt a hitelesítési kérést, például az oldal vagy nézet, amilyenek korábban voltak a.</span><span class="sxs-lookup"><span data-stu-id="97196-227">Use the state to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |

<span data-ttu-id="97196-228">Az Azure AD ezen a ponton a bérlői rendszergazda bejelentkezhet a kérés teljesítéséhez szükséges.</span><span class="sxs-lookup"><span data-stu-id="97196-228">At this point, Azure AD requires a tenant administrator to sign in to complete the request.</span></span> <span data-ttu-id="97196-229">A rendszergazda felkéri, hogy hagyja jóvá az alkalmazás az app-regisztrációs portálon kért összes engedélyt.</span><span class="sxs-lookup"><span data-stu-id="97196-229">The administrator is asked to approve all the permissions that you have requested for your app in the app registration portal.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="97196-230">A sikeres válasz</span><span class="sxs-lookup"><span data-stu-id="97196-230">Successful response</span></span>
<span data-ttu-id="97196-231">Ha a rendszergazda engedélyeit, az alkalmazás jóváhagyása, a sikeres válasz jelenik meg:</span><span class="sxs-lookup"><span data-stu-id="97196-231">If the admin approves the permissions for your app, the successful response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?tenant=a8990e1f-ff32-408a-9f8e-78d3b9139b95&state=state=12345&admin_consent=True
```

| <span data-ttu-id="97196-232">Paraméter</span><span class="sxs-lookup"><span data-stu-id="97196-232">Parameter</span></span> | <span data-ttu-id="97196-233">Leírás</span><span class="sxs-lookup"><span data-stu-id="97196-233">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="97196-234">Bérlői</span><span class="sxs-lookup"><span data-stu-id="97196-234">tenant</span></span> |<span data-ttu-id="97196-235">A directory-bérlőhöz, amely engedéllyel rendelkezik az alkalmazás a kért, GUID formátumban.</span><span class="sxs-lookup"><span data-stu-id="97196-235">The directory tenant that granted your application the permissions it requested, in GUID format.</span></span> |
| <span data-ttu-id="97196-236">state</span><span class="sxs-lookup"><span data-stu-id="97196-236">state</span></span> |<span data-ttu-id="97196-237">A kérelem is visszaad a biztonságijogkivonat-válaszban szereplő érték.</span><span class="sxs-lookup"><span data-stu-id="97196-237">A value included in the request that also will be returned in the token response.</span></span> <span data-ttu-id="97196-238">Bármilyen tartalmat karakterlánc lehet.</span><span class="sxs-lookup"><span data-stu-id="97196-238">It can be a string of any content you want.</span></span> <span data-ttu-id="97196-239">Az állapot az alkalmazás a felhasználói állapot információt kódolásához, előtt a hitelesítési kérést, például az oldal vagy nézet, amilyenek korábban voltak a használatos.</span><span class="sxs-lookup"><span data-stu-id="97196-239">The state is used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |
| <span data-ttu-id="97196-240">admin_consent</span><span class="sxs-lookup"><span data-stu-id="97196-240">admin_consent</span></span> |<span data-ttu-id="97196-241">Úgy lesz beállítva, **igaz**.</span><span class="sxs-lookup"><span data-stu-id="97196-241">Will be set to **true**.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="97196-242">Hibaválaszba</span><span class="sxs-lookup"><span data-stu-id="97196-242">Error response</span></span>
<span data-ttu-id="97196-243">Ha a rendszergazda nem hagyja jóvá az engedélyek beállítása az alkalmazáshoz, a sikertelen válasz jelenik meg:</span><span class="sxs-lookup"><span data-stu-id="97196-243">If the admin does not approve the permissions for your app, the failed response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?error=permission_denied&error_description=The+admin+canceled+the+request
```

| <span data-ttu-id="97196-244">Paraméter</span><span class="sxs-lookup"><span data-stu-id="97196-244">Parameter</span></span> | <span data-ttu-id="97196-245">Leírás</span><span class="sxs-lookup"><span data-stu-id="97196-245">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="97196-246">error</span><span class="sxs-lookup"><span data-stu-id="97196-246">error</span></span> |<span data-ttu-id="97196-247">Egy hiba kód karakterlánc, amely segítségével besorolni a felmerülő hibákat, és reagálni hibákat is használható.</span><span class="sxs-lookup"><span data-stu-id="97196-247">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span></span> |
| <span data-ttu-id="97196-248">error_description</span><span class="sxs-lookup"><span data-stu-id="97196-248">error_description</span></span> |<span data-ttu-id="97196-249">Egy adott hibaüzenet, amelyek segítségével a fejlesztők hiba okának azonosításához.</span><span class="sxs-lookup"><span data-stu-id="97196-249">A specific error message that can help a developer identify the root cause of an error.</span></span> |

<span data-ttu-id="97196-250">A rendszergazda jóváhagyását végpont már a sikeres válasz érkezett, miután az alkalmazás a kért engedélyeket köszönhetően.</span><span class="sxs-lookup"><span data-stu-id="97196-250">After you've received a successful response from the admin consent endpoint, your app has gained the permissions it requested.</span></span> <span data-ttu-id="97196-251">Ezután a kívánt erőforráshoz tartozó jogkivonatot kérhet.</span><span class="sxs-lookup"><span data-stu-id="97196-251">Next, you can request a token for the resource you want.</span></span>

## <a name="using-permissions"></a><span data-ttu-id="97196-252">Engedélyek használata</span><span class="sxs-lookup"><span data-stu-id="97196-252">Using permissions</span></span>
<span data-ttu-id="97196-253">Miután a felhasználó hozzájárul engedélyeinek beállítása az alkalmazáshoz, az alkalmazás szerezhetnek be a hozzáférési jogkivonatok, amelyek megfelelnek az alkalmazás engedély az egyes kapacitás erőforrások eléréséhez.</span><span class="sxs-lookup"><span data-stu-id="97196-253">After the user consents to permissions for your app, your app can acquire access tokens that represent your app's permission to access a resource in some capacity.</span></span> <span data-ttu-id="97196-254">Olyan hozzáférési jogkivonatot csak egyetlen használható, de a hozzáférési jogkivonat belül kódolású minden engedélyt, hogy az alkalmazás rendelkezik az adott erőforráshoz.</span><span class="sxs-lookup"><span data-stu-id="97196-254">An access token can be used only for a single resource, but encoded inside the access token is every permission that your app has been granted for that resource.</span></span> <span data-ttu-id="97196-255">Olyan hozzáférési jogkivonatot szerezni, az alkalmazás képes indítson egy lekérdezést a v2.0 jogkivonat végpontjához, ehhez hasonló:</span><span class="sxs-lookup"><span data-stu-id="97196-255">To acquire an access token, your app can make a request to the v2.0 token endpoint, like this:</span></span>

```
POST common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/json

{
    "grant_type": "authorization_code",
    "client_id": "6731de76-14a6-49ae-97bc-6eba6914391e",
    "scope": "https://outlook.office.com/mail.read https://outlook.office.com/mail.send",
    "code": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq..."
    "redirect_uri": "https://localhost/myapp",
    "client_secret": "zc53fwe80980293klaj9823"  // NOTE: Only required for web apps
}
```

<span data-ttu-id="97196-256">Az eredményül kapott hozzáférési jogkivonat használható HTTP-kérelmek az erőforráshoz.</span><span class="sxs-lookup"><span data-stu-id="97196-256">You can use the resulting access token in HTTP requests to the resource.</span></span> <span data-ttu-id="97196-257">Azt megbízhatóan jelzi az erőforráshoz, hogy az alkalmazás rendelkezik-e a megfelelő engedéllyel az adott feladat végrehajtásához.</span><span class="sxs-lookup"><span data-stu-id="97196-257">It reliably indicates to the resource that your app has the proper permission to perform a specific task.</span></span>  

<span data-ttu-id="97196-258">Az OAuth 2.0 protokollt és a hozzáférési jogkivonatok beolvasásával kapcsolatos további információkért lásd: a [v2.0 protokoll végponthivatkozás](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="97196-258">For more information about the OAuth 2.0 protocol and how to get access tokens, see the [v2.0 endpoint protocol reference](active-directory-v2-protocols.md).</span></span>
