---
title: "egy olyan alkalmazáshoz, minden Azure AD-felhasználó bejelentkezés aaaHow toobuild |} Microsoft Docs"
description: "Lépésről lépésre, amely egy alkalmazás létrehozásához szükséges utasításokat jelentkezhetnek be a felhasználó bármely Azure Active Directory-bérlőhöz, más néven egy több-bérlős alkalmazást."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 35af95cb-ced3-46ad-b01d-5d2f6fd064a3
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/26/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 123ea8125fa3c308ce0f124cc58e85ec28d476d5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="how-toosign-in-any-azure-active-directory-ad-user-using-hello-multi-tenant-application-pattern"></a><span data-ttu-id="b5d18-103">Hogyan bármely Azure Active Directory (AD) felhasználó használatával toosign hello több-bérlős alkalmazásminta</span><span class="sxs-lookup"><span data-stu-id="b5d18-103">How toosign in any Azure Active Directory (AD) user using hello multi-tenant application pattern</span></span>
<span data-ttu-id="b5d18-104">Ha egy szoftver, a szolgáltatás alkalmazás toomany szervezetek, konfigurálhatja az alkalmazás tooaccept bejelentkezések bármely Azure AD-bérlő.</span><span class="sxs-lookup"><span data-stu-id="b5d18-104">If you offer a Software as a Service application toomany organizations, you can configure your application tooaccept sign-ins from any Azure AD tenant.</span></span>  <span data-ttu-id="b5d18-105">Az Azure ad-ben ezt nevezik, így az alkalmazás több-bérlős.</span><span class="sxs-lookup"><span data-stu-id="b5d18-105">In Azure AD this is called making your application multi-tenant.</span></span>  <span data-ttu-id="b5d18-106">Az Azure AD-bérlő felhasználók fognak tooyour alkalmazás után tudja toosign küldőnek toouse az alkalmazás a fiókját.</span><span class="sxs-lookup"><span data-stu-id="b5d18-106">Users in any Azure AD tenant will be able toosign in tooyour application after consenting toouse their account with your application.</span></span>  

<span data-ttu-id="b5d18-107">Ha egy meglévő alkalmazást a saját fiók rendszer, vagy egyéb forgalomból adódó bejelentkezés más felhőalapú szolgáltatók támogatja, felvétele az Azure AD-bejelentkezés a panelhez használata egyszerű.</span><span class="sxs-lookup"><span data-stu-id="b5d18-107">If you have an existing application that has its own account system, or supports other kinds of sign-in from other cloud providers, adding Azure AD sign-in from any tenant is simple.</span></span> <span data-ttu-id="b5d18-108">Csak az alkalmazás regisztrálásához, adja hozzá az OAuth2, az OpenID Connect vagy a SAML-bejelentkezés kódot, és a "Sign In with Microsoft" gomb elhelyezése az alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="b5d18-108">Just register your app, add sign-in code via OAuth2, OpenID Connect, or SAML, and put a "Sign In with Microsoft" button on your application.</span></span> <span data-ttu-id="b5d18-109">Kattintson a következő gombra toolearn további információk az alkalmazás branding hello.</span><span class="sxs-lookup"><span data-stu-id="b5d18-109">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="b5d18-110">[! [Gomb bejelentkezés] [Az AAD-bejelentkezés]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="b5d18-110">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="b5d18-111">Ez a cikk feltételezi, hogy már ismeri az Azure AD egy egybérlős alkalmazás felépítése.</span><span class="sxs-lookup"><span data-stu-id="b5d18-111">This article assumes you’re already familiar with building a single tenant application for Azure AD.</span></span>  <span data-ttu-id="b5d18-112">Ha nem, a head mentésére toohello [fejlesztői útmutató kezdőlap] [ AAD-Dev-Guide] és tekintse meg a gyors üzembe helyezések!</span><span class="sxs-lookup"><span data-stu-id="b5d18-112">If you’re not, head back up toohello [developer guide homepage][AAD-Dev-Guide] and try one of our quick starts!</span></span>

<span data-ttu-id="b5d18-113">Nincsenek négy egyszerű lépésben tooconvert az alkalmazás az Azure AD több-bérlős alkalmazásba:</span><span class="sxs-lookup"><span data-stu-id="b5d18-113">There are four simple steps tooconvert your application into an Azure AD multi-tenant app:</span></span>

1. <span data-ttu-id="b5d18-114">Az alkalmazás regisztrálása toobe többvállalatos frissítése</span><span class="sxs-lookup"><span data-stu-id="b5d18-114">Update your application registration toobe multi-tenant</span></span>
2. <span data-ttu-id="b5d18-115">Frissítse a kódot toosend kérelmek toohello/Common végpont</span><span class="sxs-lookup"><span data-stu-id="b5d18-115">Update your code toosend requests toohello /common endpoint</span></span> 
3. <span data-ttu-id="b5d18-116">Frissítse a kódot toohandle több kibocsátó érték</span><span class="sxs-lookup"><span data-stu-id="b5d18-116">Update your code toohandle multiple issuer values</span></span>
4. <span data-ttu-id="b5d18-117">Felhasználó és rendszergazda jóváhagyását megértéséhez, valamint a megfelelő kódot módosításokat</span><span class="sxs-lookup"><span data-stu-id="b5d18-117">Understand user and admin consent and make appropriate code changes</span></span>

<span data-ttu-id="b5d18-118">Nézzük részletes lépéseit.</span><span class="sxs-lookup"><span data-stu-id="b5d18-118">Let’s look at each step in detail.</span></span> <span data-ttu-id="b5d18-119">Akkor is is ugorhat rögtön túl[ebben a listában több-bérlős minták][AAD-Samples-MT].</span><span class="sxs-lookup"><span data-stu-id="b5d18-119">You can also jump straight too[this list of multi-tenant samples][AAD-Samples-MT].</span></span>

## <a name="update-registration-toobe-multi-tenant"></a><span data-ttu-id="b5d18-120">Frissítse a regisztrációs toobe több-bérlős</span><span class="sxs-lookup"><span data-stu-id="b5d18-120">Update registration toobe multi-tenant</span></span>
<span data-ttu-id="b5d18-121">Alapértelmezés szerint web app/API regisztráció az Azure ad-ben található egybérlős.</span><span class="sxs-lookup"><span data-stu-id="b5d18-121">By default, web app/API registrations in Azure AD are single tenant.</span></span>  <span data-ttu-id="b5d18-122">Akkor is használhatja a regisztrációs több-bérlős keresése hello "több központjaként" kapcsoló hello tulajdonságok lapján az alkalmazáshoz való regisztráció hello [Azure-portálon] [ AZURE-portal] és beállítása a túl "Yes".</span><span class="sxs-lookup"><span data-stu-id="b5d18-122">You can make your registration multi-tenant by finding hello “Multi-Tenanted” switch on hello properties page of your application registration in hello [Azure portal][AZURE-portal] and setting it too“Yes”.</span></span>

<span data-ttu-id="b5d18-123">Vegye figyelembe azt is, előtt egy alkalmazás több-bérlős, Azure AD szükséges hello hello alkalmazás toobe globálisan egyedi App ID URI Azonosítóját.</span><span class="sxs-lookup"><span data-stu-id="b5d18-123">Also note, before an application can be made multi-tenant, Azure AD requires hello App ID URI of hello application toobe globally unique.</span></span> <span data-ttu-id="b5d18-124">hello App ID URI egy alkalmazás, amelynél az protokoll üzeneteinek hello módszerek valamelyikével.</span><span class="sxs-lookup"><span data-stu-id="b5d18-124">hello App ID URI is one of hello ways an application is identified in protocol messages.</span></span>  <span data-ttu-id="b5d18-125">Egyetlen bérlői alkalmazások a rendszer megfelelő hello App ID URI toobe egyedi bérlőre belül.</span><span class="sxs-lookup"><span data-stu-id="b5d18-125">For a single tenant application, it is sufficient for hello App ID URI toobe unique within that tenant.</span></span>  <span data-ttu-id="b5d18-126">Egy több-bérlős alkalmazáshoz kell legyen globálisan egyedi, az Azure AD alkalmazás hello található összes bérlők között.</span><span class="sxs-lookup"><span data-stu-id="b5d18-126">For a multi-tenant application, it must be globally unique so Azure AD can find hello application across all tenants.</span></span>  <span data-ttu-id="b5d18-127">Globális egyediségi kikényszeríti igénylő hello App ID URI toohave egy állomásnevet, amely megfelel az Azure AD-bérlő hello ellenőrzött tartományt.</span><span class="sxs-lookup"><span data-stu-id="b5d18-127">Global uniqueness is enforced by requiring hello App ID URI toohave a host name that matches a verified domain of hello Azure AD tenant.</span></span>  <span data-ttu-id="b5d18-128">Például, ha a bérlő neve hello contoso.onmicrosoft.com, majd egy érvényes App ID URI lenne `https://contoso.onmicrosoft.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="b5d18-128">For example, if hello name of your tenant was contoso.onmicrosoft.com then a valid App ID URI would be `https://contoso.onmicrosoft.com/myapp`.</span></span>  <span data-ttu-id="b5d18-129">Ha a bérlő az ellenőrzött tartományt kellett `contoso.com`, majd egy érvényes App ID URI is használhatók lesznek `https://contoso.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="b5d18-129">If your tenant had a verified domain of `contoso.com`, then a valid App ID URI would also be `https://contoso.com/myapp`.</span></span>  <span data-ttu-id="b5d18-130">Az alkalmazás beállítását több-bérlős sikertelen lesz, ha hello App ID URI nem követi ezt a mintát.</span><span class="sxs-lookup"><span data-stu-id="b5d18-130">Setting an application as multi-tenant will fail if hello App ID URI doesn’t follow this pattern.</span></span>

<span data-ttu-id="b5d18-131">Natív ügyfél alapértelmezés szerint több-bérlős hiányoznak.</span><span class="sxs-lookup"><span data-stu-id="b5d18-131">Native client registrations are multi-tenant by default.</span></span>  <span data-ttu-id="b5d18-132">Bármely művelet toomake egy natív ügyfél alkalmazás regisztrációs többvállalatos tootake nem szükséges.</span><span class="sxs-lookup"><span data-stu-id="b5d18-132">You don’t need tootake any action toomake a native client application registration multi-tenant.</span></span>

## <a name="update-your-code-toosend-requests-toocommon"></a><span data-ttu-id="b5d18-133">A kód toosend kérelmek túl/közös frissítése</span><span class="sxs-lookup"><span data-stu-id="b5d18-133">Update your code toosend requests too/common</span></span>
<span data-ttu-id="b5d18-134">Egy bérlő egyetlen alkalmazást a bejelentkezési kérelmek toohello bérlői bejelentkezési végpont kell küldeni.</span><span class="sxs-lookup"><span data-stu-id="b5d18-134">In a single tenant application, sign-in requests are sent toohello tenant’s sign-in endpoint.</span></span> <span data-ttu-id="b5d18-135">Például a contoso.onmicrosoft.com hello végpont a következő lesz:</span><span class="sxs-lookup"><span data-stu-id="b5d18-135">For example, for contoso.onmicrosoft.com hello endpoint would be:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="b5d18-136">Kérelmek küldése tooa tenant végpont bármikor beléphet a felhasználók (vagy a vendégek), hogy a bérlő bérlői tooapplications.</span><span class="sxs-lookup"><span data-stu-id="b5d18-136">Requests sent tooa tenant’s endpoint can sign in users (or guests) in that tenant tooapplications in that tenant.</span></span>  <span data-ttu-id="b5d18-137">Egy több-bérlős alkalmazással hello alkalmazás nem tud előre kérelmek tooa tenant végpont milyen bérlői hello felhasználói származik, ezért nem lehet elküldeni.</span><span class="sxs-lookup"><span data-stu-id="b5d18-137">With a multi-tenant application, hello application doesn’t know up front what tenant hello user is from, so you can’t send requests tooa tenant’s endpoint.</span></span>  <span data-ttu-id="b5d18-138">Ehelyett a kérések érkeznek, amely minden Azure AD bérlők között multiplexes tooan végpont:</span><span class="sxs-lookup"><span data-stu-id="b5d18-138">Instead, requests are sent tooan endpoint that multiplexes across all Azure AD tenants:</span></span>

    https://login.microsoftonline.com/common

<span data-ttu-id="b5d18-139">Ha az Azure AD a hello kérést kap/közös végpont hello felhasználó jelentkezik be, és azt, a következménye hello bérlői felhasználói deríti fel a.</span><span class="sxs-lookup"><span data-stu-id="b5d18-139">When Azure AD receives a request on hello /common endpoint, it signs hello user in and as a consequence discovers which tenant hello user is from.</span></span>  <span data-ttu-id="b5d18-140">hello/közös végpont működik együtt az összes Azure AD által támogatott hello hitelesítési protokollok: OpenID Connect, a OAuth 2.0, a SAML 2.0 és a WS-Federation.</span><span class="sxs-lookup"><span data-stu-id="b5d18-140">hello /common endpoint works with all of hello authentication protocols supported by Azure AD:  OpenID Connect, OAuth 2.0, SAML 2.0, and WS-Federation.</span></span>

<span data-ttu-id="b5d18-141">hello bejelentkezési válasz toohello alkalmazás majd hello felhasználói jelképező jogkivonatot tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="b5d18-141">hello sign-in response toohello application then contains a token representing hello user.</span></span>  <span data-ttu-id="b5d18-142">hello kibocsátó érték hello jogkivonat közli az alkalmazás milyen bérlői hello felhasználó.</span><span class="sxs-lookup"><span data-stu-id="b5d18-142">hello issuer value in hello token tells an application what tenant hello user is from.</span></span>  <span data-ttu-id="b5d18-143">Ha választ ad vissza hello, vagy közös végpontot, hello kibocsátó érték hello jogkivonat toohello felhasználó bérlői felel meg.</span><span class="sxs-lookup"><span data-stu-id="b5d18-143">When a response returns from hello /common endpoint, hello issuer value in hello token will correspond toohello user’s tenant.</span></span>  <span data-ttu-id="b5d18-144">Fontos toonote hello / közös végpont nem a bérlőt, és nincs kibocsátó, hogy csak a multiplexer.</span><span class="sxs-lookup"><span data-stu-id="b5d18-144">It’s important toonote hello /common endpoint is not a tenant and is not an issuer, it’s just a multiplexer.</span></span>  <span data-ttu-id="b5d18-145">/ Common használata esetén az alkalmazás toovalidate jogkivonatokba hello logika kell frissíteni toobe tootake ez figyelembe.</span><span class="sxs-lookup"><span data-stu-id="b5d18-145">When using /common, hello logic in your application toovalidate tokens needs toobe updated tootake this into account.</span></span> 

<span data-ttu-id="b5d18-146">Korábban említettük, a több-bérlős alkalmazásokhoz is biztosítania kell egy egységes bejelentkezés során tapasztal élmény a felhasználók számára, mert a következő hello branding irányelvek Azure AD-alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="b5d18-146">As mentioned earlier, multi-tenant applications should also provide a consistent sign-in experience for users, following hello Azure AD application branding guidelines.</span></span> <span data-ttu-id="b5d18-147">Kattintson a következő gombra toolearn további információk az alkalmazás branding hello.</span><span class="sxs-lookup"><span data-stu-id="b5d18-147">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="b5d18-148">[! [Gomb bejelentkezés] [Az AAD-bejelentkezés]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="b5d18-148">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="b5d18-149">Vessen egy pillantást hello/Common hello használata végpont és a kód végrehajtása részletesebben.</span><span class="sxs-lookup"><span data-stu-id="b5d18-149">Let’s take a look at hello use of hello /common endpoint and your code implementation in more detail.</span></span>

## <a name="update-your-code-toohandle-multiple-issuer-values"></a><span data-ttu-id="b5d18-150">Frissítse a kódot toohandle több kibocsátó érték</span><span class="sxs-lookup"><span data-stu-id="b5d18-150">Update your code toohandle multiple issuer values</span></span>
<span data-ttu-id="b5d18-151">Webalkalmazások és webes API-k kap, és érvényesítse az Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b5d18-151">Web applications and web APIs receive and validate tokens from Azure AD.</span></span>  

> [!NOTE]
> <span data-ttu-id="b5d18-152">Natív ügyfélalkalmazások kérése és jogkivonatokat fogadni az Azure AD, így toosend tehetik tooAPIs, ahol érvényesíti azokat.</span><span class="sxs-lookup"><span data-stu-id="b5d18-152">While native client applications request and receive tokens from Azure AD, they do so toosend them tooAPIs, where they are validated.</span></span>  <span data-ttu-id="b5d18-153">Natív alkalmazások nem érvényesíthet jogkivonatokat és kell kezeli őket nem átlátszó.</span><span class="sxs-lookup"><span data-stu-id="b5d18-153">Native applications do not validate tokens and must treat them as opaque.</span></span>
> 
> 

<span data-ttu-id="b5d18-154">Nézzük, hogyan ellenőrzi az alkalmazás a jogkivonatokat kap az Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b5d18-154">Let’s look at how an application validates tokens it receives from Azure AD.</span></span>  <span data-ttu-id="b5d18-155">Egy bérlő egyetlen alkalmazás általában lépnek egy végpont értékét, például:</span><span class="sxs-lookup"><span data-stu-id="b5d18-155">A single tenant application will normally take an endpoint value like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="b5d18-156">és egy metaadatainak URL-CÍMÉT (ebben az esetben az OpenID Connect), például tooconstruct használhatja:</span><span class="sxs-lookup"><span data-stu-id="b5d18-156">and use it tooconstruct a metadata URL (in this case, OpenID Connect) like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration

<span data-ttu-id="b5d18-157">a két toodownload fontos adatot, amelyek használt toovalidate: hello bérlői tartozó aláíró kulcsok és a kiállító érték.</span><span class="sxs-lookup"><span data-stu-id="b5d18-157">toodownload two critical pieces of information that are used toovalidate tokens:  hello tenant’s signing keys and issuer value.</span></span>  <span data-ttu-id="b5d18-158">Minden Azure AD-bérlő értéke egyedi kibocsátó hello űrlap:</span><span class="sxs-lookup"><span data-stu-id="b5d18-158">Each Azure AD tenant has a unique issuer value of hello form:</span></span>

    https://sts.windows.net/31537af4-6d77-4bb9-a681-d2394888ea26/

<span data-ttu-id="b5d18-159">ahol hello GUID érték hello átnevezése szálbiztos változatával hello bérlői azonosító hello bérlő.</span><span class="sxs-lookup"><span data-stu-id="b5d18-159">where hello GUID value is hello rename-safe version of hello tenant ID of hello tenant.</span></span>  <span data-ttu-id="b5d18-160">Ha hello megelőző metaadatok hivatkozásra kattintva `contoso.onmicrosoft.com`, láthatja, hogy a kibocsátó érték hello dokumentumban.</span><span class="sxs-lookup"><span data-stu-id="b5d18-160">If you click on hello preceding metadata link for `contoso.onmicrosoft.com`, you can see this issuer value in hello document.</span></span>

<span data-ttu-id="b5d18-161">Amikor egy bérlő egyetlen alkalmazás érvényesíti a jogkivonatot, ellenőrzi, hello jogkivonat-aláírási kulcsokat hello metaadat-dokumentum hello elleni hello aláírását.</span><span class="sxs-lookup"><span data-stu-id="b5d18-161">When a single tenant application validates a token, it checks hello signature of hello token against hello signing keys from hello metadata document.</span></span> <span data-ttu-id="b5d18-162">Ez lehetővé teszi azt toomake meg arról, hogy hello kibocsátó érték hello token megfelel hello egyet, amely hello metaadat-dokumentum található.</span><span class="sxs-lookup"><span data-stu-id="b5d18-162">This allows it toomake sure hello issuer value in hello token matches hello one that was found in hello metadata document.</span></span>

<span data-ttu-id="b5d18-163">Hello óta/közös végpont tooa bérlő nem felel meg, és nem egy kibocsátó, ha megvizsgálja az hello metaadatok hello kibocsátó érték/közös rendelkezik sablonalapú URL-cím helyett egy tényleges érték:</span><span class="sxs-lookup"><span data-stu-id="b5d18-163">Since hello /common endpoint doesn’t correspond tooa tenant and isn’t an issuer, when you examine hello issuer value in hello metadata for /common it has a templated URL instead of an actual value:</span></span>

    https://sts.windows.net/{tenantid}/

<span data-ttu-id="b5d18-164">Ezért egy több-bérlős alkalmazás nem érvényesíthet jogkivonatokat hello hello metaadatait hello kibocsátó értéke csak egyeztetve `issuer` hello token értékét.</span><span class="sxs-lookup"><span data-stu-id="b5d18-164">Therefore, a multi-tenant application can’t validate tokens just by matching hello issuer value in hello metadata with hello `issuer` value in hello token.</span></span>  <span data-ttu-id="b5d18-165">Egy több-bérlős alkalmazást kell logika toodecide kibocsátó értékek érvényesek, és amelyeket nem szerint hello bérlői Állomásazonosító részét feloszthatja hello kibocsátó érték alapján.</span><span class="sxs-lookup"><span data-stu-id="b5d18-165">A multi-tenant application needs logic toodecide which issuer values are valid and which are not, based on hello tenant ID portion of hello issuer value.</span></span>  

<span data-ttu-id="b5d18-166">Például ha egy több-bérlős alkalmazás csak lehetővé teszi, hogy bejelentkezési adott bérlő, aki regisztrált-e a szolgáltatás, akkor azt kell ellenőrizze hello kibocsátó érték vagy hello `tid` jogcím értéke a hello token toomake meg arról, hogy a bérlő az tartalmazó előfizetők.</span><span class="sxs-lookup"><span data-stu-id="b5d18-166">For example, if a multi-tenant application only allows sign-in from specific tenants who have signed up for their service, then it must check either hello issuer value or hello `tid` claim value in hello token toomake sure that tenant is in their list of subscribers.</span></span>  <span data-ttu-id="b5d18-167">Ha csak egy több-bérlős alkalmazás egyének foglalkozik, és nem minden hozzáférés alapján döntéseket bérlők, majd azt figyelmen kívül hagyhatja hello kibocsátó érték regisztrálását.</span><span class="sxs-lookup"><span data-stu-id="b5d18-167">If a multi-tenant application only deals with individuals and doesn’t make any access decisions based on tenants, then it can ignore hello issuer value altogether.</span></span>

<span data-ttu-id="b5d18-168">A több-bérlős minták hello hello [kapcsolódó tartalom](#related-content) letiltva tooenable bármely Azure AD bérlő toosign a szakasz ebben a cikkben kibocsátó érvényesítése hello végén.</span><span class="sxs-lookup"><span data-stu-id="b5d18-168">In hello multi-tenant samples in hello [Related Content](#related-content) section at hello end of this article, issuer validation is disabled tooenable any Azure AD tenant toosign in.</span></span>

<span data-ttu-id="b5d18-169">Most hello felhasználói élmény a felhasználók számára, amely toomulti bérlői alkalmazások bejelentkezés vizsgáljuk meg.</span><span class="sxs-lookup"><span data-stu-id="b5d18-169">Now let’s look at hello user experience for users that are signing in toomulti-tenant applications.</span></span>

## <a name="understanding-user-and-admin-consent"></a><span data-ttu-id="b5d18-170">Understanding felhasználói és rendszergazdai hozzájárulási</span><span class="sxs-lookup"><span data-stu-id="b5d18-170">Understanding user and admin consent</span></span>
<span data-ttu-id="b5d18-171">Egy felhasználó toosign tooan alkalmazásokban az Azure ad-ben, a hello alkalmazás meg kell jelennie hello felhasználó bérlői.</span><span class="sxs-lookup"><span data-stu-id="b5d18-171">For a user toosign in tooan application in Azure AD, hello application must be represented in hello user’s tenant.</span></span>  <span data-ttu-id="b5d18-172">Ez lehetővé teszi, hogy hello szervezet toodo dolog, például a bérlő a felhasználók bejelentkezésekor toohello alkalmazás egyedi házirendeket alkalmazhat.</span><span class="sxs-lookup"><span data-stu-id="b5d18-172">This allows hello organization toodo things like apply unique policies when users from their tenant sign in toohello application.</span></span>  <span data-ttu-id="b5d18-173">Egyetlen bérlői alkalmazások a regisztráció az egyszerű; az rendelkezik egy, akkor fordul elő, amikor regisztrál hello alkalmazás hello hello [Azure-portálon][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="b5d18-173">For a single tenant application, this registration is simple; it’s hello one that happens when you register hello application in hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="b5d18-174">Egy több-bérlős alkalmazáshoz hello kezdeti regisztrációs hello alkalmazás él, hello Azure AD-bérlő hello fejlesztői használják.</span><span class="sxs-lookup"><span data-stu-id="b5d18-174">For a multi-tenant application, hello initial registration for hello application lives in hello Azure AD tenant used by hello developer.</span></span>  <span data-ttu-id="b5d18-175">Amikor egy felhasználó egy másik bérlőhöz toohello alkalmazás hello első alkalommal bejelentkezik, az Azure AD megkéri hello alkalmazás által kért tooconsent toohello engedélyek.</span><span class="sxs-lookup"><span data-stu-id="b5d18-175">When a user from a different tenant signs in toohello application for hello first time, Azure AD asks them tooconsent toohello permissions requested by hello application.</span></span>  <span data-ttu-id="b5d18-176">Ha azok hozzájárulás, akkor egy hello alkalmazás ábrázolása nevű egy *egyszerű* jön létre az hello felhasználó bérlői, és a bejelentkezés.</span><span class="sxs-lookup"><span data-stu-id="b5d18-176">If they consent, then a representation of hello application called a *service principal* is created in hello user’s tenant, and sign-in can continue.</span></span> <span data-ttu-id="b5d18-177">A delegálás hello felhasználói hozzájárulás toohello alkalmazás rögzíti hello címtárban is létrejön.</span><span class="sxs-lookup"><span data-stu-id="b5d18-177">A delegation is also created in hello directory that records hello user’s consent toohello application.</span></span> <span data-ttu-id="b5d18-178">Lásd: [alkalmazás és szolgáltatás egyszerű objektumok] [ AAD-App-SP-Objects] hello alkalmazás alkalmazás- és szolgáltatásnév objektumokat, és azok más tooeach leírását.</span><span class="sxs-lookup"><span data-stu-id="b5d18-178">See [Application Objects and Service Principal Objects][AAD-App-SP-Objects] for details on hello application's Application and ServicePrincipal objects, and how they relate tooeach other.</span></span>

![Hozzájárulás toosingle szintű alkalmazás][Consent-Single-Tier] 

<span data-ttu-id="b5d18-180">A hozzájárulási élmény hello alkalmazás által kért hello engedélyek van hatással.</span><span class="sxs-lookup"><span data-stu-id="b5d18-180">This consent experience is affected by hello permissions requested by hello application.</span></span>  <span data-ttu-id="b5d18-181">Az Azure AD kétféle engedélyek, csak alkalmazást, és a delegált támogatja:</span><span class="sxs-lookup"><span data-stu-id="b5d18-181">Azure AD supports two kinds of permissions, app-only and delegated:</span></span>

* <span data-ttu-id="b5d18-182">Egy engedélyt biztosít egy alkalmazás hello képességét tooact, mint a bejelentkezett felhasználó hello dolgot hello felhasználói egy része számára is.</span><span class="sxs-lookup"><span data-stu-id="b5d18-182">A delegated permission grants an application hello ability tooact as a signed in user for a subset of hello things hello user can do.</span></span>  <span data-ttu-id="b5d18-183">Például egy alkalmazás hello engedélyt tooread hello bejelentkezett felhasználó naptár megadásához.</span><span class="sxs-lookup"><span data-stu-id="b5d18-183">For example, you can grant an application hello delegated permission tooread hello signed in user’s calendar.</span></span>
* <span data-ttu-id="b5d18-184">Egy alkalmazás csak az engedélyt közvetlenül hello alkalmazás toohello identitását.</span><span class="sxs-lookup"><span data-stu-id="b5d18-184">An app-only permission is granted directly toohello identity of hello application.</span></span>  <span data-ttu-id="b5d18-185">Például egy alkalmazás hello csak app tooread hello felhasználók listáján egy bérlőn, függetlenül attól, akik toohello alkalmazás alá van írva megadásához.</span><span class="sxs-lookup"><span data-stu-id="b5d18-185">For example, you can grant an application hello app-only permission tooread hello list of users in a tenant, regardless of who is signed in toohello application.</span></span>

<span data-ttu-id="b5d18-186">Néhány lehet engedélyeket hozzájárult tooby normál felhasználói, míg más egy Bérlői rendszergazda jóváhagyását.</span><span class="sxs-lookup"><span data-stu-id="b5d18-186">Some permissions can be consented tooby a regular user, while others require a tenant administrator’s consent.</span></span> 

### <a name="admin-consent"></a><span data-ttu-id="b5d18-187">Felügyeleti hozzájárulás</span><span class="sxs-lookup"><span data-stu-id="b5d18-187">Admin consent</span></span>
<span data-ttu-id="b5d18-188">Csak alkalmazás engedélyek minden esetben szükséges egy Bérlői rendszergazda jóváhagyását.</span><span class="sxs-lookup"><span data-stu-id="b5d18-188">App-only permissions always require a tenant administrator’s consent.</span></span>  <span data-ttu-id="b5d18-189">Ha az alkalmazás az alkalmazás csak engedélyt kér, és egy felhasználó megpróbál toosign toohello alkalmazásban, egy hibaüzenet jelenik meg arról, hogy hello felhasználó nem tud tooconsent.</span><span class="sxs-lookup"><span data-stu-id="b5d18-189">If your application requests an app-only permission and a user tries toosign in toohello application, an error message will be displayed saying hello user isn’t able tooconsent.</span></span>

<span data-ttu-id="b5d18-190">Bizonyos delegált jogosultságokkal sikeresen telepítették is szükség lehet egy Bérlői rendszergazda jóváhagyását.</span><span class="sxs-lookup"><span data-stu-id="b5d18-190">Certain delegated permissions also require a tenant administrator’s consent.</span></span>  <span data-ttu-id="b5d18-191">Hello képességét toowrite hátsó tooAzure AD hello bejelentkezett felhasználó, például egy Bérlői rendszergazda jóváhagyását igényli.</span><span class="sxs-lookup"><span data-stu-id="b5d18-191">For example, hello ability toowrite back tooAzure AD as hello signed in user requires a tenant administrator’s consent.</span></span>  <span data-ttu-id="b5d18-192">Csak alkalmazáshoz engedéllyel, például ha egy szokásos felhasználó megpróbál toosign tooan alkalmazás, amelyet a rendszergazda jóváhagyását igénylő engedélyt igényel az alkalmazás egy hibaüzenetet fog kapni.</span><span class="sxs-lookup"><span data-stu-id="b5d18-192">Like app-only permissions, if an ordinary user tries toosign in tooan application that requests a delegated permission that requires administrator consent, your application will receive an error.</span></span>  <span data-ttu-id="b5d18-193">Engedélyt igényel-e a rendszergazda jóváhagyását hello fejlesztői hello erőforrás közzétett határozza meg, és lehet hello erőforrás hello dokumentációjában található.</span><span class="sxs-lookup"><span data-stu-id="b5d18-193">Whether or not a permission requires admin consent is determined by hello developer that published hello resource, and can be found in hello documentation for hello resource.</span></span>  <span data-ttu-id="b5d18-194">Hivatkozásokat tartalmaz a leíró hello elérhető engedélyek a hello Azure AD Graph API és a Microsoft Graph API a következők hello tootopics [kapcsolódó tartalom](#related-content) című szakaszát.</span><span class="sxs-lookup"><span data-stu-id="b5d18-194">Links tootopics describing hello available permissions for hello Azure AD Graph API and Microsoft Graph API are in hello [Related Content](#related-content) section of this article.</span></span>

<span data-ttu-id="b5d18-195">Ha az alkalmazás rendszergazda jóváhagyását igénylő engedélyek, kell toohave a hitelesítési mód, például egy gombra való kattintást vagy hivatkozás, ahol Üdvözöljük a rendszergazdákat hello művelettel is kezdeményezhető.</span><span class="sxs-lookup"><span data-stu-id="b5d18-195">If your application uses permissions that require admin consent, you need toohave a gesture such as a button or link where hello admin can initiate hello action.</span></span>  <span data-ttu-id="b5d18-196">az alkalmazás elküld, ez a művelet nem a szokásos OAuth2/OpenID Connect hitelesítési kérést, de a hello is tartalmazó hello kérelem `prompt=admin_consent` lekérdezési karakterlánc.</span><span class="sxs-lookup"><span data-stu-id="b5d18-196">hello request your application sends for this action is a usual OAuth2/OpenID Connect authorization request, but that also includes hello `prompt=admin_consent` query string parameter.</span></span>  <span data-ttu-id="b5d18-197">Üdvözöljük a rendszergazdákat hozzájárult, és hello szolgáltatás egyszerű hello ügyfél bérlő jön létre, ha új bejelentkezési kérelmek nem kell hello `prompt=admin_consent` paraméter.</span><span class="sxs-lookup"><span data-stu-id="b5d18-197">Once hello admin has consented and hello service principal is created in hello customer’s tenant, subsequent sign-in requests do not need hello `prompt=admin_consent` parameter.</span></span> <span data-ttu-id="b5d18-198">Hello rendszergazda úgy dönt, hello kért engedélyeket elfogadhatók, mivel nincs más hello bérlői felhasználói bekéri a hozzájárulási ettől kezdve.</span><span class="sxs-lookup"><span data-stu-id="b5d18-198">Since hello administrator has decided hello requested permissions are acceptable, no other users in hello tenant will be prompted for consent from that point forward.</span></span>

<span data-ttu-id="b5d18-199">Hello `prompt=admin_consent` paraméter is használható az engedélyeket, nincs szükség a rendszergazda jóváhagyását igénylő alkalmazásokkal.</span><span class="sxs-lookup"><span data-stu-id="b5d18-199">hello `prompt=admin_consent` parameter can also be used by applications that request permissions that do not require admin consent.</span></span> <span data-ttu-id="b5d18-200">Ez történik, amikor a hello alkalmazástelepítések szükséges élményt ahol hello Bérlői rendszergazda "előfizet" egy időben, és nincs más felhasználók felszólítást kapnak hozzájárulási ettől a.</span><span class="sxs-lookup"><span data-stu-id="b5d18-200">This is done when hello applicaton requires an experience where hello tenant admin “signs up” one time, and no other users are prompted for consent from that point on.</span></span>

<span data-ttu-id="b5d18-201">Ha egy alkalmazás megkövetel egy rendszergazda jóváhagyását, és egy rendszergazda jelentkezik, de hello `prompt=admin_consent` paraméter nem küldi el, Üdvözöljük a rendszergazdákat sikeresen fog hozzájárulás toohello alkalmazás **csak a hozzájuk tartozó felhasználói fiókok**.</span><span class="sxs-lookup"><span data-stu-id="b5d18-201">If an application requires admin consent, and an admin signs in but hello `prompt=admin_consent` parameter is not sent, hello admin will successfully consent toohello application **only for their user account**.</span></span>  <span data-ttu-id="b5d18-202">Rendszeres felhasználók nem marad a képes toosign és hozzájárulási toohello alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="b5d18-202">Regular users will still not be able toosign in and consent toohello application.</span></span>  <span data-ttu-id="b5d18-203">Ez akkor hasznos, ha azt szeretné, toogive hello Bérlői rendszergazda hello képességét tooexplore az alkalmazást, mielőtt más felhasználók hozzáférést.</span><span class="sxs-lookup"><span data-stu-id="b5d18-203">This is useful if you want toogive hello tenant administrator hello ability tooexplore your application before allowing other users access.</span></span>

<span data-ttu-id="b5d18-204">A bérlői rendszergazda letilthatja a normál felhasználók tooconsent tooapplications hello képességét.</span><span class="sxs-lookup"><span data-stu-id="b5d18-204">A tenant administrator can disable hello ability for regular users tooconsent tooapplications.</span></span>  <span data-ttu-id="b5d18-205">Ha ez a funkció le van tiltva, admin hozzájárulási mindig szükség hello alkalmazás toobe hello bérlői beállítása.</span><span class="sxs-lookup"><span data-stu-id="b5d18-205">If this capability is disabled, admin consent is always required for hello application toobe set up in hello tenant.</span></span>  <span data-ttu-id="b5d18-206">Ha azt szeretné, hogy az alkalmazás normál felhasználói hozzájárulásával letiltva tootest, hello konfigurációs kapcsolót az található hello Azure AD bérlő hello konfigurációs szakasza [Azure-portálon][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="b5d18-206">If you want tootest your application with regular user consent disabled, you can find hello configuration switch in hello Azure AD tenant configuration section of hello [Azure portal][AZURE-portal].</span></span>

> [!NOTE]
> <span data-ttu-id="b5d18-207">Egyes alkalmazások szeretné, hogy ha rendszeres felhasználók képes tooconsent kezdetben, és későbbi hello alkalmazás magába foglaló hello rendszergazda és a rendszergazda jóváhagyását igénylő engedélyeket élményt.</span><span class="sxs-lookup"><span data-stu-id="b5d18-207">Some applications want an experience where regular users are able tooconsent initially, and later hello application can involve hello administrator and request permissions that require admin consent.</span></span>  <span data-ttu-id="b5d18-208">Nincs semmilyen módon toodo Ez egy egyetlen alkalmazás regisztrálása az Azure AD ma.</span><span class="sxs-lookup"><span data-stu-id="b5d18-208">There is no way toodo this with a single application registration in Azure AD today.</span></span>  <span data-ttu-id="b5d18-209">hello jövőbeli az Azure AD v2 végpont lehetővé teszi alkalmazások toorequest engedélyek futásidőben, ahelyett, hogy regisztrációs időpontban, amely lehetővé teszi, hogy ebben a forgatókönyvben.</span><span class="sxs-lookup"><span data-stu-id="b5d18-209">hello upcoming Azure AD v2 endpoint will allow applications toorequest permissions at runtime, instead of at registration time, which will enable this scenario.</span></span>  <span data-ttu-id="b5d18-210">További információkért lásd: hello [Azure AD alkalmazás-modell v2 – útmutató fejlesztőknek][AAD-V2-Dev-Guide].</span><span class="sxs-lookup"><span data-stu-id="b5d18-210">For more information, see hello [Azure AD App Model v2 Developer Guide][AAD-V2-Dev-Guide].</span></span>
> 
> 

### <a name="consent-and-multi-tier-applications"></a><span data-ttu-id="b5d18-211">Hozzájárulás és a többrétegű alkalmazások</span><span class="sxs-lookup"><span data-stu-id="b5d18-211">Consent and multi-tier applications</span></span>
<span data-ttu-id="b5d18-212">Előfordulhat, hogy az alkalmazás több rétegek, a saját regisztrációs által képviselt minden Azure AD-ben.</span><span class="sxs-lookup"><span data-stu-id="b5d18-212">Your application may have multiple tiers, each represented by its own registration in Azure AD.</span></span>  <span data-ttu-id="b5d18-213">Például egy webes API-t egy natív alkalmazás, vagy egy webes alkalmazás, amely meghívja a webes API-k.</span><span class="sxs-lookup"><span data-stu-id="b5d18-213">For example, a native application that calls a web API, or a web application that calls a web API.</span></span>  <span data-ttu-id="b5d18-214">Mindkét esetben a hello (a natív alkalmazással vagy a web app) ügyfélszámítógép engedélyek toocall hello erőforrás (webes API-k).</span><span class="sxs-lookup"><span data-stu-id="b5d18-214">In both of these cases, hello client (native app or web app) requests permissions toocall hello resource (web API).</span></span>  <span data-ttu-id="b5d18-215">Hello ügyfél toobe sikeresen átadni kívánt hozzájárult e az ügyfél bérlői, az összes erőforrások toowhich kér engedélyeket már léteznie kell hello az ügyfél-bérlőben.</span><span class="sxs-lookup"><span data-stu-id="b5d18-215">For hello client toobe successfully consented into a customer’s tenant, all resources toowhich it requests permissions must already exist in hello customer’s tenant.</span></span>  <span data-ttu-id="b5d18-216">Ha ez a feltétel nem teljesül, az Azure AD vissza, amely erőforrás hello hiba először hozzá kell adni.</span><span class="sxs-lookup"><span data-stu-id="b5d18-216">If this condition isn’t met, Azure AD will return an error that hello resource must be added first.</span></span>

<span data-ttu-id="b5d18-217">**Egy bérlő több rétegből**</span><span class="sxs-lookup"><span data-stu-id="b5d18-217">**Multiple tiers in a single tenant**</span></span>

<span data-ttu-id="b5d18-218">Ez problémát okozhat, ha a logikai alkalmazás két vagy több alkalmazás regisztrációk, például egy külön ügyfél- és erőforrás áll.</span><span class="sxs-lookup"><span data-stu-id="b5d18-218">This can be a problem if your logical application consists of two or more application registrations, for example a separate client and resource.</span></span>  <span data-ttu-id="b5d18-219">Hogyan kapunk hello erőforrás hello ügyfél bérlői történő első?</span><span class="sxs-lookup"><span data-stu-id="b5d18-219">How do you get hello resource into hello customer tenant first?</span></span>  <span data-ttu-id="b5d18-220">Az Azure AD ebben az esetben ismerteti ügyfél engedélyezésével, és erőforrás-toobe átadni kívánt hozzájárult e egyetlen lépésben.</span><span class="sxs-lookup"><span data-stu-id="b5d18-220">Azure AD covers this case by enabling client and resource toobe consented in a single step.</span></span> <span data-ttu-id="b5d18-221">hello felhasználónál hello ügyfél- és erőforrás hello hozzájárulási oldalon által kért hello engedélyek hello összessége.</span><span class="sxs-lookup"><span data-stu-id="b5d18-221">hello user sees hello sum total of hello permissions requested by both hello client and resource on hello consent page.</span></span>  <span data-ttu-id="b5d18-222">tooenable ezt a viselkedést hello erőforrás-alkalmazás regisztrációja tartalmaznia kell a hello ügyfél alkalmazás azonosítója egy `knownClientApplications` az alkalmazásjegyzékben.</span><span class="sxs-lookup"><span data-stu-id="b5d18-222">tooenable this behavior, hello resource’s application registration must include hello client’s App ID as a `knownClientApplications` in its application manifest.</span></span>  <span data-ttu-id="b5d18-223">Példa:</span><span class="sxs-lookup"><span data-stu-id="b5d18-223">For example:</span></span>

    knownClientApplications": ["94da0930-763f-45c7-8d26-04d5938baab2"]

<span data-ttu-id="b5d18-224">Ez a tulajdonság hello erőforrás keresztül frissíthető [alkalmazás jegyzékfájlja][AAD-App-Manifest].</span><span class="sxs-lookup"><span data-stu-id="b5d18-224">This property can be updated via hello resource [application’s manifest][AAD-App-Manifest].</span></span> <span data-ttu-id="b5d18-225">Ezt mutatják be egy natív ügyfél többrétegű, webes API-mintát hívása hello [kapcsolódó tartalom](#related-content) szakasz ebben a cikkben hello végén.</span><span class="sxs-lookup"><span data-stu-id="b5d18-225">This is demonstrated in a multi-tier native client calling web API sample in hello [Related Content](#related-content) section at hello end of this article.</span></span> <span data-ttu-id="b5d18-226">hello következő ábra áttekintést nyújt hozzájárulási egy többrétegű alkalmazást, regisztrálni az egyetlen bérlő számára:</span><span class="sxs-lookup"><span data-stu-id="b5d18-226">hello following diagram provides an overview of consent for a multi-tier app registered in a single tenant :</span></span>

![Hozzájárulás toomulti szintű ismert ügyfélalkalmazás][Consent-Multi-Tier-Known-Client] 

<span data-ttu-id="b5d18-228">**A több bérlő több rétegből**</span><span class="sxs-lookup"><span data-stu-id="b5d18-228">**Multiple tiers in multiple tenants**</span></span>

<span data-ttu-id="b5d18-229">Hasonló esetek történik, ha a különböző bérlők regisztrált hello különböző rétegek, egy alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="b5d18-229">A similar case happens if hello different tiers of an application are registered in different tenants.</span></span>  <span data-ttu-id="b5d18-230">Vegye figyelembe például egy natív ügyfélalkalmazást, amely behívja az Office 365 Exchange Online API hello kialakításának hello eset.</span><span class="sxs-lookup"><span data-stu-id="b5d18-230">For example, consider hello case of building a native client application that calls hello Office 365 Exchange Online API.</span></span>  <span data-ttu-id="b5d18-231">toodevelop hello natív alkalmazás, és az ügyfél-bérlőben hello natív alkalmazás toorun később, hello Exchange Online szolgáltatás egyszerű jelen kell lennie.</span><span class="sxs-lookup"><span data-stu-id="b5d18-231">toodevelop hello native application, and later for hello native application toorun in a customer’s tenant, hello Exchange Online service principal must be present.</span></span>  <span data-ttu-id="b5d18-232">Ebben az esetben hello fejlesztői és az ügyfelek kell vásárolnia, Exchange Online hello szolgáltatás egyszerű toobe létrehozott bérlők számára.</span><span class="sxs-lookup"><span data-stu-id="b5d18-232">In this case, hello developer and customer must purchase Exchange Online for hello service principal toobe created in their tenants.</span></span>  

<span data-ttu-id="b5d18-233">Az API-k által egy szervezet, nem a Microsoft hello esetben hello fejlesztői hello API tooprovide úgy azok az ügyfelek tooconsent hello alkalmazást az ügyfelek bérlők szüksége van.</span><span class="sxs-lookup"><span data-stu-id="b5d18-233">In hello case of an API built by an organization other than Microsoft, hello developer of hello API needs tooprovide a way for their customers tooconsent hello application into their customers' tenants.</span></span> <span data-ttu-id="b5d18-234">hello ajánlott tervezési hello 3. fél fejlesztői toobuild hello API számára úgy, hogy is működhetnek egy webes ügyfél tooimplement előfizetési:</span><span class="sxs-lookup"><span data-stu-id="b5d18-234">hello recommended design is for hello 3rd party developer toobuild hello API such that it can also function as a web client tooimplement sign-up :</span></span>

1. <span data-ttu-id="b5d18-235">Hajtsa végre a hello korábbi szakaszokban tooensure hello API megvalósítja hello több-bérlős regisztrációs/kód alkalmazáskövetelmények</span><span class="sxs-lookup"><span data-stu-id="b5d18-235">Follow hello earlier sections tooensure hello API implements hello multi-tenant application registration/code requirements</span></span>
2. <span data-ttu-id="b5d18-236">Továbbá tooexposing hello API hatókörök/szerepkörök, győződjön meg arról, hello regisztrációs tartalmaz hello "Bejelentkezés és felhasználói profil olvasása" az Azure AD engedélyt (alapértelmezés szerint)</span><span class="sxs-lookup"><span data-stu-id="b5d18-236">In addition tooexposing hello API's scopes/roles, ensure hello registration includes hello "Sign in and read user profile" Azure AD permission (provided by default)</span></span>
3. <span data-ttu-id="b5d18-237">Bejelentkezési-a/regisztrációs oldal megvalósítását a hello webes ügyfél, a következő hello [admin hozzájárulási](#admin-consent) útmutatást taglaltak</span><span class="sxs-lookup"><span data-stu-id="b5d18-237">Implement a sign-in/sign-up page in hello web client, following hello [admin consent](#admin-consent) guidance discussed earlier</span></span> 
4. <span data-ttu-id="b5d18-238">Miután hello felhasználó toohello alkalmazás hozzájárul, hello szolgáltatás egyszerű és beleegyezése delegálás hivatkozásokat hoz létre a bérlői, és hello natív alkalmazás tud jogkivonatokhoz hello API</span><span class="sxs-lookup"><span data-stu-id="b5d18-238">Once hello user consents toohello application, hello service principal and consent delegation links are created in their tenant, and hello native application can get tokens for hello API</span></span>

<span data-ttu-id="b5d18-239">a következő diagram hello hozzájárulási áttekintést nyújt a különböző bérlők regisztrált többrétegű alkalmazást:</span><span class="sxs-lookup"><span data-stu-id="b5d18-239">hello following diagram provides an overview of consent for a multi-tier app registered in different tenants:</span></span>

![Több résztvevős toomulti szintű app hozzájárulás][Consent-Multi-Tier-Multi-Party] 

### <a name="revoking-consent"></a><span data-ttu-id="b5d18-241">Hozzájárulás visszavonása</span><span class="sxs-lookup"><span data-stu-id="b5d18-241">Revoking Consent</span></span>
<span data-ttu-id="b5d18-242">Felhasználók és rendszergazdák vissza tudja vonni a hozzájárulási tooyour alkalmazásból bármikor:</span><span class="sxs-lookup"><span data-stu-id="b5d18-242">Users and administrators can revoke consent tooyour application at any time:</span></span>

* <span data-ttu-id="b5d18-243">Felhasználók revoke access tooindividual alkalmazások ehhez távolítsa el a saját [Panel alkalmazásokat] [ AAD-Access-Panel] listája.</span><span class="sxs-lookup"><span data-stu-id="b5d18-243">Users revoke access tooindividual applications by removing them from their [Access Panel Applications][AAD-Access-Panel] list.</span></span>
* <span data-ttu-id="b5d18-244">A rendszergazdák hozzáférés tooapplications visszavonása eltávolítja azokat az Azure AD hello Azure AD felügyeleti szakaszának hello segítségével [Azure-portálon][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="b5d18-244">Administrators revoke access tooapplications by removing them from Azure AD using hello Azure AD management section of hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="b5d18-245">Ha egy rendszergazda tooan alkalmazás a bérlőkben lévő összes felhasználó hozzájárul, felhasználók külön-külön hozzáférési nem visszavonása.</span><span class="sxs-lookup"><span data-stu-id="b5d18-245">If an administrator consents tooan application for all users in a tenant, users cannot revoke access individually.</span></span>  <span data-ttu-id="b5d18-246">Csak hello rendszergazda visszavonhatja a hozzáférést, és csak a teljes alkalmazás hello.</span><span class="sxs-lookup"><span data-stu-id="b5d18-246">Only hello administrator can revoke access, and only for hello whole application.</span></span>

### <a name="consent-and-protocol-support"></a><span data-ttu-id="b5d18-247">Hozzájárulás és protokollok támogatása</span><span class="sxs-lookup"><span data-stu-id="b5d18-247">Consent and Protocol Support</span></span>
<span data-ttu-id="b5d18-248">Hozzájárulás támogatott keresztül hello OAuth, OpenID Connect, az Azure AD-ben és a WS-Federation, SAML protokoll.</span><span class="sxs-lookup"><span data-stu-id="b5d18-248">Consent is supported in Azure AD via hello OAuth, OpenID Connect, WS-Federation, and SAML protocols.</span></span>  <span data-ttu-id="b5d18-249">hello SAML és a WS-Federation protokollok nem támogatják a hello `prompt=admin_consent` paraméter, így a rendszergazda jóváhagyását csak az OAuth és az OpenID Connect keresztül lehetséges.</span><span class="sxs-lookup"><span data-stu-id="b5d18-249">hello SAML and WS-Federation protocols do not support hello `prompt=admin_consent` parameter, so admin consent is only possible via OAuth and OpenID Connect.</span></span>

## <a name="multi-tenant-applications-and-caching-access-tokens"></a><span data-ttu-id="b5d18-250">Több-Bérlős alkalmazásokhoz és a hozzáférési jogkivonatok gyorsítótár</span><span class="sxs-lookup"><span data-stu-id="b5d18-250">Multi-Tenant Applications and Caching Access Tokens</span></span>
<span data-ttu-id="b5d18-251">Több-bérlős alkalmazásokhoz is kérheti le a hozzáférési jogkivonatok toocall API-k, az Azure AD által védett.</span><span class="sxs-lookup"><span data-stu-id="b5d18-251">Multi-tenant applications can also get access tokens toocall APIs that are protected by Azure AD.</span></span>  <span data-ttu-id="b5d18-252">Általános hiba a több-bérlős alkalmazással hello Active Directory Authentication Library (ADAL) használatakor tooinitially kérelem egy felhasználó/Common használatával jogkivonatot, kapott választ, akkor kérjen az, hogy a felhasználók is használja a/Common későbbi tokent.</span><span class="sxs-lookup"><span data-stu-id="b5d18-252">A common error when using hello Active Directory Authentication Library (ADAL) with a multi-tenant application, is tooinitially request a token for a user using /common, receive a response, then request a subsequent token for that same user also using /common.</span></span>  <span data-ttu-id="b5d18-253">Mivel az Azure AD hello válasz nem származik a bérlő vagy közös, ADAL gyorsítótárazza a hello token hello bérlői származik.</span><span class="sxs-lookup"><span data-stu-id="b5d18-253">Since hello response from Azure AD comes from a tenant, not /common, ADAL caches hello token as being from hello tenant.</span></span> <span data-ttu-id="b5d18-254">hello későbbi hívható meg olyan hozzáférési jogkivonatot hello felhasználói gyorsítótárbeli sikertelen keresések hello gyorsítótári bejegyzést, és hello felhasználó nem a kért toosign ismét túl/közös tooget.</span><span class="sxs-lookup"><span data-stu-id="b5d18-254">hello subsequent call too/common tooget an access token for hello user misses hello cache entry, and hello user is prompted toosign in again.</span></span>  <span data-ttu-id="b5d18-255">Hiányzó hello gyorsítótár tooavoid, győződjön meg arról, hogy további hívások már bejelentkezett felhasználók toohello tenant végpont történik.</span><span class="sxs-lookup"><span data-stu-id="b5d18-255">tooavoid missing hello cache, make sure subsequent calls for an already signed in user are made toohello tenant’s endpoint.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b5d18-256">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="b5d18-256">Next steps</span></span>
<span data-ttu-id="b5d18-257">Ebben a cikkben megtanulta, hogyan meg toobuild olyan alkalmazás, amely a felhasználó bármely Azure Active Directory-bérlőhöz tud bejelentkezni.</span><span class="sxs-lookup"><span data-stu-id="b5d18-257">In this article, you learned how toobuild an application that can sign in a user from any Azure Active Directory tenant.</span></span> <span data-ttu-id="b5d18-258">Miután engedélyezte az egyszeri bejelentkezés az alkalmazás és az Azure Active Directory között, az alkalmazás tooaccess Microsoft erőforrások, például az Office 365 által közzétett API-kban is frissítheti.</span><span class="sxs-lookup"><span data-stu-id="b5d18-258">After enabling Single Sign-On between your app and Azure Active Directory, you can also update your application tooaccess APIs exposed by Microsoft resources, like Office 365.</span></span> <span data-ttu-id="b5d18-259">Ezért kínálhat testreszabott élmént az alkalmazás például toohello felhasználók, például a profilkép vagy a következő naptári időpontot egyeztessen az környezetfüggő adatainak megjelenítése.</span><span class="sxs-lookup"><span data-stu-id="b5d18-259">So you can offer a personalized experience in your application, for example showing contextual information toohello users, like their profile picture or their next calendar appointment.</span></span> <span data-ttu-id="b5d18-260">További információ az API így toolearn meghívja tooAzure Active Directory, és Office 365-szolgáltatásokhoz, például az Exchange, SharePoint, a OneDrive, a OneNote, Planner, Excel és további, látogasson el: [Microsoft Graph API][MSFT-Graph-overview].</span><span class="sxs-lookup"><span data-stu-id="b5d18-260">toolearn more about making API calls tooAzure Active Directory and Office 365 services like Exchange, SharePoint, OneDrive, OneNote, Planner, Excel and more, visit: [Microsoft Graph API][MSFT-Graph-overview].</span></span>


## <a name="related-content"></a><span data-ttu-id="b5d18-261">Kapcsolódó tartalom</span><span class="sxs-lookup"><span data-stu-id="b5d18-261">Related content</span></span>
* <span data-ttu-id="b5d18-262">[Több-bérlős alkalmazás minták][AAD-Samples-MT]</span><span class="sxs-lookup"><span data-stu-id="b5d18-262">[Multi-tenant application samples][AAD-Samples-MT]</span></span>
* <span data-ttu-id="b5d18-263">[Az alkalmazások arculati útmutatóját][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="b5d18-263">[Branding Guidelines for Applications][AAD-App-Branding]</span></span>
* <span data-ttu-id="b5d18-264">[Az Azure AD fejlesztői útmutató][AAD-Dev-Guide]</span><span class="sxs-lookup"><span data-stu-id="b5d18-264">[Azure AD Developer's Guide][AAD-Dev-Guide]</span></span>
* <span data-ttu-id="b5d18-265">[Alkalmazás és szolgáltatás egyszerű objektumok][AAD-App-SP-Objects]</span><span class="sxs-lookup"><span data-stu-id="b5d18-265">[Application Objects and Service Principal Objects][AAD-App-SP-Objects]</span></span>
* <span data-ttu-id="b5d18-266">[Alkalmazások integrálása az Azure Active Directoryval][AAD-Integrating-Apps]</span><span class="sxs-lookup"><span data-stu-id="b5d18-266">[Integrating Applications with Azure Active Directory][AAD-Integrating-Apps]</span></span>
* <span data-ttu-id="b5d18-267">[Hello hozzájárulás keretrendszer áttekintése][AAD-Consent-Overview]</span><span class="sxs-lookup"><span data-stu-id="b5d18-267">[Overview of hello Consent Framework][AAD-Consent-Overview]</span></span>
* <span data-ttu-id="b5d18-268">[A Microsoft Graph API-Engedélyhatókörök][MSFT-Graph-permision-scopes]</span><span class="sxs-lookup"><span data-stu-id="b5d18-268">[Microsoft Graph API Permission Scopes][MSFT-Graph-permision-scopes]</span></span>
* <span data-ttu-id="b5d18-269">[Az Azure AD Graph API-Engedélyhatókörök][AAD-Graph-Perm-Scopes]</span><span class="sxs-lookup"><span data-stu-id="b5d18-269">[Azure AD Graph API Permission Scopes][AAD-Graph-Perm-Scopes]</span></span>

<span data-ttu-id="b5d18-270">A következő megjegyzések szakasz tooprovide visszajelzés hello használata, és segítsen pontosítsa és a tartalom.</span><span class="sxs-lookup"><span data-stu-id="b5d18-270">Please use hello following comments section tooprovide feedback and help us refine and shape our content.</span></span>

<!--Reference style links IN USE -->
[AAD-Access-Panel]:  https://myapps.microsoft.com
[AAD-App-Branding]: ./active-directory-branding-guidelines.md
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Consent-Overview]: ./active-directory-integrating-applications.md#overview-of-the-consent-framework
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Overview]: https://azure.microsoft.com/en-us/documentation/articles/active-directory-graph-api/
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Samples-MT]: https://azure.microsoft.com/documentation/samples/?service=active-directory&term=multitenant
[AAD-Why-To-Integrate]: ./active-directory-how-to-integrate.md
[AZURE-portal]: https://portal.azure.com
[MSFT-Graph-overview]: https://graph.microsoft.io/en-us/docs/overview/overview
[MSFT-Graph-permision-scopes]: https://graph.microsoft.io/en-us/docs/authorization/permission_scopes

<!--Image references-->
[AAD-Sign-In]: ./media/active-directory-devhowto-multi-tenant-overview/sign-in-with-microsoft-light.png
[Consent-Single-Tier]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-single-tier.png
[Consent-Multi-Tier-Known-Client]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-known-clients.png
[Consent-Multi-Tier-Multi-Party]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-multi-party.png

<!--Reference style links -->
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Graph-App-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#application-entity
[AAD-Graph-Sp-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity
[AAD-Graph-User-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#user-entity
[AAD-How-To-Integrate]: ./active-directory-how-to-integrate.md
[AAD-Security-Token-Claims]: ./active-directory-authentication-scenarios/#claims-in-azure-ad-security-tokens
[AAD-Tokens-Claims]: ./active-directory-token-and-claims.md
[AAD-V2-Dev-Guide]: ../active-directory-appmodel-v2-overview.md
[AZURE-portal]: https://portal.azure.com
[Duyshant-Role-Blog]: http://www.dushyantgill.com/blog/2014/12/10/roles-based-access-control-in-cloud-applications-using-azure-ad/
[JWT]: https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-32
[O365-Perm-Ref]: https://msdn.microsoft.com/en-us/office/office365/howto/application-manifest
[OAuth2-Access-Token-Scopes]: https://tools.ietf.org/html/rfc6749#section-3.3
[OAuth2-AuthZ-Code-Grant-Flow]: https://msdn.microsoft.com/library/azure/dn645542.aspx
[OAuth2-AuthZ-Grant-Types]: https://tools.ietf.org/html/rfc6749#section-1.3 
[OAuth2-Client-Types]: https://tools.ietf.org/html/rfc6749#section-2.1
[OAuth2-Role-Def]: https://tools.ietf.org/html/rfc6749#page-6
[OpenIDConnect]: http://openid.net/specs/openid-connect-core-1_0.html
[OpenIDConnect-ID-Token]: http://openid.net/specs/openid-connect-core-1_0.html#IDToken














