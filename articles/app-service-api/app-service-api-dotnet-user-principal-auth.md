---
title: "az Azure App Service API Apps hitelesítése aaaUser |} Microsoft Docs"
description: "Ismerje meg, hogyan férhetnek hozzá a tooprotect engedélyezésével az Azure App Service API-alkalmazás csak tooauthenticated felhasználók."
services: app-service\api
documentationcenter: .net
author: alexkarcher-msft
manager: erikre
editor: 
ms.assetid: 3896760d-46ff-4b67-b98a-edd233f24758
ms.service: app-service-api
ms.workload: na
ms.tgt_pltfrm: dotnet
ms.devlang: na
ms.topic: article
ms.date: 06/30/2016
ms.author: alkarche
ms.openlocfilehash: 4702fc77fcfe736405e22b033c35d22ae3c5a300
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="user-authentication-for-api-apps-in-azure-app-service"></a><span data-ttu-id="bb7fe-103">Az Azure App Service API-alkalmazások felhasználói hitelesítésének</span><span class="sxs-lookup"><span data-stu-id="bb7fe-103">User authentication for API Apps in Azure App Service</span></span>
## <a name="overview"></a><span data-ttu-id="bb7fe-104">Áttekintés</span><span class="sxs-lookup"><span data-stu-id="bb7fe-104">Overview</span></span>
<span data-ttu-id="bb7fe-105">Ez a cikk bemutatja, hogyan tooprotect Azure API-alkalmazást úgy, hogy csak hitelesített felhasználók tudják hívni.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-105">This article shows how tooprotect an Azure API app so that only authenticated users can call it.</span></span> <span data-ttu-id="bb7fe-106">hello cikk feltételezi, hogy rendelkezik olvasási hello [Azure App Service hitelesítés áttekintése](../app-service/app-service-authentication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-106">hello article assumes that you have read hello [Azure App Service authentication overview](../app-service/app-service-authentication-overview.md).</span></span>

<span data-ttu-id="bb7fe-107">Az oktatóanyagból a következőket sajátíthatja el:</span><span class="sxs-lookup"><span data-stu-id="bb7fe-107">You'll learn:</span></span>

* <span data-ttu-id="bb7fe-108">Hogyan tooconfigure egy hitelesítésszolgáltatót, az Azure Active Directory (Azure AD) adatokkal.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-108">How tooconfigure an authentication provider, with details for Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="bb7fe-109">Hogyan tooconsume védett API-alkalmazás használatával hello [Active Directory Authentication Library (ADAL) a JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-109">How tooconsume a protected API app by using hello [Active Directory Authentication Library (ADAL) for JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span></span>

<span data-ttu-id="bb7fe-110">hello cikk két részből áll:</span><span class="sxs-lookup"><span data-stu-id="bb7fe-110">hello article contains two sections:</span></span>

* <span data-ttu-id="bb7fe-111">Hello [hogyan tooconfigure felhasználói hitelesítés az Azure App Service](#authconfig) a szakasz ismerteti a általános hogyan tooconfigure bármely API-alkalmazások felhasználói hitelesítésének és tooall keretrendszerek App Service, beleértve a .NET, által támogatott keretrendszerre alkalmazható NODE.js és Java.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-111">hello [How tooconfigure user authentication in Azure App Service](#authconfig) section explains in general how tooconfigure user authentication for any API app and applies equally tooall frameworks supported by App Service, including .NET, Node.js, and Java.</span></span>
* <span data-ttu-id="bb7fe-112">Hello kezdve [hello .NET API-alkalmazások oktatóanyagok folytatása](#tutorialstart) területen hello segítségével konfigurálja a .NET mintaalkalmazás biztonsági másolatot az AngularJS első előtérrel és, hogy az Azure Active Directory felhasználó cikk útmutatók hitelesítés.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-112">Starting with hello [Continuing hello .NET API Apps tutorials](#tutorialstart) section, hello article guides you through configuring a sample application with a .NET back end and an AngularJS front end so that it uses Azure Active Directory for user authentication.</span></span> 

## <span data-ttu-id="bb7fe-113"><a id="authconfig"></a>Hogyan tooconfigure felhasználói hitelesítés az Azure App Service-ben</span><span class="sxs-lookup"><span data-stu-id="bb7fe-113"><a id="authconfig"></a> How tooconfigure user authentication in Azure App Service</span></span>
<span data-ttu-id="bb7fe-114">Ez a témakör általános útmutatást, amelyek érvényesek a tooany API-alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-114">This section provides general instructions that apply tooany API app.</span></span> <span data-ttu-id="bb7fe-115">A lépések adott toohello tooDo lista .NET mintaalkalmazás, go túl[hello .NET-bevezető oktatóanyagok folytatása](#tutorialstart).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-115">For steps specific toohello tooDo List .NET sample application, go too[Continuing hello .NET getting-started tutorials](#tutorialstart).</span></span>

1. <span data-ttu-id="bb7fe-116">A hello [Azure-portálon](https://portal.azure.com/), keresse meg a toohello **beállítások** hello API-alkalmazás, amelyet az tooprotect, keresés hello panel **szolgáltatások** szakaszt, és kattintson a  **Hitelesítési / engedélyezési**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-116">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you want tooprotect, find hello **Features** section, and then click **Authentication/ Authorization**.</span></span>
   
    ![Azure-portálon hitelesítési/engedélyezési](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="bb7fe-118">A hello **hitelesítési / engedélyezési** panelen kattintson a **a**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-118">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="bb7fe-119">Hello lehetőségek közül választhatnak hello **művelet tootake hitelesítetlen kérés esetén** legördülő listából.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-119">Select one of hello options from hello **Action tootake when request is not authenticated** drop-down list.</span></span>
   
   * <span data-ttu-id="bb7fe-120">Ha azt szeretné, csak a hitelesített hívásokon tooreach az API-alkalmazás, válasszon egyet az hello **jelentkezzen be az...**  beállítások.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-120">If you want only authenticated calls tooreach your API app, choose one of hello **Log in with ...** options.</span></span> <span data-ttu-id="bb7fe-121">Ezzel a beállítással azt tooprotect hello API-alkalmazás az azt futtató programozás nélkül.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-121">This option enables you tooprotect hello API app without writing any code that runs in it.</span></span>
   * <span data-ttu-id="bb7fe-122">Ha azt szeretné, hogy az összes meghívja tooreach az API-alkalmazás, **kérés engedélyezése (intézkedés)**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-122">If you want all calls tooreach your API app, choose **Allow request (no action)**.</span></span> <span data-ttu-id="bb7fe-123">A beállítás nem hitelesített toodirect hívóknak tooa választott hitelesítésszolgáltatókat is használhatja.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-123">You can use this option toodirect unauthenticated callers tooa choice of authentication providers.</span></span> <span data-ttu-id="bb7fe-124">Ezt a beállítást az informatikai részleg toowrite kód toohandle engedélyezési.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-124">With this option you have toowrite code toohandle authorization.</span></span>
     
     <span data-ttu-id="bb7fe-125">További információ: [Az API Apps hitelesítése és engedélyezése az Azure App Service-ben](app-service-api-authentication.md#multiple-protection-options).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-125">For more information, see [Authentication and authorization for API Apps in Azure App Service](app-service-api-authentication.md#multiple-protection-options).</span></span>
4. <span data-ttu-id="bb7fe-126">Jelöljön ki legalább egy hello **hitelesítésszolgáltatókat**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-126">Select one or more of hello **Authentication Providers**.</span></span>
   
    <span data-ttu-id="bb7fe-127">hello kép bemutatja az Azure AD által hitelesített összes hívóknak toobe igénylő lehetőségeket.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-127">hello image shows    choices that require all callers toobe authenticated by Azure AD.</span></span>
   
    ![Az Azure portál hitelesítési/engedélyezési panel](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
   
    <span data-ttu-id="bb7fe-129">Ha úgy dönt, hogy egy hitelesítésszolgáltató, hello portál egy konfigurációs panel jeleníti meg ezt a szolgáltatót.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-129">When you choose an authentication provider, hello portal displays a configuration blade for that provider.</span></span> 
   
    <span data-ttu-id="bb7fe-130">Ismerteti, hogyan tooconfigure hello hitelesítési szolgáltató konfigurációs paneleken részletes útmutatás: [hogyan tooconfigure az App Service alkalmazás toouse Azure Active Directory bejelentkezési](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-130">For detailed instructions that explain how tooconfigure hello authentication provider configuration blades, see [How tooconfigure your App Service application toouse Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span></span> <span data-ttu-id="bb7fe-131">(hello hivatkozás kerül tooan cikk arról, hogy az Azure AD meg, de hello cikkbe, amely hozzárendeli a hello tooarticles más hitelesítésszolgáltatókat lapot tartalmaz,.)</span><span class="sxs-lookup"><span data-stu-id="bb7fe-131">(hello link goes tooan article about Azure AD, but hello article itself contains tabs that link tooarticles for hello other authentication providers.)</span></span>
5. <span data-ttu-id="bb7fe-132">Amikor elkészült, a hello hitelesítési szolgáltató konfigurációs panelen, kattintson a **OK**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-132">When you're done with hello authentication provider configuration blade, click **OK**.</span></span>
6. <span data-ttu-id="bb7fe-133">A hello **hitelesítési / engedélyezési** panelen kattintson a **mentése**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-133">In hello **Authentication / Authorization** blade, click **Save**.</span></span>

<span data-ttu-id="bb7fe-134">Ebben az esetben, ha az App Service API-hívások hitelesíti a hello API-alkalmazás elérése előtti.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-134">When this is done, App Service authenticates all API calls before they reach hello API app.</span></span> <span data-ttu-id="bb7fe-135">hello hitelesítési szolgáltatások munkahelyi hello ugyanaz az App service támogat, beleértve a .NET, Node.js és Java minden nyelvhez.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-135">hello authentication services work hello same for all languages that App service supports, including .NET, Node.js, and Java.</span></span> 

<span data-ttu-id="bb7fe-136">toomake hitelesített API-hívások, hello hívó tartalmaz hello hitelesítési szolgáltató OAuth 2.0 tulajdonosi jogkivonattal a HTTP-kérések hello Authorization fejlécet.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-136">toomake authenticated API calls, hello caller includes hello authentication provider's OAuth 2.0 bearer token in hello Authorization header of HTTP requests.</span></span> <span data-ttu-id="bb7fe-137">hello token szerezhető hello hitelesítési szolgáltató SDK használatával.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-137">hello token can be acquired by using hello authentication provider's SDK.</span></span>

## <span data-ttu-id="bb7fe-138"><a id="tutorialstart"></a>Hello .NET API-alkalmazások oktatóanyagok folytatása</span><span class="sxs-lookup"><span data-stu-id="bb7fe-138"><a id="tutorialstart"></a> Continuing hello .NET API Apps tutorials</span></span>
<span data-ttu-id="bb7fe-139">Ha a következő hello Node.js vagy Java oktatóanyagok API-alkalmazások, hagyja ki toohello a következő cikkben [szolgáltatás egyszerű hitelesítési API-alkalmazások](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-139">If you are following hello Node.js or Java tutorials for API apps, skip toohello next article, [service principal authentication for API apps](app-service-api-dotnet-service-principal-auth.md).</span></span> 

<span data-ttu-id="bb7fe-140">Ha a következő hello .NET oktatóanyag adatsorozat API-alkalmazások és a már telepített hello mintaalkalmazás hello megfelelően [első](app-service-api-dotnet-get-started.md) és [második](app-service-api-cors-consume-javascript.md) oktatóanyagok kihagyása toohello [beállítása az App Service és az Azure AD hitelesítési](#azureauth) szakasz.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-140">If you are following hello .NET tutorial series for API apps and have already deployed hello sample application as directed in hello [first](app-service-api-dotnet-get-started.md) and [second](app-service-api-cors-consume-javascript.md) tutorials, skip toohello [Set up authentication in App Service and Azure AD](#azureauth) section.</span></span>

<span data-ttu-id="bb7fe-141">Ha azt szeretné toofollow ebben az oktatóanyagban hello első és második oktatóanyagok áthaladás nélkül, hello a következő lépések azt ismertetik, hogyan tooget egy automatikus folyamat toodeploy hello mintaalkalmazás használatával indította.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-141">If you want toofollow this tutorial without going through hello first and second tutorials, do hello following steps which explain how tooget started by using an automated process toodeploy hello sample application.</span></span>

> [!NOTE]
> <span data-ttu-id="bb7fe-142">hello lépések első azonos kiindulási pontja, mintha az első két oktatóanyagokat, egy kivétellel volt hello toohello: a Visual Studio már nem tudja, melyik webalkalmazás vagy API-alkalmazás, amelynek minden projekt telepítése lekérdezi.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-142">hello following steps get you toohello same starting point as if you did hello first two tutorials, with one exception: Visual Studio won't already know which web app or API app that each project gets deployed to.</span></span> <span data-ttu-id="bb7fe-143">Ez azt jelenti, hogy emiatt nem tud pontos útmutatásokat ebben az oktatóanyagban hogyan toodeploy toohello megfelelő célokat.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-143">That means you won't have exact instructions in this tutorial that explain how toodeploy toohello right targets.</span></span> <span data-ttu-id="bb7fe-144">Ha nem beválik tudja, hogyan toodo hello telepítési lépéseit a saját, a rendszer jobb toofollow hello oktatóanyag adatsorozat hello a [első oktatóanyaga, amely](app-service-api-dotnet-get-started.md) mint toostart ennek automatikus központi telepítési folyamat.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-144">If you're not comfortable with figuring out how toodo hello deployment steps on your own, it's better toofollow hello tutorial series from hello [first tutorial](app-service-api-dotnet-get-started.md) than toostart with this automated deployment process.</span></span>
> 
> 

1. <span data-ttu-id="bb7fe-145">Győződjön meg arról, hogy rendelkezik az összes felsorolt hello hello Előfeltételek [első oktatóanyaga, amely](app-service-api-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-145">Make sure that you have all of hello prerequisites listed in hello [first tutorial](app-service-api-dotnet-get-started.md).</span></span> <span data-ttu-id="bb7fe-146">Továbbá toohello előfeltételeket a hitelesítési oktatóanyagok azt feltételezik, az App Service web apps és az API apps a Visual Studio dolgozott, és hello Azure-portálon.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-146">In addition toohello prerequisites listed, these authentication tutorials assume that you have worked with App Service web apps and API apps in Visual Studio and hello Azure portal.</span></span>
2. <span data-ttu-id="bb7fe-147">Kattintson a hello **tooAzure telepítése** hello gombjára [tooDo lista minta tárház információs fájl](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps és hello webes alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-147">Click hello **Deploy tooAzure** button in hello [tooDo List sample repository readme file](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps and hello web app.</span></span> <span data-ttu-id="bb7fe-148">Jegyezze fel a hello Azure erőforráscsoport jön létre, hasonlóan a későbbi toolook web app és az API-alkalmazás nevét.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-148">Make a note of hello Azure resource group that gets created, as you can use this later toolook up web app and API app names.</span></span>
3. <span data-ttu-id="bb7fe-149">Letöltés vagy a Klónozás hello [tooDo lista minta tárház](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello kódját fogja használata helyileg a Visual Studióban.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-149">Download or clone hello [tooDo List sample repository](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello code that you'll work with locally in Visual Studio.</span></span>

## <span data-ttu-id="bb7fe-150"><a id="azureauth"></a>Az App Service és az Azure AD hitelesítési beállítása</span><span class="sxs-lookup"><span data-stu-id="bb7fe-150"><a id="azureauth"></a> Set up authentication in App Service and Azure AD</span></span>
<span data-ttu-id="bb7fe-151">Most már rendelkezik anélkül, hogy a felhasználók hitelesítése az Azure App Service-ben futó hello alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-151">You now have hello application running in Azure App Service without requiring that users be authenticated.</span></span> <span data-ttu-id="bb7fe-152">Ebben a szakaszban hitelesítés hello a következő feladatok végrehajtásával hozzáadása:</span><span class="sxs-lookup"><span data-stu-id="bb7fe-152">In this section you add authentication by doing hello following tasks:</span></span>

* <span data-ttu-id="bb7fe-153">Konfigurálja az App Service toorequire Azure Active Directory (Azure AD-) hitelesítést a hello középső rétegbeli API-alkalmazást hívja.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-153">Configure App Service toorequire Azure Active Directory (Azure AD) authentication for calling hello middle tier API app.</span></span>
* <span data-ttu-id="bb7fe-154">Hozzon létre egy Azure AD-alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-154">Create an Azure AD application.</span></span>
* <span data-ttu-id="bb7fe-155">Hello Azure AD alkalmazás toosend hello tulajdonosi jogkivonattal konfigurálása után bejelentkezési toohello AngularJS előtér.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-155">Configure hello Azure AD application toosend hello bearer token after logon toohello AngularJS front end.</span></span> 

<span data-ttu-id="bb7fe-156">Ha a következő hello oktatóanyag utasításait során problémákat tapasztal, tekintse meg a hello [hibaelhárítás](#troubleshooting) szakasz hello oktatóanyag hello végén.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-156">If you run into problems while following hello tutorial directions, see hello [Troubleshooting](#troubleshooting) section at hello end of hello tutorial.</span></span> 

### <a name="configure-authentication-for-hello-middle-tier-api-app"></a><span data-ttu-id="bb7fe-157">Hitelesítés beállítása a hello középső rétegbeli API-alkalmazás</span><span class="sxs-lookup"><span data-stu-id="bb7fe-157">Configure authentication for hello middle tier API app</span></span>
1. <span data-ttu-id="bb7fe-158">A hello [Azure-portálon](https://portal.azure.com/), keresse meg a toohello **beállítások** hello ToDoListAPI projektben létrehozott hello API-alkalmazás paneljén található hello **szolgáltatások** szakaszban, majd Kattintson a **hitelesítési / engedélyezési**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-158">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you created for hello ToDoListAPI project, find hello **Features** section, and then click **Authentication / Authorization**.</span></span>
   
    ![Azure-portálon hitelesítési/engedélyezési](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="bb7fe-160">A hello **hitelesítési / engedélyezési** panelen kattintson a **a**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-160">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="bb7fe-161">A hello **hitelesítetlen kérés esetén a művelet tootake** legördülő listában válassza **bejelentkezés Azure Active Directoryval**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-161">In hello **Action tootake when request is not authenticated** drop-down list, select **Log in with Azure Active Directory**.</span></span>
   
    <span data-ttu-id="bb7fe-162">Ez a beállítás biztosítja, hogy unauathenticated kérelmek nem elérje hello API-alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-162">This option ensures that no unauathenticated requests will reach hello API app.</span></span> 
4. <span data-ttu-id="bb7fe-163">A **hitelesítésszolgáltatókat**, kattintson a **Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-163">Under **Authentication Providers**, click **Azure Active Directory**.</span></span>
   
    ![Az Azure portál hitelesítési/engedélyezési panel](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
5. <span data-ttu-id="bb7fe-165">A hello **Azure Active Directory beállításai** paneljén kattintson **Express**</span><span class="sxs-lookup"><span data-stu-id="bb7fe-165">In hello **Azure Active Directory Settings** blade, click **Express**</span></span>
   
    ![Az Azure portál hitelesítési/engedélyezési Express beállítás](./media/app-service-api-dotnet-user-principal-auth/aadsettings.png)
   
    <span data-ttu-id="bb7fe-167">A hello **Express** beállítás, az App Service automatikusan létrehozhat egy Azure AD-alkalmazást az Azure ad [bérlői](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-167">With hello **Express** option, App Service can automatically create an Azure AD application in your Azure AD [tenant](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span></span> 
   
    <span data-ttu-id="bb7fe-168">Nincs toocreate a bérlőt, mert minden Azure-fiók automatikusan van egy.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-168">You don't have toocreate a tenant, because every Azure account automatically has one.</span></span>
6. <span data-ttu-id="bb7fe-169">A **üzemmód**, kattintson a **új AD-alkalmazás létrehozása** Ha nincs kiválasztva, és figyelje meg, amely hello hello érték **alkalmazás létrehozása** szövegmező; lesz meg az aad-ben a klasszikus Azure portálon később hello alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-169">Under **Management mode**, click **Create New AD App** if it isn't already selected, and notice hello value that is in hello **Create App** text box; you'll look up this AAD application in hello Azure classic portal later.</span></span>
   
    ![Azure-portálon az Azure AD-beállítások](./media/app-service-api-dotnet-user-principal-auth/aadsettings2.png)
   
    <span data-ttu-id="bb7fe-171">Azure automatikusan hoz létre egy Azure AD-alkalmazást, hello kijelzett nevet adja meg az Azure AD-bérlő.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-171">Azure will automatically create an Azure AD application with hello indicated name in your Azure AD tenant.</span></span> <span data-ttu-id="bb7fe-172">Alapértelmezés szerint az Azure AD-alkalmazást hello nevű hello ugyanaz, mint hello API alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-172">By default, hello Azure AD application is named hello same as hello API app.</span></span> <span data-ttu-id="bb7fe-173">Tetszés szerint megadhat egy másik nevet.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-173">If you prefer, you can enter a different name.</span></span>
7. <span data-ttu-id="bb7fe-174">Kattintson az **OK** gombra.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-174">Click **OK**.</span></span>
8. <span data-ttu-id="bb7fe-175">A hello **hitelesítési / engedélyezési** panelen kattintson a **mentése**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-175">In hello **Authentication / Authorization** blade, click **Save**.</span></span>
   
    ![Kattintson a Save (Mentés) gombra.](./media/app-service-api-dotnet-user-principal-auth/authsave.png)

<span data-ttu-id="bb7fe-177">Most már csak az Azure AD-bérlő felhasználók meghívhatja hello API-alkalmazásba.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-177">Now only users in your Azure AD tenant can call hello API app.</span></span>

### <a name="optional-test-hello-api-app"></a><span data-ttu-id="bb7fe-178">Választható lehetőség: Hello API-alkalmazás tesztelése</span><span class="sxs-lookup"><span data-stu-id="bb7fe-178">Optional: Test hello API app</span></span>
1. <span data-ttu-id="bb7fe-179">Egy böngészőben nyissa meg hello API-alkalmazás URL-CÍMÉT toohello: a hello **API-alkalmazás** panel az Azure-portálon hello alatt hello hivatkozásra **URL-cím**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-179">In a browser go toohello URL of hello API app: in hello **API app** blade in hello Azure portal, click hello link under **URL**.</span></span>  
   
    <span data-ttu-id="bb7fe-180">Átirányított tooa bejelentkezési képernyő áll, mert nem hitelesített kérelmek nem engedélyezettek tooreach hello API-alkalmazás.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-180">You are redirected tooa login screen because unauthenticated requests are not allowed tooreach hello API app.</span></span>
   
    <span data-ttu-id="bb7fe-181">Ha a böngésző "sikeresen létrejött" toohello lapra kerül, hello böngésző már kerülhettek naplózásra – ebben az esetben, nyisson meg egy InPrivate vagy Incognito ablakot és nyissa meg toohello API-alkalmazás URL-CÍMÉT.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-181">If your browser goes toohello "successfully created" page, hello browser might already be logged on -- in that case, open an InPrivate or Incognito window and go toohello API app's URL.</span></span>
2. <span data-ttu-id="bb7fe-182">Jelentkezzen be az Azure AD-bérlő a felhasználó hitelesítő adataival.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-182">Log on using credentials for a user in your Azure AD tenant.</span></span>
   
    <span data-ttu-id="bb7fe-183">Ha van bejelentkezve, hello "sikeresen létrejött" lap hello böngészőben.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-183">When you're logged on, hello "successfully created" page appears in hello browser.</span></span>
3. <span data-ttu-id="bb7fe-184">Bezárás hello böngésző.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-184">Close hello browser.</span></span>

### <a name="configure-hello-azure-ad-application"></a><span data-ttu-id="bb7fe-185">Hello Azure AD alkalmazás konfigurálása</span><span class="sxs-lookup"><span data-stu-id="bb7fe-185">Configure hello Azure AD application</span></span>
<span data-ttu-id="bb7fe-186">Ha konfigurálta az Azure AD-alapú hitelesítés, az App Service létre egy Azure AD-alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-186">When you configured Azure AD authentication, App Service created an Azure AD application for you.</span></span> <span data-ttu-id="bb7fe-187">Alapértelmezés szerint a hello új Azure AD-alkalmazás konfigurált tooprovide hello tulajdonosi jogkivonat toohello API-alkalmazás URL-cím volt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-187">By default hello new Azure AD application was configured tooprovide hello bearer token toohello API app's URL.</span></span> <span data-ttu-id="bb7fe-188">Ez a szakasz konfigurálja hello Azure AD alkalmazás tooprovide hello tulajdonosi jogkivonat toohello AngularJS előterének helyett közvetlenül toohello középső rétegbeli API-alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-188">In this section you configure hello Azure AD application tooprovide hello bearer token toohello AngularJS front end instead of directly toohello middle tier API app.</span></span> <span data-ttu-id="bb7fe-189">hello AngularJS előtér által küldött hello token toohello API app meghívja hello API-alkalmazásba.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-189">hello AngularJS front end will send hello token toohello API app when it calls hello API app.</span></span>

> [!NOTE]
> <span data-ttu-id="bb7fe-190">tookeep hello folyamat lehető legegyszerűbb, ez az oktatóanyag használja egy egyetlen Azure AD alkalmazás hello előtér és hello középső rétegbeli API-alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-190">tookeep hello process as simple as possible, this tutorial uses a single Azure AD application for both hello front end and hello middle tier API app.</span></span> <span data-ttu-id="bb7fe-191">Másik lehetőség is toouse két Azure AD-alkalmazások.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-191">Another option is toouse two Azure AD applications.</span></span> <span data-ttu-id="bb7fe-192">Ebben az esetben az Azure AD-alkalmazást toogive hello előtér meg az Azure AD alkalmazás engedély toocall hello középső réteg kellene lennie.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-192">In that case you would have toogive hello front end's Azure AD application permission toocall hello middle tier's Azure AD application.</span></span> <span data-ttu-id="bb7fe-193">Ezt a módszert használja a több alkalmazást ad meg részletesebben vezérelhető, engedélyek tooeach réteg keresztül.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-193">This multi-application approach would give you more granular control over permissions tooeach tier.</span></span>
> 
> 

1. <span data-ttu-id="bb7fe-194">A hello [a klasszikus Azure portálon](https://manage.windowsazure.com/), nyissa meg túl**Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-194">In hello [Azure classic portal](https://manage.windowsazure.com/), go too**Azure Active Directory**.</span></span>
   
   <span data-ttu-id="bb7fe-195">Ezért rendelkezik toouse hello klasszikus portál bizonyos Azure Active Directory szükséges beállítások eléréséhez tooare még nem érhető el a hello Azure-portálon.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-195">You have toouse hello classic portal because certain Azure Active Directory settings that you need access tooare not yet available in hello current Azure portal.</span></span>
2. <span data-ttu-id="bb7fe-196">A hello **Directory** lapra, majd az AAD-bérlőt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-196">On hello **Directory** tab, click your AAD tenant.</span></span>
   
   ![A klasszikus portálon az Azure AD](./media/app-service-api-dotnet-user-principal-auth/selecttenant.png)
3. <span data-ttu-id="bb7fe-198">Kattintson a **alkalmazások > a vállalat tulajdonában lévő alkalmazások**, majd kattintson a pipa hello.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-198">Click **Applications > Applications my company owns**, and then click hello check mark.</span></span>
   
   <span data-ttu-id="bb7fe-199">Toorefresh hello lap toosee hello új alkalmazás is szükség lehet.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-199">You might also have toorefresh hello page toosee hello new application.</span></span>
4. <span data-ttu-id="bb7fe-200">Az alkalmazások hello listában kattintson egy Azure hozott létre az Ön számára az API-alkalmazás hitelesítési engedélyezésekor hello hello nevét.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-200">In hello list of applications, click hello name of hello one that Azure created for you when you enabled authentication for your API app.</span></span>
   
   ![Az Azure AD-alkalmazások lap](./media/app-service-api-dotnet-user-principal-auth/appstab.png)
5. <span data-ttu-id="bb7fe-202">Kattintson a **Configure** (Konfigurálás) elemre.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-202">Click **Configure**.</span></span>
   
   ![Az Azure AD konfigurálása lap](./media/app-service-api-dotnet-user-principal-auth/configure.png)
6. <span data-ttu-id="bb7fe-204">Állítsa be **bejelentkezési URL-cím** toohello URL-cím, az AngularJS webalkalmazás, nem végződhet perjellel.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-204">Set **Sign-on URL** toohello URL for your AngularJS web app, no trailing slash.</span></span>
   
   <span data-ttu-id="bb7fe-205">Például: https://todolistangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="bb7fe-205">For example: https://todolistangular.azurewebsites.net</span></span>
   
   ![Bejelentkezési URL-cím](./media/app-service-api-dotnet-user-principal-auth/signonurlazure.png)
7. <span data-ttu-id="bb7fe-207">Állítsa be **válasz URL-CÍMEN** toohello URL-címet a webalkalmazás, nem végződhet perjellel.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-207">Set **Reply URL** toohello URL for your web app, no trailing slash.</span></span>
   
   <span data-ttu-id="bb7fe-208">Például: https://todolistsangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="bb7fe-208">For example: https://todolistsangular.azurewebsites.net</span></span>
8. <span data-ttu-id="bb7fe-209">Kattintson a **Save** (Mentés) gombra.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-209">Click **Save**.</span></span>
   
   ![Válasz URL-címe](./media/app-service-api-dotnet-user-principal-auth/replyurlazure.png)
9. <span data-ttu-id="bb7fe-211">Hello a hello lap alján, kattintson **kezelése jegyzékfájl > Letöltés jegyzékfájl**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-211">At hello bottom of hello page, click **Manage manifest > Download manifest**.</span></span>
   
   ![Töltse le a jegyzékben](./media/app-service-api-dotnet-user-principal-auth/downloadmanifest.png)
10. <span data-ttu-id="bb7fe-213">Töltse le a hello tooa fájlhelyre ahol módosíthatja azt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-213">Download hello file tooa location where you can edit it.</span></span>
11. <span data-ttu-id="bb7fe-214">A letöltött hello jegyzékfájl, keresse meg a hello `oauth2AllowImplicitFlow` tulajdonság.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-214">In hello downloaded manifest file, search for hello  `oauth2AllowImplicitFlow` property.</span></span> <span data-ttu-id="bb7fe-215">Ezt a tulajdonságot hello értékének módosítása `false` túl`true`, majd mentse hello fájlt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-215">Change hello value of this property from `false` too`true`, and then save hello file.</span></span>
    
    <span data-ttu-id="bb7fe-216">Ez a beállítás a hozzáférést a a JavaScript egyoldalas alkalmazások szükség.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-216">This setting is required for access from a JavaScript single-page application.</span></span> <span data-ttu-id="bb7fe-217">Ez lehetővé teszi a hello Oauth 2.0 tulajdonosi jogkivonat toobe a hello URL-cím töredéket adott vissza.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-217">It enables hello Oauth 2.0 bearer token toobe returned in hello URL fragment.</span></span>
12. <span data-ttu-id="bb7fe-218">Kattintson a **kezelése jegyzékfájl > feltöltés jegyzékfájl**, és hello fájlfeltöltés, amelyeket azért frissített, az előző lépésben hello.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-218">Click **Manage manifest > Upload manifest**, and upload hello file that you updated in hello preceding step.</span></span>
    
    ![Töltse fel a jegyzékben](./media/app-service-api-dotnet-user-principal-auth/uploadmanifest.png)
13. <span data-ttu-id="bb7fe-220">Másolás hello **ügyfél-azonosító** értékét, és mentse valahol beszerezheti a később.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-220">Copy hello **Client ID** value and save it somewhere you can get it from later.</span></span>

## <a name="configure-hello-todolistangular-project-toouse-authentication"></a><span data-ttu-id="bb7fe-221">Hello ToDoListAngular projekt toouse hitelesítés konfigurálása</span><span class="sxs-lookup"><span data-stu-id="bb7fe-221">Configure hello ToDoListAngular project toouse authentication</span></span>
<span data-ttu-id="bb7fe-222">Ebben a szakaszban módosíthatja hello AngularJS előtér, hogy az Active Directory Authentication Library (ADAL) a JS tooacquire hello bejelentkezett felhasználó az Azure AD egy tulajdonosi jogkivonatot használ.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-222">In this section you change hello AngularJS front end so that it uses Active Directory Authentication Library (ADAL) for JS tooacquire a bearer token for hello logged-on user from Azure AD.</span></span> <span data-ttu-id="bb7fe-223">hello kódot tartalmazza hello jogkivonat a középső réteg toohello, küldött HTTP-kérelmek hello a következő ábrán látható módon.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-223">hello code will include hello token in HTTP requests sent toohello middle tier, as shown in hello following diagram.</span></span> 

![Felhasználói hitelesítés diagramja](./media/app-service-api-dotnet-user-principal-auth/appdiagram.png)

<span data-ttu-id="bb7fe-225">Ellenőrizze a következő módosításokat toofiles hello ToDoListAngular projekt hello.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-225">Make hello following changes toofiles in hello ToDoListAngular project.</span></span>

1. <span data-ttu-id="bb7fe-226">Nyissa meg hello *index.cshtml* fájlt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-226">Open hello *index.cshtml* file.</span></span>
2. <span data-ttu-id="bb7fe-227">Állítsa vissza az Active Directory Authentication Library (ADAL) hello JS parancsfájlok hivatkozó hello sorokat.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-227">Uncomment hello lines that reference hello Active Directory Authentication Library (ADAL) for JS scripts.</span></span>
   
        <script src="app/scripts/adal.js"></script>
        <script src="app/scripts/adal-angular.js"></script>
3. <span data-ttu-id="bb7fe-228">Nyissa meg hello *app/scripts/app.js* fájlt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-228">Open hello *app/scripts/app.js* file.</span></span>
4. <span data-ttu-id="bb7fe-229">Hello kódblokkot megjegyzésbe "nélkül hitelesítés" megjelölve, és törölje a "-hitelesítés a" hello kódblokkot megjelölve.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-229">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
   
    <span data-ttu-id="bb7fe-230">Ez a változás hello ADAL JS hitelesítésszolgáltatót és konfigurációs értékeket tooit.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-230">This change references hello ADAL JS authentication provider and provides configuration values tooit.</span></span> <span data-ttu-id="bb7fe-231">Az alábbi lépésekkel hello beállítása hello konfigurációs értékeket az API-alkalmazás és az Azure AD-alkalmazást.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-231">In hello following steps you set hello configuration values for your API app and Azure AD application.</span></span>
5. <span data-ttu-id="bb7fe-232">Beállítja a hello hello kódban `endpoints` változó, beállíthatja hello API URL-címe toohello URL-címe hello API-alkalmazást, amely hello ToDoListAPI projekt készült, és állítsa be az Azure AD alkalmazás azonosítója toohello ügyfél-azonosító, melyet a klasszikus Azure portálon hello kimásolt hello.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-232">In hello code that sets hello `endpoints` variable, set hello API URL toohello URL of hello API app that you created for hello ToDoListAPI project, and set hello Azure AD application ID toohello client ID that you copied from hello Azure classic portal.</span></span>
   
    <span data-ttu-id="bb7fe-233">hello kód mostantól a következő példa hasonló toohello.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-233">hello code is now similar toohello following example.</span></span>
   
        var endpoints = {
            "https://todolistapi0121.azurewebsites.net/": "1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3"
        };
6. <span data-ttu-id="bb7fe-234">A hello hívása túl`adalProvider.init`, beállíthatja `tenant` tooyour bérlő neve és `clientId` hello előző lépésben használt toosame érték.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-234">In hello call too`adalProvider.init`, set `tenant` tooyour tenant name and `clientId` toosame value you used in hello previous step.</span></span>
   
    <span data-ttu-id="bb7fe-235">hello kód mostantól a következő példa hasonló toohello.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-235">hello code is now similar toohello following example.</span></span>
   
        adalProvider.init(
            {
                instance: 'https://login.microsoftonline.com/', 
                tenant: 'contoso.onmicrosoft.com',
                clientId: '1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3',
                extraQueryParameter: 'nux=1',
                endpoints: endpoints
            },
            $httpProvider
            );
   
    <span data-ttu-id="bb7fe-236">A módosítások túl`app.js` adja meg, hogy hello hívó kód és API hívása hello hello ugyanazt az Azure AD alkalmazás legyenek-e.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-236">These changes too`app.js` specify that hello calling code and hello called API are in hello same Azure AD application.</span></span>
7. <span data-ttu-id="bb7fe-237">Nyissa meg hello *app/scripts/homeCtrl.js* fájlt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-237">Open hello *app/scripts/homeCtrl.js* file.</span></span>
8. <span data-ttu-id="bb7fe-238">Hello kódblokkot megjegyzésbe "nélkül hitelesítés" megjelölve, és törölje a "-hitelesítés a" hello kódblokkot megjelölve.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-238">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
9. <span data-ttu-id="bb7fe-239">Nyissa meg hello *app/scripts/indexCtrl.js* fájlt.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-239">Open hello *app/scripts/indexCtrl.js* file.</span></span>
10. <span data-ttu-id="bb7fe-240">Hello kódblokkot megjegyzésbe "nélkül hitelesítés" megjelölve, és törölje a "-hitelesítés a" hello kódblokkot megjelölve.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-240">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>

### <a name="deploy-hello-todolistangular-project-tooazure"></a><span data-ttu-id="bb7fe-241">Hello ToDoListAngular projekt tooAzure telepítése</span><span class="sxs-lookup"><span data-stu-id="bb7fe-241">Deploy hello ToDoListAngular project tooAzure</span></span>
1. <span data-ttu-id="bb7fe-242">A **Megoldáskezelőben**, kattintson a jobb gombbal a ToDoListAngular projekt hello, és kattintson a **közzététel**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-242">In **Solution Explorer**, right-click hello ToDoListAngular project, and then click **Publish**.</span></span>
2. <span data-ttu-id="bb7fe-243">Kattintson a **Publish** (Közzététel) gombra.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-243">Click **Publish**.</span></span>
   
    <span data-ttu-id="bb7fe-244">Visual Studio telepíti hello projektet, és megnyitja a böngésző toohello webes alkalmazás alap URL-címet.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-244">Visual Studio deploys hello project and opens a browser toohello web app's base URL.</span></span> <span data-ttu-id="bb7fe-245">Ez azt mutatja majd 403-as hiba lap, egy kísérlet toogo tooa Web API alap URL-CÍMÉT a böngésző normális.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-245">This will show a 403 error page, which is normal for an attempt toogo tooa Web API base URL from a browser.</span></span>
   
    <span data-ttu-id="bb7fe-246">Továbbra is meg kell toomake egy módosítás toohello középső rétegbeli API-alkalmazás előtt hello alkalmazást tesztelheti.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-246">You still have toomake a change toohello middle tier API app before you can test hello application.</span></span>
3. <span data-ttu-id="bb7fe-247">Bezárás hello böngésző.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-247">Close hello browser.</span></span>

## <a name="configure-hello-todolistapi-project-toouse-authentication"></a><span data-ttu-id="bb7fe-248">Hello ToDoListAPI projekt toouse hitelesítés konfigurálása</span><span class="sxs-lookup"><span data-stu-id="bb7fe-248">Configure hello ToDoListAPI project toouse authentication</span></span>
<span data-ttu-id="bb7fe-249">Jelenleg a ToDoListAPI projekt küld hello "*" hello, `owner` érték tooToDoListDataAPI.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-249">Currently hello ToDoListAPI project sends "*" as hello `owner` value tooToDoListDataAPI.</span></span> <span data-ttu-id="bb7fe-250">Ebben a szakaszban módosítsa hello kód toosend hello Azonosítót hello bejelentkezett felhasználó.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-250">In this section you change hello code toosend hello ID of hello logged-on user.</span></span>

<span data-ttu-id="bb7fe-251">Ellenőrizze a következő módosításokat hello ToDoListAPI projektben hello.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-251">Make hello following changes in hello ToDoListAPI project.</span></span>

1. <span data-ttu-id="bb7fe-252">Nyissa meg hello *Controllers/ToDoListController.cs* fájlt, és állítsa vissza az egyes tartozó műveleti módszer, amely beállítja a hello sor `owner` toohello az Azure AD `NameIdentifier` jogcím értéke.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-252">Open hello *Controllers/ToDoListController.cs* file, and uncomment hello line in each action method that sets `owner` toohello Azure AD `NameIdentifier` claim value.</span></span> <span data-ttu-id="bb7fe-253">Példa:</span><span class="sxs-lookup"><span data-stu-id="bb7fe-253">For example:</span></span>
   
        owner = ((ClaimsIdentity)User.Identity).FindFirst(ClaimTypes.NameIdentifier).Value;
   
    <span data-ttu-id="bb7fe-254">**Fontos**: ne állítsa vissza a hello kód `ToDoListDataAPI` metódus; el kell végeznie, amelyek később hello szolgáltatás egyszerű hitelesítés az oktatóanyaghoz.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-254">**Important**: Don't uncomment code in hello `ToDoListDataAPI` method; you'll do that later for hello service principal authentication tutorial.</span></span>

### <a name="deploy-hello-todolistapi-project-tooazure"></a><span data-ttu-id="bb7fe-255">Hello ToDoListAPI projekt tooAzure telepítése</span><span class="sxs-lookup"><span data-stu-id="bb7fe-255">Deploy hello ToDoListAPI project tooAzure</span></span>
1. <span data-ttu-id="bb7fe-256">A **Megoldáskezelőben**, kattintson a jobb gombbal a hello ToDoListAPI projektet, és kattintson **közzététel**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-256">In **Solution Explorer**, right-click hello ToDoListAPI project, and then click **Publish**.</span></span>
2. <span data-ttu-id="bb7fe-257">Kattintson a **Publish** (Közzététel) gombra.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-257">Click **Publish**.</span></span>
   
    <span data-ttu-id="bb7fe-258">Visual Studio telepíti hello projektet, és megnyitja a böngésző toohello API-alkalmazás alap URL-címet.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-258">Visual Studio deploys hello project and opens a browser toohello API app's base URL.</span></span>
3. <span data-ttu-id="bb7fe-259">Bezárás hello böngésző.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-259">Close hello browser.</span></span>

### <a name="test-hello-application"></a><span data-ttu-id="bb7fe-260">Hello alkalmazás tesztelése</span><span class="sxs-lookup"><span data-stu-id="bb7fe-260">Test hello application</span></span>
1. <span data-ttu-id="bb7fe-261">Nyissa meg hello webalkalmazás, toohello URL-címe **HTTPS-kapcsolaton keresztül, nem HTTP**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-261">Go toohello URL of hello web app, **using HTTPS, not HTTP**.</span></span>
2. <span data-ttu-id="bb7fe-262">Kattintson a hello **tooDo lista** fülre.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-262">Click hello **tooDo List** tab.</span></span>
   
    <span data-ttu-id="bb7fe-263">A kért toolog áll.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-263">You are prompted toolog in.</span></span>
3. <span data-ttu-id="bb7fe-264">Jelentkezzen be az AAD-bérlőben felhasználó hello hitelesítő adatait.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-264">Log in with hello credentials of a user in your AAD tenant.</span></span>
4. <span data-ttu-id="bb7fe-265">Hello **tooDo lista** lap jelenik meg.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-265">hello **tooDo List** page appears.</span></span>
   
   ![tooDo lista lap](./media/app-service-api-dotnet-user-principal-auth/webappindex.png)
   
   <span data-ttu-id="bb7fe-267">Nincs tennivaló jelennek meg, mert eddig összes voltak tulajdonosa "*".</span><span class="sxs-lookup"><span data-stu-id="bb7fe-267">No to-do items are displayed because until now they have all been for owner "*".</span></span> <span data-ttu-id="bb7fe-268">Most hello középső réteg által kért elemek hello bejelentkezett felhasználó számára, és nincs még létrejött.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-268">Now hello middle tier is requesting items for hello logged-on user, and none have been created yet.</span></span>
5. <span data-ttu-id="bb7fe-269">Vegyen fel új hello alkalmazás működik-e tennivaló elemek tooverify.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-269">Add new to-do items tooverify that hello application is working.</span></span>
6. <span data-ttu-id="bb7fe-270">Egy másik böngészőablakban, lépjen a Swagger felhasználói felület URL-cím toohello hello ToDoListDataAPI API-alkalmazás, és kattintson **ToDoList > Get**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-270">In another browser window, go toohello Swagger UI URL for hello ToDoListDataAPI API app and click **ToDoList > Get**.</span></span> <span data-ttu-id="bb7fe-271">Adjon meg csillagot hello `owner` paraméter, és kattintson **próbálja ki**.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-271">Enter an asterisk for hello `owner` parameter, and then click **Try it out**.</span></span>
   
   <span data-ttu-id="bb7fe-272">hello válasz azt mutatja, hogy új teendőelemet hello hello tényleges az Azure AD felhasználói azonosító hello tulajdonos tulajdonságában.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-272">hello response shows that hello new to-do items have hello actual Azure AD user ID in hello Owner property.</span></span>
   
   ![JSON-NÁ válaszul tulajdonos azonosítója](./media/app-service-api-dotnet-user-principal-auth/todolistapiauth.png)

## <a name="building-hello-projects-from-scratch"></a><span data-ttu-id="bb7fe-274">Teljesen új hello projektek felépítése</span><span class="sxs-lookup"><span data-stu-id="bb7fe-274">Building hello projects from scratch</span></span>
<span data-ttu-id="bb7fe-275">hello két Web API-projektet hello használatával létrehozott **Azure API App** projektek sablon és a ToDoList vezérlő tagjára hello alapértelmezett értékek vezérlő.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-275">hello two Web API projects were created by using hello **Azure API App** project template and replacing hello default Values controller with a ToDoList controller.</span></span> 

<span data-ttu-id="bb7fe-276">Információ a túl hozzon létre egy AngularJS egyoldalas alkalmazást a Web API 2 háttérből, lásd: [beavatkozás nélküli a labor: egy egyetlen oldal alkalmazás (SPA) az ASP.NET Web API és Angular.js Build](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-276">For information about how too create an AngularJS single-page application with a Web API 2 back end, see  [Hands On Lab: Build a Single Page Application (SPA) with ASP.NET Web API and Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span></span> <span data-ttu-id="bb7fe-277">További információ tooadd az Azure AD hitelesítési kódot, tekintse meg a következő erőforrások hello:</span><span class="sxs-lookup"><span data-stu-id="bb7fe-277">For information about how tooadd Azure AD authentication code, see hello following resources:</span></span>

* <span data-ttu-id="bb7fe-278">[Az Azure AD-alkalmazások biztonságossá tétele az AngularJS egyetlen lapon](../active-directory/active-directory-devquickstarts-angular.md).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-278">[Securing AngularJS Single Page Apps with Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span></span>
* [<span data-ttu-id="bb7fe-279">A V1-es ADAL JS bemutatása</span><span class="sxs-lookup"><span data-stu-id="bb7fe-279">Introducing ADAL JS v1</span></span>](http://www.cloudidentity.com/blog/2015/02/19/introducing-adal-js-v1/)

## <a name="troubleshooting"></a><span data-ttu-id="bb7fe-280">Hibaelhárítás</span><span class="sxs-lookup"><span data-stu-id="bb7fe-280">Troubleshooting</span></span>
[!INCLUDE [troubleshooting](../../includes/app-service-api-auth-troubleshooting.md)]

* <span data-ttu-id="bb7fe-281">Győződjön meg arról, hogy azt ne tévessze össze ToDoListAPI (középső réteg) és a ToDoListDataAPI (adatrétegbeli).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-281">Make sure that you don't confuse ToDoListAPI (middle tier) and ToDoListDataAPI (data tier).</span></span> <span data-ttu-id="bb7fe-282">Például győződjön meg arról, hogy hozzáadta a hitelesítési toohello középső rétegbeli API-alkalmazást, nem hello adatrétegbeli.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-282">For example, verify that you added authentication toohello middle tier API app, not hello data tier.</span></span> 
* <span data-ttu-id="bb7fe-283">Győződjön meg arról, hogy a hello AngularJS forrás kód hivatkozások hello középső rétegbeli API alkalmazás URL-CÍMÉT (ToDoListAPI, ToDoListDataAPI nem) és hello megfelelő ügyfél-azonosítót az Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-283">Make sure that hello AngularJS source code references hello middle tier API app URL (ToDoListAPI, not ToDoListDataAPI)and hello correct Azure AD client ID.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="bb7fe-284">Következő lépések</span><span class="sxs-lookup"><span data-stu-id="bb7fe-284">Next steps</span></span>
<span data-ttu-id="bb7fe-285">Ebben az oktatóanyagban megtanulta, hogyan toouse API-alkalmazás az App Service hitelesítés, és hogyan toocall hello segítségével API-alkalmazás hello ADAL JS kódtárat.</span><span class="sxs-lookup"><span data-stu-id="bb7fe-285">In this tutorial you learned how toouse App Service authentication for an API app and how toocall hello API app by using hello ADAL JS library.</span></span> <span data-ttu-id="bb7fe-286">Az oktatóanyag következő hello megtudhatja, hogyan túl[biztonságos hozzáférést tooyour API app service-to-service forgatókönyvek](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="bb7fe-286">In hello next tutorial you'll learn how too[secure access tooyour API app for service-to-service scenarios](app-service-api-dotnet-service-principal-auth.md).</span></span>

