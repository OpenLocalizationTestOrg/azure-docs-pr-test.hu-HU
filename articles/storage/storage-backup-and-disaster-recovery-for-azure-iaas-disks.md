---
title: "Az Azure infrastruktúra-szolgáltatási lemezek a biztonsági mentés és katasztrófa-helyreállítás |} Microsoft Docs"
description: "Ebben a cikkben ismertetjük a biztonsági mentés és katasztrófa utáni helyreállítás (DR) az infrastruktúra-szolgáltatási virtuális gépeket (VM) tervezéséről és a lemezek az Azure-ban. Ez a dokumentum ismerteti a felügyelt és a nem felügyelt lemezek"
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 0de675e46dbd527148ac5fedcd35d81962adfb7e
ms.sourcegitcommit: 422efcbac5b6b68295064bd545132fcc98349d01
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 07/29/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="30e17-104">Az Azure infrastruktúra-szolgáltatási lemezek a biztonsági mentés és katasztrófa-helyreállítás</span><span class="sxs-lookup"><span data-stu-id="30e17-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="30e17-105">Ebben a cikkben ismertetjük a biztonsági mentés és katasztrófa utáni helyreállítás (DR) az infrastruktúra-szolgáltatási virtuális gépeket (VM) tervezéséről és a lemezek az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="30e17-105">In this article, we will explain how to plan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="30e17-106">Ez a dokumentum ismerteti a felügyelt és a nem felügyelt lemezek.</span><span class="sxs-lookup"><span data-stu-id="30e17-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="30e17-107">Lesz először döntésről bővebben a beépített tartalék tolerancia képességek az Azure platformon, amely segítségével védelmet biztosítanak a helyi hibák.</span><span class="sxs-lookup"><span data-stu-id="30e17-107">We’ll first talk about the built-in fault tolerance capabilities in the Azure platform which help guard against local failures.</span></span> <span data-ttu-id="30e17-108">Mutatjuk a vész-eljárással nem teljes mértékben a beépített képességei, majd, ami témája a fő ebben a dokumentumban tárgyalt.</span><span class="sxs-lookup"><span data-stu-id="30e17-108">We’ll then discuss the disaster scenarios not fully covered by the built-in capabilities, which is the main topic addressed by this document.</span></span> <span data-ttu-id="30e17-109">Néhány példa munkaterhelés forgatókönyvek, ahol különböző biztonsági mentési és vész-Helyreállítási feltételek vonatkoznak, előfordulhat, hogy is mutat.</span><span class="sxs-lookup"><span data-stu-id="30e17-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="30e17-110">Azt majd áttekinti a lehetséges megoldásokról az infrastruktúra-szolgáltatási lemezek vész-Helyreállítási.</span><span class="sxs-lookup"><span data-stu-id="30e17-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="30e17-111">Bevezetés</span><span class="sxs-lookup"><span data-stu-id="30e17-111">Introduction</span></span>

<span data-ttu-id="30e17-112">Az Azure platformon segítséget nyújtanak a honosított hardver hibák merülnek fel a redundancia és a hibatűrés különböző módszereket használ.</span><span class="sxs-lookup"><span data-stu-id="30e17-112">The Azure platform uses various methods for redundancy and fault tolerance to help protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="30e17-113">Helyi hibák tartalmazhatják egy tároló virtuális lemez számára az adatok egy részét vagy az SSD és HDD sikertelen ezen a kiszolgálón az Azure storage server gépével kapcsolatos probléma.</span><span class="sxs-lookup"><span data-stu-id="30e17-113">Local failures may include problems with an Azure storage server machine that stores part of the data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="30e17-114">Ilyen elkülönített hardver összetevőinek meghibásodása esetén fordulhat elő, a normál működés során, és a platform az célja, hogy ezek a hibák rugalmasak lehetnek.</span><span class="sxs-lookup"><span data-stu-id="30e17-114">Such isolated hardware component failures can happen during normal operations and the platform is designed to be resilient to these failures.</span></span> <span data-ttu-id="30e17-115">Jelentős katasztrófa hibák vagy a tároló kiszolgálók vagy a teljes adatközpont nagy számú inaccessibility eredményezhetnek.</span><span class="sxs-lookup"><span data-stu-id="30e17-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="30e17-116">Miközben a virtuális gépek és a lemezek megfelelően védettek a helyi hibák, további lépések szükségesek a számítási feladatok a meghibásodásával szembeni védelemhez régió kiterjedő katasztrofális (például egy jelentős katasztrófa), amelyek hatással lehetnek a virtuális gép és a lemezek.</span><span class="sxs-lookup"><span data-stu-id="30e17-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary to protect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="30e17-117">Platform hibák lehetőségét, valamint az ügyfél alkalmazáshoz vagy adatok hibák léphetnek fel.</span><span class="sxs-lookup"><span data-stu-id="30e17-117">In addition to the possibility of platform failures, problems with the customer application or data can occur.</span></span> <span data-ttu-id="30e17-118">Például az alkalmazás új verziójának véletlenül tehet egy friss, módosítsa az adatokat.</span><span class="sxs-lookup"><span data-stu-id="30e17-118">For example, a new version of your application may inadvertently make a breaking change to the data.</span></span> <span data-ttu-id="30e17-119">Ebben az esetben érdemes lehet visszaállítani az alkalmazás és az adatokat a legutóbbi ismert helyes állapotát tartalmazó előzetes verzióra.</span><span class="sxs-lookup"><span data-stu-id="30e17-119">In that case, you may want to revert the application and the data to a prior version containing the last known good state.</span></span> <span data-ttu-id="30e17-120">Ehhez a rendszeres biztonsági mentések karbantartása.</span><span class="sxs-lookup"><span data-stu-id="30e17-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="30e17-121">Regionális katasztrófa utáni helyreállítás biztonsági másolatot az infrastruktúra-szolgáltatási virtuális gépek lemezei egy másik régióban.</span><span class="sxs-lookup"><span data-stu-id="30e17-121">For regional disaster recovery, you must backup your IaaS VM disks to a different region.</span></span> 

<span data-ttu-id="30e17-122">Mielőtt úgy tekintünk, biztonsági mentési és vész-Helyreállítási beállítások, most recap néhány módszer áll rendelkezésre helyi hibák kezelése.</span><span class="sxs-lookup"><span data-stu-id="30e17-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="30e17-123">Az Azure IaaS rugalmasság</span><span class="sxs-lookup"><span data-stu-id="30e17-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="30e17-124">*Rugalmasság* normál hardverösszetevők az előforduló hibák tolerancia hivatkozik.</span><span class="sxs-lookup"><span data-stu-id="30e17-124">*Resiliency* refers to the tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="30e17-125">Rugalmasságra helyreállni hibák után, és továbbra is működik.</span><span class="sxs-lookup"><span data-stu-id="30e17-125">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="30e17-126">Nincs kapcsolatos hibák elkerülése, de válaszol a hibák úgy, hogy elkerülhető az állásidő és adatvesztés.</span><span class="sxs-lookup"><span data-stu-id="30e17-126">It's not about avoiding failures, but responding to failures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="30e17-127">A rugalmasság célja térjen vissza az alkalmazást a hiba teljes mértékben működő állapotú.</span><span class="sxs-lookup"><span data-stu-id="30e17-127">The goal of resiliency is to return the application to a fully functioning state following a failure.</span></span> <span data-ttu-id="30e17-128">Az Azure virtuális gépek és a lemezek úgy tervezték, hogy közös hardver hibákra rugalmasak lehetnek.</span><span class="sxs-lookup"><span data-stu-id="30e17-128">Azure Virtual Machines and Disks are designed to be resilient to common hardware faults.</span></span> <span data-ttu-id="30e17-129">Ossza meg velünk keresse meg, hogy az Azure infrastruktúra-szolgáltatási platform ez rugalmasságot biztosít.</span><span class="sxs-lookup"><span data-stu-id="30e17-129">Let us look at how the Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="30e17-130">A virtuális gépek általában két részből áll: (1) A kiszolgálón, és (2) az állandó lemezek számítási.</span><span class="sxs-lookup"><span data-stu-id="30e17-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) the persistent disks.</span></span> <span data-ttu-id="30e17-131">A hibatűrés egy virtuális gép is érinti.</span><span class="sxs-lookup"><span data-stu-id="30e17-131">Both affect the fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="30e17-132">Ha az Azure compute gazdagép-kiszolgálón, amely a virtuális gép hardverhiba (amely ritka), Azure célja, hogy automatikusan állítsa helyre a virtuális Gépet, egy másik kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="30e17-132">If the Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed to automatically restore the VM on another server.</span></span> <span data-ttu-id="30e17-133">Ez akkor fordul elő, ha újraindítás fog tapasztalni, és a virtuális gép biztonsági mentése némi várakozás után lesz.</span><span class="sxs-lookup"><span data-stu-id="30e17-133">If this happens, you will experience a reboot, and the VM will be back up after some time.</span></span> <span data-ttu-id="30e17-134">Azure automatikusan észleli az ilyen hardverhibák, és végrehajtja a helyreállítások érdekében a lehető legrövidebb időn belül az ügyfél virtuális gép lesz elérhető.</span><span class="sxs-lookup"><span data-stu-id="30e17-134">Azure automatically detects such hardware failures and executes recoveries to help ensure the customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="30e17-135">Infrastruktúra-szolgáltatási lemezekre vonatkozó adatok tartósságát fontos állandó tároló platform.</span><span class="sxs-lookup"><span data-stu-id="30e17-135">Regarding IaaS disks, durability of data is critical for the persistent storage platform.</span></span> <span data-ttu-id="30e17-136">Azure-ügyfél rendelkezik infrastruktúra-szolgáltatáson futó üzleti alkalmazások és a megőrzése függenek.</span><span class="sxs-lookup"><span data-stu-id="30e17-136">Azure customers have important business applications running on IaaS and they depend on the persistence of the data.</span></span> <span data-ttu-id="30e17-137">Azure tervek védelmét a három redundáns másolatok IaaS lemezeket helyileg tárolt adatok biztosít magas tartósság helyi hibák ellen.</span><span class="sxs-lookup"><span data-stu-id="30e17-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="30e17-138">Ha egy a hardverösszetevők, amely tárolja a lemez meghibásodik, a virtuális gép nem változik, mert a lemez kérelmek támogatásához két további példányban.</span><span class="sxs-lookup"><span data-stu-id="30e17-138">If one of the hardware components that holds your disk fails, your VM is not impacted because there are two additional copies to support disk requests.</span></span> <span data-ttu-id="30e17-139">Jól működik akkor is, ha egy lemez támogató két különböző hardverösszetevők (amely általában nagyon ritkán) egyszerre sikertelen.</span><span class="sxs-lookup"><span data-stu-id="30e17-139">It works fine even if two different hardware components supporting a disk fail at the same time (which would be very rare).</span></span> <span data-ttu-id="30e17-140">Győződjön meg arról, hogy mindig karbantartása három replikák érdekében az Azure Storage szolgáltatás automatikusan indít az adatokat egy új példányát, ha az egyik három példány nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="30e17-140">To help ensure we always maintain three replicas, the Azure Storage service automatically spawns a new copy of data in the background if one of the three copies becomes unavailable.</span></span> <span data-ttu-id="30e17-141">Ezért azt nem kell RAID használható Azure-lemezeket a hibatűrés szükséges.</span><span class="sxs-lookup"><span data-stu-id="30e17-141">Therefore, it should not be necessary to use RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="30e17-142">Egy egyszerű RAID 0 konfigurációs elegendő-e a lemezek szétosztott, ha nagyobb kötetek létrehozásához szükséges kell lennie.</span><span class="sxs-lookup"><span data-stu-id="30e17-142">A simple RAID 0 configuration should be sufficient for striping the disks if necessary to create larger volumes.</span></span>

<span data-ttu-id="30e17-143">Ebben az architektúrában miatt **Azure következetesen rendelkezik kézbesíteni a vállalati szintű tartósságot, az infrastruktúra-szolgáltatási lemezek, egy iparágvezető a nulla % [Annualized hibaaránya](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span><span class="sxs-lookup"><span data-stu-id="30e17-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="30e17-144">Honosított hardver hibáit a számítási a gazdagép, vagy a tárolási platform is néha elérhetetlenség eredményez a virtuális gép hatálya alá a [Azure garantált szolgáltatási szintje](https://azure.microsoft.com/support/legal/sla/virtual-machines/) a virtuális gép rendelkezésre állás érdekében.</span><span class="sxs-lookup"><span data-stu-id="30e17-144">Localized hardware faults on the compute host or in the storage platform can sometimes result in temporary unavailability for the VM which is covered by the [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="30e17-145">Azure iparágvezető szolgáltatásiszint-szerződésben garantált is biztosít, a prémium szintű Storage lemezeket használó egyetlen Virtuálisgép-példányok.</span><span class="sxs-lookup"><span data-stu-id="30e17-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="30e17-146">Állásidő egy lemezt vagy a virtuális gép ideiglenes elérhetetlensége miatt az alkalmazások és szolgáltatások biztosításához, kihasználhatják a felhasználók [rendelkezésre állási készletek](../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-146">To safeguard application workloads from downtime due to the temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="30e17-147">Két vagy több virtuális gépek rendelkezésre állási csoport számára biztosít redundanciát az alkalmazáshoz.</span><span class="sxs-lookup"><span data-stu-id="30e17-147">Two or more virtual machines in an availability set provides redundancy for the application.</span></span> <span data-ttu-id="30e17-148">Azure majd hoz létre a virtuális gépek és a lemezek külön tartalék tartományok különböző tápellátáshoz, a hálózati és a kiszolgáló-összetevők.</span><span class="sxs-lookup"><span data-stu-id="30e17-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="30e17-149">Ebből kifolyólag honosított hardver meghibásodása általában nem befolyásolják a készlet több virtuális gép egyszerre, magas rendelkezésre állás biztosítása az alkalmazáshoz.</span><span class="sxs-lookup"><span data-stu-id="30e17-149">Thus, localized hardware failures typically do not affect multiple VMs in the set at the same time, providing high availability for your application.</span></span> <span data-ttu-id="30e17-150">Megállapították, célszerű rendelkezésre állási készletek használata, ha magas rendelkezésre állású szükség.</span><span class="sxs-lookup"><span data-stu-id="30e17-150">It is considered a good practice to use availability sets when high availability is required.</span></span> <span data-ttu-id="30e17-151">További információkért lásd: a vész-helyreállítási szempontok részletes alatt.</span><span class="sxs-lookup"><span data-stu-id="30e17-151">For more information, see the Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="30e17-152">Biztonsági mentés és katasztrófa utáni helyreállítás</span><span class="sxs-lookup"><span data-stu-id="30e17-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="30e17-153">Vészhelyreállítás (DR) a ritka, de jelentős események esetén lehetősége: nem átmeneti, szinten hibák, például egy teljes terület érintő üzemkimaradás időtartamát.</span><span class="sxs-lookup"><span data-stu-id="30e17-153">Disaster recovery (DR) is the ability to recover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="30e17-154">Vész-helyreállítási magában foglalja az adatok biztonsági mentése és az archiválásra, és előfordulhat, hogy tartalmazza a manuális beavatkozásra, például egy adatbázis biztonsági másolatból történő visszaállítását.</span><span class="sxs-lookup"><span data-stu-id="30e17-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="30e17-155">Az Azure platformon beépített védelmet biztosít a helyi hibák lehetséges, hogy nem teljes védelme érdekében a virtuális gépek/lemezek esetén jelentős katasztrófa, amelyek nagy méretű kimaradások esetén.</span><span class="sxs-lookup"><span data-stu-id="30e17-155">The Azure platform’s built-in protection against localized failures may not fully protect the VMs/disks in the case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="30e17-156">Ez magában foglalja a katasztrofális esemény, például egy Hurrikán, földrengés, tűz vagy nagy méretű méretezési egység hardverhibák alatt kattintson az adatközpontban.</span><span class="sxs-lookup"><span data-stu-id="30e17-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="30e17-157">Ezenkívül alkalmazás vagy adatokkal kapcsolatos problémák miatt hibák fordulhatnak.</span><span class="sxs-lookup"><span data-stu-id="30e17-157">In addition, you may encounter failures due to application or data issues.</span></span>

<span data-ttu-id="30e17-158">A kimaradások az IaaS munkaterhelések védelme érdekében meg kell terveznie a redundancia és a biztonsági mentések történő helyreállítás engedélyezéséhez.</span><span class="sxs-lookup"><span data-stu-id="30e17-158">To help protect your IaaS workloads from outages, you should plan for redundancy and backups to enable recovery.</span></span> <span data-ttu-id="30e17-159">A vészhelyreállítás esetében meg kell terveznie a redundancia és a különböző földrajzi helyen elhagyja az elsődleges hely biztonsági mentése.</span><span class="sxs-lookup"><span data-stu-id="30e17-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from the primary site.</span></span> <span data-ttu-id="30e17-160">Ez biztosítja a biztonsági másolat nem érinti, amely a virtuális gép vagy lemezek eredetileg érintett ugyanarra az eseményre.</span><span class="sxs-lookup"><span data-stu-id="30e17-160">This helps ensure your backup is not affected by the same event that originally impacted the VM or disks.</span></span> <span data-ttu-id="30e17-161">További információkért lásd: [alkalmazások vész-helyreállítási épülő Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span><span class="sxs-lookup"><span data-stu-id="30e17-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="30e17-162">A vész-Helyreállítási szempontokat is figyelembe venni a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="30e17-162">Your DR considerations may include the following aspects:</span></span>

1. <span data-ttu-id="30e17-163">Magas rendelkezésre állású (HA) azt a képességet az alkalmazás állapota kifogástalan, jelentős állásidőt nélkül folytatódik.</span><span class="sxs-lookup"><span data-stu-id="30e17-163">High Availability (HA) is the ability of the application to continue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="30e17-164">"Kifogástalan állapot," által azt jelenti, az alkalmazás működik-e, és a felhasználók az alkalmazás csatlakozhat, és használhatja őket.</span><span class="sxs-lookup"><span data-stu-id="30e17-164">By "healthy state," we mean the application is responsive, and users can connect to the application and interact with it.</span></span> <span data-ttu-id="30e17-165">Egyes kritikus fontosságú alkalmazások és adatbázis elérhető legyen mindig, még akkor is, ha a hibák vannak a platform szükség lehet.</span><span class="sxs-lookup"><span data-stu-id="30e17-165">Certain mission-critical applications and databases may be required to be available always, even when there are failures in the platform.</span></span> <span data-ttu-id="30e17-166">A munkaterhelések esetén szükség lehet tervezze meg az alkalmazás, valamint az adatok redundancia.</span><span class="sxs-lookup"><span data-stu-id="30e17-166">For these workloads, you may need to plan redundancy for the application as well as the data.</span></span>

2. <span data-ttu-id="30e17-167">Adatok tartóssága: Bizonyos esetekben a fő szempont van biztosítva az adatok megmaradjanak katasztrófa esetén.</span><span class="sxs-lookup"><span data-stu-id="30e17-167">Data Durability: In some cases, the main consideration is ensuring the data is preserved in the case of a disaster.</span></span> <span data-ttu-id="30e17-168">Ezért szükség lehet egy másik helyen az adatok biztonsági másolata.</span><span class="sxs-lookup"><span data-stu-id="30e17-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="30e17-169">Az ilyen munkaterhelések esetén nem szükség lehet az alkalmazás, de a lemezek rendszeres biztonsági másolatot a teljes redundanciát.</span><span class="sxs-lookup"><span data-stu-id="30e17-169">For such workloads, you may not need full redundancy for the application, but a regular backup of the disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="30e17-170">Biztonsági mentési és vész-Helyreállítási forgatókönyvek</span><span class="sxs-lookup"><span data-stu-id="30e17-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="30e17-171">Vizsgáljuk meg néhány gyakori példák alkalmazás munkaterhelés forgatókönyveket és vész-helyreállítási tervezésével kapcsolatos szempontokat.</span><span class="sxs-lookup"><span data-stu-id="30e17-171">Let’s look at a few typical examples of application workload scenarios and the considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="30e17-172">1. forgatókönyv: Fő adatbázis megoldások</span><span class="sxs-lookup"><span data-stu-id="30e17-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="30e17-173">Vegye figyelembe például az SQL Server vagy Oracle, amely támogatja a magas rendelkezésre állású éles adatbázis-kiszolgálót.</span><span class="sxs-lookup"><span data-stu-id="30e17-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="30e17-174">Kritikus termelési alkalmazások és a felhasználók ezt az adatbázist függ.</span><span class="sxs-lookup"><span data-stu-id="30e17-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="30e17-175">A vész-helyreállítási terv, a rendszer a következő követelmények támogatására lehet szükség:</span><span class="sxs-lookup"><span data-stu-id="30e17-175">The Disaster Recovery plan for this system may need to support the following requirements:</span></span>

1. <span data-ttu-id="30e17-176">Az adatok védett és helyreállítható kell lennie.</span><span class="sxs-lookup"><span data-stu-id="30e17-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="30e17-177">Lehet, hogy a kiszolgáló használható.</span><span class="sxs-lookup"><span data-stu-id="30e17-177">Server must be available for use.</span></span>

<span data-ttu-id="30e17-178">Elképzelhető, hogy szükség az adatbázis biztonsági mentéséhez egy másik régióban karbantartása.</span><span class="sxs-lookup"><span data-stu-id="30e17-178">This may require maintaining a replica of the database in a different region as a backup.</span></span> <span data-ttu-id="30e17-179">Attól függően, hogy a kiszolgáló rendelkezésre állása és az adatok helyreállítása a követelményei a megoldás az aktív-aktív vagy aktív-passzív replika hely terjedhet rendszeres offline biztonsági mentést az adatok számára.</span><span class="sxs-lookup"><span data-stu-id="30e17-179">Depending on the requirements for server availability and data recovery, the solution could range from an Active-Active or Active-Passive replica site to periodic offline backups of the data.</span></span> <span data-ttu-id="30e17-180">Például az SQL Server és Oracle relációs adatbázisok replikációs különböző lehetőségeket biztosítanak.</span><span class="sxs-lookup"><span data-stu-id="30e17-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="30e17-181">Az SQL Server [SQL Server Always On rendelkezésre állási csoportok](https://msdn.microsoft.com/library/hh510230.aspx) magas rendelkezésre állás is használható.</span><span class="sxs-lookup"><span data-stu-id="30e17-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="30e17-182">MongoDB hasonló NoSQL-adatbázisok is támogatja a [replikák](https://docs.mongodb.com/manual/replication/) a redundancia érdekében.</span><span class="sxs-lookup"><span data-stu-id="30e17-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="30e17-183">A magas rendelkezésre állás a replikák is használható.</span><span class="sxs-lookup"><span data-stu-id="30e17-183">The replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="30e17-184">2. forgatókönyv: Egy fürt redundáns virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="30e17-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="30e17-185">Érdemes lehet a munkaterhelés, a fürt virtuális gépeket, a redundanciát és terheléselosztást kezeli.</span><span class="sxs-lookup"><span data-stu-id="30e17-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="30e17-186">Egy példa erre egy Cassandra fürt üzembe helyezett egy régiót.</span><span class="sxs-lookup"><span data-stu-id="30e17-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="30e17-187">Az ilyen típusú architektúra már biztosít magas szintű redundancia adott régión belül.</span><span class="sxs-lookup"><span data-stu-id="30e17-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="30e17-188">Azonban a munkaterhelések védelme a regionális szintű meghibásodása, vegye figyelembe a fürt két régióban is terjednek vagy rendszeres biztonsági mentést tételére egy másik régióban.</span><span class="sxs-lookup"><span data-stu-id="30e17-188">However, to protect the workload from a regional level failure, you should consider spreading the cluster across two regions or making periodic backups to another region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="30e17-189">3. forgatókönyv: Infrastruktúra-szolgáltatási alkalmazás munkaterhelés</span><span class="sxs-lookup"><span data-stu-id="30e17-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="30e17-190">Ennek oka lehet egy tipikus környezet munkaterhelés egy Azure virtuális gépen.</span><span class="sxs-lookup"><span data-stu-id="30e17-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="30e17-191">Elképzelhető például, egy webkiszolgáló vagy a fájlkiszolgáló a tartalom és a hely más erőforrások.</span><span class="sxs-lookup"><span data-stu-id="30e17-191">For example, it could be a web server or file server holding the content and other resources of a site.</span></span> <span data-ttu-id="30e17-192">Egy egyedi üzleti alkalmazás, amely az adatok, erőforrások és alkalmazásállapot lemezen tárolja a a virtuális gép egy virtuális gépen is lehet.</span><span class="sxs-lookup"><span data-stu-id="30e17-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on the VM disks.</span></span> <span data-ttu-id="30e17-193">Ebben az esetben fontos ellenőrizze, hogy rendszeresen a biztonsági mentések igénybe vehet.</span><span class="sxs-lookup"><span data-stu-id="30e17-193">In this case, it is important to make sure you take backups on a regular basis.</span></span> <span data-ttu-id="30e17-194">Biztonsági mentési gyakoriság alapján a virtuális gép munkaterhelés jellegét.</span><span class="sxs-lookup"><span data-stu-id="30e17-194">Backup frequency should be based on the nature of the VM workload.</span></span> <span data-ttu-id="30e17-195">Például ha az alkalmazás naponta fut, és módosítja az adatokat, majd a biztonsági mentést kell végezni minden órában.</span><span class="sxs-lookup"><span data-stu-id="30e17-195">For example, if the application runs every day and modifies data, then the backup should be taken every hour.</span></span>

<span data-ttu-id="30e17-196">Egy másik példa a jelentéskészítő kiszolgáló más forrásokból származó adatok lekéréses és összesített jelentéseket hoz létre.</span><span class="sxs-lookup"><span data-stu-id="30e17-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="30e17-197">A virtuális gép vagy a lemezek a jelentések elvesztését eredményezi.</span><span class="sxs-lookup"><span data-stu-id="30e17-197">Loss of this VM or disks will lead to the loss of the reports.</span></span> <span data-ttu-id="30e17-198">Azonban lehet futtassa újra a jelentéskészítési folyamat és a kimenet újragenerálása.</span><span class="sxs-lookup"><span data-stu-id="30e17-198">However, it may be possible to rerun the reporting process and regenerate the output.</span></span> <span data-ttu-id="30e17-199">Ebben az esetben valóban nincs adatvesztést akkor is, ha a jelentéskészítő kiszolgáló egy olyan vészhelyzet esetén a találati, így magasabb szintű tűréshatár elvesztése a jelentéskészítő kiszolgálón az adatok egy részét sikerült kell.</span><span class="sxs-lookup"><span data-stu-id="30e17-199">In that case, you don’t really have a loss of data even if the reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of the data on the reporting server.</span></span> <span data-ttu-id="30e17-200">Ebben az esetben ritkábban biztonsági mentések lehetősége arra a költségek csökkentése.</span><span class="sxs-lookup"><span data-stu-id="30e17-200">In that case, less frequent backups is an option to reduce the cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="30e17-201">4. forgatókönyv: Az infrastruktúra-szolgáltatási alkalmazás adatok kapcsolatos problémákat</span><span class="sxs-lookup"><span data-stu-id="30e17-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="30e17-202">Van olyan alkalmazás, amely kiszámítja, tart fenn és kritikus kereskedelmi forgalomban beszerezhető adatok, például a díjszabásról szolgál.</span><span class="sxs-lookup"><span data-stu-id="30e17-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="30e17-203">Az alkalmazás új verziójának szoftver programhiba helytelenül az árképzés számított, és a meglévő kereskedelmi adatok, a platform által kiszolgált sérült volt.</span><span class="sxs-lookup"><span data-stu-id="30e17-203">A new version of your application had a software bug which incorrectly computed the pricing and corrupted the existing commerce data served by the platform.</span></span> <span data-ttu-id="30e17-204">Állítsa vissza a korábbi verzióra, az alkalmazás és az adatok itt lenne, a helyes intézkedéseket.</span><span class="sxs-lookup"><span data-stu-id="30e17-204">Here, the best course of action would be to revert to the earlier version of the application and the data first.</span></span> <span data-ttu-id="30e17-205">Ehhez igénybe vehet a rendszer rendszeres biztonsági mentést.</span><span class="sxs-lookup"><span data-stu-id="30e17-205">To enable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="30e17-206">Vész-helyreállítási megoldást: Azure biztonsági mentési szolgáltatás</span><span class="sxs-lookup"><span data-stu-id="30e17-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="30e17-207">[Az Azure Backup szolgáltatás](https://azure.microsoft.com/services/backup/) biztonsági mentési és vész-Helyreállítási is használható, és működik együtt a [kezelt lemezek](storage-managed-disks-overview.md) , valamint [nem felügyelt lemezek](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="30e17-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](storage-managed-disks-overview.md) as well as [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span></span> <span data-ttu-id="30e17-208">Az idő-alapú biztonsági mentések, könnyű VM-helyreállítás és biztonsági másolatok megőrzésének házirendek segítségével hozhat létre egy biztonsági mentési feladat.</span><span class="sxs-lookup"><span data-stu-id="30e17-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="30e17-209">Ha [prémium szintű Storage lemezek](storage-premium-storage.md), [kezelt lemezek](storage-managed-disks-overview.md), vagy más lemeztípusok esetén a a [helyileg redundáns tárolás (LRS)](storage-redundancy.md#locally-redundant-storage) beállítást, különösen fontos ki rendszeres vész-Helyreállítási biztonsági mentést.</span><span class="sxs-lookup"><span data-stu-id="30e17-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](storage-managed-disks-overview.md), or other disk types with the [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important to leverage periodic DR backups.</span></span> <span data-ttu-id="30e17-210">Az Azure Backup a Recovery Services-tároló, a hosszú távú megőrzési tárolja az adatokat.</span><span class="sxs-lookup"><span data-stu-id="30e17-210">Azure Backup stores the data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="30e17-211">Válassza ki a [georedundáns tárolás (GRS)](storage-redundancy.md#geo-redundant-storage) beállítás megadása a biztonsági mentés Recovery Services-tároló.</span><span class="sxs-lookup"><span data-stu-id="30e17-211">Choose the [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for the Backup Recovery Services vault.</span></span> <span data-ttu-id="30e17-212">Amely biztosítja a biztonsági mentések replikálva vannak a regionális katasztrófák megóvása egy másik Azure-régiót.</span><span class="sxs-lookup"><span data-stu-id="30e17-212">That will ensure backups are replicated to a different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="30e17-213">A [nem felügyelt lemezek](storage-about-disks-and-vhds-windows.md#unmanaged-disks), az infrastruktúra-szolgáltatási lemezek az LRS tárolási típust használja, de győződjön meg arról, hogy az Azure Backup szolgáltatás engedélyezve van-e a Georedundáns beállítással a Recovery Services-tároló.</span><span class="sxs-lookup"><span data-stu-id="30e17-213">For [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks), you can use the LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with the GRS option for the Recovery Services Vault.</span></span>

<span data-ttu-id="30e17-214">**Ha használja a [Georedundáns](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) beállítás megadása után még a nem felügyelt lemezek kell alkalmazáskonzisztens pillanatképeket vonatkozó biztonsági mentési és vész-Helyreállítási.**</span><span class="sxs-lookup"><span data-stu-id="30e17-214">**If you use the [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="30e17-215">Egyikét kell használnia [Azure Backup szolgáltatás](https://azure.microsoft.com/services/backup/) vagy [alkalmazáskonzisztens pillanatképek](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="30e17-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="30e17-216">A következő egy vész-Helyreállítási megoldások összegzését.</span><span class="sxs-lookup"><span data-stu-id="30e17-216">The following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="30e17-217">Forgatókönyv</span><span class="sxs-lookup"><span data-stu-id="30e17-217">Scenario</span></span> | <span data-ttu-id="30e17-218">Automatikus replikáció</span><span class="sxs-lookup"><span data-stu-id="30e17-218">Automatic Replication</span></span> | <span data-ttu-id="30e17-219">Vész-Helyreállítási megoldás</span><span class="sxs-lookup"><span data-stu-id="30e17-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="30e17-220">*Prémium szintű Storage-lemezekhez*</span><span class="sxs-lookup"><span data-stu-id="30e17-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="30e17-221">Helyi ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="30e17-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="30e17-222">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="30e17-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="30e17-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="30e17-223">*Managed Disks*</span></span> | <span data-ttu-id="30e17-224">Helyi ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="30e17-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="30e17-225">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="30e17-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="30e17-226">*Nem felügyelt LRS-lemezek*</span><span class="sxs-lookup"><span data-stu-id="30e17-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="30e17-227">Helyi ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="30e17-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="30e17-228">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="30e17-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="30e17-229">*Nem felügyelt Georedundáns lemezek*</span><span class="sxs-lookup"><span data-stu-id="30e17-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="30e17-230">Több régióban ([Georedundáns](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="30e17-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="30e17-231">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="30e17-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="30e17-232">Alkalmazáskonzisztens pillanatképek</span><span class="sxs-lookup"><span data-stu-id="30e17-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="30e17-233">*Nem felügyelt RA-GRS-lemezek*</span><span class="sxs-lookup"><span data-stu-id="30e17-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="30e17-234">Több régióban ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="30e17-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="30e17-235">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="30e17-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="30e17-236">Alkalmazáskonzisztens pillanatképek</span><span class="sxs-lookup"><span data-stu-id="30e17-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="30e17-237">Magas rendelkezésre állású, legjobban érheti kezelt lemezeken rendelkezésre állási csoport együtt az Azure Backup segítségével.</span><span class="sxs-lookup"><span data-stu-id="30e17-237">High availability can best by met through the use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="30e17-238">Nem felügyelt lemezt használ, ha a vész-Helyreállítási továbbra is használhatja a Azure Backup szolgáltatásnál.</span><span class="sxs-lookup"><span data-stu-id="30e17-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="30e17-239">Ha nem használható az Azure biztonsági mentés, majd véve [alkalmazáskonzisztens pillanatképek](#alternative-solution-consistent-snapshots) leírtak szerint egy későbbi szakasz ismerteti a biztonsági mentési és vész-Helyreállítási alternatív megoldást-e.</span><span class="sxs-lookup"><span data-stu-id="30e17-239">If you are unable to use Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="30e17-240">A választott a magas rendelkezésre állás érdekében biztonsági mentési és vész-Helyreállítási alkalmazást vagy az infrastruktúra szintjén, az alábbiakban ábrázolhatók:</span><span class="sxs-lookup"><span data-stu-id="30e17-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="30e17-241">*Szint*</span><span class="sxs-lookup"><span data-stu-id="30e17-241">*Level*</span></span> | <span data-ttu-id="30e17-242">Magas rendelkezésre állás</span><span class="sxs-lookup"><span data-stu-id="30e17-242">High Availability</span></span>   | <span data-ttu-id="30e17-243">Biztonsági mentés / DR</span><span class="sxs-lookup"><span data-stu-id="30e17-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="30e17-244">*Alkalmazás*</span><span class="sxs-lookup"><span data-stu-id="30e17-244">*Application*</span></span> | <span data-ttu-id="30e17-245">Always On SQL</span><span class="sxs-lookup"><span data-stu-id="30e17-245">SQL Always On</span></span> | <span data-ttu-id="30e17-246">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="30e17-246">Azure Backup</span></span> |
| <span data-ttu-id="30e17-247">*Infrastruktúra*</span><span class="sxs-lookup"><span data-stu-id="30e17-247">*Infrastructure*</span></span>  | <span data-ttu-id="30e17-248">Rendelkezésre állási csoport</span><span class="sxs-lookup"><span data-stu-id="30e17-248">Availability Set</span></span>  | <span data-ttu-id="30e17-249">Az alkalmazáskonzisztens pillanatképek Georedundáns</span><span class="sxs-lookup"><span data-stu-id="30e17-249">GRS with consistent snapshots</span></span> |

### <a name="using-the-azure-backup-service"></a><span data-ttu-id="30e17-250">Az Azure biztonsági mentési szolgáltatás használatával</span><span class="sxs-lookup"><span data-stu-id="30e17-250">Using the Azure Backup Service</span></span>

<span data-ttu-id="30e17-251">[Azure biztonsági mentés](../backup/backup-azure-vms-introduction.md) tud biztonsági másolatot készíteni a Windows vagy Linux rendszerű futtató az Azure Recovery Services-tároló virtuális gépek.</span><span class="sxs-lookup"><span data-stu-id="30e17-251">[Azure Backup](../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux to the Azure Recovery Services Vault.</span></span> <span data-ttu-id="30e17-252">Biztonsági mentése és visszaállítása az üzleti szempontból kritikus fontosságú adatok bonyolítja van arra, hogy üzleti szempontból kritikus fontosságú adatok kell készülni, az alkalmazások az adatokat előállító működése közben.</span><span class="sxs-lookup"><span data-stu-id="30e17-252">Backing up and restoring business-critical data is complicated by the fact that business-critical data must be backed up while the applications that produce the data are running.</span></span> <span data-ttu-id="30e17-253">Orvoslása érdekében Azure biztonsági mentés alkalmazáskonzisztens biztonsági mentések Microsoft-munkaterhelések segítségével biztosítja a kötet árnyékmásolata szolgáltatás (VSS) annak érdekében, hogy adatot ír megfelelően tároló.</span><span class="sxs-lookup"><span data-stu-id="30e17-253">To address this, Azure Backup provides application-consistent backups for Microsoft workloads by using the Volume Shadow Service (VSS) to ensure that data is written correctly to storage.</span></span> <span data-ttu-id="30e17-254">Linux virtuális gépekhez csak a fájlkonzisztens biztonsági mentések is előfordulhatnak, Linux nem tartozik funkció egyenértékű VSS-t.</span><span class="sxs-lookup"><span data-stu-id="30e17-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent to VSS.</span></span>

![][1]

<span data-ttu-id="30e17-255">Azure biztonsági mentési indít el a biztonsági mentési feladatot a megadott időpontban, amikor elindítja a biztonságimásolat-kiterjesztés telepítése pont időponthoz kötött pillanatképet készít a virtuális gépen.</span><span class="sxs-lookup"><span data-stu-id="30e17-255">When Azure Backup initiates a backup job at the scheduled time, it triggers the backup extension installed in the VM to take a point-in-time snapshot.</span></span> <span data-ttu-id="30e17-256">A rendszer pillanatképet készít VSS együtt a lemezek konzisztens pillanatképének beolvasása a virtuális gép nem kell leállítani.</span><span class="sxs-lookup"><span data-stu-id="30e17-256">A snapshot is taken in coordination with VSS to get a consistent snapshot of the disks in the virtual machine without having to shut it down.</span></span> <span data-ttu-id="30e17-257">A biztonsági mentési bővítményt a virtuális gép összes írása előtt a konzisztens pillanatképének készítése a lemezek kiürítése.</span><span class="sxs-lookup"><span data-stu-id="30e17-257">The backup extension in the VM flushes all writes before taking the consistent snapshot of all the disks.</span></span> <span data-ttu-id="30e17-258">Miután a rendszer pillanatképet készít, az adatátvitel Azure Backup szolgáltatás a biztonsági mentési tárolóba.</span><span class="sxs-lookup"><span data-stu-id="30e17-258">After the snapshot is taken, the data is transferred by Azure Backup to the backup vault.</span></span> <span data-ttu-id="30e17-259">A biztonsági mentési folyamat hatékonyabbá teheti, hogy a szolgáltatás azonosítja, és csak az adatok utolsó biztonsági mentés óta módosult blokkok átvitele.</span><span class="sxs-lookup"><span data-stu-id="30e17-259">To make the backup process more efficient, the service identifies and transfers only the blocks of data that have changed since the last backup.</span></span>


<span data-ttu-id="30e17-260">Visszaállításához a rendelkezésre álló biztonsági mentések Azure Backup segítségével tekintheti meg és majd indítsa el a visszaállítást.</span><span class="sxs-lookup"><span data-stu-id="30e17-260">To restore, you can view the available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="30e17-261">Hozhat létre és állítsa vissza az Azure biztonsági mentések keresztül a [Azure-portálon](https://portal.azure.com/), [PowerShell-lel](../backup/backup-azure-vms-automation.md ), vagy használja a [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="30e17-261">You can create and restore Azure backups through the [Azure portal](https://portal.azure.com/), [using PowerShell](../backup/backup-azure-vms-automation.md ), or using the [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="30e17-262">További információkért tekintse meg az Azure biztonsági mentés.</span><span class="sxs-lookup"><span data-stu-id="30e17-262">For more information, see Azure Backup.</span></span>

### <a name="steps-to-enable-backup"></a><span data-ttu-id="30e17-263">Biztonsági mentés engedélyezésének lépései</span><span class="sxs-lookup"><span data-stu-id="30e17-263">Steps to Enable Backup</span></span>

<span data-ttu-id="30e17-264">Az alábbi lépéseket általában használt biztonsági mentéseket a virtuális gépek használata a [Azure Portal](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="30e17-264">The following steps are typically used to enable backups of your VMs using the [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="30e17-265">A pontos forgatókönyvtől függően változata lesz.</span><span class="sxs-lookup"><span data-stu-id="30e17-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="30e17-266">Tekintse meg a [Azure biztonsági mentés](../backup/backup-azure-vms-introduction.md) teljes dokumentációjában.</span><span class="sxs-lookup"><span data-stu-id="30e17-266">Refer to the [Azure Backup](../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="30e17-267">Azure biztonsági mentés is [támogatja a felügyelt lemezzel rendelkező virtuális gépek](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="30e17-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="30e17-268">A recovery services-tároló létrehozása a virtuális gépek az alábbi lépéseket követve:</span><span class="sxs-lookup"><span data-stu-id="30e17-268">Create a recovery services vault for a VM using the following steps:</span></span>

    <span data-ttu-id="30e17-269">a.</span><span class="sxs-lookup"><span data-stu-id="30e17-269">a.</span></span>  <span data-ttu-id="30e17-270">Használja a [Azure-portálon](https://portal.azure.com/), keresse meg az összes erőforrást és a "Recovery Services-tárolók" található.</span><span class="sxs-lookup"><span data-stu-id="30e17-270">Using the [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="30e17-271">b.</span><span class="sxs-lookup"><span data-stu-id="30e17-271">b.</span></span>  <span data-ttu-id="30e17-272">A Recovery Services-tárolók menüben kattintson a Hozzáadás gombra, és a lépéseket követve létrehozhat egy új tárolót a virtuális gép ugyanabban a régióban.</span><span class="sxs-lookup"><span data-stu-id="30e17-272">On the Recovery Services vaults menu, click Add and follow the steps to create a new vault in the same region as the VM.</span></span> <span data-ttu-id="30e17-273">Például ha a virtuális gép USA nyugati régiója régióban, válasszon USA nyugati régiója a tároló.</span><span class="sxs-lookup"><span data-stu-id="30e17-273">For example, if your VM is in West US region, pick West US for the vault.</span></span>

2.  <span data-ttu-id="30e17-274">Ellenőrizze a tárolási replikáció, az újonnan létrehozott tároló.</span><span class="sxs-lookup"><span data-stu-id="30e17-274">Verify the Storage replication for the newly created vault.</span></span> <span data-ttu-id="30e17-275">Ehhez a Recovery Services-tárolók panel hozzáférést a tárolóhoz, és navigáljon a beállítások/biztonsági konfiguráció.</span><span class="sxs-lookup"><span data-stu-id="30e17-275">To do this, access the vault from the Recovery Services vaults blade and go to the settings/Backup Configuration.</span></span> <span data-ttu-id="30e17-276">Győződjön meg arról, a Georedundáns beállítás alapértelmezés szerint.</span><span class="sxs-lookup"><span data-stu-id="30e17-276">Ensure the GRS option is selected by default.</span></span> <span data-ttu-id="30e17-277">Ezzel biztosíthatja, hogy a rendszer automatikusan replikálja a tároló egy másodlagos adatközpontba.</span><span class="sxs-lookup"><span data-stu-id="30e17-277">This will ensure that your vault is automatically replicated to a secondary data center.</span></span> <span data-ttu-id="30e17-278">Például a tároló az USA nyugati régiója a rendszer automatikusan replikálja USA keleti régiója.</span><span class="sxs-lookup"><span data-stu-id="30e17-278">For example, your vault in West US will be automatically replicated to East US.</span></span>

3.  <span data-ttu-id="30e17-279">Konfigurálja a biztonsági mentési házirend, és válassza ki a virtuális gép ugyanabban a szövegben.</span><span class="sxs-lookup"><span data-stu-id="30e17-279">Configure the backup policy and select the VM from the same UI.</span></span>

4.  <span data-ttu-id="30e17-280">Győződjön meg arról, hogy a biztonsági mentési ügynök telepítve van a virtuális Gépen.</span><span class="sxs-lookup"><span data-stu-id="30e17-280">Make sure the Backup Agent is installed on the VM.</span></span> <span data-ttu-id="30e17-281">Ha a virtuális gép létrehozása az Azure katalógusában lemezképpel, majd a biztonsági mentési ügynök már telepítve van.</span><span class="sxs-lookup"><span data-stu-id="30e17-281">If your VM is created using an Azure gallery image, then the Backup agent is already installed.</span></span> <span data-ttu-id="30e17-282">Egyéb (Ez azt jelenti, hogy ha egyéni lemezkép használata esetén), kövesse az utasításokat [a Virtuálisgép-ügynök telepítése a virtuális gépen](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="30e17-282">Otherwise (that is, if you are using a custom image), use instructions to [Install the VM Agent on the virtual machine](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="30e17-283">Győződjön meg arról, hogy a virtuális gép hálózati kapcsolattal a biztonsági mentési szolgáltatás működéséhez.</span><span class="sxs-lookup"><span data-stu-id="30e17-283">Make sure that the VM allows network connectivity for the backup service to function.</span></span> <span data-ttu-id="30e17-284">Kövesse ezeket az utasításokat a [hálózati kapcsolatra](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="30e17-284">Follow these instructions for [Network connectivity](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="30e17-285">Miután a fenti lépéseket, a biztonsági mentés a biztonsági mentési házirend rendszeres időközönként indul el.</span><span class="sxs-lookup"><span data-stu-id="30e17-285">Once the above steps are completed, the backup will run at regular intervals as specified in the backup policy.</span></span> <span data-ttu-id="30e17-286">Szükség esetén manuálisan az irányítópultról tárolóban az Azure portálon az első biztonsági mentés indíthat el.</span><span class="sxs-lookup"><span data-stu-id="30e17-286">If necessary, you can trigger the first backup manually from the vault dashboard on the Azure portal.</span></span>

<span data-ttu-id="30e17-287">A automatizálása Azure biztonsági mentési parancsfájlok segítségével, tekintse meg [PowerShell-parancsmagok a virtuális gép biztonsági mentése](../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-287">For automating Azure Backup using scripts, please refer to [PowerShell cmdlets for VM backup](../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="30e17-288">A helyreállítás lépései</span><span class="sxs-lookup"><span data-stu-id="30e17-288">Steps for Recovery</span></span>

<span data-ttu-id="30e17-289">Ha tudja javítani, illetve építse újra a virtuális gép van szüksége, visszaállíthatja a virtuális gép bármelyik a biztonsági mentések helyreállítási pontjait a tárolóban lévő állapottal.</span><span class="sxs-lookup"><span data-stu-id="30e17-289">If you need to repair or rebuild a VM, you can restore the VM from any of the backup recovery points in the vault.</span></span> <span data-ttu-id="30e17-290">Többféle helyreállításhoz különböző lehetőségek közül:</span><span class="sxs-lookup"><span data-stu-id="30e17-290">There are a couple of different options for performing the recovery:</span></span>

1.  <span data-ttu-id="30e17-291">A biztonsági másolat virtuális Gépet egy időpontban ábrázolása, hozhat létre egy új virtuális Gépet.</span><span class="sxs-lookup"><span data-stu-id="30e17-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="30e17-292">Visszaállíthatja a lemezeket, és majd használni a virtuális gép testreszabása, és építse újra a visszaállított virtuális Géphez.</span><span class="sxs-lookup"><span data-stu-id="30e17-292">You can restore the disks and then use the template for the VM to customize and rebuild the restored VM.</span></span> 

<span data-ttu-id="30e17-293">Az utasítások [visszaállítani a virtuális gépek használata Azure-portálon](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="30e17-293">See instructions to [Use Azure portal to restore virtual machines](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="30e17-294">A dokumentum is ismerteti az adott biztonsági másolat virtuális gépek visszaállítására a párosított adatközpontba, a georedundáns biztonsági mentési tároló katasztrófa esetén használja az elsődleges adatközpont.</span><span class="sxs-lookup"><span data-stu-id="30e17-294">The document also explains the specific steps for restoring backed-up VMs to the paired data center using your geo-redundant backup vault in the case of a disaster at the primary data center.</span></span> <span data-ttu-id="30e17-295">Ebben az esetben Azure Backup segítségével a számítási szolgáltatás másodlagos régióban hozza létre a visszaállított virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="30e17-295">In that case, Azure Backup uses the Compute service from the secondary region to create the restored virtual machine.</span></span>

<span data-ttu-id="30e17-296">Használhatja a PowerShell [visszaállítását egy virtuális gép](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) vagy [lemezeket az új virtuális gép létrehozása vissza](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="30e17-296">You can also use PowerShell for [restoring a VM](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="30e17-297">Alternatív megoldás: Alkalmazáskonzisztens pillanatképek</span><span class="sxs-lookup"><span data-stu-id="30e17-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="30e17-298">Ha nem használható az Azure Backup szolgáltatás, a saját készített pillanatfelvételek segítségével történő biztonsági mentési mechanizmus valósíthat meg.</span><span class="sxs-lookup"><span data-stu-id="30e17-298">If you are unable to use the Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="30e17-299">Egy virtuális gép által használt lemezek alkalmazáskonzisztens pillanatképeket, és egy másik régióban majd replikálja ezeket a pillanatképeket bonyolult.</span><span class="sxs-lookup"><span data-stu-id="30e17-299">It is complicated to create consistent snapshots for all disks used by a VM and then replicate those snapshots to another region.</span></span> <span data-ttu-id="30e17-300">Emiatt Azure figyelembe veszi, kihasználva a biztonsági mentési szolgáltatás egy jobb megoldás, mint egy egyéni megoldás összeállításakor.</span><span class="sxs-lookup"><span data-stu-id="30e17-300">For this reason, Azure considers leveraging the Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="30e17-301">Ha RA-GRS vagy GRS-tároló lemezt használ, pillanatképeket a rendszer automatikusan replikálja egy másodlagos adatközpontba.</span><span class="sxs-lookup"><span data-stu-id="30e17-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated to a secondary data center.</span></span> <span data-ttu-id="30e17-302">Ha LRS-tároló lemezt használ, akkor replikálja az adatokat.</span><span class="sxs-lookup"><span data-stu-id="30e17-302">If you use LRS storage for disks, you will need to replicate the data yourself.</span></span> <span data-ttu-id="30e17-303">További információkért lásd: [készítsen biztonsági másolatot az Azure nem felügyelt méretű lemezek növekményes pillanatképek](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

<span data-ttu-id="30e17-304">Pillanatkép egy időben egy adott időpontban objektum ábrázolása.</span><span class="sxs-lookup"><span data-stu-id="30e17-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="30e17-305">Pillanatkép gyakorisága számlázási adatok növekményes méretének azt tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="30e17-305">A snapshot will incur billing for the incremental size of the data it holds.</span></span> <span data-ttu-id="30e17-306">További információkért lásd: [blob pillanatkép létrehozása](storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-306">For more information, see [Create a blob snapshot](storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-the-vm-is-running"></a><span data-ttu-id="30e17-307">Pillanatképeinek, a virtuális gép futása közben</span><span class="sxs-lookup"><span data-stu-id="30e17-307">Creating snapshots while the VM is running</span></span>

<span data-ttu-id="30e17-308">Bármikor is készítsen pillanatképet, ha a virtuális gép fut, miközben továbbra is fennáll a lemezek részére küldött adatok, és a pillanatképek tartalmazhat részleges műveletek, melyeket a felhőszolgáltató közötti átviteléhez.</span><span class="sxs-lookup"><span data-stu-id="30e17-308">While you can take a snapshot at any time, if the VM is running, there is still data being streamed to the disks, and the snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="30e17-309">Is ha több lemez használnak, különböző lemezek pillanatkép-készítési azért fordulhatott elő különböző időpontokban, ami azt jelenti, hogy ezeket a pillanatképeket nem lehet koordinált.</span><span class="sxs-lookup"><span data-stu-id="30e17-309">Also, if there are several disks involved, the snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="30e17-310">Ez a különösen akkor jelent problémát, amelynek fájlok megsérülhetnek, ha éppen módosítva biztonsági mentés során csíkozott kötetek.</span><span class="sxs-lookup"><span data-stu-id="30e17-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="30e17-311">Ebben a helyzetben elkerülése érdekében a biztonsági mentési folyamat implementálnia kell az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="30e17-311">To avoid this situation, the backup process must implement the following steps:</span></span>

1.  <span data-ttu-id="30e17-312">A lemezek rögzítése</span><span class="sxs-lookup"><span data-stu-id="30e17-312">Freeze all the disks</span></span>

2.  <span data-ttu-id="30e17-313">Ürítse ki az összes függőben lévő írási műveletek</span><span class="sxs-lookup"><span data-stu-id="30e17-313">Flush all the pending writes</span></span>

3.  <span data-ttu-id="30e17-314">Ezt követően [blob pillanatkép létrehozása](storage-blob-snapshots.md) lemezein</span><span class="sxs-lookup"><span data-stu-id="30e17-314">Then, [create a blob snapshot](storage-blob-snapshots.md) for all the disks</span></span>

<span data-ttu-id="30e17-315">Egyes Windows-alkalmazások, például az SQL Server egy olyan mechanizmust koordinált biztonsági mentési keresztül VSS alkalmazáskonzisztens biztonsági mentéseinek létrehozását.</span><span class="sxs-lookup"><span data-stu-id="30e17-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS to create application-consistent backups.</span></span> <span data-ttu-id="30e17-316">Linux a lemezeken, amely előállít fájlkonzisztens biztonsági mentések, de nem alkalmazáskonzisztens pillanatképeket összehangolására egy eszköz, például fsfreeze használhatja.</span><span class="sxs-lookup"><span data-stu-id="30e17-316">On Linux, you can use a tool like fsfreeze for coordinating the disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="30e17-317">Ez a folyamat bonyolult, így érdemes használni, és [Azure biztonsági mentési](../backup/backup-azure-vms-introduction.md) vagy egy külső biztonsági mentési megoldást, amely már megvalósításának.</span><span class="sxs-lookup"><span data-stu-id="30e17-317">This process is complicated, so and you should consider using [Azure Backup](../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="30e17-318">A fenti eljárás koordinált pillanatképek a virtuális gép lemezein, a virtuális gép egy adott időpontban nézet képviselő gyűjteménye eredményez.</span><span class="sxs-lookup"><span data-stu-id="30e17-318">The above process will result in a collection of coordinated snapshots for all the VM disks, representing a specific point-in-time view of the VM.</span></span> <span data-ttu-id="30e17-319">Ez a biztonsági mentés visszaállítási pont a virtuális gép számára.</span><span class="sxs-lookup"><span data-stu-id="30e17-319">This is a backup restore point for the VM.</span></span> <span data-ttu-id="30e17-320">Az eljárás megismétlésével rendszeres időközönként a rendszeres biztonsági mentések létrehozását.</span><span class="sxs-lookup"><span data-stu-id="30e17-320">You can repeat the process at scheduled intervals to create periodic backups.</span></span> <span data-ttu-id="30e17-321">Lásd az alábbi lépéseit [másolja át a biztonsági mentés egy másik régióban](#copy-the-snapshots-to-another-region) Dr.</span><span class="sxs-lookup"><span data-stu-id="30e17-321">See below for the steps to [copy the backups to another region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-the-vm-is-offline"></a><span data-ttu-id="30e17-322">Pillanatképeinek, miközben a virtuális gép offline állapotban.</span><span class="sxs-lookup"><span data-stu-id="30e17-322">Creating snapshots while the VM is offline</span></span>

<span data-ttu-id="30e17-323">Egy másik lehetőség a konzisztens biztonsági mentések létrehozását a virtuális gép leállítása vagy blob pillanatképek készítése a lemezek.</span><span class="sxs-lookup"><span data-stu-id="30e17-323">Another option to create consistent backups is shutting down the VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="30e17-324">Ez az egyszerűbb, mint a futó virtuális gépek koordináló pillanatképek, de néhány perc leállás mellett van szükség.</span><span class="sxs-lookup"><span data-stu-id="30e17-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="30e17-325">Ez a folyamat kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="30e17-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="30e17-326">Állítsa le a virtuális Gépet.</span><span class="sxs-lookup"><span data-stu-id="30e17-326">Shut down the VM.</span></span>

2. <span data-ttu-id="30e17-327">Pillanatkép létrehozása a minden Virtuálismerevlemez-blobot, amely csak a néhány másodpercet vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="30e17-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="30e17-328">Pillanatkép létrehozása, használhatja a [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), a [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), vagy az Azure Storage Ügyfélkódtáraival például egyik [a Storage ügyféloldali kódtára a .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="30e17-328">To create a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), the [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of the Azure Storage Client Libraries such as [the Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="30e17-329">Indítsa el a virtuális Gépet, ami befejezi az állásidő.</span><span class="sxs-lookup"><span data-stu-id="30e17-329">Start the VM, which ends the downtime.</span></span> <span data-ttu-id="30e17-330">Általában a teljes folyamat néhány percen belül befejeződik.</span><span class="sxs-lookup"><span data-stu-id="30e17-330">Typically the entire process completes within a few minutes.</span></span>

<span data-ttu-id="30e17-331">Ez a folyamat egy gyűjteményhez tartozó összes lemezt, a biztonsági mentés visszaállítási pontot biztosít a virtuális gép alkalmazáskonzisztens pillanatképek adja eredményül.</span><span class="sxs-lookup"><span data-stu-id="30e17-331">This process yields a collection of consistent snapshots for all the disks, providing a backup restore point for the VM.</span></span> <span data-ttu-id="30e17-332">A pillanatképek másolása egy másik régióban Dr lépéseit lásd az alábbi.</span><span class="sxs-lookup"><span data-stu-id="30e17-332">See below for the steps to copy the snapshots to another region for DR.</span></span>

### <a name="copy-the-snapshots-to-another-region"></a><span data-ttu-id="30e17-333">A pillanatképek másolása egy másik régióban</span><span class="sxs-lookup"><span data-stu-id="30e17-333">Copy the snapshots to another region</span></span>

<span data-ttu-id="30e17-334">Kizárólag pillanatképek létrehozásának nem elegendő a vész-Helyreállítási lehet.</span><span class="sxs-lookup"><span data-stu-id="30e17-334">Creation of the snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="30e17-335">Egy másik régióban is a pillanatkép biztonsági mentést kell készítenie.</span><span class="sxs-lookup"><span data-stu-id="30e17-335">You must also replicate the snapshot backups to another region.</span></span>

<span data-ttu-id="30e17-336">Ha grs-re vagy RA-GRS a lemezek használ, majd a pillanatképek replikálva vannak a másodlagos régióba automatikusan.</span><span class="sxs-lookup"><span data-stu-id="30e17-336">If you are using GRS or RA-GRS for your disks, then the snapshots are replicated to the secondary region automatically.</span></span> <span data-ttu-id="30e17-337">Nem határozható meg, a replikáció előtt lag néhány percet, és ha az elsődleges adatközpont leáll, mielőtt a pillanatképek Befejezés replikálása, nem lesz fér hozzá a pillanatképek a másodlagos adatközpont.</span><span class="sxs-lookup"><span data-stu-id="30e17-337">There can be a few minutes of lag before the replication, and if the primary data center goes down before the snapshots finish replicating, you will not be able to access the snapshots from the secondary data center.</span></span> <span data-ttu-id="30e17-338">Ez a valószínűségét nem nagy.</span><span class="sxs-lookup"><span data-stu-id="30e17-338">The likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="30e17-339">Amelyek csak a lemezeket a grs-re vagy RA-GRS-fiók nem nyújt védelmet a virtuális gép a vészhelyzetek esetére.</span><span class="sxs-lookup"><span data-stu-id="30e17-339">Only having the disks in a GRS or RA-GRS account does not protect the VM from disasters.</span></span> <span data-ttu-id="30e17-340">Kell koordinált pillanatképeket, vagy az Azure Backupot használni.</span><span class="sxs-lookup"><span data-stu-id="30e17-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="30e17-341">Ez a konzisztens állapotú virtuális gépek helyreállítása szükséges.</span><span class="sxs-lookup"><span data-stu-id="30e17-341">This is required to recover a VM to a consistent state.</span></span>

<span data-ttu-id="30e17-342">Ha LRS használ, akkor át kell másolnia a pillanatképek során eltérő tárfiók a pillanatkép létrehozása után azonnal.</span><span class="sxs-lookup"><span data-stu-id="30e17-342">If you are using LRS, you must copy the snapshots to a different storage account immediately after creating the snapshot.</span></span> <span data-ttu-id="30e17-343">A Másolás célja az LRS tárfiók más régióban, ami azt eredményezi, a példány éppen egy távoli régióban lehet.</span><span class="sxs-lookup"><span data-stu-id="30e17-343">The copy target could be an LRS storage account in a different region, resulting in the copy being in a remote region.</span></span> <span data-ttu-id="30e17-344">A pillanatkép is másolhatja az RA-GRS-tárfiókot, ugyanabban a régióban.</span><span class="sxs-lookup"><span data-stu-id="30e17-344">You can also copy the snapshot to an RA-GRS storage account in the same region.</span></span> <span data-ttu-id="30e17-345">Ebben az esetben a pillanatkép lazily replikálja a távoli másodlagos régióba.</span><span class="sxs-lookup"><span data-stu-id="30e17-345">In this case, the snapshot will be lazily replicated to the remote secondary region.</span></span> <span data-ttu-id="30e17-346">A biztonsági mentés védve van katasztrófák egyszer a másolása az elsődleges helyen, és a replikálás befejeződik.</span><span class="sxs-lookup"><span data-stu-id="30e17-346">Your backup is protected from disasters at the primary site once the copying and replication is complete.</span></span>

<span data-ttu-id="30e17-347">A növekményes pillanatképek hatékony vész-Helyreállítási másolása, tekintse át a utasításait [készítsen biztonsági másolatot az Azure nem felügyelt méretű lemezek növekményes pillanatképek](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-347">To copy your incremental snapshots for DR efficiently, review the instructions in [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

![][2]

### <a name="recovery-from-snapshots"></a><span data-ttu-id="30e17-348">A pillanatképek helyreállítás</span><span class="sxs-lookup"><span data-stu-id="30e17-348">Recovery from Snapshots</span></span>

<span data-ttu-id="30e17-349">Pillanatkép lekéréséhez másolja azt, hogy egy új blob legyen.</span><span class="sxs-lookup"><span data-stu-id="30e17-349">To retrieve a snapshot, copy it to make a new blob.</span></span> <span data-ttu-id="30e17-350">A pillanatkép másolása az elsődleges fiókból, másolhatja a pillanatkép keresztül az alap blob a pillanatkép, így, akkor a gyermekrekordokra a lemezen a pillanatkép; Ez más néven a pillanatkép támogatása.</span><span class="sxs-lookup"><span data-stu-id="30e17-350">If you are copying the snapshot from the primary account, you can copy the snapshot over to the base blob of the snapshot, thus reverting the disk to the snapshot; this is known as promoting the snapshot.</span></span> <span data-ttu-id="30e17-351">A pillanatkép biztonsági másolatából másol egy másodlagos fiókból (RA-GRS) esetén, ha egy elsődleges fiókhoz kell másolni.</span><span class="sxs-lookup"><span data-stu-id="30e17-351">If you are copying the snapshot backup from a secondary account (in the case of RA-GRS), it must be copied to a primary account.</span></span> <span data-ttu-id="30e17-352">Pillanatkép másolhatja [PowerShell-lel](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) vagy az AzCopy segédprogram használatával.</span><span class="sxs-lookup"><span data-stu-id="30e17-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using the AzCopy utility.</span></span> <span data-ttu-id="30e17-353">További információkért lásd: [adatátvitel az AzCopy parancssori segédprogram a](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-353">For more information, see [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="30e17-354">Esetén több lemezzel rendelkező virtuális gépek át kell másolnia a azonos koordinált visszaállítási pont részét képező összes pillanatképet.</span><span class="sxs-lookup"><span data-stu-id="30e17-354">In the case of VMs with multiple disks, you must copy all the snapshots that are part of the same coordinated restore point.</span></span> <span data-ttu-id="30e17-355">A pillanatképek írható VHD-blobok másolja, miután a blobok segítségével hozza létre újra a virtuális Gépet a sablon használatával a virtuális gép.</span><span class="sxs-lookup"><span data-stu-id="30e17-355">Once you copy the snapshots to writable VHD blobs, you can use the blobs to recreate your VM using the template for the VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="30e17-356">Egyéb beállítások</span><span class="sxs-lookup"><span data-stu-id="30e17-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="30e17-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="30e17-357">SQL Server</span></span>

<span data-ttu-id="30e17-358">A virtuális gépen futó SQL Server biztonsági mentés az SQL Server adatbázis Azure Blob-tároló vagy egy fájlmegosztást a saját beépített funkciókkal rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="30e17-358">SQL Server running in a VM has its own built-in capabilities to backup your SQL Server database to Azure Blob storage or a file share.</span></span> <span data-ttu-id="30e17-359">Ha a tárfiók grs-re vagy RA-GRS, elérheti azokat a biztonsági másolatok a tárfiók másodlagos adatközpont legyen katasztrófahelyzet esetén, a ugyanazok a korlátozások, korábban bemutatott.</span><span class="sxs-lookup"><span data-stu-id="30e17-359">If the storage account is GRS or RA-GRS, you can access those backups in the storage account’s secondary data center in the event of a disaster, with the same restrictions as discussed previously.</span></span> <span data-ttu-id="30e17-360">További információkért lásd: [biztonsági mentése és visszaállítása az SQL Server Azure virtuális gépek](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="30e17-361">Biztonsági mentés és helyreállítás, valamint [SQL Server Always On rendelkezésre állási csoportok](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) is fenntartható a másodlagos replikákat az adatbázisok pedig jelentősen csökkenti a vész-helyreállítási idő.</span><span class="sxs-lookup"><span data-stu-id="30e17-361">In addition to backup and restore, [SQL Server Always On Availability Groups](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases to greatly reduce the disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="30e17-362">Egyéb szempontok</span><span class="sxs-lookup"><span data-stu-id="30e17-362">Other considerations</span></span>

<span data-ttu-id="30e17-363">Ez a cikk a biztonsági mentéshez, vagy a pillanatképek készítése a virtuális gépek és a lemezek katasztrófa utáni helyreállítás támogatásához, és ezek segítségével helyreállíthat rendelkezik ismertetése.</span><span class="sxs-lookup"><span data-stu-id="30e17-363">This article has discussed how to backup or take snapshots of your VMs and their disks to support disaster recovery, and how to use those to recover.</span></span> <span data-ttu-id="30e17-364">Az Azure Resource Manager modellt sokan sablonokkal a virtuális gépek és egyéb infrastruktúrával létrehozása az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="30e17-364">With the Azure Resource Manager model, many people use templates to create their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="30e17-365">Egy sablon használatával hozzon létre egy virtuális Gépet, amely minden esetben azonos konfigurációval rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="30e17-365">You can use a template to create a VM that has the same configuration every time.</span></span> <span data-ttu-id="30e17-366">Egyéni lemezképek létrehozásához a virtuális gépek használatakor is meg kell győződnie, hogy a képek védett RA-GRS fiókkal tárolja azokat.</span><span class="sxs-lookup"><span data-stu-id="30e17-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account to store them.</span></span>

<span data-ttu-id="30e17-367">Ezért a biztonsági mentési folyamat két dolgot kombinációja lehet:</span><span class="sxs-lookup"><span data-stu-id="30e17-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="30e17-368">Biztonsági mentés az adatokat (lemez)</span><span class="sxs-lookup"><span data-stu-id="30e17-368">Backup the data (disks)</span></span>
2. <span data-ttu-id="30e17-369">A konfiguráció (sablonok, egyéni lemezképek) biztonsági mentése</span><span class="sxs-lookup"><span data-stu-id="30e17-369">Backup the configuration (templates, custom images)</span></span>

<span data-ttu-id="30e17-370">Attól függően, hogy a biztonsági mentési lehetőséget választja előfordulhat, hogy a biztonsági mentés az adatok és a konfiguráció kezeléséhez, vagy a biztonsági mentési szolgáltatás előfordulhat, hogy kezelni tudja, hogy az Ön.</span><span class="sxs-lookup"><span data-stu-id="30e17-370">Depending on the backup option you choose, you may have to handle the backup of both the data and the configuration, or the backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-the-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="30e17-371">Függelék – LRS, GRS és RA-GRS hatásának ismertetése</span><span class="sxs-lookup"><span data-stu-id="30e17-371">Appendix - Understanding the impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="30e17-372">Az Azure storage-fiókok, háromféle adatredundanciát is figyelembe kell vennie az vonatkozó vész-helyreállítási – helyileg redundáns (LRS), georedundáns (GRS), vagy georedundáns az olvasási hozzáférést (RA-GRS).</span><span class="sxs-lookup"><span data-stu-id="30e17-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="30e17-373">Megtartja a helyileg redundáns tárolás (LRS) három másolatot ugyanabban az adatközpontban lévő adatokat.</span><span class="sxs-lookup"><span data-stu-id="30e17-373">Locally Redundant Storage (LRS) retains three copies of the data in the same data center.</span></span> <span data-ttu-id="30e17-374">Az adatok írásakor, minden három másolatot frissítése előtt, hogy azok egyezését visszaérkezik a hívóhoz sikeres van.</span><span class="sxs-lookup"><span data-stu-id="30e17-374">When writing the data, all three copies are updated before success is returned to the caller, so you know they are identical.</span></span> <span data-ttu-id="30e17-375">A lemez védett a helyi hibák, mivel nem valószínű, hogy szeretné-e minden három másolatot hatása egyszerre.</span><span class="sxs-lookup"><span data-stu-id="30e17-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at the same time.</span></span> <span data-ttu-id="30e17-376">Esetén az LRS nincs redundancia, földrajzi, a lemez nem védett a végzetes hibák, amely hatással lehet egy teljes data center vagy tárolási egység.</span><span class="sxs-lookup"><span data-stu-id="30e17-376">In the case of LRS, there is no geo-redundancy, so the disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="30e17-377">Georedundáns és RA-GRS három másolatot az adatok megmaradnak az elsődleges régióban (az Ön által kiválasztott), valamint az adatok három további példányait a megfelelő másodlagos régióban (beállítása az Azure-ban) megmaradnak.</span><span class="sxs-lookup"><span data-stu-id="30e17-377">With GRS and RA-GRS, three copies of your data are retained in the primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="30e17-378">Például ha USA nyugati régiója adatokat tárolja, az adatok replikálja az USA keleti régiója.</span><span class="sxs-lookup"><span data-stu-id="30e17-378">For example, if you store data in West US, the data will be replicated to East US.</span></span> <span data-ttu-id="30e17-379">Ez a aszinkron módon történik, és frissítései az elsődleges és másodlagos kis késleltetés.</span><span class="sxs-lookup"><span data-stu-id="30e17-379">This is done asynchronously, and there is a small delay between updates to the primary and secondary.</span></span> <span data-ttu-id="30e17-380">A lemezek, a másodlagos hely replika konzisztens lemez alapú (a késés), de a több aktív lemez replikái nem lehet szinkronban **egymással**.</span><span class="sxs-lookup"><span data-stu-id="30e17-380">Replicas of the disks on the secondary site are consistent on a per-disk basis (with the delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="30e17-381">Ahhoz, hogy konzisztens replikák több lemezre, alkalmazáskonzisztens pillanatképek van szükség.</span><span class="sxs-lookup"><span data-stu-id="30e17-381">To have consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="30e17-382">A GRS és az RA-GRS közötti fő különbség a, hogy az RA-GRS, a másodlagos másolat olvasható bármikor.</span><span class="sxs-lookup"><span data-stu-id="30e17-382">The main difference between GRS and RA-GRS is that with RA-GRS, you can read the secondary copy at any time.</span></span> <span data-ttu-id="30e17-383">Az Azure-csapat megjelenítő nem érhető el az adatokat az elsődleges régióban probléma merül fel, minden erőfeszítést állítsa vissza a hozzáférést.</span><span class="sxs-lookup"><span data-stu-id="30e17-383">If there is a problem that renders the data in the primary region inaccessible, the Azure team will make every effort to restore access.</span></span> <span data-ttu-id="30e17-384">Amíg az elsődleges nem működik, ha az RA-GRS engedélyezve van, hozzáférhet-e az adatokat a másodlagos adatközpont.</span><span class="sxs-lookup"><span data-stu-id="30e17-384">While the primary is down, if you have RA-GRS enabled, you can access the data in the secondary data center.</span></span> <span data-ttu-id="30e17-385">Ezért ha azt tervezi, hogy olvassa el a replikából, amíg az elsődleges kiszolgáló nem érhető el, majd RA-GRS-érdemes figyelembe venni.</span><span class="sxs-lookup"><span data-stu-id="30e17-385">Therefore, if you plan to read from the replica while the primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="30e17-386">Ha egy jelentős leállás kell, az Azure-csapat egy földrajzi feladatátvételt indít, és módosítsa az elsődleges DNS-bejegyzéseket, mutasson a másodlagos tárterületre.</span><span class="sxs-lookup"><span data-stu-id="30e17-386">If it turns out to be a significant outage, the Azure team may trigger a geo-failover and change the primary DNS entries to point to secondary storage.</span></span> <span data-ttu-id="30e17-387">Ezen a ponton Ha bármelyik Georedundáns vagy RA-GRS engedélyezve van, akkor férhet hozzá az adatokhoz a régióban kell lennie a másodlagos használt.</span><span class="sxs-lookup"><span data-stu-id="30e17-387">At this point, if you have either GRS or RA-GRS enabled, you can access the data in the region that used to be the secondary.</span></span> <span data-ttu-id="30e17-388">Ez azt jelenti Ha a tárfiók Georedundáns és probléma merül fel, végezheti el a másodlagos tárterületre csak, ha egy földrajzi feladatátvételt.</span><span class="sxs-lookup"><span data-stu-id="30e17-388">In other words, if your storage account is GRS and there is a problem, you can access the secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="30e17-389">További információkért lásd: [Mi a teendő, ha egy Azure Storage esetleges leálláskor](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="30e17-389">For more information, see [What to do if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="30e17-390">Figyelje meg, hogy a Microsoft meghatározza, hogy egy feladatátvétel történik.</span><span class="sxs-lookup"><span data-stu-id="30e17-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="30e17-391">Feladatátvétel nem szabályozott egy tárfiókot, ezért úgy nem határoznak egyéni ügyfelek.</span><span class="sxs-lookup"><span data-stu-id="30e17-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="30e17-392">A speciális tárolási és virtuális gépek lemezeit katasztrófa utáni helyreállítás végrehajtásához a jelen cikkben korábban ismertetett módszerek kell használnia.</span><span class="sxs-lookup"><span data-stu-id="30e17-392">To implement Disaster Recovery for specific storage accounts or virtual machine disks, you must use the techniques described previously in this article.</span></span>



[1]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png
[2]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png