---
title: "az Azure infrastruktúra-szolgáltatási lemezek aaaBackup, valamint a vész helyreállítási |} Microsoft Docs"
description: "Ebben a cikkben ismertetjük hogyan tooplan a biztonsági mentés és katasztrófa utáni helyreállítás (DR) az infrastruktúra-szolgáltatási virtuális gépeket (VM) és az Azure-lemezeket. Ez a dokumentum ismerteti a felügyelt és a nem felügyelt lemezek"
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 17c697bc411fb47c4b7483b59829af1c40732ac1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 10/06/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="670a1-104">Az Azure infrastruktúra-szolgáltatási lemezek a biztonsági mentés és katasztrófa-helyreállítás</span><span class="sxs-lookup"><span data-stu-id="670a1-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="670a1-105">Ebben a cikkben ismertetjük hogyan tooplan a biztonsági mentés és katasztrófa utáni helyreállítás (DR) az infrastruktúra-szolgáltatási virtuális gépeket (VM) és az Azure-lemezeket.</span><span class="sxs-lookup"><span data-stu-id="670a1-105">In this article, we will explain how tooplan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="670a1-106">Ez a dokumentum ismerteti a felügyelt és a nem felügyelt lemezek.</span><span class="sxs-lookup"><span data-stu-id="670a1-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="670a1-107">Lesz először döntésről bővebben hello beépített tartalék tolerancia képességei hello Azure platformon, amely segítségével védelmet biztosítanak a helyi hibák.</span><span class="sxs-lookup"><span data-stu-id="670a1-107">We’ll first talk about hello built-in fault tolerance capabilities in hello Azure platform which help guard against local failures.</span></span> <span data-ttu-id="670a1-108">Majd mutatjuk hello vészhelyreállítási forgatókönyvek nem teljes mértékben hello beépített képességei, amelyek ebben a dokumentumban tárgyalt hello fő témakört.</span><span class="sxs-lookup"><span data-stu-id="670a1-108">We’ll then discuss hello disaster scenarios not fully covered by hello built-in capabilities, which is hello main topic addressed by this document.</span></span> <span data-ttu-id="670a1-109">Néhány példa munkaterhelés forgatókönyvek, ahol különböző biztonsági mentési és vész-Helyreállítási feltételek vonatkoznak, előfordulhat, hogy is mutat.</span><span class="sxs-lookup"><span data-stu-id="670a1-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="670a1-110">Azt majd áttekinti a lehetséges megoldásokról az infrastruktúra-szolgáltatási lemezek vész-Helyreállítási.</span><span class="sxs-lookup"><span data-stu-id="670a1-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="670a1-111">Bevezetés</span><span class="sxs-lookup"><span data-stu-id="670a1-111">Introduction</span></span>

<span data-ttu-id="670a1-112">hello Azure platformon a redundancia érdekében különböző módszereket használja, és tartalék tolerancia toohelp az ügyfelek a előforduló honosított hardver meghibásodásával szembeni védelemhez.</span><span class="sxs-lookup"><span data-stu-id="670a1-112">hello Azure platform uses various methods for redundancy and fault tolerance toohelp protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="670a1-113">Helyi hibák tartalmazhatják egy tároló virtuális lemez hello adatok egy részét vagy az SSD és HDD sikertelen ezen a kiszolgálón az Azure storage server gépével kapcsolatos probléma.</span><span class="sxs-lookup"><span data-stu-id="670a1-113">Local failures may include problems with an Azure storage server machine that stores part of hello data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="670a1-114">Ilyen elkülönített hardver összetevőinek meghibásodása esetén fordulhat elő, a normál működés során, és hello platform tervezett toobe rugalmas toothese hibák.</span><span class="sxs-lookup"><span data-stu-id="670a1-114">Such isolated hardware component failures can happen during normal operations and hello platform is designed toobe resilient toothese failures.</span></span> <span data-ttu-id="670a1-115">Jelentős katasztrófa hibák vagy a tároló kiszolgálók vagy a teljes adatközpont nagy számú inaccessibility eredményezhetnek.</span><span class="sxs-lookup"><span data-stu-id="670a1-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="670a1-116">Miközben a virtuális gépek és a lemezek megfelelően védettek a helyi hibák, további lépések végrehajtására-e a szükséges tooprotect az érdekében, hogy a régió kiterjedő súlyos hibák (például egy jelentős katasztrófa), amelyek hatással lehetnek a virtuális gép és a lemezek.</span><span class="sxs-lookup"><span data-stu-id="670a1-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary tooprotect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="670a1-117">Ezenkívül platform hibák toohello lehetőségét, problémák hello ügyfél alkalmazáshoz vagy az adatok akkor fordulhat elő.</span><span class="sxs-lookup"><span data-stu-id="670a1-117">In addition toohello possibility of platform failures, problems with hello customer application or data can occur.</span></span> <span data-ttu-id="670a1-118">Például az alkalmazás új verziójának véletlenül teheti a legfrissebb toohello adatok módosítása.</span><span class="sxs-lookup"><span data-stu-id="670a1-118">For example, a new version of your application may inadvertently make a breaking change toohello data.</span></span> <span data-ttu-id="670a1-119">Ebben az esetben érdemes lehet toorevert hello alkalmazás és hello adatok tooa előzetes verzióját tartalmazó hello utolsó ismerten jó állapot.</span><span class="sxs-lookup"><span data-stu-id="670a1-119">In that case, you may want toorevert hello application and hello data tooa prior version containing hello last known good state.</span></span> <span data-ttu-id="670a1-120">Ehhez a rendszeres biztonsági mentések karbantartása.</span><span class="sxs-lookup"><span data-stu-id="670a1-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="670a1-121">Regionális katasztrófa utáni helyreállítás biztonsági másolatot az infrastruktúra-szolgáltatási virtuális gép lemezek tooa más régióban.</span><span class="sxs-lookup"><span data-stu-id="670a1-121">For regional disaster recovery, you must backup your IaaS VM disks tooa different region.</span></span> 

<span data-ttu-id="670a1-122">Mielőtt úgy tekintünk, biztonsági mentési és vész-Helyreállítási beállítások, most recap néhány módszer áll rendelkezésre helyi hibák kezelése.</span><span class="sxs-lookup"><span data-stu-id="670a1-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="670a1-123">Az Azure IaaS rugalmasság</span><span class="sxs-lookup"><span data-stu-id="670a1-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="670a1-124">*Rugalmasság* toohello tolerancia hivatkozik a normál a hardverösszetevők előforduló hibákat.</span><span class="sxs-lookup"><span data-stu-id="670a1-124">*Resiliency* refers toohello tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="670a1-125">Rugalmasság hello képességét toorecover a hibák és toofunction folytatni.</span><span class="sxs-lookup"><span data-stu-id="670a1-125">Resiliency is hello ability toorecover from failures and continue toofunction.</span></span> <span data-ttu-id="670a1-126">Nincs kapcsolatos hibák elkerülése, de úgy, hogy elkerülhető az állásidő és adatvesztés toofailures válaszol.</span><span class="sxs-lookup"><span data-stu-id="670a1-126">It's not about avoiding failures, but responding toofailures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="670a1-127">hello rugalmassági célja tooreturn hello tooa teljes mértékben működő alkalmazásállapot hibát követően.</span><span class="sxs-lookup"><span data-stu-id="670a1-127">hello goal of resiliency is tooreturn hello application tooa fully functioning state following a failure.</span></span> <span data-ttu-id="670a1-128">Az Azure virtuális gépek és lemezek a tervezett toobe rugalmas toocommon hardveres hibák.</span><span class="sxs-lookup"><span data-stu-id="670a1-128">Azure Virtual Machines and Disks are designed toobe resilient toocommon hardware faults.</span></span> <span data-ttu-id="670a1-129">Ossza meg velünk tekintse meg hogyan hello Azure IaaS platform ez rugalmasságot biztosít.</span><span class="sxs-lookup"><span data-stu-id="670a1-129">Let us look at how hello Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="670a1-130">A virtuális gépek általában két részből áll: (1) A kiszolgálón, és (2) hello állandó lemezek számítási.</span><span class="sxs-lookup"><span data-stu-id="670a1-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) hello persistent disks.</span></span> <span data-ttu-id="670a1-131">Hello hibatűrés egy virtuális gép is érinti.</span><span class="sxs-lookup"><span data-stu-id="670a1-131">Both affect hello fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="670a1-132">Ha a hello Azure számítási gazdagép-kiszolgálón, amely a virtuális gép hardverhiba (amely ritka), Azure a tervezett tooautomatically visszaállítási hello virtuális gép egy másik kiszolgálón.</span><span class="sxs-lookup"><span data-stu-id="670a1-132">If hello Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed tooautomatically restore hello VM on another server.</span></span> <span data-ttu-id="670a1-133">Ez akkor fordul elő, ha újraindítás fog tapasztalni, és hello virtuális gép biztonsági mentése némi várakozás után lesz.</span><span class="sxs-lookup"><span data-stu-id="670a1-133">If this happens, you will experience a reboot, and hello VM will be back up after some time.</span></span> <span data-ttu-id="670a1-134">Azure automatikusan észleli az ilyen hardverhibák, és végrehajtja a helyreállítások toohelp győződjön meg arról, minél hamarabb hello ügyfél virtuális gép lesz elérhető.</span><span class="sxs-lookup"><span data-stu-id="670a1-134">Azure automatically detects such hardware failures and executes recoveries toohelp ensure hello customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="670a1-135">IaaS lemezekre vonatkozó adatok tartósságát fontos állandó tároló platform hello.</span><span class="sxs-lookup"><span data-stu-id="670a1-135">Regarding IaaS disks, durability of data is critical for hello persistent storage platform.</span></span> <span data-ttu-id="670a1-136">Azure-ügyfél infrastruktúra-szolgáltatáson futó üzleti alkalmazásokkal rendelkezik, és hello megőrzése hello függenek.</span><span class="sxs-lookup"><span data-stu-id="670a1-136">Azure customers have important business applications running on IaaS and they depend on hello persistence of hello data.</span></span> <span data-ttu-id="670a1-137">Azure tervek védelmét a három redundáns másolatok IaaS lemezeket helyileg tárolt adatok biztosít magas tartósság helyi hibák ellen.</span><span class="sxs-lookup"><span data-stu-id="670a1-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="670a1-138">Ha egy hello hardverösszetevők, amely tárolja a lemez meghibásodik, a virtuális gép nem változik, mert nincsenek két további másolatokat toosupport kérésekre.</span><span class="sxs-lookup"><span data-stu-id="670a1-138">If one of hello hardware components that holds your disk fails, your VM is not impacted because there are two additional copies toosupport disk requests.</span></span> <span data-ttu-id="670a1-139">Jól működik akkor is, ha a lemez támogató két különböző hardverösszetevők meghiúsulhatnak hello azonos idő (amely általában nagyon ritkán).</span><span class="sxs-lookup"><span data-stu-id="670a1-139">It works fine even if two different hardware components supporting a disk fail at hello same time (which would be very rare).</span></span> <span data-ttu-id="670a1-140">toohelp győződjön meg arról, hogy mindig karbantartása három replikák, hello Azure Storage szolgáltatás automatikusan indít hello háttérben adatok egy új példányát, ha egy hello három példányban nem érhető el.</span><span class="sxs-lookup"><span data-stu-id="670a1-140">toohelp ensure we always maintain three replicas, hello Azure Storage service automatically spawns a new copy of data in hello background if one of hello three copies becomes unavailable.</span></span> <span data-ttu-id="670a1-141">Emiatt nem kell az Azure-lemezeket a hibatűrés szükséges toouse RAID.</span><span class="sxs-lookup"><span data-stu-id="670a1-141">Therefore, it should not be necessary toouse RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="670a1-142">Egy egyszerű RAID 0 konfigurációs legyen elegendő hello lemezek szétosztott, ha a szükséges toocreate nagyobb méretű köteteket.</span><span class="sxs-lookup"><span data-stu-id="670a1-142">A simple RAID 0 configuration should be sufficient for striping hello disks if necessary toocreate larger volumes.</span></span>

<span data-ttu-id="670a1-143">Ebben az architektúrában miatt **Azure következetesen rendelkezik kézbesíteni a vállalati szintű tartósságot, az infrastruktúra-szolgáltatási lemezek, egy iparágvezető a nulla % [Annualized hibaaránya](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span><span class="sxs-lookup"><span data-stu-id="670a1-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="670a1-144">Honosított hardver hibák hello a gazdagép vagy hello tárolási platform néha okozhat a virtuális gép, amely a hello hello átmeneti elérhetetlenség számítási [Azure garantált szolgáltatási szintje](https://azure.microsoft.com/support/legal/sla/virtual-machines/) a virtuális gép rendelkezésre állás érdekében.</span><span class="sxs-lookup"><span data-stu-id="670a1-144">Localized hardware faults on hello compute host or in hello storage platform can sometimes result in temporary unavailability for hello VM which is covered by hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="670a1-145">Azure iparágvezető szolgáltatásiszint-szerződésben garantált is biztosít, a prémium szintű Storage lemezeket használó egyetlen Virtuálisgép-példányok.</span><span class="sxs-lookup"><span data-stu-id="670a1-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="670a1-146">toosafeguard alkalmazások és szolgáltatások a lemez-vagy virtuális gép toohello elérhetetlenség miatt állásidő, az ügyfelek kihasználhatják a [rendelkezésre állási készletek](../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-146">toosafeguard application workloads from downtime due toohello temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="670a1-147">Két vagy több virtuális gépek rendelkezésre állási csoport számára biztosít redundanciát hello alkalmazáshoz.</span><span class="sxs-lookup"><span data-stu-id="670a1-147">Two or more virtual machines in an availability set provides redundancy for hello application.</span></span> <span data-ttu-id="670a1-148">Azure majd hoz létre a virtuális gépek és a lemezek külön tartalék tartományok különböző tápellátáshoz, a hálózati és a kiszolgáló-összetevők.</span><span class="sxs-lookup"><span data-stu-id="670a1-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="670a1-149">Ebből kifolyólag honosított hardver meghibásodása általában nem befolyásolják hello hello állítsa be a több virtuális gép magas rendelkezésre állás biztosítása az alkalmazás egy időben.</span><span class="sxs-lookup"><span data-stu-id="670a1-149">Thus, localized hardware failures typically do not affect multiple VMs in hello set at hello same time, providing high availability for your application.</span></span> <span data-ttu-id="670a1-150">Egy jó gyakorlat toouse rendelkezésre állási készletek, amikor szükség a magas rendelkezésre állású számít.</span><span class="sxs-lookup"><span data-stu-id="670a1-150">It is considered a good practice toouse availability sets when high availability is required.</span></span> <span data-ttu-id="670a1-151">További információkért lásd: hello vész-helyreállítási szempontok részletes alatt.</span><span class="sxs-lookup"><span data-stu-id="670a1-151">For more information, see hello Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="670a1-152">Biztonsági mentés és katasztrófa utáni helyreállítás</span><span class="sxs-lookup"><span data-stu-id="670a1-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="670a1-153">Vészhelyreállítás (DR) hello képességét toorecover a ritka, de jelentős események: nem átmeneti, szinten hibák, például egy teljes terület érintő üzemkimaradás időtartamát.</span><span class="sxs-lookup"><span data-stu-id="670a1-153">Disaster recovery (DR) is hello ability toorecover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="670a1-154">Vész-helyreállítási magában foglalja az adatok biztonsági mentése és az archiválásra, és előfordulhat, hogy tartalmazza a manuális beavatkozásra, például egy adatbázis biztonsági másolatból történő visszaállítását.</span><span class="sxs-lookup"><span data-stu-id="670a1-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="670a1-155">hello Azure platformon beépített védelmet biztosít a helyi hibák lehetséges, hogy nem teljes védelme érdekében hello virtuális gépek/lemezek hello esetében jelentős katasztrófa, amelyek nagy méretű kimaradások esetén.</span><span class="sxs-lookup"><span data-stu-id="670a1-155">hello Azure platform’s built-in protection against localized failures may not fully protect hello VMs/disks in hello case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="670a1-156">Ez magában foglalja a katasztrofális esemény, például egy Hurrikán, földrengés, tűz vagy nagy méretű méretezési egység hardverhibák alatt kattintson az adatközpontban.</span><span class="sxs-lookup"><span data-stu-id="670a1-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="670a1-157">Ezenkívül tooapplication vagy adatok problémák miatt hibák fordulhatnak.</span><span class="sxs-lookup"><span data-stu-id="670a1-157">In addition, you may encounter failures due tooapplication or data issues.</span></span>

<span data-ttu-id="670a1-158">toohelp az IaaS munkaterhelések védelme a kimaradások, meg kell terveznie a redundancia és a biztonsági mentések tooenable helyreállításhoz.</span><span class="sxs-lookup"><span data-stu-id="670a1-158">toohelp protect your IaaS workloads from outages, you should plan for redundancy and backups tooenable recovery.</span></span> <span data-ttu-id="670a1-159">A vészhelyreállítás esetében meg kell terveznie a redundancia és a biztonsági mentés befejeződött hello elsődleges hely különböző földrajzi helyen.</span><span class="sxs-lookup"><span data-stu-id="670a1-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from hello primary site.</span></span> <span data-ttu-id="670a1-160">Ez biztosítja a biztonsági másolat nem érinti a hello ugyanarra az eseményre, amely eredetileg érintett hello VM vagy a lemezeket.</span><span class="sxs-lookup"><span data-stu-id="670a1-160">This helps ensure your backup is not affected by hello same event that originally impacted hello VM or disks.</span></span> <span data-ttu-id="670a1-161">További információkért lásd: [alkalmazások vész-helyreállítási épülő Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span><span class="sxs-lookup"><span data-stu-id="670a1-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="670a1-162">A vész-Helyreállítási szempontok lehetnek hello a következő szempontokat:</span><span class="sxs-lookup"><span data-stu-id="670a1-162">Your DR considerations may include hello following aspects:</span></span>

1. <span data-ttu-id="670a1-163">Magas rendelkezésre állású (HA) hello alkalmazás toocontinue állapota kifogástalan, jelentős állásidőt nélkül fut hello képességét.</span><span class="sxs-lookup"><span data-stu-id="670a1-163">High Availability (HA) is hello ability of hello application toocontinue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="670a1-164">"Kifogástalan állapot," által jelenleg: hello alkalmazás működik-e, és a felhasználók toohello alkalmazás csatlakozás és használhatja őket.</span><span class="sxs-lookup"><span data-stu-id="670a1-164">By "healthy state," we mean hello application is responsive, and users can connect toohello application and interact with it.</span></span> <span data-ttu-id="670a1-165">Egyes kritikus fontosságú alkalmazások és az adatbázisok lehet szükséges toobe elérhető mindig, még akkor is, ha nincsenek hibák hello platform.</span><span class="sxs-lookup"><span data-stu-id="670a1-165">Certain mission-critical applications and databases may be required toobe available always, even when there are failures in hello platform.</span></span> <span data-ttu-id="670a1-166">A munkaterhelések esetén szükség lehet a tooplan redundancia hello alkalmazás, valamint a hello adatok.</span><span class="sxs-lookup"><span data-stu-id="670a1-166">For these workloads, you may need tooplan redundancy for hello application as well as hello data.</span></span>

2. <span data-ttu-id="670a1-167">Adatok tartóssága: Bizonyos esetekben hello legfontosabb szempont annak ellenőrzése hello adatok megmaradjanak hello esetében egy olyan vészhelyzet esetén.</span><span class="sxs-lookup"><span data-stu-id="670a1-167">Data Durability: In some cases, hello main consideration is ensuring hello data is preserved in hello case of a disaster.</span></span> <span data-ttu-id="670a1-168">Ezért szükség lehet egy másik helyen az adatok biztonsági másolata.</span><span class="sxs-lookup"><span data-stu-id="670a1-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="670a1-169">Ilyen munkaterhelések esetén előfordulhat, hogy nem kell teljes redundancia hello alkalmazáshoz, de hello lemezek rendszeres biztonsági másolatot.</span><span class="sxs-lookup"><span data-stu-id="670a1-169">For such workloads, you may not need full redundancy for hello application, but a regular backup of hello disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="670a1-170">Biztonsági mentési és vész-Helyreállítási forgatókönyvek</span><span class="sxs-lookup"><span data-stu-id="670a1-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="670a1-171">Vizsgáljuk meg az alkalmazás munkaterhelés-forgatókönyvek és vész-helyreállítási tervezési szempontjai hello néhány tipikus példája.</span><span class="sxs-lookup"><span data-stu-id="670a1-171">Let’s look at a few typical examples of application workload scenarios and hello considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="670a1-172">1. forgatókönyv: Fő adatbázis megoldások</span><span class="sxs-lookup"><span data-stu-id="670a1-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="670a1-173">Vegye figyelembe például az SQL Server vagy Oracle, amely támogatja a magas rendelkezésre állású éles adatbázis-kiszolgálót.</span><span class="sxs-lookup"><span data-stu-id="670a1-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="670a1-174">Kritikus termelési alkalmazások és a felhasználók ezt az adatbázist függ.</span><span class="sxs-lookup"><span data-stu-id="670a1-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="670a1-175">a rendszer hello vész-helyreállítási terv esetleg toosupport hello követelményeknek:</span><span class="sxs-lookup"><span data-stu-id="670a1-175">hello Disaster Recovery plan for this system may need toosupport hello following requirements:</span></span>

1. <span data-ttu-id="670a1-176">Az adatok védett és helyreállítható kell lennie.</span><span class="sxs-lookup"><span data-stu-id="670a1-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="670a1-177">Lehet, hogy a kiszolgáló használható.</span><span class="sxs-lookup"><span data-stu-id="670a1-177">Server must be available for use.</span></span>

<span data-ttu-id="670a1-178">Elképzelhető, hogy szükség karbantartása hello adatbázis biztonsági mentéséhez egy másik régióban.</span><span class="sxs-lookup"><span data-stu-id="670a1-178">This may require maintaining a replica of hello database in a different region as a backup.</span></span> <span data-ttu-id="670a1-179">Attól függően, hogy a kiszolgáló rendelkezésre állása és az adat-helyreállítás hello követelményei hello megoldás terjedhet egy aktív-aktív vagy aktív-passzív replika hely tooperiodic offline biztonsági mentés hello adatok.</span><span class="sxs-lookup"><span data-stu-id="670a1-179">Depending on hello requirements for server availability and data recovery, hello solution could range from an Active-Active or Active-Passive replica site tooperiodic offline backups of hello data.</span></span> <span data-ttu-id="670a1-180">Például az SQL Server és Oracle relációs adatbázisok replikációs különböző lehetőségeket biztosítanak.</span><span class="sxs-lookup"><span data-stu-id="670a1-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="670a1-181">Az SQL Server [SQL Server Always On rendelkezésre állási csoportok](https://msdn.microsoft.com/library/hh510230.aspx) magas rendelkezésre állás is használható.</span><span class="sxs-lookup"><span data-stu-id="670a1-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="670a1-182">MongoDB hasonló NoSQL-adatbázisok is támogatja a [replikák](https://docs.mongodb.com/manual/replication/) a redundancia érdekében.</span><span class="sxs-lookup"><span data-stu-id="670a1-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="670a1-183">a magas rendelkezésre állású hello replikák használható.</span><span class="sxs-lookup"><span data-stu-id="670a1-183">hello replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="670a1-184">2. forgatókönyv: Egy fürt redundáns virtuális gépek</span><span class="sxs-lookup"><span data-stu-id="670a1-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="670a1-185">Érdemes lehet a munkaterhelés, a fürt virtuális gépeket, a redundanciát és terheléselosztást kezeli.</span><span class="sxs-lookup"><span data-stu-id="670a1-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="670a1-186">Egy példa erre egy Cassandra fürt üzembe helyezett egy régiót.</span><span class="sxs-lookup"><span data-stu-id="670a1-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="670a1-187">Az ilyen típusú architektúra már biztosít magas szintű redundancia adott régión belül.</span><span class="sxs-lookup"><span data-stu-id="670a1-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="670a1-188">Azonban tooprotect hello munkaterhelés, a regionális szintű meghibásodása, érdemes vagy a rendszeres biztonsági mentést tooanother régió hello fürt két régióban is terjednek.</span><span class="sxs-lookup"><span data-stu-id="670a1-188">However, tooprotect hello workload from a regional level failure, you should consider spreading hello cluster across two regions or making periodic backups tooanother region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="670a1-189">3. forgatókönyv: Infrastruktúra-szolgáltatási alkalmazás munkaterhelés</span><span class="sxs-lookup"><span data-stu-id="670a1-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="670a1-190">Ennek oka lehet egy tipikus környezet munkaterhelés egy Azure virtuális gépen.</span><span class="sxs-lookup"><span data-stu-id="670a1-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="670a1-191">Például annak oka lehet egy webkiszolgáló vagy a fájlkiszolgáló hello tartalom és a hely más erőforrásokat.</span><span class="sxs-lookup"><span data-stu-id="670a1-191">For example, it could be a web server or file server holding hello content and other resources of a site.</span></span> <span data-ttu-id="670a1-192">Egy egyedi üzleti alkalmazást, amely az adatok, erőforrások és alkalmazásállapot lemezen tárolja a hello méretű is lehet.</span><span class="sxs-lookup"><span data-stu-id="670a1-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on hello VM disks.</span></span> <span data-ttu-id="670a1-193">Ebben az esetben is fontos toomake meg arról, hogy a biztonsági mentések rendszeresen igénybe vehet.</span><span class="sxs-lookup"><span data-stu-id="670a1-193">In this case, it is important toomake sure you take backups on a regular basis.</span></span> <span data-ttu-id="670a1-194">Biztonsági mentési gyakoriság alapján hello VM munkaterhelés hello jellegét.</span><span class="sxs-lookup"><span data-stu-id="670a1-194">Backup frequency should be based on hello nature of hello VM workload.</span></span> <span data-ttu-id="670a1-195">Például ha hello alkalmazás naponta fut, és módosítja az adatokat, majd hello biztonsági mentést kell fordítani óránként.</span><span class="sxs-lookup"><span data-stu-id="670a1-195">For example, if hello application runs every day and modifies data, then hello backup should be taken every hour.</span></span>

<span data-ttu-id="670a1-196">Egy másik példa a jelentéskészítő kiszolgáló más forrásokból származó adatok lekéréses és összesített jelentéseket hoz létre.</span><span class="sxs-lookup"><span data-stu-id="670a1-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="670a1-197">A virtuális gép vagy lemezek hello jelentések toohello megszűnését irányítja.</span><span class="sxs-lookup"><span data-stu-id="670a1-197">Loss of this VM or disks will lead toohello loss of hello reports.</span></span> <span data-ttu-id="670a1-198">Azonban lehetséges toorerun hello jelentéskészítési folyamat kimenet újragenerálása hello lehet.</span><span class="sxs-lookup"><span data-stu-id="670a1-198">However, it may be possible toorerun hello reporting process and regenerate hello output.</span></span> <span data-ttu-id="670a1-199">Ebben az esetben valóban nincs adatvesztést akkor is, ha egy olyan vészhelyzet esetén a találati hello által használandó jelentéskészítő kiszolgáló, így magasabb szintű tűréshatár elvesztése a jelentéskészítő kiszolgáló hello hello adatok egy részét sikerült kell.</span><span class="sxs-lookup"><span data-stu-id="670a1-199">In that case, you don’t really have a loss of data even if hello reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of hello data on hello reporting server.</span></span> <span data-ttu-id="670a1-200">Ebben az esetben ritkábban biztonsági mentések egy beállítás tooreduce hello költséget.</span><span class="sxs-lookup"><span data-stu-id="670a1-200">In that case, less frequent backups is an option tooreduce hello cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="670a1-201">4. forgatókönyv: Az infrastruktúra-szolgáltatási alkalmazás adatok kapcsolatos problémákat</span><span class="sxs-lookup"><span data-stu-id="670a1-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="670a1-202">Van olyan alkalmazás, amely kiszámítja, tart fenn és kritikus kereskedelmi forgalomban beszerezhető adatok, például a díjszabásról szolgál.</span><span class="sxs-lookup"><span data-stu-id="670a1-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="670a1-203">Az alkalmazás új verziójának szoftver programhiba helytelenül számított hello árképzési és hello hello platform által kiszolgált meglévő commerce adatok sérült volt.</span><span class="sxs-lookup"><span data-stu-id="670a1-203">A new version of your application had a software bug which incorrectly computed hello pricing and corrupted hello existing commerce data served by hello platform.</span></span> <span data-ttu-id="670a1-204">Itt, a helyes intézkedéseket hello lenne toorevert toohello hello alkalmazás és az adatok hello korábbi verziójának első.</span><span class="sxs-lookup"><span data-stu-id="670a1-204">Here, hello best course of action would be toorevert toohello earlier version of hello application and hello data first.</span></span> <span data-ttu-id="670a1-205">tooenable a, hajtsa végre a megfelelő rendszeres biztonsági mentést a rendszer.</span><span class="sxs-lookup"><span data-stu-id="670a1-205">tooenable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="670a1-206">Vész-helyreállítási megoldást: Azure biztonsági mentési szolgáltatás</span><span class="sxs-lookup"><span data-stu-id="670a1-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="670a1-207">[Az Azure Backup szolgáltatás](https://azure.microsoft.com/services/backup/) biztonsági mentési és vész-Helyreállítási is használható, és működik együtt a [kezelt lemezek](storage-managed-disks-overview.md) , valamint [nem felügyelt lemezek](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="670a1-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](storage-managed-disks-overview.md) as well as [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span></span> <span data-ttu-id="670a1-208">Az idő-alapú biztonsági mentések, könnyű VM-helyreállítás és biztonsági másolatok megőrzésének házirendek segítségével hozhat létre egy biztonsági mentési feladat.</span><span class="sxs-lookup"><span data-stu-id="670a1-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="670a1-209">Ha [prémium szintű Storage lemezek](storage-premium-storage.md), [kezelt lemezek](storage-managed-disks-overview.md), vagy más lemeztípusok esetén a hello [helyileg redundáns tárolás (LRS)](storage-redundancy.md#locally-redundant-storage) beállítást, különösen fontos tooleverage DR rendszeres biztonsági mentést.</span><span class="sxs-lookup"><span data-stu-id="670a1-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](storage-managed-disks-overview.md), or other disk types with hello [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important tooleverage periodic DR backups.</span></span> <span data-ttu-id="670a1-210">Az Azure biztonsági mentést a Recovery Services-tároló, a hosszú távú megőrzési hello adatokat tárolja.</span><span class="sxs-lookup"><span data-stu-id="670a1-210">Azure Backup stores hello data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="670a1-211">Válassza ki a hello [georedundáns tárolás (GRS)](storage-redundancy.md#geo-redundant-storage) a hello biztonsági mentés Recovery Services-tároló lehetőséget.</span><span class="sxs-lookup"><span data-stu-id="670a1-211">Choose hello [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for hello Backup Recovery Services vault.</span></span> <span data-ttu-id="670a1-212">Amely biztosítja, biztonsági mentések replikált tooa különböző Azure-régiót a regionális katasztrófák védelmére.</span><span class="sxs-lookup"><span data-stu-id="670a1-212">That will ensure backups are replicated tooa different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="670a1-213">A [nem felügyelt lemezek](storage-about-disks-and-vhds-windows.md#unmanaged-disks), az infrastruktúra-szolgáltatási lemezek hello LRS tárolási típust használja, de győződjön meg arról, hogy az Azure Backup szolgáltatás engedélyezve van-e a Recovery Services-tároló hello Georedundáns beállítást hello.</span><span class="sxs-lookup"><span data-stu-id="670a1-213">For [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks), you can use hello LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with hello GRS option for hello Recovery Services Vault.</span></span>

<span data-ttu-id="670a1-214">**Ha hello [Georedundáns](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) beállítás megadása után még a nem felügyelt lemezek kell alkalmazáskonzisztens pillanatképeket vonatkozó biztonsági mentési és vész-Helyreállítási.**</span><span class="sxs-lookup"><span data-stu-id="670a1-214">**If you use hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="670a1-215">Egyikét kell használnia [Azure Backup szolgáltatás](https://azure.microsoft.com/services/backup/) vagy [alkalmazáskonzisztens pillanatképek](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="670a1-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="670a1-216">hello vész-Helyreállítási megoldások összefoglalása látható.</span><span class="sxs-lookup"><span data-stu-id="670a1-216">hello following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="670a1-217">Forgatókönyv</span><span class="sxs-lookup"><span data-stu-id="670a1-217">Scenario</span></span> | <span data-ttu-id="670a1-218">Automatikus replikáció</span><span class="sxs-lookup"><span data-stu-id="670a1-218">Automatic Replication</span></span> | <span data-ttu-id="670a1-219">Vész-Helyreállítási megoldás</span><span class="sxs-lookup"><span data-stu-id="670a1-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="670a1-220">*Prémium szintű Storage-lemezekhez*</span><span class="sxs-lookup"><span data-stu-id="670a1-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="670a1-221">Helyi ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="670a1-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="670a1-222">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="670a1-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="670a1-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="670a1-223">*Managed Disks*</span></span> | <span data-ttu-id="670a1-224">Helyi ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="670a1-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="670a1-225">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="670a1-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="670a1-226">*Nem felügyelt LRS-lemezek*</span><span class="sxs-lookup"><span data-stu-id="670a1-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="670a1-227">Helyi ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="670a1-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="670a1-228">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="670a1-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="670a1-229">*Nem felügyelt Georedundáns lemezek*</span><span class="sxs-lookup"><span data-stu-id="670a1-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="670a1-230">Több régióban ([Georedundáns](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="670a1-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="670a1-231">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="670a1-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="670a1-232">Alkalmazáskonzisztens pillanatképek</span><span class="sxs-lookup"><span data-stu-id="670a1-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="670a1-233">*Nem felügyelt RA-GRS-lemezek*</span><span class="sxs-lookup"><span data-stu-id="670a1-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="670a1-234">Több régióban ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="670a1-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="670a1-235">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="670a1-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="670a1-236">Alkalmazáskonzisztens pillanatképek</span><span class="sxs-lookup"><span data-stu-id="670a1-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="670a1-237">Magas rendelkezésre állású, legjobban érheti hello használata felügyelt lemezeinek rendelkezésre állási csoport együtt az Azure Backup szolgáltatásnál.</span><span class="sxs-lookup"><span data-stu-id="670a1-237">High availability can best by met through hello use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="670a1-238">Nem felügyelt lemezt használ, ha a vész-Helyreállítási továbbra is használhatja a Azure Backup szolgáltatásnál.</span><span class="sxs-lookup"><span data-stu-id="670a1-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="670a1-239">Ha nem toouse Azure biztonsági mentés, majd véve [alkalmazáskonzisztens pillanatképek](#alternative-solution-consistent-snapshots) leírtak szerint egy későbbi szakasz ismerteti a biztonsági mentési és vész-Helyreállítási alternatív megoldást-e.</span><span class="sxs-lookup"><span data-stu-id="670a1-239">If you are unable toouse Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="670a1-240">A választott a magas rendelkezésre állás érdekében biztonsági mentési és vész-Helyreállítási alkalmazást vagy az infrastruktúra szintjén, az alábbiakban ábrázolhatók:</span><span class="sxs-lookup"><span data-stu-id="670a1-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="670a1-241">*Szint*</span><span class="sxs-lookup"><span data-stu-id="670a1-241">*Level*</span></span> | <span data-ttu-id="670a1-242">Magas rendelkezésre állás</span><span class="sxs-lookup"><span data-stu-id="670a1-242">High Availability</span></span>   | <span data-ttu-id="670a1-243">Biztonsági mentés / DR</span><span class="sxs-lookup"><span data-stu-id="670a1-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="670a1-244">*Alkalmazás*</span><span class="sxs-lookup"><span data-stu-id="670a1-244">*Application*</span></span> | <span data-ttu-id="670a1-245">Always On SQL</span><span class="sxs-lookup"><span data-stu-id="670a1-245">SQL Always On</span></span> | <span data-ttu-id="670a1-246">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="670a1-246">Azure Backup</span></span> |
| <span data-ttu-id="670a1-247">*Infrastruktúra*</span><span class="sxs-lookup"><span data-stu-id="670a1-247">*Infrastructure*</span></span>  | <span data-ttu-id="670a1-248">Rendelkezésre állási csoport</span><span class="sxs-lookup"><span data-stu-id="670a1-248">Availability Set</span></span>  | <span data-ttu-id="670a1-249">Az alkalmazáskonzisztens pillanatképek Georedundáns</span><span class="sxs-lookup"><span data-stu-id="670a1-249">GRS with consistent snapshots</span></span> |

### <a name="using-hello-azure-backup-service"></a><span data-ttu-id="670a1-250">Hello Azure Backup szolgáltatás használatával</span><span class="sxs-lookup"><span data-stu-id="670a1-250">Using hello Azure Backup Service</span></span>

<span data-ttu-id="670a1-251">[Azure biztonsági mentés](../backup/backup-azure-vms-introduction.md) tud biztonsági másolatot készíteni a Windows vagy Linux toohello Azure Recovery Services-tároló futó virtuális gépeket.</span><span class="sxs-lookup"><span data-stu-id="670a1-251">[Azure Backup](../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux toohello Azure Recovery Services Vault.</span></span> <span data-ttu-id="670a1-252">Biztonsági mentése és visszaállítása az üzleti szempontból kritikus fontosságú adatok van bonyolítja hello tényt, hogy üzleti szempontból kritikus fontosságú adatok kell biztonsági mentése közben hello alkalmazások, amelyek hello adatok futnak egymással.</span><span class="sxs-lookup"><span data-stu-id="670a1-252">Backing up and restoring business-critical data is complicated by hello fact that business-critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="670a1-253">tooaddress az Azure Backup alkalmazáskonzisztens biztonsági mentések Microsoft-munkaterhelések segítségével biztosítja, hogy adatot ír megfelelően toostorage hello kötet árnyékmásolata szolgáltatás (VSS) tooensure.</span><span class="sxs-lookup"><span data-stu-id="670a1-253">tooaddress this, Azure Backup provides application-consistent backups for Microsoft workloads by using hello Volume Shadow Service (VSS) tooensure that data is written correctly toostorage.</span></span> <span data-ttu-id="670a1-254">Linux virtuális gépekhez csak a fájlkonzisztens biztonsági mentések is előfordulhatnak, Linux nem tartozik megfelelő tooVSS funkció.</span><span class="sxs-lookup"><span data-stu-id="670a1-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent tooVSS.</span></span>

![][1]

<span data-ttu-id="670a1-255">Azure biztonsági mentési indít el egy biztonsági mentési feladat hello ütemezett időpontban, elindítja a telepített virtuális gép tootake időpontban pillanatkép hello hello tartalék mellék.</span><span class="sxs-lookup"><span data-stu-id="670a1-255">When Azure Backup initiates a backup job at hello scheduled time, it triggers hello backup extension installed in hello VM tootake a point-in-time snapshot.</span></span> <span data-ttu-id="670a1-256">A rendszer pillanatképet készít hello virtuális gép lemezeinek hello VSS tooget alkalmazáskonzisztens pillanatfelvételi együttműködve anélkül, hogy tooshut azt le.</span><span class="sxs-lookup"><span data-stu-id="670a1-256">A snapshot is taken in coordination with VSS tooget a consistent snapshot of hello disks in hello virtual machine without having tooshut it down.</span></span> <span data-ttu-id="670a1-257">hello biztonsági mentési bővítményt a virtuális gép hello kiürítése minden írás előtt az összes hello lemez a hello konzisztens pillanatképének készítése.</span><span class="sxs-lookup"><span data-stu-id="670a1-257">hello backup extension in hello VM flushes all writes before taking hello consistent snapshot of all hello disks.</span></span> <span data-ttu-id="670a1-258">Miután hello pillanatképet készít, hello adatátvitel által toohello Azure Backup mentési tároló.</span><span class="sxs-lookup"><span data-stu-id="670a1-258">After hello snapshot is taken, hello data is transferred by Azure Backup toohello backup vault.</span></span> <span data-ttu-id="670a1-259">toomake hello biztonsági mentési folyamat sokkal hatékonyabb, hello szolgáltatás azonosítja, és csak a hello utolsó biztonsági mentés óta megváltoztak adattípusnak hello blokkok átvitele.</span><span class="sxs-lookup"><span data-stu-id="670a1-259">toomake hello backup process more efficient, hello service identifies and transfers only hello blocks of data that have changed since hello last backup.</span></span>


<span data-ttu-id="670a1-260">toorestore, hello elérhető biztonsági másolatok Azure Backup segítségével tekintheti meg és majd indítsa el a visszaállítást.</span><span class="sxs-lookup"><span data-stu-id="670a1-260">toorestore, you can view hello available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="670a1-261">Hozzon létre, és állítsa vissza az Azure biztonsági mentések hello keresztül [Azure-portálon](https://portal.azure.com/), [PowerShell használatával](../backup/backup-azure-vms-automation.md ), vagy hello segítségével [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="670a1-261">You can create and restore Azure backups through hello [Azure portal](https://portal.azure.com/), [using PowerShell](../backup/backup-azure-vms-automation.md ), or using hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="670a1-262">További információkért tekintse meg az Azure biztonsági mentés.</span><span class="sxs-lookup"><span data-stu-id="670a1-262">For more information, see Azure Backup.</span></span>

### <a name="steps-tooenable-backup"></a><span data-ttu-id="670a1-263">Lépéseket tooEnable biztonsági mentése</span><span class="sxs-lookup"><span data-stu-id="670a1-263">Steps tooEnable Backup</span></span>

<span data-ttu-id="670a1-264">hello lépések megegyeznek a virtuális gépek hello általánosan használt tooenable biztonsági másolatainak [Azure Portal](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="670a1-264">hello following steps are typically used tooenable backups of your VMs using hello [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="670a1-265">A pontos forgatókönyvtől függően változata lesz.</span><span class="sxs-lookup"><span data-stu-id="670a1-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="670a1-266">Tekintse meg a toohello [Azure biztonsági mentés](../backup/backup-azure-vms-introduction.md) teljes dokumentációjában.</span><span class="sxs-lookup"><span data-stu-id="670a1-266">Refer toohello [Azure Backup](../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="670a1-267">Azure biztonsági mentés is [támogatja a felügyelt lemezzel rendelkező virtuális gépek](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="670a1-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="670a1-268">A recovery services-tároló létrehozása a virtuális gépek lépések hello használata:</span><span class="sxs-lookup"><span data-stu-id="670a1-268">Create a recovery services vault for a VM using hello following steps:</span></span>

    <span data-ttu-id="670a1-269">a.</span><span class="sxs-lookup"><span data-stu-id="670a1-269">a.</span></span>  <span data-ttu-id="670a1-270">Hello segítségével [Azure-portálon](https://portal.azure.com/), keresse meg az összes erőforrást és a "Recovery Services-tárolók" található.</span><span class="sxs-lookup"><span data-stu-id="670a1-270">Using hello [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="670a1-271">b.</span><span class="sxs-lookup"><span data-stu-id="670a1-271">b.</span></span>  <span data-ttu-id="670a1-272">Hello a Recovery Services-tárolók menüben, kattintson a Hozzáadás gombra, és kövesse a hello lépéseket toocreate egy új tárolót a hello hello VM és ugyanabban a régióban.</span><span class="sxs-lookup"><span data-stu-id="670a1-272">On hello Recovery Services vaults menu, click Add and follow hello steps toocreate a new vault in hello same region as hello VM.</span></span> <span data-ttu-id="670a1-273">Például ha a virtuális gép USA nyugati régiója régióban, válasszon USA nyugati régiója hello tároló.</span><span class="sxs-lookup"><span data-stu-id="670a1-273">For example, if your VM is in West US region, pick West US for hello vault.</span></span>

2.  <span data-ttu-id="670a1-274">Ellenőrizze a tárolóban található, újonnan létrehozott hello hello tárolóreplikálást.</span><span class="sxs-lookup"><span data-stu-id="670a1-274">Verify hello Storage replication for hello newly created vault.</span></span> <span data-ttu-id="670a1-275">toodo, hozzáférési hello tárolóhoz hello Recovery Services tárolók panelen, majd a toohello beállítások/biztonsági másolatból konfigurációs.</span><span class="sxs-lookup"><span data-stu-id="670a1-275">toodo this, access hello vault from hello Recovery Services vaults blade and go toohello settings/Backup Configuration.</span></span> <span data-ttu-id="670a1-276">Győződjön meg arról, alapértelmezés szerint hello Georedundáns lehetőség van kiválasztva.</span><span class="sxs-lookup"><span data-stu-id="670a1-276">Ensure hello GRS option is selected by default.</span></span> <span data-ttu-id="670a1-277">Ez biztosítja, hogy a tároló automatikusan replikált tooa másodlagos adatközpont.</span><span class="sxs-lookup"><span data-stu-id="670a1-277">This will ensure that your vault is automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="670a1-278">Például a tároló az USA nyugati régiója lesz automatikusan replikált tooEast USA.</span><span class="sxs-lookup"><span data-stu-id="670a1-278">For example, your vault in West US will be automatically replicated tooEast US.</span></span>

3.  <span data-ttu-id="670a1-279">Hello biztonsági mentési házirend konfigurálása, és válassza ki a virtuális gép hello hello a ugyanabban a szövegben.</span><span class="sxs-lookup"><span data-stu-id="670a1-279">Configure hello backup policy and select hello VM from hello same UI.</span></span>

4.  <span data-ttu-id="670a1-280">Győződjön meg arról, hogy hello hello VM Backup szolgáltatás ügynöke telepítve van.</span><span class="sxs-lookup"><span data-stu-id="670a1-280">Make sure hello Backup Agent is installed on hello VM.</span></span> <span data-ttu-id="670a1-281">Ha a virtuális gép létrehozása az Azure katalógusában lemezkép használatával, majd hello Backup ügynök már telepítve van.</span><span class="sxs-lookup"><span data-stu-id="670a1-281">If your VM is created using an Azure gallery image, then hello Backup agent is already installed.</span></span> <span data-ttu-id="670a1-282">Egyéb (Ez azt jelenti, hogy ha egyéni lemezkép használata esetén), kövesse az utasításokat, túl[hello virtuális gépen a Virtuálisgép-ügynök telepítése hello](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="670a1-282">Otherwise (that is, if you are using a custom image), use instructions too[Install hello VM Agent on hello virtual machine](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="670a1-283">Győződjön meg arról, hogy hello VM hello biztonsági mentési szolgáltatás toofunction hálózati kapcsolattal.</span><span class="sxs-lookup"><span data-stu-id="670a1-283">Make sure that hello VM allows network connectivity for hello backup service toofunction.</span></span> <span data-ttu-id="670a1-284">Kövesse ezeket az utasításokat a [hálózati kapcsolatra](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="670a1-284">Follow these instructions for [Network connectivity](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="670a1-285">Hello a fenti lépések elvégzése után hello biztonsági mentés a biztonsági mentési házirend hello rendszeres időközönként indul el.</span><span class="sxs-lookup"><span data-stu-id="670a1-285">Once hello above steps are completed, hello backup will run at regular intervals as specified in hello backup policy.</span></span> <span data-ttu-id="670a1-286">Ha szükséges, hello manuálisan irányítópultról hello tároló hello Azure-portálon az első biztonsági mentés indíthat el.</span><span class="sxs-lookup"><span data-stu-id="670a1-286">If necessary, you can trigger hello first backup manually from hello vault dashboard on hello Azure portal.</span></span>

<span data-ttu-id="670a1-287">A automatizálása Azure biztonsági mentési parancsfájlok segítségével, tekintse meg az túl[PowerShell-parancsmagok a virtuális gép biztonsági mentése](../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-287">For automating Azure Backup using scripts, please refer too[PowerShell cmdlets for VM backup](../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="670a1-288">A helyreállítás lépései</span><span class="sxs-lookup"><span data-stu-id="670a1-288">Steps for Recovery</span></span>

<span data-ttu-id="670a1-289">Ha toorepair kell, vagy építse újra a virtuális gépek, helyreállíthatja a hello VM bármelyik hello biztonsági mentések helyreállítási pontjait hello tárolóban lévő állapottal.</span><span class="sxs-lookup"><span data-stu-id="670a1-289">If you need toorepair or rebuild a VM, you can restore hello VM from any of hello backup recovery points in hello vault.</span></span> <span data-ttu-id="670a1-290">Többféle hello helyreállítás végrehajtását különböző lehetőségek közül:</span><span class="sxs-lookup"><span data-stu-id="670a1-290">There are a couple of different options for performing hello recovery:</span></span>

1.  <span data-ttu-id="670a1-291">A biztonsági másolat virtuális Gépet egy időpontban ábrázolása, hozhat létre egy új virtuális Gépet.</span><span class="sxs-lookup"><span data-stu-id="670a1-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="670a1-292">Visszaállíthatja a hello lemezeket, és ezután használja az hello sablon hello VM toocustomize és rebuild hello visszaállítani a virtuális gép.</span><span class="sxs-lookup"><span data-stu-id="670a1-292">You can restore hello disks and then use hello template for hello VM toocustomize and rebuild hello restored VM.</span></span> 

<span data-ttu-id="670a1-293">Kövesse az utasításokat túl[használata Azure portál toorestore virtuális gépek](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="670a1-293">See instructions too[Use Azure portal toorestore virtual machines](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="670a1-294">hello dokumentum is ismerteti hello adott visszaállítására a biztonsági másolat virtuális gépek toohello párosított adatközpont a georedundáns biztonsági mentési tároló használatával egy olyan vészhelyzet esetén, az elsődleges adatközpont hello hello esetében.</span><span class="sxs-lookup"><span data-stu-id="670a1-294">hello document also explains hello specific steps for restoring backed-up VMs toohello paired data center using your geo-redundant backup vault in hello case of a disaster at hello primary data center.</span></span> <span data-ttu-id="670a1-295">Ebben az esetben az Azure Backup hello számítási szolgáltatást hello másodlagos régióba toocreate hello visszaállított virtuális gépről használja.</span><span class="sxs-lookup"><span data-stu-id="670a1-295">In that case, Azure Backup uses hello Compute service from hello secondary region toocreate hello restored virtual machine.</span></span>

<span data-ttu-id="670a1-296">Használhatja a PowerShell [visszaállítását egy virtuális gép](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) vagy [lemezeket az új virtuális gép létrehozása vissza](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="670a1-296">You can also use PowerShell for [restoring a VM](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="670a1-297">Alternatív megoldás: Alkalmazáskonzisztens pillanatképek</span><span class="sxs-lookup"><span data-stu-id="670a1-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="670a1-298">Ha nem toouse hello Azure Backup szolgáltatás, a saját készített pillanatfelvételek segítségével történő biztonsági mentési mechanizmus valósíthat meg.</span><span class="sxs-lookup"><span data-stu-id="670a1-298">If you are unable toouse hello Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="670a1-299">Bonyolult toocreate alkalmazáskonzisztens pillanatképek egy virtuális gép által használt lemezek, és ezek a pillanatképek tooanother régió majd replikálja.</span><span class="sxs-lookup"><span data-stu-id="670a1-299">It is complicated toocreate consistent snapshots for all disks used by a VM and then replicate those snapshots tooanother region.</span></span> <span data-ttu-id="670a1-300">Emiatt Azure úgy ítéli meg emelés hello biztonsági mentési szolgáltatás egy jobb megoldás, mint egy egyéni megoldás összeállításakor.</span><span class="sxs-lookup"><span data-stu-id="670a1-300">For this reason, Azure considers leveraging hello Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="670a1-301">RA-GRS/Georedundáns tárolás használatakor a lemezeket, akkor a pillanatképeket automatikusan replikált tooa másodlagos adatközpont.</span><span class="sxs-lookup"><span data-stu-id="670a1-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="670a1-302">LRS-tároló lemez használja, ha szüksége lesz tooreplicate hello adatok magát.</span><span class="sxs-lookup"><span data-stu-id="670a1-302">If you use LRS storage for disks, you will need tooreplicate hello data yourself.</span></span> <span data-ttu-id="670a1-303">További információkért lásd: [készítsen biztonsági másolatot az Azure nem felügyelt méretű lemezek növekményes pillanatképek](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

<span data-ttu-id="670a1-304">Pillanatkép egy időben egy adott időpontban objektum ábrázolása.</span><span class="sxs-lookup"><span data-stu-id="670a1-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="670a1-305">Pillanatkép gyakorisága számlázási hello növekményes méretéhez hello adatok azt tartalmazza.</span><span class="sxs-lookup"><span data-stu-id="670a1-305">A snapshot will incur billing for hello incremental size of hello data it holds.</span></span> <span data-ttu-id="670a1-306">További információkért lásd: [blob pillanatkép létrehozása](storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-306">For more information, see [Create a blob snapshot](storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-hello-vm-is-running"></a><span data-ttu-id="670a1-307">Hello közben pillanatképeinek virtuális gép fut.</span><span class="sxs-lookup"><span data-stu-id="670a1-307">Creating snapshots while hello VM is running</span></span>

<span data-ttu-id="670a1-308">Is pillanatképet készít, bármikor Ha hello virtuális gép fut, miközben továbbra is az adatfolyamként toohello lemezek adatai, és hello pillanatképek tartalmazhat részleges műveletek, melyeket a felhőszolgáltató közötti átviteléhez.</span><span class="sxs-lookup"><span data-stu-id="670a1-308">While you can take a snapshot at any time, if hello VM is running, there is still data being streamed toohello disks, and hello snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="670a1-309">Is ha több lemez használnak, különböző lemezek pillanatképei hello azért fordulhatott elő különböző időpontokban, ami azt jelenti, hogy ezeket a pillanatképeket nem lehet koordinált.</span><span class="sxs-lookup"><span data-stu-id="670a1-309">Also, if there are several disks involved, hello snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="670a1-310">Ez a különösen akkor jelent problémát, amelynek fájlok megsérülhetnek, ha éppen módosítva biztonsági mentés során csíkozott kötetek.</span><span class="sxs-lookup"><span data-stu-id="670a1-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="670a1-311">tooavoid ebben a helyzetben hello biztonsági mentési folyamat implementálnia kell a következő lépéseket hello:</span><span class="sxs-lookup"><span data-stu-id="670a1-311">tooavoid this situation, hello backup process must implement hello following steps:</span></span>

1.  <span data-ttu-id="670a1-312">Az összes hello lemez rögzítése</span><span class="sxs-lookup"><span data-stu-id="670a1-312">Freeze all hello disks</span></span>

2.  <span data-ttu-id="670a1-313">Ürítse ki az összes hello írása függőben</span><span class="sxs-lookup"><span data-stu-id="670a1-313">Flush all hello pending writes</span></span>

3.  <span data-ttu-id="670a1-314">Ezt követően [blob pillanatkép létrehozása](storage-blob-snapshots.md) az összes hello lemezek</span><span class="sxs-lookup"><span data-stu-id="670a1-314">Then, [create a blob snapshot](storage-blob-snapshots.md) for all hello disks</span></span>

<span data-ttu-id="670a1-315">Egyes Windows-alkalmazások, például az SQL Server egy olyan mechanizmust koordinált biztonsági mentés VSS toocreate alkalmazáskonzisztens biztonsági mentések keresztül.</span><span class="sxs-lookup"><span data-stu-id="670a1-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS toocreate application-consistent backups.</span></span> <span data-ttu-id="670a1-316">Linux egy eszköz, például fsfreeze használható összehangolása a hello lemezek, amely előállít fájlkonzisztens biztonsági mentések, de nem alkalmazáskonzisztens pillanatképeket.</span><span class="sxs-lookup"><span data-stu-id="670a1-316">On Linux, you can use a tool like fsfreeze for coordinating hello disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="670a1-317">Ez a folyamat bonyolult, így érdemes használni, és [Azure biztonsági mentési](../backup/backup-azure-vms-introduction.md) vagy egy külső biztonsági mentési megoldást, amely már megvalósításának.</span><span class="sxs-lookup"><span data-stu-id="670a1-317">This process is complicated, so and you should consider using [Azure Backup](../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="670a1-318">hello folyamat fent egy gyűjtemény összes hello VM lemezek, egy adott időpontban ábrázolása hello VM képviselő koordinált pillanatképek eredményez.</span><span class="sxs-lookup"><span data-stu-id="670a1-318">hello above process will result in a collection of coordinated snapshots for all hello VM disks, representing a specific point-in-time view of hello VM.</span></span> <span data-ttu-id="670a1-319">Ez a hello virtuális gép egy biztonsági mentés visszaállítási pontot.</span><span class="sxs-lookup"><span data-stu-id="670a1-319">This is a backup restore point for hello VM.</span></span> <span data-ttu-id="670a1-320">Ütemezés szerint toocreate rendszeres biztonsági mentést, hello eljárás megismétlésével.</span><span class="sxs-lookup"><span data-stu-id="670a1-320">You can repeat hello process at scheduled intervals toocreate periodic backups.</span></span> <span data-ttu-id="670a1-321">Olvassa el az alábbi lépéseket hello túl[másolási hello biztonsági mentések tooanother régió](#copy-the-snapshots-to-another-region) Dr.</span><span class="sxs-lookup"><span data-stu-id="670a1-321">See below for hello steps too[copy hello backups tooanother region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-hello-vm-is-offline"></a><span data-ttu-id="670a1-322">Hello közben pillanatképeinek VM offline állapotban</span><span class="sxs-lookup"><span data-stu-id="670a1-322">Creating snapshots while hello VM is offline</span></span>

<span data-ttu-id="670a1-323">Egy másik lehetőség toocreate konzisztens biztonsági másolatok leáll hello VM és véve blob egyes lemezek pillanatkép-készítési.</span><span class="sxs-lookup"><span data-stu-id="670a1-323">Another option toocreate consistent backups is shutting down hello VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="670a1-324">Ez az egyszerűbb, mint a futó virtuális gépek koordináló pillanatképek, de néhány perc leállás mellett van szükség.</span><span class="sxs-lookup"><span data-stu-id="670a1-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="670a1-325">Ez a folyamat kövesse az alábbi lépéseket:</span><span class="sxs-lookup"><span data-stu-id="670a1-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="670a1-326">Állítsa le a virtuális gép hello.</span><span class="sxs-lookup"><span data-stu-id="670a1-326">Shut down hello VM.</span></span>

2. <span data-ttu-id="670a1-327">Pillanatkép létrehozása a minden Virtuálismerevlemez-blobot, amely csak a néhány másodpercet vesz igénybe.</span><span class="sxs-lookup"><span data-stu-id="670a1-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="670a1-328">toocreate pillanatképet, használhat [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), vagy egy hello Azure Storage Ügyfélkódtáraival például [ hello Storage ügyféloldali kódtára a .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="670a1-328">toocreate a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of hello Azure Storage Client Libraries such as [hello Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="670a1-329">Indítsa el a virtuális gép, amely hello állásidő vége hello.</span><span class="sxs-lookup"><span data-stu-id="670a1-329">Start hello VM, which ends hello downtime.</span></span> <span data-ttu-id="670a1-330">Általában hello teljes folyamat néhány percen belül befejeződik.</span><span class="sxs-lookup"><span data-stu-id="670a1-330">Typically hello entire process completes within a few minutes.</span></span>

<span data-ttu-id="670a1-331">Ez a folyamat egy gyűjtemény összes hello lemezek, a biztonsági mentés visszaállítási pontot biztosítva hello VM alkalmazáskonzisztens pillanatképek adja eredményül.</span><span class="sxs-lookup"><span data-stu-id="670a1-331">This process yields a collection of consistent snapshots for all hello disks, providing a backup restore point for hello VM.</span></span> <span data-ttu-id="670a1-332">Lásd az alábbi hello lépéseket toocopy hello pillanatképek tooanother régió Dr.</span><span class="sxs-lookup"><span data-stu-id="670a1-332">See below for hello steps toocopy hello snapshots tooanother region for DR.</span></span>

### <a name="copy-hello-snapshots-tooanother-region"></a><span data-ttu-id="670a1-333">Másolás hello pillanatképek tooanother régió</span><span class="sxs-lookup"><span data-stu-id="670a1-333">Copy hello snapshots tooanother region</span></span>

<span data-ttu-id="670a1-334">Hello pillanatképek önmagában létrehozásának nem elegendő a vész-Helyreállítási lehet.</span><span class="sxs-lookup"><span data-stu-id="670a1-334">Creation of hello snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="670a1-335">Hello pillanatkép biztonsági mentések tooanother régió replikálnia is kell.</span><span class="sxs-lookup"><span data-stu-id="670a1-335">You must also replicate hello snapshot backups tooanother region.</span></span>

<span data-ttu-id="670a1-336">Ha grs-re vagy RA-GRS a lemezek használ, majd hello pillanatképei replikált toohello másodlagos régióba automatikusan.</span><span class="sxs-lookup"><span data-stu-id="670a1-336">If you are using GRS or RA-GRS for your disks, then hello snapshots are replicated toohello secondary region automatically.</span></span> <span data-ttu-id="670a1-337">Néhány percet, mielőtt hello replikációs késés lehet, és ha hello elsődleges adatközpont leáll, mielőtt hello pillanatképek Befejezés replikálása, csak akkor tudja tooaccess hello pillanatképeinek hello másodlagos adatközpont.</span><span class="sxs-lookup"><span data-stu-id="670a1-337">There can be a few minutes of lag before hello replication, and if hello primary data center goes down before hello snapshots finish replicating, you will not be able tooaccess hello snapshots from hello secondary data center.</span></span> <span data-ttu-id="670a1-338">hello annak valószínűségét, hogy ez nem nagy.</span><span class="sxs-lookup"><span data-stu-id="670a1-338">hello likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="670a1-339">Csak rendelkező hello lemezek grs-re vagy RA-GRS-fiók nem nyújt védelmet hello VM a vészhelyzetek esetére.</span><span class="sxs-lookup"><span data-stu-id="670a1-339">Only having hello disks in a GRS or RA-GRS account does not protect hello VM from disasters.</span></span> <span data-ttu-id="670a1-340">Kell koordinált pillanatképeket, vagy az Azure Backupot használni.</span><span class="sxs-lookup"><span data-stu-id="670a1-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="670a1-341">Ez azért szükség toorecover VM tooa konzisztens állapotú legyen.</span><span class="sxs-lookup"><span data-stu-id="670a1-341">This is required toorecover a VM tooa consistent state.</span></span>

<span data-ttu-id="670a1-342">LRS használatakor hello pillanatkép létrehozása után azonnal hello pillanatképek tooa eltérő tárfiók kell másolnia.</span><span class="sxs-lookup"><span data-stu-id="670a1-342">If you are using LRS, you must copy hello snapshots tooa different storage account immediately after creating hello snapshot.</span></span> <span data-ttu-id="670a1-343">hello másolás célja az LRS tárfiók más régióban, hello másolása folyamatban egy távoli régióban eredményezve lehet.</span><span class="sxs-lookup"><span data-stu-id="670a1-343">hello copy target could be an LRS storage account in a different region, resulting in hello copy being in a remote region.</span></span> <span data-ttu-id="670a1-344">Hello pillanatkép tooan RA-GRS-tárfiókot is másolhatja a hello ugyanabban a régióban.</span><span class="sxs-lookup"><span data-stu-id="670a1-344">You can also copy hello snapshot tooan RA-GRS storage account in hello same region.</span></span> <span data-ttu-id="670a1-345">Ebben az esetben a hello pillanatkép lesz lazily replikált toohello távoli másodlagos régióba.</span><span class="sxs-lookup"><span data-stu-id="670a1-345">In this case, hello snapshot will be lazily replicated toohello remote secondary region.</span></span> <span data-ttu-id="670a1-346">A biztonsági mentés védett katasztrófák hello elsődleges helyen a hello fájlmásolási és -replikáció befejezése után.</span><span class="sxs-lookup"><span data-stu-id="670a1-346">Your backup is protected from disasters at hello primary site once hello copying and replication is complete.</span></span>

<span data-ttu-id="670a1-347">toocopy a vész-Helyreállítási növekményes pillanatképek hatékonyan, tekintse át hello utasításait [készítsen biztonsági másolatot az Azure nem felügyelt méretű lemezek növekményes pillanatképek](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-347">toocopy your incremental snapshots for DR efficiently, review hello instructions in [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

![][2]

### <a name="recovery-from-snapshots"></a><span data-ttu-id="670a1-348">A pillanatképek helyreállítás</span><span class="sxs-lookup"><span data-stu-id="670a1-348">Recovery from Snapshots</span></span>

<span data-ttu-id="670a1-349">tooretrieve egy pillanatképet, egy új blob toomake másolja.</span><span class="sxs-lookup"><span data-stu-id="670a1-349">tooretrieve a snapshot, copy it toomake a new blob.</span></span> <span data-ttu-id="670a1-350">Hello pillanatkép másolása hello elsődleges fiókból, másolhatja hello pillanatkép-keresztül toohello alap blob hello pillanatkép, így visszaállítási hello lemez toohello pillanatkép; Ez az úgynevezett hello pillanatkép támogatása.</span><span class="sxs-lookup"><span data-stu-id="670a1-350">If you are copying hello snapshot from hello primary account, you can copy hello snapshot over toohello base blob of hello snapshot, thus reverting hello disk toohello snapshot; this is known as promoting hello snapshot.</span></span> <span data-ttu-id="670a1-351">Hello pillanatkép biztonsági másolatából másolása (a hello esetben az RA-GRS) egy másodlagos fiókból, kell lennie tooa elsődleges fiók másolva.</span><span class="sxs-lookup"><span data-stu-id="670a1-351">If you are copying hello snapshot backup from a secondary account (in hello case of RA-GRS), it must be copied tooa primary account.</span></span> <span data-ttu-id="670a1-352">Pillanatkép másolhatja [PowerShell-lel](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) vagy hello AzCopy segédprogram használatával.</span><span class="sxs-lookup"><span data-stu-id="670a1-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using hello AzCopy utility.</span></span> <span data-ttu-id="670a1-353">További információkért lásd: [adatátvitel az AzCopy parancssori segédprogram hello](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-353">For more information, see [Transfer data with hello AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="670a1-354">Hello a több lemezzel rendelkező virtuális gépek esetében, át kell másolnia az összes azonos koordinált hello részét képező hello pillanatképek visszaállítási pont.</span><span class="sxs-lookup"><span data-stu-id="670a1-354">In hello case of VMs with multiple disks, you must copy all hello snapshots that are part of hello same coordinated restore point.</span></span> <span data-ttu-id="670a1-355">Ha hello pillanatképek toowritable VHD-blobok másolja, a virtuális Gépet a virtuális gép hello hello sablonnal hello blobok toorecreate azonnal használható.</span><span class="sxs-lookup"><span data-stu-id="670a1-355">Once you copy hello snapshots toowritable VHD blobs, you can use hello blobs toorecreate your VM using hello template for hello VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="670a1-356">Egyéb beállítások</span><span class="sxs-lookup"><span data-stu-id="670a1-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="670a1-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="670a1-357">SQL Server</span></span>

<span data-ttu-id="670a1-358">Virtuális gépen futó SQL Server a saját beépített képességei toobackup rendelkezik, az SQL Server adatbázis tooAzure Blob-tároló vagy egy fájlmegosztáson.</span><span class="sxs-lookup"><span data-stu-id="670a1-358">SQL Server running in a VM has its own built-in capabilities toobackup your SQL Server database tooAzure Blob storage or a file share.</span></span> <span data-ttu-id="670a1-359">Ha hello tárfiók grs-re vagy RA-GRS, végezheti el ezeket a hello tárfiók másodlagos adatközpont hello esemény egy olyan vészhelyzet esetén a biztonsági másolatok a hello ugyanazok a korlátozások vonatkoznak, mint a korábban tárgyalt.</span><span class="sxs-lookup"><span data-stu-id="670a1-359">If hello storage account is GRS or RA-GRS, you can access those backups in hello storage account’s secondary data center in hello event of a disaster, with hello same restrictions as discussed previously.</span></span> <span data-ttu-id="670a1-360">További információkért lásd: [biztonsági mentése és visszaállítása az SQL Server Azure virtuális gépek](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="670a1-361">Továbbá toobackup és visszaállítási [SQL Server Always On rendelkezésre állási csoportok](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) is fenntartható a másodlagos replikáin adatbázisok toogreatly hello vész-helyreállítási idő csökkentése.</span><span class="sxs-lookup"><span data-stu-id="670a1-361">In addition toobackup and restore, [SQL Server Always On Availability Groups](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases toogreatly reduce hello disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="670a1-362">Egyéb szempontok</span><span class="sxs-lookup"><span data-stu-id="670a1-362">Other considerations</span></span>

<span data-ttu-id="670a1-363">Ez a cikk rendelkezik tárgyalt hogyan toobackup vagy hajtsa végre a megfelelő pillanatképek a virtuális gépek és a lemezek toosupport vész-helyreállítási, és hogyan toouse e toorecover.</span><span class="sxs-lookup"><span data-stu-id="670a1-363">This article has discussed how toobackup or take snapshots of your VMs and their disks toosupport disaster recovery, and how toouse those toorecover.</span></span> <span data-ttu-id="670a1-364">Hello Azure Resource Manager modellt sokan használnak sablonok toocreate a virtuális gépek és egyéb infrastruktúrával az Azure-ban.</span><span class="sxs-lookup"><span data-stu-id="670a1-364">With hello Azure Resource Manager model, many people use templates toocreate their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="670a1-365">Használhatja a sablont egy virtuális Gépet, amelynek hello toocreate minden alkalommal ugyanazt a konfigurációt.</span><span class="sxs-lookup"><span data-stu-id="670a1-365">You can use a template toocreate a VM that has hello same configuration every time.</span></span> <span data-ttu-id="670a1-366">Egyéni lemezképek létrehozásához a virtuális gépek használatakor is meg kell győződnie, hogy a képek az RA-GRS fiók toostore-kóddal védett őket.</span><span class="sxs-lookup"><span data-stu-id="670a1-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account toostore them.</span></span>

<span data-ttu-id="670a1-367">Ezért a biztonsági mentési folyamat két dolgot kombinációja lehet:</span><span class="sxs-lookup"><span data-stu-id="670a1-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="670a1-368">Biztonsági mentési hello adatok (lemez)</span><span class="sxs-lookup"><span data-stu-id="670a1-368">Backup hello data (disks)</span></span>
2. <span data-ttu-id="670a1-369">Biztonsági mentési hello konfigurációs (sablonok, egyéni lemezképek)</span><span class="sxs-lookup"><span data-stu-id="670a1-369">Backup hello configuration (templates, custom images)</span></span>

<span data-ttu-id="670a1-370">Attól függően, hogy hello biztonsági mentési lehetőséget választja előfordulhat, hogy toohandle hello biztonsági másolata mind hello és hello konfigurációs, vagy hello biztonsági mentési szolgáltatás előfordulhat, hogy kezelni tudja, hogy az Ön.</span><span class="sxs-lookup"><span data-stu-id="670a1-370">Depending on hello backup option you choose, you may have toohandle hello backup of both hello data and hello configuration, or hello backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-hello-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="670a1-371">Függelék – LRS, GRS és RA-GRS hello hatásának ismertetése</span><span class="sxs-lookup"><span data-stu-id="670a1-371">Appendix - Understanding hello impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="670a1-372">Az Azure storage-fiókok, háromféle adatredundanciát is figyelembe kell vennie az vonatkozó vész-helyreállítási – helyileg redundáns (LRS), georedundáns (GRS), vagy georedundáns az olvasási hozzáférést (RA-GRS).</span><span class="sxs-lookup"><span data-stu-id="670a1-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="670a1-373">Helyileg redundáns tárolás (LRS) megőrzi az hello hello adatok három példányban ugyanabban az adatközpontban.</span><span class="sxs-lookup"><span data-stu-id="670a1-373">Locally Redundant Storage (LRS) retains three copies of hello data in hello same data center.</span></span> <span data-ttu-id="670a1-374">Hello adatok írásakor, minden három másolatot frissítése előtt sikeres visszaadott toohello hívó, így megtudhatja, hogy azok egyezését.</span><span class="sxs-lookup"><span data-stu-id="670a1-374">When writing hello data, all three copies are updated before success is returned toohello caller, so you know they are identical.</span></span> <span data-ttu-id="670a1-375">A lemez védett a helyi hibák, nem valószínű, hogy minden három másolatot hatással lenne az kell hello óta egy időben.</span><span class="sxs-lookup"><span data-stu-id="670a1-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at hello same time.</span></span> <span data-ttu-id="670a1-376">LRS hello esetben nincs nincs georedundancia, így hello lemez nem védett a végzetes hibák, amely hatással lehet egy teljes data center vagy tárolási egység.</span><span class="sxs-lookup"><span data-stu-id="670a1-376">In hello case of LRS, there is no geo-redundancy, so hello disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="670a1-377">Georedundáns és RA-GRS az adatok három másolatot kerülnek be az elsődleges régióban hello (az Ön által kiválasztott), valamint az adatok három további példányait a megfelelő másodlagos régióban (beállítása az Azure-ban) megmaradnak.</span><span class="sxs-lookup"><span data-stu-id="670a1-377">With GRS and RA-GRS, three copies of your data are retained in hello primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="670a1-378">Például adat tárolása USA nyugati régiója, hello adatok replikált tooEast USA lesz.</span><span class="sxs-lookup"><span data-stu-id="670a1-378">For example, if you store data in West US, hello data will be replicated tooEast US.</span></span> <span data-ttu-id="670a1-379">Ez aszinkron módon történik, és némi késés frissítések toohello elsődleges és másodlagos között van.</span><span class="sxs-lookup"><span data-stu-id="670a1-379">This is done asynchronously, and there is a small delay between updates toohello primary and secondary.</span></span> <span data-ttu-id="670a1-380">Hello lemezeit hello másodlagos hely replika konzisztens lemez alapú (hello késleltetés), de a több aktív lemez replikái nem lehet szinkronban **egymással**.</span><span class="sxs-lookup"><span data-stu-id="670a1-380">Replicas of hello disks on hello secondary site are consistent on a per-disk basis (with hello delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="670a1-381">toohave konzisztens replikák több lemezre, alkalmazáskonzisztens pillanatképek van szükség.</span><span class="sxs-lookup"><span data-stu-id="670a1-381">toohave consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="670a1-382">hello fő Georedundáns és az RA-GRS közötti különbség, hogy az RA-GRS, hello másodlagos másolat olvasható bármikor.</span><span class="sxs-lookup"><span data-stu-id="670a1-382">hello main difference between GRS and RA-GRS is that with RA-GRS, you can read hello secondary copy at any time.</span></span> <span data-ttu-id="670a1-383">Ha a probléma jeleníti meg az elsődleges régióban hello hello adatok nem érhetők el, hello Azure-csapat minden erőfeszítést toorestore hozzáférés működésképtelenné teszi.</span><span class="sxs-lookup"><span data-stu-id="670a1-383">If there is a problem that renders hello data in hello primary region inaccessible, hello Azure team will make every effort toorestore access.</span></span> <span data-ttu-id="670a1-384">Amíg elsődleges hello nem működik, ha az RA-GRS engedélyezve van, hozzáférhet-e hello adatok hello másodlagos adatközpont.</span><span class="sxs-lookup"><span data-stu-id="670a1-384">While hello primary is down, if you have RA-GRS enabled, you can access hello data in hello secondary data center.</span></span> <span data-ttu-id="670a1-385">Ezért ha hello replikából tooread elsődleges hello állapotában nem érhető el, majd RA-GRS-érdemes figyelembe venni.</span><span class="sxs-lookup"><span data-stu-id="670a1-385">Therefore, if you plan tooread from hello replica while hello primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="670a1-386">Ha toobe egy jelentős leállás, hello Azure csapata egy földrajzi feladatátvételt indít és hello elsődleges DNS-bejegyzések toopoint toosecondary tárolás módosítása.</span><span class="sxs-lookup"><span data-stu-id="670a1-386">If it turns out toobe a significant outage, hello Azure team may trigger a geo-failover and change hello primary DNS entries toopoint toosecondary storage.</span></span> <span data-ttu-id="670a1-387">Ezen a ponton Ha bármelyik Georedundáns vagy RA-GRS engedélyezve van, van-e hozzáférési hello adatok toobe hello másodlagos használt hello régióban.</span><span class="sxs-lookup"><span data-stu-id="670a1-387">At this point, if you have either GRS or RA-GRS enabled, you can access hello data in hello region that used toobe hello secondary.</span></span> <span data-ttu-id="670a1-388">Ez azt jelenti Ha a tárfiók Georedundáns és probléma merül fel, végezheti el hello másodlagos tároló földrajzi-feladatátvétel esetén csak.</span><span class="sxs-lookup"><span data-stu-id="670a1-388">In other words, if your storage account is GRS and there is a problem, you can access hello secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="670a1-389">További információkért lásd: [egy Azure Storage tervezett kimaradás esetén milyen toodo](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="670a1-389">For more information, see [What toodo if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="670a1-390">Figyelje meg, hogy a Microsoft meghatározza, hogy egy feladatátvétel történik.</span><span class="sxs-lookup"><span data-stu-id="670a1-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="670a1-391">Feladatátvétel nem szabályozott egy tárfiókot, ezért úgy nem határoznak egyéni ügyfelek.</span><span class="sxs-lookup"><span data-stu-id="670a1-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="670a1-392">Vész-helyreállítási tooimplement meghatározott tárfiókok és a virtuális gépek lemezeit, az ebben a cikkben korábban ismertetett hello technikák kell használnia.</span><span class="sxs-lookup"><span data-stu-id="670a1-392">tooimplement Disaster Recovery for specific storage accounts or virtual machine disks, you must use hello techniques described previously in this article.</span></span>



[1]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png
[2]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png