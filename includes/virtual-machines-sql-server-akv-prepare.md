## <a name="prepare-for-akv-integration"></a><span data-ttu-id="39380-101">Készítse elő a AKV-integráció</span><span class="sxs-lookup"><span data-stu-id="39380-101">Prepare for AKV Integration</span></span>
<span data-ttu-id="39380-102">toouse Azure Key Vault-integráció tooconfigure az SQL Server virtuális gép nincsenek több Előfeltételek:</span><span class="sxs-lookup"><span data-stu-id="39380-102">toouse Azure Key Vault Integration tooconfigure your SQL Server VM, there are several prerequisites:</span></span> 

1. [<span data-ttu-id="39380-103">Azure Powershell telepítése</span><span class="sxs-lookup"><span data-stu-id="39380-103">Install Azure Powershell</span></span>](#install-azure-powershell)
2. [<span data-ttu-id="39380-104">Hozzon létre egy Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="39380-104">Create an Azure Active Directory</span></span>](#create-an-azure-active-directory)
3. [<span data-ttu-id="39380-105">Hozzon létre egy kulcstartót</span><span class="sxs-lookup"><span data-stu-id="39380-105">Create a key vault</span></span>](#create-a-key-vault)

<span data-ttu-id="39380-106">hello következő szakaszok ismertetik ezeket Előfeltételek és a szükséges toocollect futtatása toolater hello PowerShell-parancsmagok hello információkat.</span><span class="sxs-lookup"><span data-stu-id="39380-106">hello following sections describe these prerequisites and hello information you need toocollect toolater run hello PowerShell cmdlets.</span></span>

### <a name="install-azure-powershell"></a><span data-ttu-id="39380-107">Az Azure PowerShell telepítése</span><span class="sxs-lookup"><span data-stu-id="39380-107">Install Azure PowerShell</span></span>
<span data-ttu-id="39380-108">Győződjön meg arról, hogy a telepített legújabb Azure PowerShell SDK hello.</span><span class="sxs-lookup"><span data-stu-id="39380-108">Make sure you have installed hello latest Azure PowerShell SDK.</span></span> <span data-ttu-id="39380-109">További információkért lásd: [hogyan tooinstall és konfigurálja az Azure Powershellt](/powershell/azureps-cmdlets-docs).</span><span class="sxs-lookup"><span data-stu-id="39380-109">For more information, see [How tooinstall and configure Azure PowerShell](/powershell/azureps-cmdlets-docs).</span></span>

### <a name="create-an-azure-active-directory"></a><span data-ttu-id="39380-110">Hozzon létre egy Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="39380-110">Create an Azure Active Directory</span></span>
<span data-ttu-id="39380-111">Először toohave egy [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) az előfizetésben.</span><span class="sxs-lookup"><span data-stu-id="39380-111">First, you need toohave an [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) in your subscription.</span></span> <span data-ttu-id="39380-112">Között számos előnyt így toogrant engedély tooyour kulcstárolójának bizonyos felhasználók és az alkalmazások.</span><span class="sxs-lookup"><span data-stu-id="39380-112">Among many benefits, this allows you toogrant permission tooyour key vault for certain users and applications.</span></span>

<span data-ttu-id="39380-113">Ezután regisztrálni egy alkalmazás AAD-ben.</span><span class="sxs-lookup"><span data-stu-id="39380-113">Next, register an application with AAD.</span></span> <span data-ttu-id="39380-114">Ekkor kap egy egyszerű hozzáférés tooyour kulcstároló, amely a virtuális Gépet kell rendelkező fiók.</span><span class="sxs-lookup"><span data-stu-id="39380-114">This will give you a Service Principal account that has access tooyour key vault which your VM will need.</span></span> <span data-ttu-id="39380-115">Hello Azure Key Vault a cikkben található lépéseket hello [alkalmazás regisztrálása az Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) szakasz, vagy látható hello a képernyőképek hello lépéseket **identitás hello alkalmazás beszerzése a szakasz** a [ebben a blogbejegyzésben](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span><span class="sxs-lookup"><span data-stu-id="39380-115">In hello Azure Key Vault article, you can find these steps in hello [Register an application with Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) section, or you can see hello steps with screen shots in hello **Get an identity for hello application section** of [this blog post](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span></span> <span data-ttu-id="39380-116">Az alábbi lépések elvégzése előtt ne feledje, hogy a következő információkat, amelyek később szükség van az SQL virtuális gép az Azure Key Vault-integráció engedélyezése esetén a regisztráció során toocollect hello.</span><span class="sxs-lookup"><span data-stu-id="39380-116">Before completing these steps, note that you need toocollect hello following information during this registration that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

* <span data-ttu-id="39380-117">Hello alkalmazás hozzáadása után található hello **ügyfél-azonosító** a hello **KONFIGURÁLÁSA** fülre.   ![Az Azure Active Directory ügyfél-azonosító](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span><span class="sxs-lookup"><span data-stu-id="39380-117">After hello application is added, find hello **CLIENT ID**  on hello **CONFIGURE** tab.   ![Azure Active Directory Client ID](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span></span>
  
    <span data-ttu-id="39380-118">hello ügyfél-azonosító hozzá van rendelve a későbbi toohello **$spName** hello PowerShell parancsfájl tooenable Azure Key Vault-integráció (egyszerű szolgáltatásnév) paramétere.</span><span class="sxs-lookup"><span data-stu-id="39380-118">hello client ID is assigned later toohello **$spName** (Service Principal name) parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span> 
* <span data-ttu-id="39380-119">Is során ezeket a lépéseket a kulcs létrehozásakor másolja a kulcs titkos kulcsát hello hello a következő képernyőfelvételen látható módon.</span><span class="sxs-lookup"><span data-stu-id="39380-119">Also, during these steps when you create your key, copy hello secret for your key as is shown in hello following screenshot.</span></span> <span data-ttu-id="39380-120">A kulcs titkos kódok hozzá van rendelve a későbbi toohello **$spSecret** hello PowerShell parancsfájl paramétere (egyszerű titok).</span><span class="sxs-lookup"><span data-stu-id="39380-120">This key secret is assigned later toohello **$spSecret** (Service Principal secret) parameter in hello PowerShell script.</span></span>  
    <span data-ttu-id="39380-121">![Az Azure Active Directory titkos kulcs](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span><span class="sxs-lookup"><span data-stu-id="39380-121">![Azure Active Directory Secret](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span></span>
* <span data-ttu-id="39380-122">Engedélyeznie kell az új ügyfél azonosító toohave hello hozzáférési engedélyek a következő: **titkosítása**, **visszafejtéséhez**, **wrapKey**, **unwrapKey**, **bejelentkezési**, és **ellenőrizze**.</span><span class="sxs-lookup"><span data-stu-id="39380-122">You must authorize this new client ID toohave hello following access permissions: **encrypt**, **decrypt**, **wrapKey**, **unwrapKey**, **sign**, and **verify**.</span></span> <span data-ttu-id="39380-123">Ez a lépés hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) parancsmag.</span><span class="sxs-lookup"><span data-stu-id="39380-123">This is done with hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet.</span></span> <span data-ttu-id="39380-124">További információ: [engedélyezés hello alkalmazás toouse hello kulcsok vagy titkos kulcsok](../articles/key-vault/key-vault-get-started.md#authorize).</span><span class="sxs-lookup"><span data-stu-id="39380-124">For more information see [Authorize hello application toouse hello key or secret](../articles/key-vault/key-vault-get-started.md#authorize).</span></span>

### <a name="create-a-key-vault"></a><span data-ttu-id="39380-125">Kulcstartó létrehozása</span><span class="sxs-lookup"><span data-stu-id="39380-125">Create a key vault</span></span>
<span data-ttu-id="39380-126">Rendelés toouse Azure Key Vault toostore hello kulcsok szüksége lesz a titkosításhoz a virtuális Gépet meg kell hozzáférés tooa kulcstároló.</span><span class="sxs-lookup"><span data-stu-id="39380-126">In order toouse Azure Key Vault toostore hello keys you will use for encryption in your VM, you need access tooa key vault.</span></span> <span data-ttu-id="39380-127">Ha már nem beállítása a kulcstároló, hozzon létre egyet hello hello utasításait követve [Ismerkedés az Azure Key Vault](../articles/key-vault/key-vault-get-started.md) témakör.</span><span class="sxs-lookup"><span data-stu-id="39380-127">If you have not already set up your key vault, create one by following hello steps in hello [Getting Started with Azure Key Vault](../articles/key-vault/key-vault-get-started.md) topic.</span></span> <span data-ttu-id="39380-128">A lépések végrehajtása előtt vegye figyelembe, hogy néhány adat toocollect van szüksége, amely a beállítása során később van szükség, ha engedélyezi az Azure Key Vault-integráció az SQL virtuális gép a.</span><span class="sxs-lookup"><span data-stu-id="39380-128">Before completing these steps, note that there is some information you need toocollect during this set up that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

<span data-ttu-id="39380-129">Meg toohello hozzon létre egy kulcstartót lépés Megjegyzés hello visszaadott **vaultUri** tulajdonságot, amelynek hello kulcstároló URL-cím.</span><span class="sxs-lookup"><span data-stu-id="39380-129">When you get toohello Create a key vault step, note hello returned **vaultUri** property, which is hello key vault URL.</span></span> <span data-ttu-id="39380-130">Hello példában, hogy az alábbi lépésben megadott hello kulcstároló neve ContosoKeyVault, ezért a hello kulcstároló URL-cím https://contosokeyvault.vault.azure.net/ lenne.</span><span class="sxs-lookup"><span data-stu-id="39380-130">In hello example provided in that step, shown below, hello key vault name is ContosoKeyVault, therefore hello key vault URL would be https://contosokeyvault.vault.azure.net/.</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVault' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia'

<span data-ttu-id="39380-131">hello kulcstároló URL-cím hozzá van rendelve a későbbi toohello **$akvURL** hello PowerShell parancsfájl tooenable Azure Key Vault-integráció paramétere.</span><span class="sxs-lookup"><span data-stu-id="39380-131">hello key vault URL is assigned later toohello **$akvURL** parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span>

