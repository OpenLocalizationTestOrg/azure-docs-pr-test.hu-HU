<span data-ttu-id="5c4a1-101">Ha az Azure-ban valamely virtuális gép (VM) indítási vagy lemezhibát észlel, előfordulhat, hogy magán a virtuális merevlemezen kell elvégeznie a hibaelhárítást.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-101">If your virtual machine (VM) in Azure encounters a boot or disk error, you may need to perform troubleshooting steps on the virtual hard disk itself.</span></span> <span data-ttu-id="5c4a1-102">Egy gyakori példa erre, amikor egy sikertelen alkalmazásfrissítés megakadályozza, hogy a virtuális gép sikeresen elinduljon.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-102">A common example would be a failed application update that prevents the VM from booting successfully.</span></span> <span data-ttu-id="5c4a1-103">A cikk leírja, hogyan csatlakoztathatja virtuális merevlemezét egy másik virtuális géphez az Azure Portal használatával a hibák javítása és az eredeti virtuális gép ismételt létrehozása érdekében.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-103">This article describes how to use Azure portal to connect your virtual hard disk to another VM to fix any errors and then re-create your original VM.</span></span>

## <a name="recovery-process-overview"></a><span data-ttu-id="5c4a1-104">Helyreállítási folyamat áttekintése</span><span class="sxs-lookup"><span data-stu-id="5c4a1-104">Recovery process overview</span></span>
<span data-ttu-id="5c4a1-105">A hibaelhárítási folyamat a következő:</span><span class="sxs-lookup"><span data-stu-id="5c4a1-105">The troubleshooting process is as follows:</span></span>

1. <span data-ttu-id="5c4a1-106">Törölje a meghibásodott virtuális gépet, de a virtuális merevlemezeket ne.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-106">Delete the VM that's encountering issues, but retain the virtual hard disks.</span></span>
2. <span data-ttu-id="5c4a1-107">Csatlakoztassa a virtuális merevlemezt egy másik virtuális géphez hibaelhárítás céljából.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-107">Attach and mount the virtual hard disk to another VM for troubleshooting.</span></span>
3. <span data-ttu-id="5c4a1-108">Kapcsolódjon a hibaelhárítást végző virtuális gépre.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-108">Connect to the troubleshooting VM.</span></span> <span data-ttu-id="5c4a1-109">A fájlok szerkesztésével vagy eszközök futtatásával javítsa a hibákat az eredeti virtuális merevlemezen.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-109">Edit files or run tools to fix errors on the original virtual hard disk.</span></span>
4. <span data-ttu-id="5c4a1-110">Válassza le a virtuális merevlemezt a hibaelhárító virtuális gépről.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-110">Unmount and detach the virtual hard disk from the troubleshooting VM.</span></span>
5. <span data-ttu-id="5c4a1-111">Hozzon létre egy virtuális gépet az eredeti virtuális merevlemez használatával.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-111">Create a VM by using the original virtual hard disk.</span></span>

## <a name="delete-the-original-vm"></a><span data-ttu-id="5c4a1-112">Az eredeti virtuális gép törlése</span><span class="sxs-lookup"><span data-stu-id="5c4a1-112">Delete the original VM</span></span>
<span data-ttu-id="5c4a1-113">A virtuális merevlemezek és a virtuális gépek az Azure-erőforrások két különböző típusa.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-113">Virtual hard disks and VMs are two distinct resources in Azure.</span></span> <span data-ttu-id="5c4a1-114">A virtuális merevlemezen található az operációs rendszer, az alkalmazások, valamint a konfigurációk.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-114">A virtual hard disk is where the operating system, applications, and configurations are stored.</span></span> <span data-ttu-id="5c4a1-115">A virtuális gép ezzel szemben csak egy metaadathalmaz, amely a méretet vagy a helyet határozza meg, illetve amely az erőforrásokra, például a virtuális merevlemezre vagy a virtuális hálózati kártyára (NIC) hivatkozik.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-115">The VM is just metadata that defines the size or location and that references resources such as a virtual hard disk or virtual network interface card (NIC).</span></span> <span data-ttu-id="5c4a1-116">A rendszer minden egyes virtuális merevlemezhez hozzárendel egy bérletet, amikor az adott merevlemez egy virtuális géphez lesz csatlakoztatva.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-116">Each virtual hard disk gets a lease assigned when that disk is attached to a VM.</span></span> <span data-ttu-id="5c4a1-117">Bár az adatlemezek akkor is csatlakoztathatók és leválaszthatók, amikor a virtuális gép üzemel, az operációs rendszer merevlemeze nem csatlakoztatható le, hacsak nem törli a VM-erőforrást.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-117">Although data disks can be attached and detached even while the VM is running, the OS disk cannot be detached unless the VM resource is deleted.</span></span> <span data-ttu-id="5c4a1-118">A bérlet továbbra is hozzárendeli az operációs rendszer merevlemezét a virtuális gépekhez, még ha az adott virtuális gép leállított vagy felszabadított állapotban van is.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-118">The lease continues to associate the OS disk to a VM even when that VM is in a stopped and deallocated state.</span></span>

<span data-ttu-id="5c4a1-119">A virtuális gép helyreállításának első lépése magának a virtuális gép erőforrásnak a törlése.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-119">The first step to recovering your VM is to delete the VM resource itself.</span></span> <span data-ttu-id="5c4a1-120">A virtuális gép törlésével a virtuális merevlemezek a tárfiókban maradnak.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-120">Deleting the VM leaves the virtual hard disks in your storage account.</span></span> <span data-ttu-id="5c4a1-121">A virtuális gép törlését követően a virtuális merevlemezt csatlakoztathatja egy másik virtuális géphez a hibák megkeresése és elhárítása érdekében.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-121">After the VM is deleted, you can attach the virtual hard disk to another VM to troubleshoot and resolve the errors.</span></span> 

1. <span data-ttu-id="5c4a1-122">Jelentkezzen be az [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="5c4a1-122">Sign in to the [Azure portal](https://portal.azure.com).</span></span> 
2. <span data-ttu-id="5c4a1-123">A bal oldali menüben kattintson a **Virtuális gépek (klasszikus)** elemre.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-123">On the menu on the left side, click **Virtual Machines (classic)**.</span></span>
3. <span data-ttu-id="5c4a1-124">Válassza ki a hibás virtuális gépet, kattintson a **Lemezek** elemre, majd azonosítsa a virtuális merevlemez nevét.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-124">Select the VM that has the problem, click **Disks**, and then identify the name of the virtual hard disk.</span></span> 
4. <span data-ttu-id="5c4a1-125">Válassza ki az operációs rendszer merevlemezét, és a **Hely** mezőben azonosítsa a virtuális merevlemezt tároló tárfiók nevét.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-125">Select the OS virtual hard disk and check the **Location** to identify the storage account that contains that virtual hard disk.</span></span> <span data-ttu-id="5c4a1-126">Az alábbi példában a közvetlenül a „.blob.core.windows.net” előtt álló karakterlánc a tárfiók neve.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-126">In the following example, the string immediately before ".blob.core.windows.net" is the storage account name.</span></span>

    ```
    https://portalvhds73fmhrw5xkp43.blob.core.windows.net/vhds/SCCM2012-2015-08-28.vhd
    ```

    ![A virtuális gép helyét bemutató kép](./media/virtual-machines-classic-recovery-disks-portal/vm-location.png)

5. <span data-ttu-id="5c4a1-128">Kattintson jobb gombbal a virtuális gépre, majd válassza a **Törlés** lehetőséget.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-128">Right-click the VM and then select **Delete**.</span></span> <span data-ttu-id="5c4a1-129">Győződjön meg róla, hogy a lemezek nincsenek kijelölve, amikor törli a virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-129">Make sure that the disks are not selected when you delete the VM.</span></span>
6. <span data-ttu-id="5c4a1-130">Hozzon létre egy új helyreállítási virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-130">Create a new recovery VM.</span></span> <span data-ttu-id="5c4a1-131">Ennek a virtuális gépnek ugyanabban a régióban és erőforráscsoportban (felhőszolgáltatás) kell lennie, mint a hibás virtuális gépnek.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-131">This VM must be in the same region and resource group (Cloud Service) as the problem VM.</span></span>
7. <span data-ttu-id="5c4a1-132">Jelölje ki a helyreállítási virtuális gépet, majd válassza a **Lemezek** > **Meglévő csatolása** lehetőséget.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-132">Select the recovery VM, and then select **Disks** > **Attach Existing**.</span></span>
8. <span data-ttu-id="5c4a1-133">A meglévő virtuális merevlemez kiválasztásához kattintson a **VHD-fájl** lehetőségre:</span><span class="sxs-lookup"><span data-stu-id="5c4a1-133">To select your existing virtual hard disk, click **VHD File**:</span></span>

    ![Meglévő VHD keresése](./media/virtual-machines-classic-recovery-disks-portal/select-vhd-location.png)

9. <span data-ttu-id="5c4a1-135">Jelölje ki a tárfiókot > a VHD-tárolót > és a virtuális merevlemezt, majd kattintson a **Kiválasztás** gombra a kijelölés megerősítéséhez.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-135">Select the storage account > VHD container > the virtual hard disk, click the **Select** button to confirm your choice.</span></span>

    ![Meglévő VHD kiválasztása](./media/virtual-machines-classic-recovery-disks-portal/select-vhd.png)

10. <span data-ttu-id="5c4a1-137">Miután már kiválasztotta a VHD-t, kattintson az **OK** gombra a meglévő virtuális merevlemez csatlakoztatásához.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-137">With your VHD now selected, select **OK** to attach the existing virtual hard disk.</span></span>
11. <span data-ttu-id="5c4a1-138">Néhány másodperc elteltével a virtuális gép **Lemezek** panelje csatlakoztatott adatlemezként jeleníti meg a meglévő virtuális merevlemezt:</span><span class="sxs-lookup"><span data-stu-id="5c4a1-138">After a few seconds, the **Disks** pane for your VM will display your existing virtual hard disk connected as a data disk:</span></span>

    ![Adatlemezként csatlakoztatott meglévő virtuális merevlemez](./media/virtual-machines-classic-recovery-disks-portal/attached-disk.png)

## <a name="fix-issues-on-the-original-virtual-hard-disk"></a><span data-ttu-id="5c4a1-140">Hibák javítása az eredeti virtuális merevlemezen</span><span class="sxs-lookup"><span data-stu-id="5c4a1-140">Fix issues on the original virtual hard disk</span></span>
<span data-ttu-id="5c4a1-141">Miután csatlakoztatta a meglévő virtuális merevlemezt, végrehajthatja a szükséges karbantartási és hibaelhárítási lépéseket.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-141">When the existing virtual hard disk is mounted, you can now perform any maintenance and troubleshooting steps as needed.</span></span> <span data-ttu-id="5c4a1-142">Miután végzett a hibák javításával, folytassa az alábbi lépésekkel.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-142">Once you have addressed the issues, continue with the following steps.</span></span>

## <a name="unmount-and-detach-the-original-virtual-hard-disk"></a><span data-ttu-id="5c4a1-143">Az eredeti virtuális merevlemez leválasztása</span><span class="sxs-lookup"><span data-stu-id="5c4a1-143">Unmount and detach the original virtual hard disk</span></span>
<span data-ttu-id="5c4a1-144">Miután a hibákat kijavította, válassza le a meglévő virtuális merevlemezt a hibaelhárító virtuális gépről.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-144">Once any errors are resolved, unmount and detach the existing virtual hard disk from your troubleshooting VM.</span></span> <span data-ttu-id="5c4a1-145">A virtuális merevlemezt nem használhatja más virtuális géppel, amíg a virtuális merevlemezt a hibaelhárító virtuális géphez társító bérlet nincs feloldva.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-145">You cannot use your virtual hard disk together with any other VM until the lease that attaches the virtual hard disk to the troubleshooting VM is released.</span></span>  

1. <span data-ttu-id="5c4a1-146">Jelentkezzen be az [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="5c4a1-146">Sign in to the [Azure portal](https://portal.azure.com).</span></span> 
2. <span data-ttu-id="5c4a1-147">A bal oldali menüben válassza a **Virtuális gépek (klasszikus)** elemet.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-147">On the menu on the left side, select **Virtual Machines (classic)**.</span></span>
3. <span data-ttu-id="5c4a1-148">Keresse meg a helyreállítási virtuális gépet.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-148">Locate the recovery VM.</span></span> <span data-ttu-id="5c4a1-149">Válassza a Lemezek lehetőséget, kattintson a jobb gombbal a lemezre, majd válassza a **Leválasztás** parancsot.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-149">Select Disks, right-click the disk, and then select **Detach**.</span></span>

## <a name="create-a-vm-from-the-original-hard-disk"></a><span data-ttu-id="5c4a1-150">Virtuális gép létrehozása az eredeti merevlemezről</span><span class="sxs-lookup"><span data-stu-id="5c4a1-150">Create a VM from the original hard disk</span></span>

<span data-ttu-id="5c4a1-151">Ha az eredeti virtuális merevlemezről szeretne létrehozni virtuális gépet, használja a [klasszikus Azure portált](https://manage.windowsazure.com).</span><span class="sxs-lookup"><span data-stu-id="5c4a1-151">To create a VM from your original virtual hard disk, use [Azure classic portal](https://manage.windowsazure.com).</span></span>

1. <span data-ttu-id="5c4a1-152">Jelentkezzen be a [klasszikus Azure portálra](https://manage.windowsazure.com).</span><span class="sxs-lookup"><span data-stu-id="5c4a1-152">Sign into [Azure classic portal](https://manage.windowsazure.com).</span></span>
2. <span data-ttu-id="5c4a1-153">A portál alsó részén válassza az **Új** > **Számítás** > **Virtuális gép** > **Gyűjteményből** elemet.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-153">At the bottom of the portal, select **New** > **Compute** > **Virtual Machine** > **From Gallery**.</span></span>
3. <span data-ttu-id="5c4a1-154">A **Kép kiválasztása** szakaszban válassza a **Saját lemezek** lehetőséget, majd válassza ki az eredeti virtuális merevlemezt.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-154">In the **Choose an Image** section, select **My disks**, and then select the original virtual hard disk.</span></span> <span data-ttu-id="5c4a1-155">Ellenőrizze a helyadatokat.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-155">Check the location information.</span></span> <span data-ttu-id="5c4a1-156">Ez az a régió, ahol a virtuális gépet üzembe kell helyezni.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-156">This is the region where the VM must be deployed.</span></span> <span data-ttu-id="5c4a1-157">Válassza a Tovább gombot.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-157">Select the next button.</span></span>
4. <span data-ttu-id="5c4a1-158">A **Virtuális gép konfigurációja** szakaszban írja be a virtuális gép nevét, majd válasszon méretet a virtuális gép számára.</span><span class="sxs-lookup"><span data-stu-id="5c4a1-158">In the **Virtual machine configuration** section, type the VM name and select a size for the VM.</span></span>